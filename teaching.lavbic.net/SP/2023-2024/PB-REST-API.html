<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Poglavje 6 P3.1 Podatkovna baza in REST API | Spletno programiranje 2023/2024</title>
  <meta name="description" content="Skripta za pomoč pri predmetu Spletno programiranje 2022/2023" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="Poglavje 6 P3.1 Podatkovna baza in REST API | Spletno programiranje 2023/2024" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Skripta za pomoč pri predmetu Spletno programiranje 2022/2023" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Poglavje 6 P3.1 Podatkovna baza in REST API | Spletno programiranje 2023/2024" />
  
  <meta name="twitter:description" content="Skripta za pomoč pri predmetu Spletno programiranje 2022/2023" />
  

<meta name="author" content="izr. prof. dr. Dejan Lavbič" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="Node-js.html"/>
<link rel="next" href="Swagger.html"/>
<script src="assets/lib/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="assets/lib/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="assets/lib/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="assets/lib/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="assets/lib/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="assets/lib/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="assets/lib/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="assets/lib/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="assets/lib/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="assets/lib/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="assets/lib/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="assets/lib/kePrint-0.0.1/kePrint.js"></script>
<link href="assets/lib/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="assets/style/stil.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="index.html#terminski-plan-izvajanja-predmeta">SP 2023/2024 terminski plan</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Uvod</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#splošne-informacije"><i class="fa fa-check"></i>Splošne informacije</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#predavatelj"><i class="fa fa-check"></i>Predavatelj</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#asistent"><i class="fa fa-check"></i>Asistent</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#terminski-plan-izvajanja-predmeta"><i class="fa fa-check"></i>Terminski plan izvajanja predmeta</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#pravila-igre"><i class="fa fa-check"></i>Pravila igre</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#predavanja"><i class="fa fa-check"></i>Predavanja</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#vaje"><i class="fa fa-check"></i>Vaje</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#ocenjevanje"><i class="fa fa-check"></i>Ocenjevanje</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#pisni-izpiti"><i class="fa fa-check"></i>Pisni izpiti</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#priporočena-literatura"><i class="fa fa-check"></i>Priporočena literatura</a></li>
</ul></li>
<li class="part"><span><b>I sklop: Uvod v spletno programiranje</b></span></li>
<li class="chapter" data-level="1" data-path="P11.html"><a href="P11.html"><i class="fa fa-check"></i><b>1</b> <span class="sklop1 oznaka">P1.1</span> Svetovni splet in celostni razvoj programske opreme</a>
<ul>
<li class="chapter" data-level="1.1" data-path="P11.html"><a href="P11.html#infrastrukturni-in-arhitekturni-pogled-na-svetovni-splet"><i class="fa fa-check"></i><b>1.1</b> Infrastrukturni in arhitekturni pogled na svetovni splet</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="P11.html"><a href="P11.html#moorov-zakon"><i class="fa fa-check"></i><b>1.1.1</b> Moorov zakon</a></li>
<li class="chapter" data-level="1.1.2" data-path="P11.html"><a href="P11.html#internet-vs.-svetovni-splet"><i class="fa fa-check"></i><b>1.1.2</b> Internet vs. (svetovni) splet</a></li>
<li class="chapter" data-level="1.1.3" data-path="P11.html"><a href="P11.html#razvoj-interneta"><i class="fa fa-check"></i><b>1.1.3</b> Razvoj interneta</a></li>
<li class="chapter" data-level="1.1.4" data-path="P11.html"><a href="P11.html#razvoj-WWW"><i class="fa fa-check"></i><b>1.1.4</b> Razvoj (svetovnega) spleta</a></li>
<li class="chapter" data-level="1.1.5" data-path="P11.html"><a href="P11.html#arhitektura-odjemalecstrežnik"><i class="fa fa-check"></i><b>1.1.5</b> Arhitektura odjemalec/strežnik</a></li>
<li class="chapter" data-level="1.1.6" data-path="P11.html"><a href="P11.html#večnivojska-arhitektura"><i class="fa fa-check"></i><b>1.1.6</b> Večnivojska arhitektura</a></li>
<li class="chapter" data-level="1.1.7" data-path="P11.html"><a href="P11.html#pomembni-mejniki-in-akterji"><i class="fa fa-check"></i><b>1.1.7</b> Pomembni mejniki in akterji</a></li>
<li class="chapter" data-level="1.1.8" data-path="P11.html"><a href="P11.html#trenutno-stanje-na-trgu"><i class="fa fa-check"></i><b>1.1.8</b> Trenutno stanje na trgu</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="P11.html"><a href="P11.html#uporabljen-pristop-pri-predmetu"><i class="fa fa-check"></i><b>1.2</b> Uporabljen pristop pri predmetu</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="P11.html"><a href="P11.html#tehnologije-ki-jih-bomo-uporabljali"><i class="fa fa-check"></i><b>1.2.1</b> Tehnologije, ki jih bomo uporabljali</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="P11.html"><a href="P11.html#celostni-razvoj-programske-opreme-z-mean-arhitekturo"><i class="fa fa-check"></i><b>1.3</b> Celostni razvoj programske opreme z MEAN arhitekturo</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="P11.html"><a href="P11.html#Node-js-niti"><i class="fa fa-check"></i><b>1.3.1</b> Node.js</a></li>
<li class="chapter" data-level="1.3.2" data-path="P11.html"><a href="P11.html#express"><i class="fa fa-check"></i><b>1.3.2</b> Express</a></li>
<li class="chapter" data-level="1.3.3" data-path="P11.html"><a href="P11.html#MongoDB-uvod"><i class="fa fa-check"></i><b>1.3.3</b> MongoDB</a></li>
<li class="chapter" data-level="1.3.4" data-path="P11.html"><a href="P11.html#angular"><i class="fa fa-check"></i><b>1.3.4</b> Angular</a></li>
<li class="chapter" data-level="1.3.5" data-path="P11.html"><a href="P11.html#podporna-orodja-ogrodja-in-knjižnice"><i class="fa fa-check"></i><b>1.3.5</b> Podporna orodja, ogrodja in knjižnice</a></li>
<li class="chapter" data-level="1.3.6" data-path="P11.html"><a href="P11.html#git"><i class="fa fa-check"></i><b>1.3.6</b> Git</a></li>
<li class="chapter" data-level="1.3.7" data-path="P11.html"><a href="P11.html#heroku"><i class="fa fa-check"></i><b>1.3.7</b> Heroku</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="P11.html"><a href="P11.html#razvoj-dejanske-aplikacije"><i class="fa fa-check"></i><b>1.4</b> Razvoj dejanske aplikacije</a></li>
<li class="chapter" data-level="1.5" data-path="P11.html"><a href="P11.html#nacrtovanje-aplikacije-po-mean-arhitekturi"><i class="fa fa-check"></i><b>1.5</b> Načrtovanje aplikacije po MEAN arhitekturi</a></li>
<li class="chapter" data-level="1.6" data-path="P11.html"><a href="P11.html#dobre-prakse-pri-načrtovanju-in-implementaciji-aplikacije"><i class="fa fa-check"></i><b>1.6</b> Dobre prakse pri načrtovanju in implementaciji aplikacije</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="P11.html"><a href="P11.html#uporaba-api-ja-za-dostop-do-podatkovne-ravni"><i class="fa fa-check"></i><b>1.6.1</b> Uporaba API-ja za dostop do podatkovne ravni</a></li>
<li class="chapter" data-level="1.6.2" data-path="P11.html"><a href="P11.html#koraki-pri-nacrtovanju-nove-spletne-aplikacije"><i class="fa fa-check"></i><b>1.6.2</b> Koraki pri načrtovanju nove spletne aplikacije</a></li>
<li class="chapter" data-level="1.6.3" data-path="P11.html"><a href="P11.html#koraki-pri-implementaciji-nove-spletne-aplikacije"><i class="fa fa-check"></i><b>1.6.3</b> Koraki pri implementaciji nove spletne aplikacije</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="P11.html"><a href="P11.html#okolje"><i class="fa fa-check"></i><b>1.7</b> Okolje</a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="P11.html"><a href="P11.html#razvojno-okolje"><i class="fa fa-check"></i><b>1.7.1</b> Razvojno okolje</a></li>
<li class="chapter" data-level="1.7.2" data-path="P11.html"><a href="P11.html#produkcijsko-okolje"><i class="fa fa-check"></i><b>1.7.2</b> Produkcijsko okolje</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="P11.html"><a href="P11.html#git-1"><i class="fa fa-check"></i><b>1.8</b> Git</a>
<ul>
<li class="chapter" data-level="1.8.1" data-path="P11.html"><a href="P11.html#osnovne-operacije-vcs"><i class="fa fa-check"></i><b>1.8.1</b> Osnovne operacije VCS</a></li>
<li class="chapter" data-level="1.8.2" data-path="P11.html"><a href="P11.html#posebnosti-porazdeljenih-sistemov-za-obvladovanje-verzij-dvcs"><i class="fa fa-check"></i><b>1.8.2</b> Posebnosti porazdeljenih sistemov za obvladovanje verzij (DVCS)</a></li>
<li class="chapter" data-level="1.8.3" data-path="P11.html"><a href="P11.html#dobre-prakse-uporabe-git"><i class="fa fa-check"></i><b>1.8.3</b> Dobre prakse uporabe Git</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="LP1.html"><a href="LP1.html"><i class="fa fa-check"></i><b>2</b> <span class="sklop4 oznaka">1. LP</span> Dinamična spletna aplikacija na strani strežnika in odjemalca</a>
<ul>
<li class="chapter" data-level="2.1" data-path="LP1.html"><a href="LP1.html#pravila-zahteve-in-omejitve"><i class="fa fa-check"></i><b>2.1</b> Pravila, zahteve in omejitve</a></li>
<li class="chapter" data-level="2.2" data-path="LP1.html"><a href="LP1.html#LP11"><i class="fa fa-check"></i><b>2.2</b> <span class="sklop1 oznaka">1. del</span> Osnutek aplikacije in wireframe model</a></li>
<li class="chapter" data-level="2.3" data-path="LP1.html"><a href="LP1.html#LP12"><i class="fa fa-check"></i><b>2.3</b> <span class="sklop2 oznaka">2. del</span> Arhitektura aplikacije in različna razvojna okolja</a></li>
<li class="chapter" data-level="2.4" data-path="LP1.html"><a href="LP1.html#LP13"><i class="fa fa-check"></i><b>2.4</b> <span class="sklop3 oznaka">3. del</span> Zaledni del in dostop do podatkovne baze</a></li>
<li class="chapter" data-level="2.5" data-path="LP1.html"><a href="LP1.html#LP14"><i class="fa fa-check"></i><b>2.5</b> <span class="sklop4 oznaka">4. del</span> Uporabniški vmesnik, SPA in avtentikacija</a></li>
<li class="chapter" data-level="2.6" data-path="LP1.html"><a href="LP1.html#kriteriji-vrednotenja"><i class="fa fa-check"></i><b>2.6</b> Kriteriji vrednotenja</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="HTML-CSS.html"><a href="HTML-CSS.html"><i class="fa fa-check"></i><b>3</b> <span class="sklop1 oznaka">P1.2</span> Osnovna spletna standarda HTML in CSS</a>
<ul>
<li class="chapter" data-level="3.1" data-path="HTML-CSS.html"><a href="HTML-CSS.html#html-tehnologija"><i class="fa fa-check"></i><b>3.1</b> HTML</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="HTML-CSS.html"><a href="HTML-CSS.html#enostaven-primer-html5-dokumenta"><i class="fa fa-check"></i><b>3.1.1</b> Enostaven primer HTML5 dokumenta</a></li>
<li class="chapter" data-level="3.1.2" data-path="HTML-CSS.html"><a href="HTML-CSS.html#ustreznost-html5-dokumenta"><i class="fa fa-check"></i><b>3.1.2</b> Ustreznost HTML5 dokumenta</a></li>
<li class="chapter" data-level="3.1.3" data-path="HTML-CSS.html"><a href="HTML-CSS.html#naslovi"><i class="fa fa-check"></i><b>3.1.3</b> Naslovi</a></li>
<li class="chapter" data-level="3.1.4" data-path="HTML-CSS.html"><a href="HTML-CSS.html#povezave"><i class="fa fa-check"></i><b>3.1.4</b> Povezave</a></li>
<li class="chapter" data-level="3.1.5" data-path="HTML-CSS.html"><a href="HTML-CSS.html#slike"><i class="fa fa-check"></i><b>3.1.5</b> Slike</a></li>
<li class="chapter" data-level="3.1.6" data-path="HTML-CSS.html"><a href="HTML-CSS.html#posebni-znaki-in-vodoravne-črte"><i class="fa fa-check"></i><b>3.1.6</b> Posebni znaki in vodoravne črte</a></li>
<li class="chapter" data-level="3.1.7" data-path="HTML-CSS.html"><a href="HTML-CSS.html#seznami"><i class="fa fa-check"></i><b>3.1.7</b> Seznami</a></li>
<li class="chapter" data-level="3.1.8" data-path="HTML-CSS.html"><a href="HTML-CSS.html#tabele"><i class="fa fa-check"></i><b>3.1.8</b> Tabele</a></li>
<li class="chapter" data-level="3.1.9" data-path="HTML-CSS.html"><a href="HTML-CSS.html#Spletni-obrazci-HTML"><i class="fa fa-check"></i><b>3.1.9</b> Spletni obrazci</a></li>
<li class="chapter" data-level="3.1.10" data-path="HTML-CSS.html"><a href="HTML-CSS.html#interne-povezave"><i class="fa fa-check"></i><b>3.1.10</b> Interne povezave</a></li>
<li class="chapter" data-level="3.1.11" data-path="HTML-CSS.html"><a href="HTML-CSS.html#meta-elementi"><i class="fa fa-check"></i><b>3.1.11</b> Meta elementi</a></li>
<li class="chapter" data-level="3.1.12" data-path="HTML-CSS.html"><a href="HTML-CSS.html#napredni-gradniki-spletnih-obrazcev"><i class="fa fa-check"></i><b>3.1.12</b> Napredni gradniki spletnih obrazcev</a></li>
<li class="chapter" data-level="3.1.13" data-path="HTML-CSS.html"><a href="HTML-CSS.html#samodejno-dopolnjevanje-vrednosti-pri-vnosnih-poljih"><i class="fa fa-check"></i><b>3.1.13</b> Samodejno dopolnjevanje vrednosti pri vnosnih poljih</a></li>
<li class="chapter" data-level="3.1.14" data-path="HTML-CSS.html"><a href="HTML-CSS.html#elementi-za-opredelitev-strukture-strani"><i class="fa fa-check"></i><b>3.1.14</b> Elementi za opredelitev strukture strani</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="HTML-CSS.html"><a href="HTML-CSS.html#prekrivni-slogi-css"><i class="fa fa-check"></i><b>3.2</b> Prekrivni slogi (CSS)</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="HTML-CSS.html"><a href="HTML-CSS.html#uvod-1"><i class="fa fa-check"></i><b>3.2.1</b> Uvod</a></li>
<li class="chapter" data-level="3.2.2" data-path="HTML-CSS.html"><a href="HTML-CSS.html#neposredno-opredeljeni-slogi"><i class="fa fa-check"></i><b>3.2.2</b> Neposredno opredeljeni slogi</a></li>
<li class="chapter" data-level="3.2.3" data-path="HTML-CSS.html"><a href="HTML-CSS.html#vgrajeni-slogi"><i class="fa fa-check"></i><b>3.2.3</b> Vgrajeni slogi</a></li>
<li class="chapter" data-level="3.2.4" data-path="HTML-CSS.html"><a href="HTML-CSS.html#konfliktni-slogi"><i class="fa fa-check"></i><b>3.2.4</b> Konfliktni slogi</a></li>
<li class="chapter" data-level="3.2.5" data-path="HTML-CSS.html"><a href="HTML-CSS.html#zunanji-slogi"><i class="fa fa-check"></i><b>3.2.5</b> Zunanji slogi</a></li>
<li class="chapter" data-level="3.2.6" data-path="HTML-CSS.html"><a href="HTML-CSS.html#pozicioniranje-elementov"><i class="fa fa-check"></i><b>3.2.6</b> Pozicioniranje elementov</a></li>
<li class="chapter" data-level="3.2.7" data-path="HTML-CSS.html"><a href="HTML-CSS.html#ozadje"><i class="fa fa-check"></i><b>3.2.7</b> Ozadje</a></li>
<li class="chapter" data-level="3.2.8" data-path="HTML-CSS.html"><a href="HTML-CSS.html#dimenzije-elementa"><i class="fa fa-check"></i><b>3.2.8</b> Dimenzije elementa</a></li>
<li class="chapter" data-level="3.2.9" data-path="HTML-CSS.html"><a href="HTML-CSS.html#model-škatle"><i class="fa fa-check"></i><b>3.2.9</b> Model škatle</a></li>
<li class="chapter" data-level="3.2.10" data-path="HTML-CSS.html"><a href="HTML-CSS.html#plavajoči-elementi"><i class="fa fa-check"></i><b>3.2.10</b> Plavajoči elementi</a></li>
<li class="chapter" data-level="3.2.11" data-path="HTML-CSS.html"><a href="HTML-CSS.html#vrste-medijev"><i class="fa fa-check"></i><b>3.2.11</b> Vrste medijev</a></li>
<li class="chapter" data-level="3.2.12" data-path="HTML-CSS.html"><a href="HTML-CSS.html#spustni-meniji"><i class="fa fa-check"></i><b>3.2.12</b> Spustni meniji</a></li>
<li class="chapter" data-level="3.2.13" data-path="HTML-CSS.html"><a href="HTML-CSS.html#senca-na-besedilu"><i class="fa fa-check"></i><b>3.2.13</b> Senca na besedilu</a></li>
<li class="chapter" data-level="3.2.14" data-path="HTML-CSS.html"><a href="HTML-CSS.html#zaobljeni-robovi"><i class="fa fa-check"></i><b>3.2.14</b> Zaobljeni robovi</a></li>
<li class="chapter" data-level="3.2.15" data-path="HTML-CSS.html"><a href="HTML-CSS.html#barva"><i class="fa fa-check"></i><b>3.2.15</b> Barva</a></li>
<li class="chapter" data-level="3.2.16" data-path="HTML-CSS.html"><a href="HTML-CSS.html#senca-na-modelu-škatle"><i class="fa fa-check"></i><b>3.2.16</b> Senca na modelu škatle</a></li>
<li class="chapter" data-level="3.2.17" data-path="HTML-CSS.html"><a href="HTML-CSS.html#uporaba-pisav-s-spleta"><i class="fa fa-check"></i><b>3.2.17</b> Uporaba pisav s spleta</a></li>
<li class="chapter" data-level="3.2.18" data-path="HTML-CSS.html"><a href="HTML-CSS.html#prilagodljiv-model-škatle-in-izbira-poljubnega-ugnezdenega-elementa"><i class="fa fa-check"></i><b>3.2.18</b> Prilagodljiv model škatle in izbira poljubnega ugnezdenega elementa</a></li>
<li class="chapter" data-level="3.2.19" data-path="HTML-CSS.html"><a href="HTML-CSS.html#postavitev-v-več-stolpcev"><i class="fa fa-check"></i><b>3.2.19</b> Postavitev v več stolpcev</a></li>
<li class="chapter" data-level="3.2.20" data-path="HTML-CSS.html"><a href="HTML-CSS.html#poizvedovanje-po-medijih"><i class="fa fa-check"></i><b>3.2.20</b> Poizvedovanje po medijih</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="HTML-CSS.html"><a href="HTML-CSS.html#bootstrap-1"><i class="fa fa-check"></i><b>3.3</b> Bootstrap</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="HTML-CSS.html"><a href="HTML-CSS.html#uvod-in-način-uporabe"><i class="fa fa-check"></i><b>3.3.1</b> Uvod in način uporabe</a></li>
<li class="chapter" data-level="3.3.2" data-path="HTML-CSS.html"><a href="HTML-CSS.html#enostavni-primer"><i class="fa fa-check"></i><b>3.3.2</b> Enostavni primer</a></li>
<li class="chapter" data-level="3.3.3" data-path="HTML-CSS.html"><a href="HTML-CSS.html#prilagajanje-vsebine-z-mrežnim-sistemom"><i class="fa fa-check"></i><b>3.3.3</b> Prilagajanje vsebine z mrežnim sistemom</a></li>
<li class="chapter" data-level="3.3.4" data-path="HTML-CSS.html"><a href="HTML-CSS.html#tipografija"><i class="fa fa-check"></i><b>3.3.4</b> Tipografija</a></li>
<li class="chapter" data-level="3.3.5" data-path="HTML-CSS.html"><a href="HTML-CSS.html#tabele-1"><i class="fa fa-check"></i><b>3.3.5</b> Tabele</a></li>
<li class="chapter" data-level="3.3.6" data-path="HTML-CSS.html"><a href="HTML-CSS.html#slike-1"><i class="fa fa-check"></i><b>3.3.6</b> Slike</a></li>
<li class="chapter" data-level="3.3.7" data-path="HTML-CSS.html"><a href="HTML-CSS.html#opozorila"><i class="fa fa-check"></i><b>3.3.7</b> Opozorila</a></li>
<li class="chapter" data-level="3.3.8" data-path="HTML-CSS.html"><a href="HTML-CSS.html#gumbi"><i class="fa fa-check"></i><b>3.3.8</b> Gumbi</a></li>
<li class="chapter" data-level="3.3.9" data-path="HTML-CSS.html"><a href="HTML-CSS.html#ikone"><i class="fa fa-check"></i><b>3.3.9</b> Ikone</a></li>
<li class="chapter" data-level="3.3.10" data-path="HTML-CSS.html"><a href="HTML-CSS.html#oznake"><i class="fa fa-check"></i><b>3.3.10</b> Oznake</a></li>
<li class="chapter" data-level="3.3.11" data-path="HTML-CSS.html"><a href="HTML-CSS.html#kazalnik-poteka"><i class="fa fa-check"></i><b>3.3.11</b> Kazalnik poteka</a></li>
<li class="chapter" data-level="3.3.12" data-path="HTML-CSS.html"><a href="HTML-CSS.html#prehodi-po-straneh"><i class="fa fa-check"></i><b>3.3.12</b> Prehodi po straneh</a></li>
<li class="chapter" data-level="3.3.13" data-path="HTML-CSS.html"><a href="HTML-CSS.html#plošča"><i class="fa fa-check"></i><b>3.3.13</b> Plošča</a></li>
<li class="chapter" data-level="3.3.14" data-path="HTML-CSS.html"><a href="HTML-CSS.html#spustni-meni"><i class="fa fa-check"></i><b>3.3.14</b> Spustni meni</a></li>
<li class="chapter" data-level="3.3.15" data-path="HTML-CSS.html"><a href="HTML-CSS.html#spletni-obrazci"><i class="fa fa-check"></i><b>3.3.15</b> Spletni obrazci</a></li>
<li class="chapter" data-level="3.3.16" data-path="HTML-CSS.html"><a href="HTML-CSS.html#modalno-okno"><i class="fa fa-check"></i><b>3.3.16</b> Modalno okno</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="HTML-CSS.html"><a href="HTML-CSS.html#praktični-prikaz-uporabe-css"><i class="fa fa-check"></i><b>3.4</b> Praktični prikaz uporabe CSS</a></li>
</ul></li>
<li class="part"><span><b>II sklop: JavaScript - programski jezik na strani odjemalca in strežnika</b></span></li>
<li class="chapter" data-level="4" data-path="JavaScript.html"><a href="JavaScript.html"><i class="fa fa-check"></i><b>4</b> <span class="sklop2 oznaka">P2.1</span> JavaScript, jezik svetovnega spleta</a>
<ul>
<li class="chapter" data-level="4.1" data-path="JavaScript.html"><a href="JavaScript.html#razvoj-jezika"><i class="fa fa-check"></i><b>4.1</b> Razvoj jezika</a></li>
<li class="chapter" data-level="4.2" data-path="JavaScript.html"><a href="JavaScript.html#vrednosti-podatkovni-tipi-in-operatorji"><i class="fa fa-check"></i><b>4.2</b> Vrednosti, podatkovni tipi in operatorji</a></li>
<li class="chapter" data-level="4.3" data-path="JavaScript.html"><a href="JavaScript.html#struktura-programa"><i class="fa fa-check"></i><b>4.3</b> Struktura programa</a></li>
<li class="chapter" data-level="4.4" data-path="JavaScript.html"><a href="JavaScript.html#kontrolni-stavki"><i class="fa fa-check"></i><b>4.4</b> Kontrolni stavki</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="JavaScript.html"><a href="JavaScript.html#if-stavek"><i class="fa fa-check"></i><b>4.4.1</b> <code>if</code> stavek</a></li>
<li class="chapter" data-level="4.4.2" data-path="JavaScript.html"><a href="JavaScript.html#if...else-stavek"><i class="fa fa-check"></i><b>4.4.2</b> <code>if...else</code> stavek</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="JavaScript.html"><a href="JavaScript.html#operatorji"><i class="fa fa-check"></i><b>4.5</b> Operatorji</a></li>
<li class="chapter" data-level="4.6" data-path="JavaScript.html"><a href="JavaScript.html#struktura-ponavljanja"><i class="fa fa-check"></i><b>4.6</b> Struktura ponavljanja</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="JavaScript.html"><a href="JavaScript.html#while-stavek"><i class="fa fa-check"></i><b>4.6.1</b> <code>while</code> stavek</a></li>
<li class="chapter" data-level="4.6.2" data-path="JavaScript.html"><a href="JavaScript.html#for-stavek"><i class="fa fa-check"></i><b>4.6.2</b> <code>for</code> stavek</a></li>
<li class="chapter" data-level="4.6.3" data-path="JavaScript.html"><a href="JavaScript.html#do...while-stavek"><i class="fa fa-check"></i><b>4.6.3</b> <code>do...while</code> stavek</a></li>
<li class="chapter" data-level="4.6.4" data-path="JavaScript.html"><a href="JavaScript.html#break-in-continue"><i class="fa fa-check"></i><b>4.6.4</b> <code>break</code> in <code>continue</code></a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="JavaScript.html"><a href="JavaScript.html#funkcije"><i class="fa fa-check"></i><b>4.7</b> Funkcije</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="JavaScript.html"><a href="JavaScript.html#opredelitev-funkcije"><i class="fa fa-check"></i><b>4.7.1</b> Opredelitev funkcije</a></li>
<li class="chapter" data-level="4.7.2" data-path="JavaScript.html"><a href="JavaScript.html#parametri-in-kontekst"><i class="fa fa-check"></i><b>4.7.2</b> Parametri in kontekst</a></li>
<li class="chapter" data-level="4.7.3" data-path="JavaScript.html"><a href="JavaScript.html#zaprtje"><i class="fa fa-check"></i><b>4.7.3</b> Zaprtje</a></li>
<li class="chapter" data-level="4.7.4" data-path="JavaScript.html"><a href="JavaScript.html#rekurzija"><i class="fa fa-check"></i><b>4.7.4</b> Rekurzija</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="JavaScript.html"><a href="JavaScript.html#podatkovne-strukture"><i class="fa fa-check"></i><b>4.8</b> Podatkovne strukture</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="JavaScript.html"><a href="JavaScript.html#nizi-in-njihove-lastnosti"><i class="fa fa-check"></i><b>4.8.1</b> Nizi in njihove lastnosti</a></li>
<li class="chapter" data-level="4.8.2" data-path="JavaScript.html"><a href="JavaScript.html#objekt-argumentov-funkcije"><i class="fa fa-check"></i><b>4.8.2</b> Objekt argumentov funkcije</a></li>
<li class="chapter" data-level="4.8.3" data-path="JavaScript.html"><a href="JavaScript.html#json"><i class="fa fa-check"></i><b>4.8.3</b> JSON</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="JavaScript.html"><a href="JavaScript.html#funkcije-višjega-reda"><i class="fa fa-check"></i><b>4.9</b> Funkcije višjega reda</a>
<ul>
<li class="chapter" data-level="4.9.1" data-path="JavaScript.html"><a href="JavaScript.html#abstrakcija"><i class="fa fa-check"></i><b>4.9.1</b> Abstrakcija</a></li>
<li class="chapter" data-level="4.9.2" data-path="JavaScript.html"><a href="JavaScript.html#funkcije-višjega-reda-1"><i class="fa fa-check"></i><b>4.9.2</b> Funkcije višjega reda</a></li>
<li class="chapter" data-level="4.9.3" data-path="JavaScript.html"><a href="JavaScript.html#posredovanje-argumentov"><i class="fa fa-check"></i><b>4.9.3</b> Posredovanje argumentov</a></li>
</ul></li>
<li class="chapter" data-level="4.10" data-path="JavaScript.html"><a href="JavaScript.html#objekti"><i class="fa fa-check"></i><b>4.10</b> Objekti</a>
<ul>
<li class="chapter" data-level="4.10.1" data-path="JavaScript.html"><a href="JavaScript.html#metode"><i class="fa fa-check"></i><b>4.10.1</b> Metode</a></li>
<li class="chapter" data-level="4.10.2" data-path="JavaScript.html"><a href="JavaScript.html#prototipi"><i class="fa fa-check"></i><b>4.10.2</b> Prototipi</a></li>
<li class="chapter" data-level="4.10.3" data-path="JavaScript.html"><a href="JavaScript.html#konstruktorji"><i class="fa fa-check"></i><b>4.10.3</b> Konstruktorji</a></li>
<li class="chapter" data-level="4.10.4" data-path="JavaScript.html"><a href="JavaScript.html#razredna-notacija"><i class="fa fa-check"></i><b>4.10.4</b> Razredna notacija</a></li>
<li class="chapter" data-level="4.10.5" data-path="JavaScript.html"><a href="JavaScript.html#prekrivanje-lastnosti"><i class="fa fa-check"></i><b>4.10.5</b> Prekrivanje lastnosti</a></li>
<li class="chapter" data-level="4.10.6" data-path="JavaScript.html"><a href="JavaScript.html#get-in-set-metode"><i class="fa fa-check"></i><b>4.10.6</b> <code>Get</code> in <code>set</code> metode</a></li>
<li class="chapter" data-level="4.10.7" data-path="JavaScript.html"><a href="JavaScript.html#primerek"><i class="fa fa-check"></i><b>4.10.7</b> Primerek</a></li>
</ul></li>
<li class="chapter" data-level="4.11" data-path="JavaScript.html"><a href="JavaScript.html#hrošči-in-obvladovanje-napak"><i class="fa fa-check"></i><b>4.11</b> Hrošči in obvladovanje napak</a>
<ul>
<li class="chapter" data-level="4.11.1" data-path="JavaScript.html"><a href="JavaScript.html#strog-način-delovanja"><i class="fa fa-check"></i><b>4.11.1</b> Strog način delovanja</a></li>
<li class="chapter" data-level="4.11.2" data-path="JavaScript.html"><a href="JavaScript.html#testiranje"><i class="fa fa-check"></i><b>4.11.2</b> Testiranje</a></li>
<li class="chapter" data-level="4.11.3" data-path="JavaScript.html"><a href="JavaScript.html#obvladovanje-izjem"><i class="fa fa-check"></i><b>4.11.3</b> Obvladovanje izjem</a></li>
</ul></li>
<li class="chapter" data-level="4.12" data-path="JavaScript.html"><a href="JavaScript.html#regularni-izrazi"><i class="fa fa-check"></i><b>4.12</b> Regularni izrazi</a>
<ul>
<li class="chapter" data-level="4.12.1" data-path="JavaScript.html"><a href="JavaScript.html#kreiranje-regularnega-izraza"><i class="fa fa-check"></i><b>4.12.1</b> Kreiranje regularnega izraza</a></li>
<li class="chapter" data-level="4.12.2" data-path="JavaScript.html"><a href="JavaScript.html#testiranje-ujemanja"><i class="fa fa-check"></i><b>4.12.2</b> Testiranje ujemanja</a></li>
<li class="chapter" data-level="4.12.3" data-path="JavaScript.html"><a href="JavaScript.html#testiranje-ujemanja-množice-znakov"><i class="fa fa-check"></i><b>4.12.3</b> Testiranje ujemanja množice znakov</a></li>
<li class="chapter" data-level="4.12.4" data-path="JavaScript.html"><a href="JavaScript.html#ponavljanje-delov-vzorca"><i class="fa fa-check"></i><b>4.12.4</b> Ponavljanje delov vzorca</a></li>
<li class="chapter" data-level="4.12.5" data-path="JavaScript.html"><a href="JavaScript.html#združevanje-delov-vzorca"><i class="fa fa-check"></i><b>4.12.5</b> Združevanje delov vzorca</a></li>
<li class="chapter" data-level="4.12.6" data-path="JavaScript.html"><a href="JavaScript.html#ujemanje-in-grupiranje"><i class="fa fa-check"></i><b>4.12.6</b> Ujemanje in grupiranje</a></li>
<li class="chapter" data-level="4.12.7" data-path="JavaScript.html"><a href="JavaScript.html#omejevanje-besed"><i class="fa fa-check"></i><b>4.12.7</b> Omejevanje besed</a></li>
<li class="chapter" data-level="4.12.8" data-path="JavaScript.html"><a href="JavaScript.html#vzorci-z-več-možnostmi"><i class="fa fa-check"></i><b>4.12.8</b> Vzorci z več možnostmi</a></li>
<li class="chapter" data-level="4.12.9" data-path="JavaScript.html"><a href="JavaScript.html#zamenjava-podnizov"><i class="fa fa-check"></i><b>4.12.9</b> Zamenjava podnizov</a></li>
<li class="chapter" data-level="4.12.10" data-path="JavaScript.html"><a href="JavaScript.html#požrešna-metoda-ujemanja"><i class="fa fa-check"></i><b>4.12.10</b> Požrešna metoda ujemanja</a></li>
<li class="chapter" data-level="4.12.11" data-path="JavaScript.html"><a href="JavaScript.html#dinamično-kreiranje-regexp-objektov"><i class="fa fa-check"></i><b>4.12.11</b> Dinamično kreiranje <code>RegExp</code> objektov</a></li>
<li class="chapter" data-level="4.12.12" data-path="JavaScript.html"><a href="JavaScript.html#sprehod-po-zadetkih-ujemanja"><i class="fa fa-check"></i><b>4.12.12</b> Sprehod po zadetkih ujemanja</a></li>
</ul></li>
<li class="chapter" data-level="4.13" data-path="JavaScript.html"><a href="JavaScript.html#moduli"><i class="fa fa-check"></i><b>4.13</b> Moduli</a>
<ul>
<li class="chapter" data-level="4.13.1" data-path="JavaScript.html"><a href="JavaScript.html#uporaba-funkcij-v-vlogi-imenskega-prostora"><i class="fa fa-check"></i><b>4.13.1</b> Uporaba funkcij v vlogi imenskega prostora</a></li>
<li class="chapter" data-level="4.13.2" data-path="JavaScript.html"><a href="JavaScript.html#objekti-kot-vmesniki"><i class="fa fa-check"></i><b>4.13.2</b> Objekti kot vmesniki</a></li>
<li class="chapter" data-level="4.13.3" data-path="JavaScript.html"><a href="JavaScript.html#izvajanje-podatkov-v-obliki-kode"><i class="fa fa-check"></i><b>4.13.3</b> Izvajanje podatkov v obliki kode</a></li>
</ul></li>
<li class="chapter" data-level="4.14" data-path="JavaScript.html"><a href="JavaScript.html#javascript-in-spletni-brskalnik"><i class="fa fa-check"></i><b>4.14</b> JavaScript in spletni brskalnik</a>
<ul>
<li class="chapter" data-level="4.14.1" data-path="JavaScript.html"><a href="JavaScript.html#html-in-javascript"><i class="fa fa-check"></i><b>4.14.1</b> HTML in JavaScript</a></li>
<li class="chapter" data-level="4.14.2" data-path="JavaScript.html"><a href="JavaScript.html#zaščiteno-okolje"><i class="fa fa-check"></i><b>4.14.2</b> Zaščiteno okolje</a></li>
</ul></li>
<li class="chapter" data-level="4.15" data-path="JavaScript.html"><a href="JavaScript.html#objektni-model-dokumenta"><i class="fa fa-check"></i><b>4.15</b> Objektni model dokumenta</a>
<ul>
<li class="chapter" data-level="4.15.1" data-path="JavaScript.html"><a href="JavaScript.html#struktura-dokumenta-in-predstavitev-v-obliki-drevesa"><i class="fa fa-check"></i><b>4.15.1</b> Struktura dokumenta in predstavitev v obliki drevesa</a></li>
<li class="chapter" data-level="4.15.2" data-path="JavaScript.html"><a href="JavaScript.html#iskanje-elementov"><i class="fa fa-check"></i><b>4.15.2</b> Iskanje elementov</a></li>
<li class="chapter" data-level="4.15.3" data-path="JavaScript.html"><a href="JavaScript.html#spreminjanje-dokumenta"><i class="fa fa-check"></i><b>4.15.3</b> Spreminjanje dokumenta</a></li>
<li class="chapter" data-level="4.15.4" data-path="JavaScript.html"><a href="JavaScript.html#dodajanje-elementov"><i class="fa fa-check"></i><b>4.15.4</b> Dodajanje elementov</a></li>
<li class="chapter" data-level="4.15.5" data-path="JavaScript.html"><a href="JavaScript.html#uporaba-lastnih-atributov"><i class="fa fa-check"></i><b>4.15.5</b> Uporaba lastnih atributov</a></li>
<li class="chapter" data-level="4.15.6" data-path="JavaScript.html"><a href="JavaScript.html#postavitev-na-strani"><i class="fa fa-check"></i><b>4.15.6</b> Postavitev na strani</a></li>
<li class="chapter" data-level="4.15.7" data-path="JavaScript.html"><a href="JavaScript.html#oblikovanje-in-prekrivni-slogi"><i class="fa fa-check"></i><b>4.15.7</b> Oblikovanje in prekrivni slogi</a></li>
</ul></li>
<li class="chapter" data-level="4.16" data-path="JavaScript.html"><a href="JavaScript.html#obvladovanje-dogodkov"><i class="fa fa-check"></i><b>4.16</b> Obvladovanje dogodkov</a>
<ul>
<li class="chapter" data-level="4.16.1" data-path="JavaScript.html"><a href="JavaScript.html#dogodki-na-html-gradnikih"><i class="fa fa-check"></i><b>4.16.1</b> Dogodki na HTML gradnikih</a></li>
<li class="chapter" data-level="4.16.2" data-path="JavaScript.html"><a href="JavaScript.html#objekt-dogodka"><i class="fa fa-check"></i><b>4.16.2</b> Objekt dogodka</a></li>
<li class="chapter" data-level="4.16.3" data-path="JavaScript.html"><a href="JavaScript.html#širjenje-obvladovanja-dogodkov"><i class="fa fa-check"></i><b>4.16.3</b> Širjenje obvladovanja dogodkov</a></li>
<li class="chapter" data-level="4.16.4" data-path="JavaScript.html"><a href="JavaScript.html#privzete-akcije"><i class="fa fa-check"></i><b>4.16.4</b> Privzete akcije</a></li>
<li class="chapter" data-level="4.16.5" data-path="JavaScript.html"><a href="JavaScript.html#pritisk-tipke-na-tipkovnici"><i class="fa fa-check"></i><b>4.16.5</b> Pritisk tipke na tipkovnici</a></li>
<li class="chapter" data-level="4.16.6" data-path="JavaScript.html"><a href="JavaScript.html#dogodki-z-miško"><i class="fa fa-check"></i><b>4.16.6</b> Dogodki z miško</a></li>
<li class="chapter" data-level="4.16.7" data-path="JavaScript.html"><a href="JavaScript.html#fokusiranje"><i class="fa fa-check"></i><b>4.16.7</b> Fokusiranje</a></li>
<li class="chapter" data-level="4.16.8" data-path="JavaScript.html"><a href="JavaScript.html#dogodek-nalaganja"><i class="fa fa-check"></i><b>4.16.8</b> Dogodek nalaganja</a></li>
<li class="chapter" data-level="4.16.9" data-path="JavaScript.html"><a href="JavaScript.html#časovniki"><i class="fa fa-check"></i><b>4.16.9</b> Časovniki</a></li>
<li class="chapter" data-level="4.16.10" data-path="JavaScript.html"><a href="JavaScript.html#čas-poteka"><i class="fa fa-check"></i><b>4.16.10</b> Čas poteka</a></li>
</ul></li>
<li class="chapter" data-level="4.17" data-path="JavaScript.html"><a href="JavaScript.html#http"><i class="fa fa-check"></i><b>4.17</b> HTTP</a>
<ul>
<li class="chapter" data-level="4.17.1" data-path="JavaScript.html"><a href="JavaScript.html#spletni-brskalniki-in-http"><i class="fa fa-check"></i><b>4.17.1</b> Spletni brskalniki in HTTP</a></li>
<li class="chapter" data-level="4.17.2" data-path="JavaScript.html"><a href="JavaScript.html#posredovanje-zahteve"><i class="fa fa-check"></i><b>4.17.2</b> Posredovanje zahteve</a></li>
<li class="chapter" data-level="4.17.3" data-path="JavaScript.html"><a href="JavaScript.html#http-peskovnik"><i class="fa fa-check"></i><b>4.17.3</b> HTTP peskovnik</a></li>
<li class="chapter" data-level="4.17.4" data-path="JavaScript.html"><a href="JavaScript.html#abstrakcija-zahtev"><i class="fa fa-check"></i><b>4.17.4</b> Abstrakcija zahtev</a></li>
<li class="chapter" data-level="4.17.5" data-path="JavaScript.html"><a href="JavaScript.html#promises"><i class="fa fa-check"></i><b>4.17.5</b> Promises</a></li>
</ul></li>
<li class="chapter" data-level="4.18" data-path="JavaScript.html"><a href="JavaScript.html#spletni-obrazci-in-vnosna-polja"><i class="fa fa-check"></i><b>4.18</b> Spletni obrazci in vnosna polja</a>
<ul>
<li class="chapter" data-level="4.18.1" data-path="JavaScript.html"><a href="JavaScript.html#vnosna-polja"><i class="fa fa-check"></i><b>4.18.1</b> Vnosna polja</a></li>
<li class="chapter" data-level="4.18.2" data-path="JavaScript.html"><a href="JavaScript.html#fokus-vnosa-s-tipkovnico"><i class="fa fa-check"></i><b>4.18.2</b> Fokus vnosa s tipkovnico</a></li>
<li class="chapter" data-level="4.18.3" data-path="JavaScript.html"><a href="JavaScript.html#onemogočeni-elementi-spletnega-obrazca"><i class="fa fa-check"></i><b>4.18.3</b> Onemogočeni elementi spletnega obrazca</a></li>
<li class="chapter" data-level="4.18.4" data-path="JavaScript.html"><a href="JavaScript.html#spletni-obrazec-kot-celota"><i class="fa fa-check"></i><b>4.18.4</b> Spletni obrazec kot celota</a></li>
<li class="chapter" data-level="4.18.5" data-path="JavaScript.html"><a href="JavaScript.html#besedilna-vnosna-polja"><i class="fa fa-check"></i><b>4.18.5</b> Besedilna vnosna polja</a></li>
<li class="chapter" data-level="4.18.6" data-path="JavaScript.html"><a href="JavaScript.html#gradniki-večkratne-izbire"><i class="fa fa-check"></i><b>4.18.6</b> Gradniki (večkratne) izbire</a></li>
<li class="chapter" data-level="4.18.7" data-path="JavaScript.html"><a href="JavaScript.html#izbirna-polja"><i class="fa fa-check"></i><b>4.18.7</b> Izbirna polja</a></li>
<li class="chapter" data-level="4.18.8" data-path="JavaScript.html"><a href="JavaScript.html#vnosno-polje-datoteke"><i class="fa fa-check"></i><b>4.18.8</b> Vnosno polje datoteke</a></li>
<li class="chapter" data-level="4.18.9" data-path="JavaScript.html"><a href="JavaScript.html#shranjevanje-podatkov-na-odjemalcu"><i class="fa fa-check"></i><b>4.18.9</b> Shranjevanje podatkov na odjemalcu</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="Node-js.html"><a href="Node-js.html"><i class="fa fa-check"></i><b>5</b> <span class="sklop2 oznaka">P2.2</span> Node.js, MVC in različna okolja</a>
<ul>
<li class="chapter" data-level="5.1" data-path="Node-js.html"><a href="Node-js.html#node.js"><i class="fa fa-check"></i><b>5.1</b> Node.js</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="Node-js.html"><a href="Node-js.html#ozadje-1"><i class="fa fa-check"></i><b>5.1.1</b> Ozadje</a></li>
<li class="chapter" data-level="5.1.2" data-path="Node-js.html"><a href="Node-js.html#asinhronost"><i class="fa fa-check"></i><b>5.1.2</b> Asinhronost</a></li>
<li class="chapter" data-level="5.1.3" data-path="Node-js.html"><a href="Node-js.html#ukaz-node"><i class="fa fa-check"></i><b>5.1.3</b> Ukaz <code>node</code></a></li>
<li class="chapter" data-level="5.1.4" data-path="Node-js.html"><a href="Node-js.html#moduli-1"><i class="fa fa-check"></i><b>5.1.4</b> Moduli</a></li>
<li class="chapter" data-level="5.1.5" data-path="Node-js.html"><a href="Node-js.html#nameščanje-z-npm"><i class="fa fa-check"></i><b>5.1.5</b> Nameščanje z <code>npm</code></a></li>
<li class="chapter" data-level="5.1.6" data-path="Node-js.html"><a href="Node-js.html#modul-za-dostop-do-datotečnega-sistema"><i class="fa fa-check"></i><b>5.1.6</b> Modul za dostop do datotečnega sistema</a></li>
<li class="chapter" data-level="5.1.7" data-path="Node-js.html"><a href="Node-js.html#modul-http"><i class="fa fa-check"></i><b>5.1.7</b> Modul <code>http</code></a></li>
<li class="chapter" data-level="5.1.8" data-path="Node-js.html"><a href="Node-js.html#tok-podatkov"><i class="fa fa-check"></i><b>5.1.8</b> Tok podatkov</a></li>
<li class="chapter" data-level="5.1.9" data-path="Node-js.html"><a href="Node-js.html#enostavni-datotečni-strežnik"><i class="fa fa-check"></i><b>5.1.9</b> Enostavni datotečni strežnik</a></li>
<li class="chapter" data-level="5.1.10" data-path="Node-js.html"><a href="Node-js.html#obvladovanje-napak"><i class="fa fa-check"></i><b>5.1.10</b> Obvladovanje napak</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="Node-js.html"><a href="Node-js.html#vzpostavitev-in-nastavitev-projekta"><i class="fa fa-check"></i><b>5.2</b> Vzpostavitev in nastavitev projekta</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="Node-js.html"><a href="Node-js.html#pregled-uporabljenih-orodij-express-node-in-npm"><i class="fa fa-check"></i><b>5.2.1</b> Pregled uporabljenih orodij Express, Node in <code>npm</code></a></li>
<li class="chapter" data-level="5.2.2" data-path="Node-js.html"><a href="Node-js.html#kreiranje-projekta-express"><i class="fa fa-check"></i><b>5.2.2</b> Kreiranje projekta Express</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="Node-js.html"><a href="Node-js.html#gradnja-aplikacije-z-mvc"><i class="fa fa-check"></i><b>5.3</b> Gradnja aplikacije z MVC</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="Node-js.html"><a href="Node-js.html#kratek-pregled-mvc-arhitekture"><i class="fa fa-check"></i><b>5.3.1</b> Kratek pregled MVC arhitekture</a></li>
<li class="chapter" data-level="5.3.2" data-path="Node-js.html"><a href="Node-js.html#kako-express-obdela-zahteve"><i class="fa fa-check"></i><b>5.3.2</b> Kako Express obdela zahteve?</a></li>
<li class="chapter" data-level="5.3.3" data-path="Node-js.html"><a href="Node-js.html#gradnja-statične-aplikacije-z-node-in-express"><i class="fa fa-check"></i><b>5.3.3</b> Gradnja statične aplikacije z Node in Express</a></li>
<li class="chapter" data-level="5.3.4" data-path="Node-js.html"><a href="Node-js.html#prilagoditev-ogrodja-express-za-mvc"><i class="fa fa-check"></i><b>5.3.4</b> Prilagoditev ogrodja Express za MVC</a></li>
<li class="chapter" data-level="5.3.5" data-path="Node-js.html"><a href="Node-js.html#dodajanje-zunanjih-knjižnic-za-prilagoditev-izgleda-strani"><i class="fa fa-check"></i><b>5.3.5</b> Dodajanje zunanjih knjižnic za prilagoditev izgleda strani</a></li>
<li class="chapter" data-level="5.3.6" data-path="Node-js.html"><a href="Node-js.html#opredelitev-usmerjevalnikov-v-express"><i class="fa fa-check"></i><b>5.3.6</b> Opredelitev usmerjevalnikov v Express</a></li>
<li class="chapter" data-level="5.3.7" data-path="Node-js.html"><a href="Node-js.html#izdelava-osnovnih-krmilnikov"><i class="fa fa-check"></i><b>5.3.7</b> Izdelava osnovnih krmilnikov</a></li>
<li class="chapter" data-level="5.3.8" data-path="Node-js.html"><a href="Node-js.html#dopolnitev-pogledov"><i class="fa fa-check"></i><b>5.3.8</b> Dopolnitev pogledov</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="Node-js.html"><a href="Node-js.html#strežba-aplikacije-v-različnih-okoljih"><i class="fa fa-check"></i><b>5.4</b> Strežba aplikacije v različnih okoljih</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="Node-js.html"><a href="Node-js.html#docker"><i class="fa fa-check"></i><b>5.4.1</b> Strežba aplikacije v okolju Docker</a></li>
<li class="chapter" data-level="5.4.2" data-path="Node-js.html"><a href="Node-js.html#strežba-aplikacije-na-fly"><i class="fa fa-check"></i><b>5.4.2</b> Strežba aplikacije na Fly</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III sklop: Zaledni del in dostop do podatkov</b></span></li>
<li class="chapter" data-level="6" data-path="PB-REST-API.html"><a href="PB-REST-API.html"><i class="fa fa-check"></i><b>6</b> <span class="sklop3 oznaka">P3.1</span> Podatkovna baza in REST API</a>
<ul>
<li class="chapter" data-level="6.1" data-path="PB-REST-API.html"><a href="PB-REST-API.html#priprava-podatkovnega-modela-za-mongodb-z-mongoose"><i class="fa fa-check"></i><b>6.1</b> Priprava podatkovnega modela za MongoDB z Mongoose</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="PB-REST-API.html"><a href="PB-REST-API.html#Povezovanje-Express-aplikacije-in-MongoDB-z-Mongoose"><i class="fa fa-check"></i><b>6.1.1</b> Povezovanje Express aplikacije in MongoDB z Mongoose</a></li>
<li class="chapter" data-level="6.1.2" data-path="PB-REST-API.html"><a href="PB-REST-API.html#zakaj-je-treba-modelirati-podatke"><i class="fa fa-check"></i><b>6.1.2</b> Zakaj je treba modelirati podatke?</a></li>
<li class="chapter" data-level="6.1.3" data-path="PB-REST-API.html"><a href="PB-REST-API.html#podatki-iz-registra"><i class="fa fa-check"></i><b>6.1.3</b> Podatki iz registra kulturne dediščine</a></li>
<li class="chapter" data-level="6.1.4" data-path="PB-REST-API.html"><a href="PB-REST-API.html#opredelitev-sheme-z-mongoose"><i class="fa fa-check"></i><b>6.1.4</b> Opredelitev sheme z Mongoose</a></li>
<li class="chapter" data-level="6.1.5" data-path="PB-REST-API.html"><a href="PB-REST-API.html#Uporaba-MongoDB-ukazne-lupine-za-dodajanje-podatkov"><i class="fa fa-check"></i><b>6.1.5</b> Uporaba MongoDB ukazne lupine za dodajanje podatkov</a></li>
<li class="chapter" data-level="6.1.6" data-path="PB-REST-API.html"><a href="PB-REST-API.html#uvoz-testnih-podatkov"><i class="fa fa-check"></i><b>6.1.6</b> Uvoz testnih podatkov</a></li>
<li class="chapter" data-level="6.1.7" data-path="PB-REST-API.html"><a href="PB-REST-API.html#vključitev-podatkovne-baze"><i class="fa fa-check"></i><b>6.1.7</b> Vključitev podatkovne baze</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="PB-REST-API.html"><a href="PB-REST-API.html#priprava-rest-api-ja-za-dostop-do-mongodb-podatkovne-baze"><i class="fa fa-check"></i><b>6.2</b> Priprava REST API-ja za dostop do MongoDB podatkovne baze</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="PB-REST-API.html"><a href="PB-REST-API.html#rest-api"><i class="fa fa-check"></i><b>6.2.1</b> REST API</a></li>
<li class="chapter" data-level="6.2.2" data-path="PB-REST-API.html"><a href="PB-REST-API.html#url-zahteva"><i class="fa fa-check"></i><b>6.2.2</b> URL zahteva</a></li>
<li class="chapter" data-level="6.2.3" data-path="PB-REST-API.html"><a href="PB-REST-API.html#metoda-zahteve"><i class="fa fa-check"></i><b>6.2.3</b> Metoda zahteve</a></li>
<li class="chapter" data-level="6.2.4" data-path="PB-REST-API.html"><a href="PB-REST-API.html#odgovor-podatek-in-status-api-ja"><i class="fa fa-check"></i><b>6.2.4</b> Odgovor (podatek in status) API-ja</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="PB-REST-API.html"><a href="PB-REST-API.html#Implementacija-API-ja-z-ogrodjem-Express"><i class="fa fa-check"></i><b>6.3</b> Implementacija API-ja z ogrodjem Express</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="PB-REST-API.html"><a href="PB-REST-API.html#priprava-usmerjevalnika"><i class="fa fa-check"></i><b>6.3.1</b> Priprava usmerjevalnika</a></li>
<li class="chapter" data-level="6.3.2" data-path="PB-REST-API.html"><a href="PB-REST-API.html#priprava-osnutka-krmilnika"><i class="fa fa-check"></i><b>6.3.2</b> Priprava osnutka krmilnika</a></li>
<li class="chapter" data-level="6.3.3" data-path="PB-REST-API.html"><a href="PB-REST-API.html#testiranje-osnutka-api-ja"><i class="fa fa-check"></i><b>6.3.3</b> Testiranje osnutka API-ja</a></li>
<li class="chapter" data-level="6.3.4" data-path="PB-REST-API.html"><a href="PB-REST-API.html#vključitev-modela"><i class="fa fa-check"></i><b>6.3.4</b> Vključitev modela</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="PB-REST-API.html"><a href="PB-REST-API.html#get-metode-za-branje-podatkov-iz-mongodb"><i class="fa fa-check"></i><b>6.4</b> GET metode za branje podatkov iz MongoDB</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="PB-REST-API.html"><a href="PB-REST-API.html#iskanje-dokumenta"><i class="fa fa-check"></i><b>6.4.1</b> Iskanje dokumenta</a></li>
<li class="chapter" data-level="6.4.2" data-path="PB-REST-API.html"><a href="PB-REST-API.html#iskanje-odvisnega-dokumenta"><i class="fa fa-check"></i><b>6.4.2</b> Iskanje odvisnega dokumenta</a></li>
<li class="chapter" data-level="6.4.3" data-path="PB-REST-API.html"><a href="PB-REST-API.html#geografsko-iskanje"><i class="fa fa-check"></i><b>6.4.3</b> Geografsko iskanje več dokumentov</a></li>
<li class="chapter" data-level="6.4.4" data-path="PB-REST-API.html"><a href="PB-REST-API.html#napredno-iskanje"><i class="fa fa-check"></i><b>6.4.4</b> Napredno iskanje</a></li>
<li class="chapter" data-level="6.4.5" data-path="PB-REST-API.html"><a href="PB-REST-API.html#seznami-sifrantov"><i class="fa fa-check"></i><b>6.4.5</b> Seznami šifrantov</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="Swagger.html"><a href="Swagger.html"><i class="fa fa-check"></i><b>7</b> <span class="sklop3 oznaka">P3.2</span> Načrtovanje s Swagger in OpenAPI</a>
<ul>
<li class="chapter" data-level="7.1" data-path="Swagger.html"><a href="Swagger.html#dokumentiranje-rest-api-ja-z-openapi-specifikacijo"><i class="fa fa-check"></i><b>7.1</b> Dokumentiranje REST API-ja z OpenAPI specifikacijo</a></li>
<li class="chapter" data-level="7.2" data-path="Swagger.html"><a href="Swagger.html#post-metode-za-dodajanje-podatkov-v-mongodb"><i class="fa fa-check"></i><b>7.2</b> POST metode za dodajanje podatkov v MongoDB</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="Swagger.html"><a href="Swagger.html#dodajanje-novih-dokumentov-v-mongodb"><i class="fa fa-check"></i><b>7.2.1</b> Dodajanje novih dokumentov v MongoDB</a></li>
<li class="chapter" data-level="7.2.2" data-path="Swagger.html"><a href="Swagger.html#dodajanje-odvisnih-dokumentov-v-mongodb"><i class="fa fa-check"></i><b>7.2.2</b> Dodajanje odvisnih dokumentov v MongoDB</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="Swagger.html"><a href="Swagger.html#put-metode-za-ažuriranje-podatkov-v-mongodb"><i class="fa fa-check"></i><b>7.3</b> PUT metode za ažuriranje podatkov v MongoDB</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="Swagger.html"><a href="Swagger.html#posodobitev-obstoječega-dokumenta-v-mongodb"><i class="fa fa-check"></i><b>7.3.1</b> Posodobitev obstoječega dokumenta v MongoDB</a></li>
<li class="chapter" data-level="7.3.2" data-path="Swagger.html"><a href="Swagger.html#PUT-odvisni-dokument"><i class="fa fa-check"></i><b>7.3.2</b> Posodobitev obstoječega odvisnega dokumenta v MongoDB</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="Swagger.html"><a href="Swagger.html#delete-metode-za-brisanje-podatkov-iz-mongodb"><i class="fa fa-check"></i><b>7.4</b> DELETE metode za brisanje podatkov iz MongoDB</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="Swagger.html"><a href="Swagger.html#DELETE-comment"><i class="fa fa-check"></i><b>7.4.1</b> Brisanje obstoječega komentarja</a></li>
<li class="chapter" data-level="7.4.2" data-path="Swagger.html"><a href="Swagger.html#brisanje-dokumentov"><i class="fa fa-check"></i><b>7.4.2</b> Brisanje dokumentov</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="Swagger.html"><a href="Swagger.html#uporaba-rest-api-ja-v-express-aplikaciji"><i class="fa fa-check"></i><b>7.5</b> Uporaba REST API-ja v Express aplikaciji</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="Swagger.html"><a href="Swagger.html#priprava-na-api-klic-iz-express-aplikacije"><i class="fa fa-check"></i><b>7.5.1</b> Priprava na API klic iz Express aplikacije</a></li>
<li class="chapter" data-level="7.5.2" data-path="Swagger.html"><a href="Swagger.html#pridobitev-seznama-lokacij-preko-api-ja"><i class="fa fa-check"></i><b>7.5.2</b> Pridobitev seznama lokacij preko API-ja</a></li>
<li class="chapter" data-level="7.5.3" data-path="Swagger.html"><a href="Swagger.html#priprava-novega-pogleda-seznama"><i class="fa fa-check"></i><b>7.5.3</b> Priprava novega pogleda seznama</a></li>
<li class="chapter" data-level="7.5.4" data-path="Swagger.html"><a href="Swagger.html#axios-zunanji-viri"><i class="fa fa-check"></i><b>7.5.4</b> Vključitev ostalih podatkov iz zunanjih virov</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="Swagger.html"><a href="Swagger.html#izboljšanje-zmogljivosti-api-ja"><i class="fa fa-check"></i><b>7.6</b> Izboljšanje zmogljivosti API-ja</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="Swagger.html"><a href="Swagger.html#porazdelitev-po-straneh"><i class="fa fa-check"></i><b>7.6.1</b> Porazdelitev po straneh</a></li>
<li class="chapter" data-level="7.6.2" data-path="Swagger.html"><a href="Swagger.html#asinhrono-beleženje"><i class="fa fa-check"></i><b>7.6.2</b> Asinhrono beleženje</a></li>
<li class="chapter" data-level="7.6.3" data-path="Swagger.html"><a href="Swagger.html#predpomnjenje"><i class="fa fa-check"></i><b>7.6.3</b> Predpomnjenje</a></li>
<li class="chapter" data-level="7.6.4" data-path="Swagger.html"><a href="Swagger.html#stiskanje-koristne-vsebine"><i class="fa fa-check"></i><b>7.6.4</b> Stiskanje koristne vsebine</a></li>
<li class="chapter" data-level="7.6.5" data-path="Swagger.html"><a href="Swagger.html#bazen-povezav"><i class="fa fa-check"></i><b>7.6.5</b> Bazen povezav</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV sklop: Uporabniški vmesnik</b></span></li>
<li class="chapter" data-level="8" data-path="Angular.html"><a href="Angular.html"><i class="fa fa-check"></i><b>8</b> <span class="sklop4 oznaka">P4.1</span> TypeScript in Angular</a>
<ul>
<li class="chapter" data-level="8.1" data-path="Angular.html"><a href="Angular.html#Dodajanje-Angular-komponent-v-Express-aplikacijo"><i class="fa fa-check"></i><b>8.1</b> Dodajanje Angular komponent v Express aplikacijo</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="Angular.html"><a href="Angular.html#namestitev-ogrodja-angular"><i class="fa fa-check"></i><b>8.1.1</b> Namestitev ogrodja Angular</a></li>
<li class="chapter" data-level="8.1.2" data-path="Angular.html"><a href="Angular.html#jezik-typescript"><i class="fa fa-check"></i><b>8.1.2</b> Jezik TypeScript</a></li>
<li class="chapter" data-level="8.1.3" data-path="Angular.html"><a href="Angular.html#kreiranje-in-zagon-angular-aplikacije"><i class="fa fa-check"></i><b>8.1.3</b> Kreiranje in zagon Angular aplikacije</a></li>
<li class="chapter" data-level="8.1.4" data-path="Angular.html"><a href="Angular.html#Izvorna-koda-Angular-aplikacije"><i class="fa fa-check"></i><b>8.1.4</b> Izvorna koda Angular aplikacije</a></li>
<li class="chapter" data-level="8.1.5" data-path="Angular.html"><a href="Angular.html#generiranje-angular-aplikacije-v-jeziku-javascript"><i class="fa fa-check"></i><b>8.1.5</b> Generiranje Angular aplikacije v jeziku JavaScript</a></li>
<li class="chapter" data-level="8.1.6" data-path="Angular.html"><a href="Angular.html#komponenta-za-prikaz-podatkov"><i class="fa fa-check"></i><b>8.1.6</b> Komponenta za prikaz podatkov</a></li>
<li class="chapter" data-level="8.1.7" data-path="Angular.html"><a href="Angular.html#Pridobivanje-podatkov-preko-REST-API-ja"><i class="fa fa-check"></i><b>8.1.7</b> Pridobivanje podatkov preko REST API-ja</a></li>
<li class="chapter" data-level="8.1.8" data-path="Angular.html"><a href="Angular.html#prenos-angular-aplikacije-v-produkcijsko-okolje"><i class="fa fa-check"></i><b>8.1.8</b> Prenos Angular aplikacije v produkcijsko okolje</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="Angular.html"><a href="Angular.html#izdelava-angular-spa-aplikacije-na-eni-strani"><i class="fa fa-check"></i><b>8.2</b> Izdelava Angular SPA aplikacije na eni strani</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="Angular.html"><a href="Angular.html#Prehod-iz-Express-usmerjanja-na-Angular-usmerjanje"><i class="fa fa-check"></i><b>8.2.1</b> Prehod iz Express usmerjanja na Angular usmerjanje</a></li>
<li class="chapter" data-level="8.2.2" data-path="Angular.html"><a href="Angular.html#navigacija-med-stranmi"><i class="fa fa-check"></i><b>8.2.2</b> Navigacija med stranmi</a></li>
<li class="chapter" data-level="8.2.3" data-path="Angular.html"><a href="Angular.html#modularna-zasnova-aplikacije-z-vgnezdenimi-komponentami"><i class="fa fa-check"></i><b>8.2.3</b> Modularna zasnova aplikacije z vgnezdenimi komponentami</a></li>
<li class="chapter" data-level="8.2.4" data-path="Angular.html"><a href="Angular.html#dodajanje-html-geolokacije-za-iskanje-bližnjih-lokacij"><i class="fa fa-check"></i><b>8.2.4</b> Dodajanje HTML geolokacije za iskanje bližnjih lokacij</a></li>
<li class="chapter" data-level="8.2.5" data-path="Angular.html"><a href="Angular.html#prikaz-zvezdic-v-obliki-ponovno-uporabne-komponente"><i class="fa fa-check"></i><b>8.2.5</b> Prikaz zvezdic v obliki ponovno uporabne komponente</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="Angular-SPA.html"><a href="Angular-SPA.html"><i class="fa fa-check"></i><b>9</b> <span class="sklop4 oznaka">P4.2</span> Angular SPA</a>
<ul>
<li class="chapter" data-level="9.1" data-path="Angular-SPA.html"><a href="Angular-SPA.html#kompleksnejši-pogledi-s-parametri-usmerjevanja"><i class="fa fa-check"></i><b>9.1</b> Kompleksnejši pogledi s parametri usmerjevanja</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="Angular-SPA.html"><a href="Angular-SPA.html#sprememba-strukture-strani"><i class="fa fa-check"></i><b>9.1.1</b> Sprememba strukture strani</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="Angular-SPA.html"><a href="Angular-SPA.html#dodajanje-usmerjanja-z-url-parametri"><i class="fa fa-check"></i><b>9.2</b> Dodajanje usmerjanja z URL parametri</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="Angular-SPA.html"><a href="Angular-SPA.html#prenos-podatkov-do-komponente-s-podrobnostmi-lokacije"><i class="fa fa-check"></i><b>9.2.1</b> Prenos podatkov do komponente s podrobnostmi lokacije</a></li>
<li class="chapter" data-level="9.2.2" data-path="Angular-SPA.html"><a href="Angular-SPA.html#pogled-podrobnosti-lokacije"><i class="fa fa-check"></i><b>9.2.2</b> Pogled podrobnosti lokacije</a></li>
<li class="chapter" data-level="9.2.3" data-path="Angular-SPA.html"><a href="Angular-SPA.html#varnostne-izjeme-pri-prikazovanju-zunanjih-podatkov"><i class="fa fa-check"></i><b>9.2.3</b> Varnostne izjeme pri prikazovanju zunanjih podatkov</a></li>
<li class="chapter" data-level="9.2.4" data-path="Angular-SPA.html"><a href="Angular-SPA.html#sprememba-vrstnega-reda-prikaza-komentarjev"><i class="fa fa-check"></i><b>9.2.4</b> Sprememba vrstnega reda prikaza komentarjev</a></li>
<li class="chapter" data-level="9.2.5" data-path="Angular-SPA.html"><a href="Angular-SPA.html#formatiranje-datuma"><i class="fa fa-check"></i><b>9.2.5</b> Formatiranje datuma</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="Angular-SPA.html"><a href="Angular-SPA.html#delo-s-spletnimi-obrazci-in-pošiljanje-podatkov"><i class="fa fa-check"></i><b>9.3</b> Delo s spletnimi obrazci in pošiljanje podatkov</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="Angular-SPA.html"><a href="Angular-SPA.html#priprava-modalnega-okna"><i class="fa fa-check"></i><b>9.3.1</b> Priprava modalnega okna</a></li>
<li class="chapter" data-level="9.3.2" data-path="Angular-SPA.html"><a href="Angular-SPA.html#dodajanje-spletnega-obrazca"><i class="fa fa-check"></i><b>9.3.2</b> Dodajanje spletnega obrazca</a></li>
<li class="chapter" data-level="9.3.3" data-path="Angular-SPA.html"><a href="Angular-SPA.html#povezovanje-podatkov-in-vnosnih-polj-obrazca"><i class="fa fa-check"></i><b>9.3.3</b> Povezovanje podatkov in vnosnih polj obrazca</a></li>
<li class="chapter" data-level="9.3.4" data-path="Angular-SPA.html"><a href="Angular-SPA.html#posredovanje-podatkov-spletnega-obrazca-na-rest-api"><i class="fa fa-check"></i><b>9.3.4</b> Posredovanje podatkov spletnega obrazca na REST API</a></li>
<li class="chapter" data-level="9.3.5" data-path="Angular-SPA.html"><a href="Angular-SPA.html#brisanje-komentarjev"><i class="fa fa-check"></i><b>9.3.5</b> Brisanje komentarjev</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="Angular-SPA.html"><a href="Angular-SPA.html#izboljšava-arhitekture"><i class="fa fa-check"></i><b>9.4</b> Izboljšava arhitekture</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="Angular-SPA.html"><a href="Angular-SPA.html#locitev-usmerjanja"><i class="fa fa-check"></i><b>9.4.1</b> Ločitev usmerjanja</a></li>
<li class="chapter" data-level="9.4.2" data-path="Angular-SPA.html"><a href="Angular-SPA.html#opredelitev-razredov"><i class="fa fa-check"></i><b>9.4.2</b> Opredelitev razredov</a></li>
<li class="chapter" data-level="9.4.3" data-path="Angular-SPA.html"><a href="Angular-SPA.html#Organizacija-izvorne-kode-v-mape"><i class="fa fa-check"></i><b>9.4.3</b> Organizacija izvorne kode v mape</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="Angular-SPA.html"><a href="Angular-SPA.html#zamenjava-strežniške-aplikacije-s-spa-aplikacijo"><i class="fa fa-check"></i><b>9.5</b> Zamenjava strežniške aplikacije s SPA aplikacijo</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="Angular-SPA.html"><a href="Angular-SPA.html#preusmeritev-zahtev-na-angular-spa"><i class="fa fa-check"></i><b>9.5.1</b> Preusmeritev zahtev na Angular SPA</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="Angular-SPA.html"><a href="Angular-SPA.html#dodatni-gradniki-angular-aplikacije"><i class="fa fa-check"></i><b>9.6</b> Dodatni gradniki Angular aplikacije</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="Avtentikacija.html"><a href="Avtentikacija.html"><i class="fa fa-check"></i><b>10</b> <span class="sklop4 oznaka">P4.3</span> Preverjanje istovetnosti uporabnika</a>
<ul>
<li class="chapter" data-level="10.1" data-path="Avtentikacija.html"><a href="Avtentikacija.html#način-avtentikacije-z-uporabo-mean-sklada-tehnologij"><i class="fa fa-check"></i><b>10.1</b> Način avtentikacije z uporabo MEAN sklada tehnologij</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="Avtentikacija.html"><a href="Avtentikacija.html#klasični-pristop-avtentikacije-pri-strežniški-aplikaciji"><i class="fa fa-check"></i><b>10.1.1</b> Klasični pristop avtentikacije pri strežniški aplikaciji</a></li>
<li class="chapter" data-level="10.1.2" data-path="Avtentikacija.html"><a href="Avtentikacija.html#avtentikacija-z-mean-skladom-tehnologij"><i class="fa fa-check"></i><b>10.1.2</b> Avtentikacija z MEAN skladom tehnologij</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="Avtentikacija.html"><a href="Avtentikacija.html#kreiranje-sheme-uporabnikov-v-mongodb"><i class="fa fa-check"></i><b>10.2</b> Kreiranje sheme uporabnikov v MongoDB</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="Avtentikacija.html"><a href="Avtentikacija.html#enosmerno-šifriranje-gesel"><i class="fa fa-check"></i><b>10.2.1</b> Enosmerno šifriranje gesel</a></li>
<li class="chapter" data-level="10.2.2" data-path="Avtentikacija.html"><a href="Avtentikacija.html#Kreiranje-sheme-z-Mongoose"><i class="fa fa-check"></i><b>10.2.2</b> Kreiranje sheme z Mongoose</a></li>
<li class="chapter" data-level="10.2.3" data-path="Avtentikacija.html"><a href="Avtentikacija.html#šifriranje-uporabniškega-gesla"><i class="fa fa-check"></i><b>10.2.3</b> Šifriranje uporabniškega gesla</a></li>
<li class="chapter" data-level="10.2.4" data-path="Avtentikacija.html"><a href="Avtentikacija.html#preverjanje-ustreznosti-podanega-gesla"><i class="fa fa-check"></i><b>10.2.4</b> Preverjanje ustreznosti podanega gesla</a></li>
<li class="chapter" data-level="10.2.5" data-path="Avtentikacija.html"><a href="Avtentikacija.html#generiranje-json-spletnega-žetona-jwt"><i class="fa fa-check"></i><b>10.2.5</b> Generiranje JSON spletnega žetona (JWT)</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="Avtentikacija.html"><a href="Avtentikacija.html#Priprava-API-ja-za-avtentikacijo"><i class="fa fa-check"></i><b>10.3</b> Priprava API-ja za avtentikacijo</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="Avtentikacija.html"><a href="Avtentikacija.html#namestitev-in-konfiguracija-passporta"><i class="fa fa-check"></i><b>10.3.1</b> Namestitev in konfiguracija Passporta</a></li>
<li class="chapter" data-level="10.3.2" data-path="Avtentikacija.html"><a href="Avtentikacija.html#kreiranje-api-dostopne-točke-in-vračanje-json-spletnih-žetonov-jwt"><i class="fa fa-check"></i><b>10.3.2</b> Kreiranje API dostopne točke in vračanje JSON spletnih žetonov (JWT)</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="Avtentikacija.html"><a href="Avtentikacija.html#Varnostna-zascita-izbranih-API-dostopnih-tock"><i class="fa fa-check"></i><b>10.4</b> Varnostna zaščita izbranih API dostopnih točk</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="Avtentikacija.html"><a href="Avtentikacija.html#dodajanje-vmesne-avtentikacijske-ravni-pri-express-usmerjanju"><i class="fa fa-check"></i><b>10.4.1</b> Dodajanje vmesne avtentikacijske ravni pri Express usmerjanju</a></li>
<li class="chapter" data-level="10.4.2" data-path="Avtentikacija.html"><a href="Avtentikacija.html#uporaba-informacij-iz-jwt-v-express-krmilniku"><i class="fa fa-check"></i><b>10.4.2</b> Uporaba informacij iz JWT v Express krmilniku</a></li>
<li class="chapter" data-level="10.4.3" data-path="Avtentikacija.html"><a href="Avtentikacija.html#avtorizacija-azuriranje"><i class="fa fa-check"></i><b>10.4.3</b> Avtorizacija pri ažuriranju komentarja</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="Avtentikacija.html"><a href="Avtentikacija.html#Priprava-storitve-avtentikacije-v-Angular"><i class="fa fa-check"></i><b>10.5</b> Priprava storitve avtentikacije v Angular</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="Avtentikacija.html"><a href="Avtentikacija.html#obvladovanje-seje-uporabnika-v-angular"><i class="fa fa-check"></i><b>10.5.1</b> Obvladovanje seje uporabnika v Angular</a></li>
<li class="chapter" data-level="10.5.2" data-path="Avtentikacija.html"><a href="Avtentikacija.html#omogočanje-registracije-prijave-in-odjave-uporabnikov"><i class="fa fa-check"></i><b>10.5.2</b> Omogočanje registracije, prijave in odjave uporabnikov</a></li>
<li class="chapter" data-level="10.5.3" data-path="Avtentikacija.html"><a href="Avtentikacija.html#uporaba-podatkov-iz-jwt-v-angular-storitvi"><i class="fa fa-check"></i><b>10.5.3</b> Uporaba podatkov iz JWT v Angular storitvi</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="Avtentikacija.html"><a href="Avtentikacija.html#Priprava-strani-za-registracijo-in-prijavo-uporabnika"><i class="fa fa-check"></i><b>10.6</b> Priprava strani za registracijo in prijavo uporabnika</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="Avtentikacija.html"><a href="Avtentikacija.html#priprava-strani-za-registracijo"><i class="fa fa-check"></i><b>10.6.1</b> Priprava strani za registracijo</a></li>
<li class="chapter" data-level="10.6.2" data-path="Avtentikacija.html"><a href="Avtentikacija.html#priprava-strani-za-prijavo"><i class="fa fa-check"></i><b>10.6.2</b> Priprava strani za prijavo</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="Avtentikacija.html"><a href="Avtentikacija.html#uporaba-avtentikacije-v-angular-aplikaciji"><i class="fa fa-check"></i><b>10.7</b> Uporaba avtentikacije v Angular aplikaciji</a>
<ul>
<li class="chapter" data-level="10.7.1" data-path="Avtentikacija.html"><a href="Avtentikacija.html#posodobitev-navigacije"><i class="fa fa-check"></i><b>10.7.1</b> Posodobitev navigacije</a></li>
<li class="chapter" data-level="10.7.2" data-path="Avtentikacija.html"><a href="Avtentikacija.html#podpora-zgodovini-brskanja"><i class="fa fa-check"></i><b>10.7.2</b> Podpora zgodovini brskanja</a></li>
<li class="chapter" data-level="10.7.3" data-path="Avtentikacija.html"><a href="Avtentikacija.html#dodajanje-uporabnika-v-komentar"><i class="fa fa-check"></i><b>10.7.3</b> Dodajanje uporabniških podatkov v komentar</a></li>
<li class="chapter" data-level="10.7.4" data-path="Avtentikacija.html"><a href="Avtentikacija.html#brisanje-lastnih-komentarjev"><i class="fa fa-check"></i><b>10.7.4</b> Brisanje lastnih komentarjev</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="Avtentikacija.html"><a href="Avtentikacija.html#nastavitve-v-brskalniku"><i class="fa fa-check"></i><b>10.8</b> Shranjevanje uporabniških nastavitev v brskalniku</a></li>
<li class="chapter" data-level="10.9" data-path="Avtentikacija.html"><a href="Avtentikacija.html#auth-guard"><i class="fa fa-check"></i><b>10.9</b> Auth Guard</a>
<ul>
<li class="chapter" data-level="10.9.1" data-path="Avtentikacija.html"><a href="Avtentikacija.html#vrste"><i class="fa fa-check"></i><b>10.9.1</b> Vrste</a></li>
<li class="chapter" data-level="10.9.2" data-path="Avtentikacija.html"><a href="Avtentikacija.html#canRegister"><i class="fa fa-check"></i><b>10.9.2</b> Onemogočenje registracije prijavljenim uporabnikom</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>V sklop: Decentralizirane aplikacije in veriga blokov</b></span></li>
<li class="chapter" data-level="11" data-path="DApps-pametne-pogodbe.html"><a href="DApps-pametne-pogodbe.html"><i class="fa fa-check"></i><b>11</b> <span class="sklop5 oznaka">P5.1</span> DApps, pametne pogodbe in Solidity</a>
<ul>
<li class="chapter" data-level="11.1" data-path="DApps-pametne-pogodbe.html"><a href="DApps-pametne-pogodbe.html#decentralizirane-aplikacije"><i class="fa fa-check"></i><b>11.1</b> Decentralizirane aplikacije</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="DApps-pametne-pogodbe.html"><a href="DApps-pametne-pogodbe.html#kaj-je-decentralizirana-aplikacija-dapp"><i class="fa fa-check"></i><b>11.1.1</b> Kaj je decentralizirana aplikacija (DApp)?</a></li>
<li class="chapter" data-level="11.1.2" data-path="DApps-pametne-pogodbe.html"><a href="DApps-pametne-pogodbe.html#omrežje-ethereum"><i class="fa fa-check"></i><b>11.1.2</b> Omrežje Ethereum</a></li>
<li class="chapter" data-level="11.1.3" data-path="DApps-pametne-pogodbe.html"><a href="DApps-pametne-pogodbe.html#terminologija-dapp"><i class="fa fa-check"></i><b>11.1.3</b> Terminologija DApp</a></li>
<li class="chapter" data-level="11.1.4" data-path="DApps-pametne-pogodbe.html"><a href="DApps-pametne-pogodbe.html#decentralizirane-in-porazdeljene-aplikacije"><i class="fa fa-check"></i><b>11.1.4</b> Decentralizirane in porazdeljene aplikacije</a></li>
<li class="chapter" data-level="11.1.5" data-path="DApps-pametne-pogodbe.html"><a href="DApps-pametne-pogodbe.html#primeri-dobrih-praks"><i class="fa fa-check"></i><b>11.1.5</b> Primeri dobrih praks</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="DApps-pametne-pogodbe.html"><a href="DApps-pametne-pogodbe.html#veriga-blokov"><i class="fa fa-check"></i><b>11.2</b> Veriga blokov</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="DApps-pametne-pogodbe.html"><a href="DApps-pametne-pogodbe.html#sklad-tehnologij-za-podporo-dapp"><i class="fa fa-check"></i><b>11.2.1</b> Sklad tehnologij za podporo DApp</a></li>
<li class="chapter" data-level="11.2.2" data-path="DApps-pametne-pogodbe.html"><a href="DApps-pametne-pogodbe.html#podrobnosti-vozlišča-ethereum"><i class="fa fa-check"></i><b>11.2.2</b> Podrobnosti vozlišča Ethereum</a></li>
<li class="chapter" data-level="11.2.3" data-path="DApps-pametne-pogodbe.html"><a href="DApps-pametne-pogodbe.html#življenjski-cikel-transakcije"><i class="fa fa-check"></i><b>11.2.3</b> Življenjski cikel transakcije</a></li>
<li class="chapter" data-level="11.2.4" data-path="DApps-pametne-pogodbe.html"><a href="DApps-pametne-pogodbe.html#razvijalski-pogled-na-postavitev-pametne-pogodbe"><i class="fa fa-check"></i><b>11.2.4</b> Razvijalski pogled na postavitev pametne pogodbe</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="DApps-pametne-pogodbe.html"><a href="DApps-pametne-pogodbe.html#platforma-ethereum"><i class="fa fa-check"></i><b>11.3</b> Platforma Ethereum</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="DApps-pametne-pogodbe.html"><a href="DApps-pametne-pogodbe.html#pametne-pogodbe-kot-osnova-dapp"><i class="fa fa-check"></i><b>11.3.1</b> Pametne pogodbe kot osnova DApp</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="DApps-pametne-pogodbe.html"><a href="DApps-pametne-pogodbe.html#programiranje-pametnih-pogodb-s-solidity"><i class="fa fa-check"></i><b>11.4</b> Programiranje pametnih pogodb s Solidity</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="DApps-pametne-pogodbe.html"><a href="DApps-pametne-pogodbe.html#Struktura-pogodbe"><i class="fa fa-check"></i><b>11.4.1</b> Struktura pogodbe</a></li>
<li class="chapter" data-level="11.4.2" data-path="DApps-pametne-pogodbe.html"><a href="DApps-pametne-pogodbe.html#razvoj-enostavne-pogodbe"><i class="fa fa-check"></i><b>11.4.2</b> Razvoj enostavne pogodbe</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="DApps-pametne-pogodbe.html"><a href="DApps-pametne-pogodbe.html#razvoj-kompleksnih-pametnih-pogodb"><i class="fa fa-check"></i><b>11.5</b> Razvoj kompleksnih pametnih pogodb</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="DApps-pametne-pogodbe.html"><a href="DApps-pametne-pogodbe.html#spremenljivke-stanja"><i class="fa fa-check"></i><b>11.5.1</b> Spremenljivke stanja</a></li>
<li class="chapter" data-level="11.5.2" data-path="DApps-pametne-pogodbe.html"><a href="DApps-pametne-pogodbe.html#konstruktor"><i class="fa fa-check"></i><b>11.5.2</b> Konstruktor</a></li>
<li class="chapter" data-level="11.5.3" data-path="DApps-pametne-pogodbe.html"><a href="DApps-pametne-pogodbe.html#funkcije-za-podporo-množični-prodaji"><i class="fa fa-check"></i><b>11.5.3</b> Funkcije za podporo množični prodaji</a></li>
<li class="chapter" data-level="11.5.4" data-path="DApps-pametne-pogodbe.html"><a href="DApps-pametne-pogodbe.html#testiranje-množične-prodaje"><i class="fa fa-check"></i><b>11.5.4</b> Testiranje množične prodaje</a></li>
<li class="chapter" data-level="11.5.5" data-path="DApps-pametne-pogodbe.html"><a href="DApps-pametne-pogodbe.html#večkratno-dedovanje"><i class="fa fa-check"></i><b>11.5.5</b> Večkratno dedovanje</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="DApps-pametne-pogodbe.html"><a href="DApps-pametne-pogodbe.html#objektno-usmerjene-lastnosti-pametnih-pogodb"><i class="fa fa-check"></i><b>11.6</b> Objektno usmerjene lastnosti pametnih pogodb</a>
<ul>
<li class="chapter" data-level="11.6.1" data-path="DApps-pametne-pogodbe.html"><a href="DApps-pametne-pogodbe.html#dedovanje"><i class="fa fa-check"></i><b>11.6.1</b> Dedovanje</a></li>
<li class="chapter" data-level="11.6.2" data-path="DApps-pametne-pogodbe.html"><a href="DApps-pametne-pogodbe.html#abstraktne-pogodbe"><i class="fa fa-check"></i><b>11.6.2</b> Abstraktne pogodbe</a></li>
<li class="chapter" data-level="11.6.3" data-path="DApps-pametne-pogodbe.html"><a href="DApps-pametne-pogodbe.html#vmesniki"><i class="fa fa-check"></i><b>11.6.3</b> Vmesniki</a></li>
<li class="chapter" data-level="11.6.4" data-path="DApps-pametne-pogodbe.html"><a href="DApps-pametne-pogodbe.html#knjižnice"><i class="fa fa-check"></i><b>11.6.4</b> Knjižnice</a></li>
<li class="chapter" data-level="11.6.5" data-path="DApps-pametne-pogodbe.html"><a href="DApps-pametne-pogodbe.html#skladnost-s-standardom-erc20"><i class="fa fa-check"></i><b>11.6.5</b> Skladnost s standardom <code>ERC20</code></a></li>
</ul></li>
<li class="chapter" data-level="11.7" data-path="DApps-pametne-pogodbe.html"><a href="DApps-pametne-pogodbe.html#ekosistem-ethereum"><i class="fa fa-check"></i><b>11.7</b> Ekosistem Ethereum</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="LP2.html"><a href="LP2.html"><i class="fa fa-check"></i><b>12</b> <span class="sklop5 oznaka">2. LP</span> Decentralizirana aplikacija na verigi blokov</a>
<ul>
<li class="chapter" data-level="12.1" data-path="LP2.html"><a href="LP2.html#pravila-zahteve-in-omejitve-1"><i class="fa fa-check"></i><b>12.1</b> Pravila, zahteve in omejitve</a></li>
<li class="chapter" data-level="12.2" data-path="LP2.html"><a href="LP2.html#kriteriji-vrednotenja-1"><i class="fa fa-check"></i><b>12.2</b> Kriteriji vrednotenja</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="Truffle-Web3.html"><a href="Truffle-Web3.html"><i class="fa fa-check"></i><b>13</b> <span class="sklop5 oznaka">P5.2</span> Truffle in Web3</a>
<ul>
<li class="chapter" data-level="13.1" data-path="Truffle-Web3.html"><a href="Truffle-Web3.html#izdelava-decentralizirane-aplikacije"><i class="fa fa-check"></i><b>13.1</b> Izdelava decentralizirane aplikacije</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="Truffle-Web3.html"><a href="Truffle-Web3.html#opredelitev-zahtev-decentralizirane-aplikacije-za-glasovanje"><i class="fa fa-check"></i><b>13.1.1</b> Opredelitev zahtev decentralizirane aplikacije za glasovanje</a></li>
<li class="chapter" data-level="13.1.2" data-path="Truffle-Web3.html"><a href="Truffle-Web3.html#razvojni-načrt"><i class="fa fa-check"></i><b>13.1.2</b> Razvojni načrt</a></li>
<li class="chapter" data-level="13.1.3" data-path="Truffle-Web3.html"><a href="Truffle-Web3.html#Truffle-projekt"><i class="fa fa-check"></i><b>13.1.3</b> Truffle projekt</a></li>
<li class="chapter" data-level="13.1.4" data-path="Truffle-Web3.html"><a href="Truffle-Web3.html#razvoj-pametne-pogodbe"><i class="fa fa-check"></i><b>13.1.4</b> Razvoj pametne pogodbe</a></li>
<li class="chapter" data-level="13.1.5" data-path="Truffle-Web3.html"><a href="Truffle-Web3.html#lastna-privatna-veriga-blokov"><i class="fa fa-check"></i><b>13.1.5</b> Lastna privatna veriga blokov</a></li>
<li class="chapter" data-level="13.1.6" data-path="Truffle-Web3.html"><a href="Truffle-Web3.html#prevajanje-in-postavitev-pametne-pogodbe"><i class="fa fa-check"></i><b>13.1.6</b> Prevajanje in postavitev pametne pogodbe</a></li>
<li class="chapter" data-level="13.1.7" data-path="Truffle-Web3.html"><a href="Truffle-Web3.html#testi-enot"><i class="fa fa-check"></i><b>13.1.7</b> Testi enot</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="Truffle-Web3.html"><a href="Truffle-Web3.html#uporabniški-vmesnik"><i class="fa fa-check"></i><b>13.2</b> Uporabniški vmesnik</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="Truffle-Web3.html"><a href="Truffle-Web3.html#priprava-odvisnosti"><i class="fa fa-check"></i><b>13.2.1</b> Priprava odvisnosti</a></li>
<li class="chapter" data-level="13.2.2" data-path="Truffle-Web3.html"><a href="Truffle-Web3.html#spletna-stran"><i class="fa fa-check"></i><b>13.2.2</b> Spletna stran</a></li>
<li class="chapter" data-level="13.2.3" data-path="Truffle-Web3.html"><a href="Truffle-Web3.html#web3-aplikacija-kot-angular-komponenta"><i class="fa fa-check"></i><b>13.2.3</b> Web3 aplikacija kot Angular komponenta</a></li>
<li class="chapter" data-level="13.2.4" data-path="Truffle-Web3.html"><a href="Truffle-Web3.html#opredelitev-izgleda"><i class="fa fa-check"></i><b>13.2.4</b> Opredelitev izgleda</a></li>
<li class="chapter" data-level="13.2.5" data-path="Truffle-Web3.html"><a href="Truffle-Web3.html#povezava-na-verigo-blokov"><i class="fa fa-check"></i><b>13.2.5</b> Povezava na verigo blokov</a></li>
<li class="chapter" data-level="13.2.6" data-path="Truffle-Web3.html"><a href="Truffle-Web3.html#podpora-funkcionalnostim-neregistriranega-volivca"><i class="fa fa-check"></i><b>13.2.6</b> Podpora funkcionalnostim neregistriranega volivca</a></li>
<li class="chapter" data-level="13.2.7" data-path="Truffle-Web3.html"><a href="Truffle-Web3.html#podpora-funkcionalnostim-registriranega-volivca"><i class="fa fa-check"></i><b>13.2.7</b> Podpora funkcionalnostim registriranega volivca</a></li>
<li class="chapter" data-level="13.2.8" data-path="Truffle-Web3.html"><a href="Truffle-Web3.html#podpora-funkcionalnostim-skrbnika"><i class="fa fa-check"></i><b>13.2.8</b> Podpora funkcionalnostim skrbnika</a></li>
<li class="chapter" data-level="13.2.9" data-path="Truffle-Web3.html"><a href="Truffle-Web3.html#obvladovanje-dogodkov-v-okviru-dapp"><i class="fa fa-check"></i><b>13.2.9</b> Obvladovanje dogodkov v okviru DApp</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="Truffle-Web3.html"><a href="Truffle-Web3.html#testiranje-decentralizirane-aplikacije-za-glasovanje"><i class="fa fa-check"></i><b>13.3</b> Testiranje decentralizirane aplikacije za glasovanje</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="Truffle-Web3.html"><a href="Truffle-Web3.html#zagon-osebne-verige-blokov-ganache"><i class="fa fa-check"></i><b>13.3.1</b> Zagon osebne verige blokov Ganache</a></li>
<li class="chapter" data-level="13.3.2" data-path="Truffle-Web3.html"><a href="Truffle-Web3.html#dostop-do-racunov-metamask"><i class="fa fa-check"></i><b>13.3.2</b> Dostop do računov preko MetaMask</a></li>
<li class="chapter" data-level="13.3.3" data-path="Truffle-Web3.html"><a href="Truffle-Web3.html#postavitev-pametne-pogodbe-na-verigo-blokov"><i class="fa fa-check"></i><b>13.3.3</b> Postavitev pametne pogodbe na verigo blokov</a></li>
<li class="chapter" data-level="13.3.4" data-path="Truffle-Web3.html"><a href="Truffle-Web3.html#povezovanje-metamask-z-dapp"><i class="fa fa-check"></i><b>13.3.4</b> Povezovanje MetaMask z DApp</a></li>
<li class="chapter" data-level="13.3.5" data-path="Truffle-Web3.html"><a href="Truffle-Web3.html#faza-registracije-volivcev"><i class="fa fa-check"></i><b>13.3.5</b> Faza registracije volivcev</a></li>
<li class="chapter" data-level="13.3.6" data-path="Truffle-Web3.html"><a href="Truffle-Web3.html#faza-začetka-sprejemanja-predlogov"><i class="fa fa-check"></i><b>13.3.6</b> Faza začetka sprejemanja predlogov</a></li>
<li class="chapter" data-level="13.3.7" data-path="Truffle-Web3.html"><a href="Truffle-Web3.html#faza-konca-sprejemanja-predlogov"><i class="fa fa-check"></i><b>13.3.7</b> Faza konca sprejemanja predlogov</a></li>
<li class="chapter" data-level="13.3.8" data-path="Truffle-Web3.html"><a href="Truffle-Web3.html#faza-začetka-glasovanja"><i class="fa fa-check"></i><b>13.3.8</b> Faza začetka glasovanja</a></li>
<li class="chapter" data-level="13.3.9" data-path="Truffle-Web3.html"><a href="Truffle-Web3.html#faza-konca-glasovanja"><i class="fa fa-check"></i><b>13.3.9</b> Faza konca glasovanja</a></li>
<li class="chapter" data-level="13.3.10" data-path="Truffle-Web3.html"><a href="Truffle-Web3.html#zaključna-faza-preštetih-glasov"><i class="fa fa-check"></i><b>13.3.10</b> Zaključna faza preštetih glasov</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="Truffle-Web3.html"><a href="Truffle-Web3.html#varna-postavitev"><i class="fa fa-check"></i><b>13.4</b> Postavitev pametne pogodbe na zaščiteno verigo blokov</a></li>
<li class="chapter" data-level="13.5" data-path="Truffle-Web3.html"><a href="Truffle-Web3.html#postavitev-pametne-pogodbe-s-pomočjo-metamask"><i class="fa fa-check"></i><b>13.5</b> Postavitev pametne pogodbe s pomočjo MetaMask</a></li>
</ul></li>
<li class="part"><span><b>VI sklop: Dodatne funkcionalnosti</b></span></li>
<li class="chapter" data-level="14" data-path="Varnost-testiranje-PWA.html"><a href="Varnost-testiranje-PWA.html"><i class="fa fa-check"></i><b>14</b> <span class="sklop6 oznaka">P6.1</span> Varnost spletnih aplikacij, testiranje in progresivne spletne aplikacije</a>
<ul>
<li class="chapter" data-level="14.1" data-path="Varnost-testiranje-PWA.html"><a href="Varnost-testiranje-PWA.html#odprtokodni-projekt-varnosti-spletnih-aplikacij-owasp"><i class="fa fa-check"></i><b>14.1</b> Odprtokodni projekt varnosti spletnih aplikacij OWASP</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="Varnost-testiranje-PWA.html"><a href="Varnost-testiranje-PWA.html#uvod-2"><i class="fa fa-check"></i><b>14.1.1</b> Uvod</a></li>
<li class="chapter" data-level="14.1.2" data-path="Varnost-testiranje-PWA.html"><a href="Varnost-testiranje-PWA.html#trend-največjih-varnostnih-tveganj-spletnih-aplikacij"><i class="fa fa-check"></i><b>14.1.2</b> Trend največjih varnostnih tveganj spletnih aplikacij</a></li>
<li class="chapter" data-level="14.1.3" data-path="Varnost-testiranje-PWA.html"><a href="Varnost-testiranje-PWA.html#ovrednotenje-varnostnih-tveganj-aplikacije"><i class="fa fa-check"></i><b>14.1.3</b> Ovrednotenje varnostnih tveganj aplikacije</a></li>
<li class="chapter" data-level="14.1.4" data-path="Varnost-testiranje-PWA.html"><a href="Varnost-testiranje-PWA.html#A1-2021"><i class="fa fa-check"></i><b>14.1.4</b> A1:2021 - Neustrezen nadzor dostopa</a></li>
<li class="chapter" data-level="14.1.5" data-path="Varnost-testiranje-PWA.html"><a href="Varnost-testiranje-PWA.html#A2-2021"><i class="fa fa-check"></i><b>14.1.5</b> A2:2021 - Kriptografske napake</a></li>
<li class="chapter" data-level="14.1.6" data-path="Varnost-testiranje-PWA.html"><a href="Varnost-testiranje-PWA.html#A3-2021"><i class="fa fa-check"></i><b>14.1.6</b> A3:2021 - Vrivanje zlonamerne kode</a></li>
<li class="chapter" data-level="14.1.7" data-path="Varnost-testiranje-PWA.html"><a href="Varnost-testiranje-PWA.html#A4-2021"><i class="fa fa-check"></i><b>14.1.7</b> A4:2021 - Nevaren načrt</a></li>
<li class="chapter" data-level="14.1.8" data-path="Varnost-testiranje-PWA.html"><a href="Varnost-testiranje-PWA.html#A5-2021"><i class="fa fa-check"></i><b>14.1.8</b> A5:2021 - Napačna varnostna konfiguracija</a></li>
<li class="chapter" data-level="14.1.9" data-path="Varnost-testiranje-PWA.html"><a href="Varnost-testiranje-PWA.html#A6-2021"><i class="fa fa-check"></i><b>14.1.9</b> A6:2021 - Ranljive in zastarele komponente</a></li>
<li class="chapter" data-level="14.1.10" data-path="Varnost-testiranje-PWA.html"><a href="Varnost-testiranje-PWA.html#A7-2021"><i class="fa fa-check"></i><b>14.1.10</b> A7:2021 - Napake pri identifikaciji in avtentikaciji</a></li>
<li class="chapter" data-level="14.1.11" data-path="Varnost-testiranje-PWA.html"><a href="Varnost-testiranje-PWA.html#A8-2021"><i class="fa fa-check"></i><b>14.1.11</b> A8:2021 - Napake v programski opremi in integriteti podatkov</a></li>
<li class="chapter" data-level="14.1.12" data-path="Varnost-testiranje-PWA.html"><a href="Varnost-testiranje-PWA.html#A9-2021"><i class="fa fa-check"></i><b>14.1.12</b> A9:2021 - Varnostno beleženje in spremljanje napak</a></li>
<li class="chapter" data-level="14.1.13" data-path="Varnost-testiranje-PWA.html"><a href="Varnost-testiranje-PWA.html#A10-2021"><i class="fa fa-check"></i><b>14.1.13</b> A10:2021 - Ponarejanje zahtev na strani strežnika (SSRF)</a></li>
<li class="chapter" data-level="14.1.14" data-path="Varnost-testiranje-PWA.html"><a href="Varnost-testiranje-PWA.html#priporočila-za-razvijalce"><i class="fa fa-check"></i><b>14.1.14</b> Priporočila za razvijalce</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="Varnost-testiranje-PWA.html"><a href="Varnost-testiranje-PWA.html#osnovni-varnostni-pregled-demo-aplikacije-z-owasp-zap"><i class="fa fa-check"></i><b>14.2</b> Osnovni varnostni pregled Demo aplikacije z OWASP ZAP</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="Varnost-testiranje-PWA.html"><a href="Varnost-testiranje-PWA.html#priprava-demo-aplikacije-v-lokalnem-okolju"><i class="fa fa-check"></i><b>14.2.1</b> Priprava Demo aplikacije v lokalnem okolju</a></li>
<li class="chapter" data-level="14.2.2" data-path="Varnost-testiranje-PWA.html"><a href="Varnost-testiranje-PWA.html#podpora-ssl"><i class="fa fa-check"></i><b>14.2.2</b> Podpora SSL</a></li>
<li class="chapter" data-level="14.2.3" data-path="Varnost-testiranje-PWA.html"><a href="Varnost-testiranje-PWA.html#zagon-aplikacije"><i class="fa fa-check"></i><b>14.2.3</b> Zagon aplikacije</a></li>
<li class="chapter" data-level="14.2.4" data-path="Varnost-testiranje-PWA.html"><a href="Varnost-testiranje-PWA.html#konfiguracija-orodja-owasp-zap"><i class="fa fa-check"></i><b>14.2.4</b> Konfiguracija orodja OWASP ZAP</a></li>
<li class="chapter" data-level="14.2.5" data-path="Varnost-testiranje-PWA.html"><a href="Varnost-testiranje-PWA.html#tezave-http-odgovori"><i class="fa fa-check"></i><b>14.2.5</b> Odprava težav s HTTP odgovori</a></li>
<li class="chapter" data-level="14.2.6" data-path="Varnost-testiranje-PWA.html"><a href="Varnost-testiranje-PWA.html#tezave-z-registracijo-in-prijavo"><i class="fa fa-check"></i><b>14.2.6</b> Odprava težav z registracijo in prijavo</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="Varnost-testiranje-PWA.html"><a href="Varnost-testiranje-PWA.html#osnovni-funkcionalni-testi-aplikacije-demo-s-selenium"><i class="fa fa-check"></i><b>14.3</b> Osnovni funkcionalni testi aplikacije Demo s Selenium</a></li>
<li class="chapter" data-level="14.4" data-path="Varnost-testiranje-PWA.html"><a href="Varnost-testiranje-PWA.html#Progresivne-spletne-aplikacije"><i class="fa fa-check"></i><b>14.4</b> Progresivne spletne aplikacije</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="Varnost-testiranje-PWA.html"><a href="Varnost-testiranje-PWA.html#uvod-3"><i class="fa fa-check"></i><b>14.4.1</b> Uvod</a></li>
<li class="chapter" data-level="14.4.2" data-path="Varnost-testiranje-PWA.html"><a href="Varnost-testiranje-PWA.html#Lighthouse"><i class="fa fa-check"></i><b>14.4.2</b> Pregled obstoječe aplikacije s pomočjo Lighthouse</a></li>
<li class="chapter" data-level="14.4.3" data-path="Varnost-testiranje-PWA.html"><a href="Varnost-testiranje-PWA.html#nadgradnja-angular"><i class="fa fa-check"></i><b>14.4.3</b> Nadgradnja Angular</a></li>
<li class="chapter" data-level="14.4.4" data-path="Varnost-testiranje-PWA.html"><a href="Varnost-testiranje-PWA.html#vključitev-podpore-za-pwa"><i class="fa fa-check"></i><b>14.4.4</b> Vključitev podpore za PWA</a></li>
<li class="chapter" data-level="14.4.5" data-path="Varnost-testiranje-PWA.html"><a href="Varnost-testiranje-PWA.html#Brskanje-brez-povezave"><i class="fa fa-check"></i><b>14.4.5</b> Brskanje brez povezave</a></li>
<li class="chapter" data-level="14.4.6" data-path="Varnost-testiranje-PWA.html"><a href="Varnost-testiranje-PWA.html#končno-testiranje"><i class="fa fa-check"></i><b>14.4.6</b> Končno testiranje</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="literatura.html"><a href="literatura.html"><i class="fa fa-check"></i>Literatura</a></li>
<li class="divider"></li>
<li><a href="https://ucilnica.fri.uni-lj.si/course/view.php?id=74">eUčilnica</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="index.html">Spletno programiranje 2023/2024</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="PB-REST-API" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">Poglavje 6</span> <span class="sklop3 oznaka">P3.1</span> Podatkovna baza in REST API<a href="PB-REST-API.html#PB-REST-API" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div class="vrstica">
<img src="assets/img/ninja/ninja_03_go_right.png">
<h3>
<span class="sklop3 oznaka">P3.2</span>
</h3>
</div>
<p><a href="https://unilj-my.sharepoint.com/:wb:/g/personal/dejanl_fri1_uni-lj_si/ESVEcjYh8vFEo4O7IS2UtGoBeMu4y7_Mv-eOls8Bv6uVsg?e=ft5nvy"><i class="fa-solid fa-chalkboard-user"></i>Sodelovalna <strong>tabla</strong></a>, ki jo bomo uporabljali pred in med predavanji ter je namenjena odložišču za vprašanja in komentarje.</p>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js"></script>
<script>
  var options_dodaj = {acrossElements: true, element: "dodaj"};
  var options_izbrisi = {acrossElements: true, element: "izbrisi"};
</script>
<div id="priprava-podatkovnega-modela-za-mongodb-z-mongoose" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Priprava podatkovnega modela za MongoDB z Mongoose<a href="PB-REST-API.html#priprava-podatkovnega-modela-za-mongodb-z-mongoose" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Kot prikazuje slika <a href="PB-REST-API.html#fig:slika-MVC">6.1</a>, se podatki pri <a href="https://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller"><i class="fa-brands fa-wikipedia-w"></i><strong>MVC</strong> načrtovalskem vzorcu</a> nahajajo v <strong>modelu</strong>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:slika-MVC"></span>
<img src="assets/img/MVC.png" alt="Podatki se pri MVC načrtovalskem vzorcu nahajajo v modelu" width="400" />
<p class="caption">
Slika 6.1: Podatki se pri MVC načrtovalskem vzorcu nahajajo v modelu
</p>
</div>
<p>V končni fazi bo krmilnik posredoval podatke pogledu, vendar podatki ne bodo shranjeni tam, ampak v modelu, podatkovni bazi. V našem primeru bomo uporabljali <a href="https://www.mongodb.com/"><i class="fa-solid fa-database"></i>podatkovno bazo <strong>MongoDB</strong></a>, za katero je najprej treba pripraviti podatkovni model.</p>
<p>Pri vključitvi podatkovne baze v našo aplikacijo bomo sledili naslednjim korakom:</p>
<ol style="list-style-type: decimal">
<li>povezava aplikacije s podatkovno bazo,</li>
<li>opredelitev sheme in modelov,</li>
<li>dodajanje testnih podatkov v podatkovno bazo in</li>
<li>prenos rešitve v produkcijsko okolje.</li>
</ol>
<p>V tem trenutku podatkovne baze še sploh nismo kreirali in nam je tudi ni treba. Če bi uporabljali kakšen drug sklad tehnologij, bi lahko zaradi tega prišlo do napake, pri uporabi MongoDB pa nam ni treba kreirati podatkovne baze pred povezavo nanjo, saj se ob prvi uporabi samodejno kreira.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:slika-MongoDB-povezovanje"></span>
<img src="assets/img/MongoDB_povezovanje.png" alt="MongoDB podatkovna baza in uporaba Mongoose z Express za modeliranje podatkov in obvladovanje povezave na podatkovno bazo" width="430" />
<p class="caption">
Slika 6.2: MongoDB podatkovna baza in uporaba Mongoose z Express za modeliranje podatkov in obvladovanje povezave na podatkovno bazo
</p>
</div>
<p>Kot prikazuje slika <a href="PB-REST-API.html#fig:slika-MongoDB-povezovanje">6.2</a> bomo v okviru tega poglavja uporabili <a href="https://mongoosejs.com/"><i class="fa-brands fa-node-js"></i><strong>Mongoose</strong></a> skupaj z <a href="https://expressjs.com/"><i class="fa-brands fa-node-js"></i>Express</a> in Node.js za modeliranje podatkov in dostop do podatkovne baze. V naslednjem koraku bomo kreirali podatkovno bazo in dodali testne podatke.</p>
<div id="Povezovanje-Express-aplikacije-in-MongoDB-z-Mongoose" class="section level3 hasAnchor" number="6.1.1">
<h3><span class="header-section-number">6.1.1</span> Povezovanje Express aplikacije in MongoDB z Mongoose<a href="PB-REST-API.html#Povezovanje-Express-aplikacije-in-MongoDB-z-Mongoose" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Express aplikacijo bi lahko z MongoDB podatkovno bazo povezali kar neposredno s pomočjo privzetega gonilnika, ki sicer deluje zadovoljivo, vendar je delo z njim kar zapleteno, zato bomo pri povezovanju Express aplikacije s podatkovno bazo MongoDB uporabljali gonilnik <a href="https://mongoosejs.com/"><i class="fa-brands fa-node-js"></i>Mongoose</a>, kot to prikazuje slika <a href="PB-REST-API.html#fig:slika-MongoDB-Mongoose">6.3</a>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:slika-MongoDB-Mongoose"></span>
<img src="assets/img/MongoDB_Mongoose.png" alt="Uporaba Mongoose pri povezovanju Express aplikacije in MongoDB podatkovne baze" width="430" />
<p class="caption">
Slika 6.3: Uporaba Mongoose pri povezovanju Express aplikacije in MongoDB podatkovne baze
</p>
</div>
<p>V razvojnem okolju je treba najprej namestiti podatkovno bazo <a href="https://www.mongodb.com/"><i class="fa-solid fa-database"></i>MongoDB</a>. Le-to si lahko namestite neposredno na računalnik, kjer je na uradni spletni strani na voljo dokumentacija za namestitev v vseh najbolj pogosto uporabljanih platformah, kot so <a href="https://docs.mongodb.com/manual/administration/install-on-linux/"><i class="fa-solid fa-earth-europe"></i>Linux</a>, <a href="https://docs.mongodb.com/manual/tutorial/install-mongodb-on-os-x/"><i class="fa-solid fa-earth-europe"></i>macOS</a> in <a href="https://docs.mongodb.com/manual/tutorial/install-mongodb-on-windows/"><i class="fa-solid fa-earth-europe"></i>Windows</a>. V nadaljevanju pa bomo predstavili namestitev v okolju <a href="https://www.docker.com/"><i class="fa-brands fa-docker"></i><strong>Docker</strong></a> (glej poglavje <a href="PB-REST-API.html#Namestitev-MongoDB-NavodilaDocker">6.1.1.1</a>), ki jo bomo tudi uporabljali na predavanjih.</p>
<blockquote>
<p><strong>Opomba</strong>: Pri platformi <em>Windows</em> je treba namestiti tudi <a href="https://www.mongodb.com/try/download/database-tools"><i class="fa-solid fa-earth-europe"></i>MongoDB Database Tools</a>, če želimo uporabljati dodatne ukaze v ukazni vrstici (npr. <code>mongoimport</code>, <code>mongodump</code> itd.). Orodja kopiramo v mapo <code>bin</code> kjer imamo nameščen MongoDB. Priporočljivo je, da pot kjer imamo nameščeno MongoDB podatkovno bazo (npr. <code>C:\Program Files\MongoDB\Server\5.0\bin</code>) dodamo v sistemsko spremenljivko <code>PATH</code> in posledično dostopamo do MongoDB ukazov povsod preko ukazne vrstice.</p>
</blockquote>
<div id="Namestitev-MongoDB-NavodilaDocker" class="section level4 hasAnchor" number="6.1.1.1">
<h4><span class="header-section-number">6.1.1.1</span> Namestitev MongoDB podatkovne baze v Docker okolju<a href="PB-REST-API.html#Namestitev-MongoDB-NavodilaDocker" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Najprej v datoteki <code>docker-compose.yml</code> poskrbimo za opredelitev nove storitve <code>mongo-db</code>, ki bo kreirala nov vsebnik <code>sp-mongo-db</code> na podlagi obstoječe slike <a href="https://hub.docker.com/_/mongo"><i class="fa-brands fa-docker"></i><code>mongo</code></a>.</p>
<p><code>docker-compose.yml</code></p>
<div class="sourceCode" id="cb396"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb396-1"><a href="PB-REST-API.html#cb396-1" tabindex="-1"></a><span class="fu">version</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;3.5&quot;</span></span>
<span id="cb396-2"><a href="PB-REST-API.html#cb396-2" tabindex="-1"></a><span class="fu">services</span><span class="kw">:</span></span>
<span id="cb396-3"><a href="PB-REST-API.html#cb396-3" tabindex="-1"></a><span class="at">  </span><span class="fu">node-api</span><span class="kw">:</span></span>
<span id="cb396-4"><a href="PB-REST-API.html#cb396-4" tabindex="-1"></a><span class="at">    </span><span class="fu">container_name</span><span class="kw">:</span><span class="at"> sp-app</span></span>
<span id="cb396-5"><a href="PB-REST-API.html#cb396-5" tabindex="-1"></a><span class="at">    </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb396-6"><a href="PB-REST-API.html#cb396-6" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="st">&quot;3000:3000&quot;</span></span>
<span id="cb396-7"><a href="PB-REST-API.html#cb396-7" tabindex="-1"></a><span class="at">    </span><span class="fu">image</span><span class="kw">:</span><span class="at"> sp-server</span></span>
<span id="cb396-8"><a href="PB-REST-API.html#cb396-8" tabindex="-1"></a><span class="at">    </span><span class="fu">build</span><span class="kw">:</span><span class="at"> ./</span></span>
<span id="cb396-9"><a href="PB-REST-API.html#cb396-9" tabindex="-1"></a><span class="at">    </span><span class="fu">networks</span><span class="kw">:</span></span>
<span id="cb396-10"><a href="PB-REST-API.html#cb396-10" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> sp-network</span></span>
<span id="cb396-11"><a href="PB-REST-API.html#cb396-11" tabindex="-1"></a><span class="at">  </span><span class="fu">mongo-db</span><span class="kw">:</span></span>
<span id="cb396-12"><a href="PB-REST-API.html#cb396-12" tabindex="-1"></a><span class="at">    </span><span class="fu">image</span><span class="kw">:</span><span class="at"> mongo</span></span>
<span id="cb396-13"><a href="PB-REST-API.html#cb396-13" tabindex="-1"></a><span class="at">    </span><span class="fu">container_name</span><span class="kw">:</span><span class="at"> sp-mongo-db</span></span>
<span id="cb396-14"><a href="PB-REST-API.html#cb396-14" tabindex="-1"></a><span class="at">    </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb396-15"><a href="PB-REST-API.html#cb396-15" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="st">&quot;27017-27019:27017-27019&quot;</span></span>
<span id="cb396-16"><a href="PB-REST-API.html#cb396-16" tabindex="-1"></a><span class="at">    </span><span class="fu">networks</span><span class="kw">:</span></span>
<span id="cb396-17"><a href="PB-REST-API.html#cb396-17" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> sp-network</span></span>
<span id="cb396-18"><a href="PB-REST-API.html#cb396-18" tabindex="-1"></a><span class="fu">networks</span><span class="kw">:</span></span>
<span id="cb396-19"><a href="PB-REST-API.html#cb396-19" tabindex="-1"></a><span class="at">  </span><span class="fu">sp-network</span><span class="kw">:</span></span>
<span id="cb396-20"><a href="PB-REST-API.html#cb396-20" tabindex="-1"></a><span class="at">    </span><span class="fu">name</span><span class="kw">:</span><span class="at"> sp-network</span></span>
<span id="cb396-21"><a href="PB-REST-API.html#cb396-21" tabindex="-1"></a><span class="at">    </span><span class="fu">driver</span><span class="kw">:</span><span class="at"> bridge</span></span></code></pre></div>
<p>Sedaj z naslednjim ukazom poskrbimo, da se za novo storitev podatkovne baze MongoDB kreira ustrezen vsebnik, medtem ko vsebnika zaenkrat še ne poženemo.</p>
<div class="sourceCode" id="cb397"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb397-1"><a href="PB-REST-API.html#cb397-1" tabindex="-1"></a><span class="ex">$</span> docker-compose up mongo-db <span class="at">--no-start</span></span>
<span id="cb397-2"><a href="PB-REST-API.html#cb397-2" tabindex="-1"></a></span>
<span id="cb397-3"><a href="PB-REST-API.html#cb397-3" tabindex="-1"></a> <span class="ex">⠿</span> Container sp-mongo-db  Created</span></code></pre></div>
<blockquote>
<p><strong>Namig</strong>: Če bi želeli odstraniti vse vsebnike (tj. Node.js strežnik in MongoDB podatkovno bazo), lahko uporabimo ukaz <code>docker-compose down</code>. Koristna sta tudi ukaza <code>docker-compose start</code>, ki vsebnike požene in <code>docker-compose stop</code>, ki aktivne vsebnike ustavi. Pri spremembah izvorne kode aplikacije moramo ponovno zahtevati izgradnjo slike za vsebnik, zato je takrat smiselna uporaba ukaza <code>docker-compose up --no-start --build</code>.</p>
</blockquote>
<p>MongoDB vsebnik <code>sp-mongo-db</code>, kjer je nameščena zadnja verzija MongoDB podatkovne baze, je kreiran in ga lahko z naslednjim ukazom poženemo.</p>
<div class="sourceCode" id="cb398"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb398-1"><a href="PB-REST-API.html#cb398-1" tabindex="-1"></a><span class="ex">$</span> docker start sp-mongo-db</span>
<span id="cb398-2"><a href="PB-REST-API.html#cb398-2" tabindex="-1"></a></span>
<span id="cb398-3"><a href="PB-REST-API.html#cb398-3" tabindex="-1"></a><span class="ex">sp-mongo-db</span></span></code></pre></div>
<blockquote>
<p><strong>Namig</strong>: Ker se vsebnik požene v načinu izvajanja v ozadju (v konzolo se ne izpisuje trenutni status), lahko npr. v novem zavihku konzole z ukazom <code>docker-compose logs -f</code> zahtevamo prikaz trenutnih dnevniških zapisov, ki se sproti osvežujejo. To bo predvsem koristno za odkrivanje morebitnih napak pri nadaljnjem razvoju aplikacije.</p>
</blockquote>
<p>Delovanje dostopa do MongoDB podatkovne baze lahko preizkusimo z zagonom odjemalca <a href="https://www.mongodb.com/docs/mongodb-shell/"><i class="fa-solid fa-database"></i><code>mongosh</code></a>, ki je tudi nameščen v vsebniku <code>sp-mongo-db</code> s podatkovno bazo.</p>
<div class="sourceCode" id="cb399"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb399-1"><a href="PB-REST-API.html#cb399-1" tabindex="-1"></a><span class="ex">$</span> docker exec <span class="at">-it</span> sp-mongo-db mongosh</span>
<span id="cb399-2"><a href="PB-REST-API.html#cb399-2" tabindex="-1"></a></span>
<span id="cb399-3"><a href="PB-REST-API.html#cb399-3" tabindex="-1"></a><span class="ex">Current</span> Mongosh Log ID: 634d05478fe01769890aae01</span>
<span id="cb399-4"><a href="PB-REST-API.html#cb399-4" tabindex="-1"></a><span class="ex">Connecting</span> to:          mongodb://127.0.0.1:27017/<span class="pp">?</span>directConnection=true<span class="kw">&amp;</span><span class="va">serverSelectionTimeoutMS</span><span class="op">=</span>2000<span class="kw">&amp;</span><span class="va">appName</span><span class="op">=</span>mongosh+1.6.0</span>
<span id="cb399-5"><a href="PB-REST-API.html#cb399-5" tabindex="-1"></a><span class="ex">Using</span> MongoDB:          6.0.2</span>
<span id="cb399-6"><a href="PB-REST-API.html#cb399-6" tabindex="-1"></a><span class="ex">Using</span> Mongosh:          1.6.0</span>
<span id="cb399-7"><a href="PB-REST-API.html#cb399-7" tabindex="-1"></a></span>
<span id="cb399-8"><a href="PB-REST-API.html#cb399-8" tabindex="-1"></a><span class="bu">test</span><span class="op">&gt;</span> </span></code></pre></div>
<blockquote>
<p><strong>Namig</strong>: Morebitna opozorila (npr. onemogočena kontrola dostopa, poročanje, uporaba XFS datotečnega sistema, manjkajoče začetne skripte idr.), ki se izpišejo, lahko za potrebe lokalnega razvoja zaenkrat ignoriramo.</p>
</blockquote>
<script>
  $(document).ready(function() {
    $("#Namestitev-MongoDB-NavodilaDocker code.yaml:eq(0)").markRegExp(/\s+?mongo-db[\s\S]+?sp-network/, options_dodaj);
    $("#Namestitev-MongoDB-NavodilaDocker code.bash:eq(0)").markRegExp(/docker-compose up.+/, options_dodaj);
    $("#Namestitev-MongoDB-NavodilaDocker code.bash:eq(1)").markRegExp(/docker start.+/, options_dodaj);
    $("#Namestitev-MongoDB-NavodilaDocker code.bash:eq(2)").markRegExp(/docker exec.+/, options_dodaj);
  });
</script>
</div>
<div id="vključitev-gonilnika-mongoose-v-aplikacijo" class="section level4 hasAnchor" number="6.1.1.2">
<h4><span class="header-section-number">6.1.1.2</span> Vključitev gonilnika Mongoose v aplikacijo<a href="PB-REST-API.html#vključitev-gonilnika-mongoose-v-aplikacijo" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>S spodnjim ukazom zahtevamo namestitev Mongoose gonilnika ter vključitev reference na knjižnico v datoteko <code>package.json</code>.</p>
<div class="sourceCode" id="cb400"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb400-1"><a href="PB-REST-API.html#cb400-1" tabindex="-1"></a><span class="ex">$</span> npm install <span class="at">--save</span> mongoose</span></code></pre></div>
<p>Opazimo lahko, da se sprememba doda tudi v datoteko <code>package.json</code>.</p>
<p><code>package.json</code></p>
<div class="sourceCode" id="cb401"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb401-1"><a href="PB-REST-API.html#cb401-1" tabindex="-1"></a>{</span>
<span id="cb401-2"><a href="PB-REST-API.html#cb401-2" tabindex="-1"></a>  <span class="st">&quot;name&quot;</span><span class="op">:</span> <span class="st">&quot;demo&quot;</span><span class="op">,</span></span>
<span id="cb401-3"><a href="PB-REST-API.html#cb401-3" tabindex="-1"></a>  <span class="st">&quot;version&quot;</span><span class="op">:</span> <span class="st">&quot;0.1.0&quot;</span><span class="op">,</span></span>
<span id="cb401-4"><a href="PB-REST-API.html#cb401-4" tabindex="-1"></a>  <span class="st">&quot;description&quot;</span><span class="op">:</span> <span class="st">&quot;Demo application for Web Programming course&quot;</span><span class="op">,</span></span>
<span id="cb401-5"><a href="PB-REST-API.html#cb401-5" tabindex="-1"></a>  <span class="st">&quot;main&quot;</span><span class="op">:</span> <span class="st">&quot;server.js&quot;</span><span class="op">,</span></span>
<span id="cb401-6"><a href="PB-REST-API.html#cb401-6" tabindex="-1"></a>  <span class="st">&quot;scripts&quot;</span><span class="op">:</span> {</span>
<span id="cb401-7"><a href="PB-REST-API.html#cb401-7" tabindex="-1"></a>    <span class="st">&quot;start&quot;</span><span class="op">:</span> <span class="st">&quot;node server.js&quot;</span></span>
<span id="cb401-8"><a href="PB-REST-API.html#cb401-8" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb401-9"><a href="PB-REST-API.html#cb401-9" tabindex="-1"></a>  <span class="st">&quot;author&quot;</span><span class="op">:</span> <span class="st">&quot;Dejan Lavbič &lt;dejan@lavbic.net&gt;&quot;</span><span class="op">,</span></span>
<span id="cb401-10"><a href="PB-REST-API.html#cb401-10" tabindex="-1"></a>  <span class="st">&quot;license&quot;</span><span class="op">:</span> <span class="st">&quot;ISC&quot;</span><span class="op">,</span></span>
<span id="cb401-11"><a href="PB-REST-API.html#cb401-11" tabindex="-1"></a>  <span class="st">&quot;private&quot;</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb401-12"><a href="PB-REST-API.html#cb401-12" tabindex="-1"></a>  <span class="st">&quot;dependencies&quot;</span><span class="op">:</span> {</span>
<span id="cb401-13"><a href="PB-REST-API.html#cb401-13" tabindex="-1"></a>    <span class="st">&quot;express&quot;</span><span class="op">:</span> <span class="st">&quot;~4.18.2&quot;</span><span class="op">,</span></span>
<span id="cb401-14"><a href="PB-REST-API.html#cb401-14" tabindex="-1"></a>    <span class="st">&quot;hbs&quot;</span><span class="op">:</span> <span class="st">&quot;~4.2.0&quot;</span><span class="op">,</span></span>
<span id="cb401-15"><a href="PB-REST-API.html#cb401-15" tabindex="-1"></a>    <span class="st">&quot;mongoose&quot;</span><span class="op">:</span> <span class="st">&quot;^7.5.0&quot;</span></span>
<span id="cb401-16"><a href="PB-REST-API.html#cb401-16" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb401-17"><a href="PB-REST-API.html#cb401-17" tabindex="-1"></a>  <span class="st">&quot;devDependencies&quot;</span><span class="op">:</span> {</span>
<span id="cb401-18"><a href="PB-REST-API.html#cb401-18" tabindex="-1"></a>    <span class="st">&quot;nodemon&quot;</span><span class="op">:</span> <span class="st">&quot;^3.0.1&quot;</span></span>
<span id="cb401-19"><a href="PB-REST-API.html#cb401-19" tabindex="-1"></a>  }</span>
<span id="cb401-20"><a href="PB-REST-API.html#cb401-20" tabindex="-1"></a>}</span></code></pre></div>
<script>
  $(document).ready(function() {
    $("#vključitev-gonilnika-mongoose-v-aplikacijo pre.sourceCode:eq(0)").markRegExp(/npm.+/, options_dodaj);
    $("#vključitev-gonilnika-mongoose-v-aplikacijo code.javascript").markRegExp(/\s+?"mongoose".+/, options_dodaj);    
  });
</script>
</div>
<div id="dodajanje-mongoose-povezave-v-našo-aplikacijo" class="section level4 hasAnchor" number="6.1.1.3">
<h4><span class="header-section-number">6.1.1.3</span> Dodajanje Mongoose povezave v našo aplikacijo<a href="PB-REST-API.html#dodajanje-mongoose-povezave-v-našo-aplikacijo" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Mongoose deluje tako, da ob zagonu vzpostavi množico več ponovno uporabnih povezav (privzeto <span class="math inline">\(5\)</span>), ki jih deli med vsemi zahtevami. To je dobra praksa pri uporabi podatkovne baze, saj lahko operacija povezovanja traja dlje časa.</p>
<p>Omenjena funkcionalnost predstavlja začetke implementacije REST API vmesnikov, zato kreiramo novo mapo <code>api</code> in podmapo <code>models</code>, kot je prikazano spodaj.</p>
<ul style="list-style-type: none;">
<li>
<dodaj><i class="fa-regular fa-folder-open"></i> <b>api</b></dodaj>
<ul style="list-style-type: none;">
<li>
<dodaj><i class="fa-regular fa-folder-open"></i> <b>models</b></dodaj>
<ul style="list-style-type: none;">
<li>
<dodaj><i class="fa-brands fa-js"></i> db.js</dodaj> ← logika za povezovanje na MongoDB podatkovno bazo
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Funkcionalnost povezovanja na podatkovno bazo bomo implementirali v modelu <code>db.js</code>, kjer najprej poskrbimo za odvisnost od knjižnice <a href="https://mongoosejs.com/"><i class="fa-brands fa-node-js"></i>Mongoose</a>.</p>
<p><code>api/models/db.js</code></p>
<div class="sourceCode" id="cb402"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb402-1"><a href="PB-REST-API.html#cb402-1" tabindex="-1"></a><span class="kw">const</span> mongoose <span class="op">=</span> <span class="pp">require</span>(<span class="st">&quot;mongoose&quot;</span>)<span class="op">;</span></span></code></pre></div>
<p>Povezava na podatkovno bazo se izvede ob zagonu aplikacije, zato dodamo odvisnost v datoteko <code>server.js</code>.</p>
<p><code>server.js</code></p>
<div class="sourceCode" id="cb403"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb403-1"><a href="PB-REST-API.html#cb403-1" tabindex="-1"></a><span class="kw">const</span> express <span class="op">=</span> <span class="pp">require</span>(<span class="st">&quot;express&quot;</span>)<span class="op">;</span></span>
<span id="cb403-2"><a href="PB-REST-API.html#cb403-2" tabindex="-1"></a><span class="kw">const</span> path <span class="op">=</span> <span class="pp">require</span>(<span class="st">&quot;path&quot;</span>)<span class="op">;</span></span>
<span id="cb403-3"><a href="PB-REST-API.html#cb403-3" tabindex="-1"></a><span class="co">/**</span></span>
<span id="cb403-4"><a href="PB-REST-API.html#cb403-4" tabindex="-1"></a><span class="co"> * Database connection</span></span>
<span id="cb403-5"><a href="PB-REST-API.html#cb403-5" tabindex="-1"></a><span class="co"> */</span></span>
<span id="cb403-6"><a href="PB-REST-API.html#cb403-6" tabindex="-1"></a><span class="pp">require</span>(<span class="st">&quot;./api/models/db.js&quot;</span>)<span class="op">;</span></span>
<span id="cb403-7"><a href="PB-REST-API.html#cb403-7" tabindex="-1"></a></span>
<span id="cb403-8"><a href="PB-REST-API.html#cb403-8" tabindex="-1"></a><span class="kw">const</span> hbsRouter <span class="op">=</span> <span class="pp">require</span>(<span class="st">&quot;./hbs/routes/hbs&quot;</span>)<span class="op">;</span></span></code></pre></div>
<p>Na podatkovno bazo, ki se nahaja na istem računalniku (kar velja za naše razvojno okolje z Dockerjem), se povežemo zelo enostavno tako, da dodamo naslednji vrstici v datoteko <code>db.js</code>.</p>
<p><code>api/models/db.js</code></p>
<div class="sourceCode" id="cb404"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb404-1"><a href="PB-REST-API.html#cb404-1" tabindex="-1"></a><span class="kw">const</span> mongoose <span class="op">=</span> <span class="pp">require</span>(<span class="st">&quot;mongoose&quot;</span>)<span class="op">;</span></span>
<span id="cb404-2"><a href="PB-REST-API.html#cb404-2" tabindex="-1"></a></span>
<span id="cb404-3"><a href="PB-REST-API.html#cb404-3" tabindex="-1"></a><span class="kw">const</span> dbURI <span class="op">=</span> <span class="st">&quot;mongodb://127.0.0.1/Demo&quot;</span><span class="op">;</span></span>
<span id="cb404-4"><a href="PB-REST-API.html#cb404-4" tabindex="-1"></a>mongoose<span class="op">.</span><span class="fu">connect</span>(dbURI)<span class="op">;</span></span></code></pre></div>
<p>Pri povezovanju na MongoDB podatkovno bazo potrebujemo povezovalni niz<a href="PB-REST-API.html#fn124" class="footnote-ref" id="fnref124"><sup>124</sup></a>, ki je v naslednji obliki in smo ga že vključili v naš model, kjer lahko določene privzete podatke tudi izpustimo:</p>
<pre class="text"><code>mongodb://uporabnisko_ime:geslo@streznik:vrata/podatkovna_baza</code></pre>
<p>Za lažje obvladovanje in razhroščevanje povezovanja na podatkovno bazo bomo dodali spremljanje dogodkov pri povezovanju na podatkovno bazo, kar dodamo v <code>db.js</code>.</p>
<p><code>api/models/db.js</code></p>
<div class="sourceCode" id="cb406"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb406-1"><a href="PB-REST-API.html#cb406-1" tabindex="-1"></a><span class="kw">const</span> mongoose <span class="op">=</span> <span class="pp">require</span>(<span class="st">&quot;mongoose&quot;</span>)<span class="op">;</span></span>
<span id="cb406-2"><a href="PB-REST-API.html#cb406-2" tabindex="-1"></a></span>
<span id="cb406-3"><a href="PB-REST-API.html#cb406-3" tabindex="-1"></a><span class="kw">const</span> dbURI <span class="op">=</span> <span class="st">&quot;mongodb://127.0.0.1/Demo&quot;</span><span class="op">;</span></span>
<span id="cb406-4"><a href="PB-REST-API.html#cb406-4" tabindex="-1"></a>mongoose<span class="op">.</span><span class="fu">connect</span>(dbURI)<span class="op">;</span></span>
<span id="cb406-5"><a href="PB-REST-API.html#cb406-5" tabindex="-1"></a></span>
<span id="cb406-6"><a href="PB-REST-API.html#cb406-6" tabindex="-1"></a>mongoose<span class="op">.</span><span class="at">connection</span><span class="op">.</span><span class="fu">on</span>(<span class="st">&quot;connected&quot;</span><span class="op">,</span> () <span class="kw">=&gt;</span></span>
<span id="cb406-7"><a href="PB-REST-API.html#cb406-7" tabindex="-1"></a>  <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="vs">`Mongoose connected to </span><span class="sc">${</span>dbURI<span class="sc">}</span><span class="vs">.`</span>)</span>
<span id="cb406-8"><a href="PB-REST-API.html#cb406-8" tabindex="-1"></a>)<span class="op">;</span></span>
<span id="cb406-9"><a href="PB-REST-API.html#cb406-9" tabindex="-1"></a>mongoose<span class="op">.</span><span class="at">connection</span><span class="op">.</span><span class="fu">on</span>(<span class="st">&quot;error&quot;</span><span class="op">,</span> (err) <span class="kw">=&gt;</span></span>
<span id="cb406-10"><a href="PB-REST-API.html#cb406-10" tabindex="-1"></a>  <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="vs">`Mongoose connection error: </span><span class="sc">${</span>err<span class="sc">}</span><span class="vs">.`</span>)</span>
<span id="cb406-11"><a href="PB-REST-API.html#cb406-11" tabindex="-1"></a>)<span class="op">;</span></span>
<span id="cb406-12"><a href="PB-REST-API.html#cb406-12" tabindex="-1"></a>mongoose<span class="op">.</span><span class="at">connection</span><span class="op">.</span><span class="fu">on</span>(<span class="st">&quot;disconnected&quot;</span><span class="op">,</span> () <span class="kw">=&gt;</span></span>
<span id="cb406-13"><a href="PB-REST-API.html#cb406-13" tabindex="-1"></a>  <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="st">&quot;Mongoose disconnected&quot;</span>)</span>
<span id="cb406-14"><a href="PB-REST-API.html#cb406-14" tabindex="-1"></a>)<span class="op">;</span></span></code></pre></div>
<p>Ravno tako pomembno pa je tudi obvladovanje dogodkov pri zapiranju povezav na podatkovno bazo, kjer je treba biti pozoren na več dogodkov, t.j. <code>SIGUSR2</code>, <code>SIGINT</code> in <code>SIGTERM</code>, kar dodamo v <code>db.js</code></p>
<p><code>api/models/db.js</code></p>
<div class="sourceCode" id="cb407"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb407-1"><a href="PB-REST-API.html#cb407-1" tabindex="-1"></a><span class="kw">const</span> gracefulShutdown <span class="op">=</span> <span class="kw">async</span> (msg<span class="op">,</span> callback) <span class="kw">=&gt;</span> {</span>
<span id="cb407-2"><a href="PB-REST-API.html#cb407-2" tabindex="-1"></a>  <span class="cf">await</span> mongoose<span class="op">.</span><span class="at">connection</span><span class="op">.</span><span class="fu">close</span>()<span class="op">;</span></span>
<span id="cb407-3"><a href="PB-REST-API.html#cb407-3" tabindex="-1"></a>  <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="vs">`Mongoose disconnected through </span><span class="sc">${</span>msg<span class="sc">}</span><span class="vs">.`</span>)<span class="op">;</span></span>
<span id="cb407-4"><a href="PB-REST-API.html#cb407-4" tabindex="-1"></a>  <span class="fu">callback</span>()<span class="op">;</span></span>
<span id="cb407-5"><a href="PB-REST-API.html#cb407-5" tabindex="-1"></a>}<span class="op">;</span></span>
<span id="cb407-6"><a href="PB-REST-API.html#cb407-6" tabindex="-1"></a><span class="bu">process</span><span class="op">.</span><span class="fu">once</span>(<span class="st">&quot;SIGUSR2&quot;</span><span class="op">,</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb407-7"><a href="PB-REST-API.html#cb407-7" tabindex="-1"></a>  <span class="fu">gracefulShutdown</span>(<span class="st">&quot;nodemon restart&quot;</span><span class="op">,</span> () <span class="kw">=&gt;</span></span>
<span id="cb407-8"><a href="PB-REST-API.html#cb407-8" tabindex="-1"></a>    <span class="bu">process</span><span class="op">.</span><span class="fu">kill</span>(<span class="bu">process</span><span class="op">.</span><span class="at">pid</span><span class="op">,</span> <span class="st">&quot;SIGUSR2&quot;</span>)</span>
<span id="cb407-9"><a href="PB-REST-API.html#cb407-9" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb407-10"><a href="PB-REST-API.html#cb407-10" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb407-11"><a href="PB-REST-API.html#cb407-11" tabindex="-1"></a><span class="bu">process</span><span class="op">.</span><span class="fu">on</span>(<span class="st">&quot;SIGINT&quot;</span><span class="op">,</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb407-12"><a href="PB-REST-API.html#cb407-12" tabindex="-1"></a>  <span class="fu">gracefulShutdown</span>(<span class="st">&quot;app termination&quot;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="bu">process</span><span class="op">.</span><span class="fu">exit</span>(<span class="dv">0</span>))<span class="op">;</span></span>
<span id="cb407-13"><a href="PB-REST-API.html#cb407-13" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb407-14"><a href="PB-REST-API.html#cb407-14" tabindex="-1"></a><span class="bu">process</span><span class="op">.</span><span class="fu">on</span>(<span class="st">&quot;SIGTERM&quot;</span><span class="op">,</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb407-15"><a href="PB-REST-API.html#cb407-15" tabindex="-1"></a>  <span class="fu">gracefulShutdown</span>(<span class="st">&quot;Cloud-based app shutdown&quot;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="bu">process</span><span class="op">.</span><span class="fu">exit</span>(<span class="dv">0</span>))<span class="op">;</span></span>
<span id="cb407-16"><a href="PB-REST-API.html#cb407-16" tabindex="-1"></a>})<span class="op">;</span></span></code></pre></div>
<script>
  $(document).ready(function() {
    $("#dodajanje-mongoose-povezave-v-našo-aplikacijo code:eq(3)").markRegExp(/db\.js/, options_dodaj);
    $("#dodajanje-mongoose-povezave-v-našo-aplikacijo code.javascript:eq(0)").markRegExp(/.+/, options_dodaj);
    $("#dodajanje-mongoose-povezave-v-našo-aplikacijo code.javascript:eq(1)").markRegExp(/.+models\/db.+/, options_dodaj);
    $("#dodajanje-mongoose-povezave-v-našo-aplikacijo code.javascript:eq(2)").markRegExp(/const dbURI[\s\S]+?\);/, options_dodaj);
    $("#dodajanje-mongoose-povezave-v-našo-aplikacijo code.javascript:eq(3)").markRegExp(/mongoose\.connection[\s\S]+?\);/, options_dodaj);
    $("#dodajanje-mongoose-povezave-v-našo-aplikacijo code.javascript:eq(4)").markRegExp(/.+/, options_dodaj);
  });
</script>
</div>
</div>
<div id="zakaj-je-treba-modelirati-podatke" class="section level3 hasAnchor" number="6.1.2">
<h3><span class="header-section-number">6.1.2</span> Zakaj je treba modelirati podatke?<a href="PB-REST-API.html#zakaj-je-treba-modelirati-podatke" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Na predavanjih <span class="sklop1">P1.1</span> smo v okviru poglavja <a href="P11.html#MongoDB-uvod">1.3.3</a> že na kratko predstavili podatkovno bazo MongoDB, kjer smo omenili, da gre za <a href="https://en.wikipedia.org/wiki/Document-oriented_database"><i class="fa-solid fa-database"></i><strong>dokumentno usmerjeno</strong> podatkovno bazo</a> in ne tradicionalno <a href="https://en.wikipedia.org/wiki/Relational_database"><i class="fa-solid fa-database"></i><strong>relacijsko</strong> podatkovno bazo</a>. S tem pridobimo veliko svobodo pri delu s podatki, saj ne potrebujemo strogo opredeljene sheme. Kljub temu pa včasih to vseeno želimo ali celo potrebujemo. To velja tudi v primeru naše aplikacije, kjer bodo podatki na seznamu lokacij jasno strukturirani.</p>
<p>Vse podatke posamezne lokacije vedno potrebujemo in vsaka lokacija mora uporabljati konsistentno strukturo poimenovanja. Brez te zahteve bi v aplikaciji težko našli želene podatke in jih uporabili. Iz tega izhaja tudi motiv za postopen prenos podatkov najprej iz pogledov v krmilnike in nato v model (glej sliko <a href="PB-REST-API.html#fig:slika-Prenos-podatkov-iz-krmilnika-v-model">6.4</a>).</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:slika-Prenos-podatkov-iz-krmilnika-v-model"></span>
<img src="assets/img/Prenos_podatkov_iz_krmilnika_v_model.png" alt="Premik podatkov iz krmilnika v model pri MVC načrtovalskem vzorcu" width="450" />
<p class="caption">
Slika 6.4: Premik podatkov iz krmilnika v model pri MVC načrtovalskem vzorcu
</p>
</div>
<p>Pri tem procesu smo namreč postopoma razmišljali o podatkih in modeliranju podatkov, ki se dejansko ukvarja z opisovanjem strukture podatkov, ki jo želimo uporabljati v okviru aplikacije. Strukturo podatkov bi lahko opisali ročno, lahko pa si tudi pomagamo s knjižnico Mongoose.</p>
<div id="kako-bomo-uporabili-mongoose" class="section level4 hasAnchor" number="6.1.2.1">
<h4><span class="header-section-number">6.1.2.1</span> Kako bomo uporabili Mongoose?<a href="PB-REST-API.html#kako-bomo-uporabili-mongoose" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><a href="https://mongoosejs.com/"><i class="fa-brands fa-node-js"></i>Mongoose</a> je vmesna raven programske opreme in skrbi predvsem za preslikavo objektov v dokumente in obratno<a href="PB-REST-API.html#fn125" class="footnote-ref" id="fnref125"><sup>125</sup></a>. Ena izmed ključnih prednosti je, da lahko podatkovni model obvladujemo kar neposredno iz aplikacije. Pred opredelitvijo podatkovnega modela pa omenimo nekaj ključnih konceptov MongoDB podatkovne baze:</p>
<ul>
<li>v MongoDB se vsak zapis v podatkovni bazi imenuje <a href="https://www.mongodb.com/docs/manual/core/document/"><i class="fa-solid fa-earth-europe"></i><strong>dokument</strong></a><a href="PB-REST-API.html#fn126" class="footnote-ref" id="fnref126"><sup>126</sup></a>,</li>
<li>skupek dokumentov v MongoDB imenujemo <a href="https://www.mongodb.com/docs/compass/current/collections/"><i class="fa-solid fa-earth-europe"></i><strong>zbirka</strong></a><a href="PB-REST-API.html#fn127" class="footnote-ref" id="fnref127"><sup>127</sup></a> (v kontekstu relacijske podatkovne baze gre za analogen pojem tabele),</li>
<li>v Mongoose se definicija dokumenta imenuje <a href="https://www.mongodb.com/docs/atlas/app-services/schemas/"><i class="fa-solid fa-earth-europe"></i><strong>shema</strong></a><a href="PB-REST-API.html#fn128" class="footnote-ref" id="fnref128"><sup>128</sup></a>,</li>
<li>posamezna podatkovna entiteta je opredeljena v shemi s <strong>potjo</strong><a href="PB-REST-API.html#fn129" class="footnote-ref" id="fnref129"><sup>129</sup></a>.</li>
</ul>
<p>V zbirki dokumentov je lahko več dokumentov. Vsak dokument vsebuje podatke, kjer je njihova struktura opredeljena s shemo. Vsaka shema je sestavljena iz več poti in vsaka pot ima lahko opredeljenih več lastnosti.</p>
<p><a href="https://mongoosejs.com/docs/models.html"><i class="fa-solid fa-earth-europe"></i><strong>Model</strong></a> je preprosto prevedena različica sheme in vsa interakcija s podatki pri uporabi Mongoose poteka z uporabo modela.</p>
<p>Če si pogledamo primer, ki smo ga že predstavili v enem izmed prejšnjih predavanj v poglavju <a href="P11.html#MongoDB-uvod">1.3.3</a>, je potem tudi v nadaljevanju podan primer sheme.</p>
<p><code>MongoDB dokument</code></p>
<div class="sourceCode" id="cb408"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb408-1"><a href="PB-REST-API.html#cb408-1" tabindex="-1"></a>{</span>
<span id="cb408-2"><a href="PB-REST-API.html#cb408-2" tabindex="-1"></a>  <span class="st">&quot;predpona&quot;</span><span class="op">:</span> <span class="st">&quot;gospod&quot;</span><span class="op">,</span></span>
<span id="cb408-3"><a href="PB-REST-API.html#cb408-3" tabindex="-1"></a>  <span class="st">&quot;ime&quot;</span><span class="op">:</span> <span class="st">&quot;Janez&quot;</span><span class="op">,</span></span>
<span id="cb408-4"><a href="PB-REST-API.html#cb408-4" tabindex="-1"></a>  <span class="st">&quot;priimek&quot;</span><span class="op">:</span> <span class="st">&quot;Kranjski&quot;</span><span class="op">,</span></span>
<span id="cb408-5"><a href="PB-REST-API.html#cb408-5" tabindex="-1"></a>  <span class="st">&quot;vzdevek&quot;</span><span class="op">:</span> <span class="st">&quot;stari&quot;</span><span class="op">,</span></span>
<span id="cb408-6"><a href="PB-REST-API.html#cb408-6" tabindex="-1"></a>  <span class="dt">_id</span><span class="op">:</span> <span class="fu">ObjectId</span>(<span class="st">&quot;52279effc62ca8b0c1000007&quot;</span>)</span>
<span id="cb408-7"><a href="PB-REST-API.html#cb408-7" tabindex="-1"></a>}</span></code></pre></div>
<p><code>MongoDB shema</code></p>
<div class="sourceCode" id="cb409"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb409-1"><a href="PB-REST-API.html#cb409-1" tabindex="-1"></a>{</span>
<span id="cb409-2"><a href="PB-REST-API.html#cb409-2" tabindex="-1"></a>  <span class="dt">predpona</span><span class="op">:</span> <span class="bu">String</span><span class="op">,</span></span>
<span id="cb409-3"><a href="PB-REST-API.html#cb409-3" tabindex="-1"></a>  <span class="dt">ime</span><span class="op">:</span> <span class="bu">String</span><span class="op">,</span></span>
<span id="cb409-4"><a href="PB-REST-API.html#cb409-4" tabindex="-1"></a>  <span class="dt">priimek</span><span class="op">:</span> <span class="bu">String</span><span class="op">,</span></span>
<span id="cb409-5"><a href="PB-REST-API.html#cb409-5" tabindex="-1"></a>  <span class="dt">vzdevek</span><span class="op">:</span> <span class="bu">String</span></span>
<span id="cb409-6"><a href="PB-REST-API.html#cb409-6" tabindex="-1"></a>}</span></code></pre></div>
<p>Pri MongoDB dokumentu lahko opazimo tudi lastnost <a href="https://www.mongodb.com/docs/manual/reference/method/ObjectId/"><i class="fa-solid fa-tag"></i><code>_id</code></a>, ki je nismo opredelili v shemi. Gre za enolični identifikator (npr. analogno primarnemu ključu v relacijski shemi) vsakega dokumenta, ki ga MongoDB samodejno ustvari, ko je dokument kreiran.</p>
<p>Pri opredelitvi sheme operiramo z enostavno strukturo <code>'ime poti': 'objekt lastnosti'</code>, kot je to prikazano v predhodnem primeru. Tip poti v shemi, ki ga moramo pri opredelitvi sheme vedno vključiti, je lahko v naslednjih vnaprej opredeljenih vrednostih:</p>
<ul>
<li><strong><code>String</code></strong> predstavlja poljuben niz, zapisan v <code>UTF-8</code>,</li>
<li><strong><code>Number</code></strong> je enostavna predstavitev vseh števil, kjer <code>long</code> in <code>double</code> podatkovna tipa privzeto nista podprta, sta pa na voljo preko <a href="https://plugins.mongoosejs.io/"><i class="fa-solid fa-earth-europe"></i>vtičnikov</a>,</li>
<li><strong><code>Date</code></strong><a href="PB-REST-API.html#fn130" class="footnote-ref" id="fnref130"><sup>130</sup></a> predstavlja datum in je po navadi v <code>ISODate</code> formatu,</li>
<li><strong><code>Boolean</code></strong> predstavlja resnično ali neresnično trditev,</li>
<li><strong><code>Buffer</code></strong> se uporablja za binarne podatke, kot so npr. slike,</li>
<li><strong><code>Mixed</code></strong> predstavlja poljuben podatkovni tip,</li>
<li><strong><code>Array</code></strong> predstavlja polje istih podatkovnih tipov ali polje ugnezdenih dokumentov,</li>
<li><strong><code>ObjectId</code></strong> za opredelitev enoličnega identifikatorja, ki je različen od <code>_id</code> in se po navadi uporablja za referenciranje ostalih dokumentov.</li>
</ul>
</div>
</div>
<div id="podatki-iz-registra" class="section level3 hasAnchor" number="6.1.3">
<h3><span class="header-section-number">6.1.3</span> Podatki iz registra kulturne dediščine<a href="PB-REST-API.html#podatki-iz-registra" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Pri implementaciji naše aplikacije bomo za seznam zanimiv lokacij, ki jih bomo prikazovali, uporabili podatke iz <a href="https://www.gov.si/teme/register-kulturne-dediscine/"><span class="skupaj"><i class="fa-solid fa-earth-europe"></i>registra <strong>kulturne dediščine</strong></span></a>.</p>
<p>Izvorno CSV datoteko <i class="fa-regular fa-file-lines"></i><code>kulturne_dediscine.json</code>, ki vsebuje omenjene podatke, bomo shranili v mapo <i class="fa-regular fa-folder-open"></i><code>data</code>. V nadaljevanju je prikazan izsek iz datoteke, kjer nas v tej fazi zanimajo predvsem atributi podatkov.</p>
<p><code>data/kulturne-dediscine.csv</code></p>
<pre class="csv"><code>ESD,Ime,Sinonimi,Zvrst,Tip,Gesla,Opis,Datacija,Avtorji,LokacijaOp,Podrocja,Zavod,Varstvo,Obcina,Y,X,WGS X,WGS Y
29884,Šentrupert na Dolenjskem - Muzej na prostem,,stavbe,profana stavbna dediščina,&quot;muzej na prostem, kozolec na psa, kozolec s plaščem, enojni kozolec, nizki kozolec, toplar, vzporedni kozolec&quot;,Muzej na prostem sestavljajo skupina 17 kozolcev različnih tipov in dve enostavni sušilni napravi (belokranjska ostrv in ribniški kozouček). Postavitev iz 2012 prikazuje genezo kozolca na Slovenskem in raznolikost kozolcev v Mirnski dolini.,&quot;zadnja četrtina 18. stol., 19. stol., prva polovica 20. stol., prva četrtina 21. stol., 2012&quot;,,Muzej na prostem je urejen na južnem obrobju Šentruperta na Dolenjskem.,&quot;etnologija, krajinska arhitektura, tehniška zgodovina&quot;,ZVKD Novo mesto,spomenik lokalnega pomena,ŠENTRUPERT,507458,92302,45.9748324693,15.0914351743
...</code></pre>
<p>Omenjeno mapo <code>data</code> tudi vključimo v datoteko <code>.dockerignore</code> ter tako zahtevamo, da se pri strežbi aplikacije v okolju <i class="fa-brands fa-docker"></i>Docker ne vključi pri gradnji slike.</p>
<p><code>.dockerignore</code></p>
<pre class="text"><code>.git*
dockerfile
docker-compose*
.dockerignore
.jshintrc
package-lock.json
node_modules
*.md
data</code></pre>
<script>
  $(document).ready(function() {
    $("#podatki-iz-registra code:eq(2)").markRegExp(/data|kulturne-dediscine\.csv/, options_dodaj);
    $("#podatki-iz-registra pre.csv:eq(0)").markRegExp(/(ESD|Ime|Sinonimi|Zvrst|Tip|Gesla|Opis|Datacija|Avtorji|LokacijaOp|Podrocja|Zavod|Varstvo|Obcina|X|Y|WGS X|WGS Y)/, options_dodaj);
    $("#podatki-iz-registra pre.text:eq(0)").markRegExp(/data/, options_dodaj);
  });
</script>
</div>
<div id="opredelitev-sheme-z-mongoose" class="section level3 hasAnchor" number="6.1.4">
<h3><span class="header-section-number">6.1.4</span> Opredelitev sheme z Mongoose<a href="PB-REST-API.html#opredelitev-sheme-z-mongoose" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Shemo naše podatkovne baze bomo opredelili v mapi <code>models</code> in jo bomo tudi uvozili v <code>db.js</code>, da bo le-ta na voljo celotni aplikaciji.</p>
<p>Najprej si pripravimo novo datoteko <code>locations.js</code>, kjer bomo opredelili shemo.</p>
<p><code>api/models/locations.js</code></p>
<div class="sourceCode" id="cb412"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb412-1"><a href="PB-REST-API.html#cb412-1" tabindex="-1"></a><span class="kw">const</span> mongoose <span class="op">=</span> <span class="pp">require</span>(<span class="st">&quot;mongoose&quot;</span>)<span class="op">;</span></span></code></pre></div>
<p>Dodamo tudi referenco na shemo <code>locations.js</code> v datoteki <code>db.js</code>.</p>
<p><code>api/models/db.js</code></p>
<div class="sourceCode" id="cb413"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb413-1"><a href="PB-REST-API.html#cb413-1" tabindex="-1"></a><span class="bu">process</span><span class="op">.</span><span class="fu">on</span>(<span class="st">&quot;SIGTERM&quot;</span><span class="op">,</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb413-2"><a href="PB-REST-API.html#cb413-2" tabindex="-1"></a>  <span class="fu">gracefulShutdown</span>(<span class="st">&quot;Cloud-based app shutdown&quot;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="bu">process</span><span class="op">.</span><span class="fu">exit</span>(<span class="dv">0</span>))<span class="op">;</span></span>
<span id="cb413-3"><a href="PB-REST-API.html#cb413-3" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb413-4"><a href="PB-REST-API.html#cb413-4" tabindex="-1"></a><span class="pp">require</span>(<span class="st">&quot;./locations&quot;</span>)<span class="op">;</span></span></code></pre></div>
<script>
  $(document).ready(function() {
    $("#opredelitev-sheme-z-mongoose code:eq(3)").markRegExp(/locations\.js/, options_dodaj);
    $("#opredelitev-sheme-z-mongoose code.javascript:eq(0)").markRegExp(/.+/, options_dodaj);
    $("#opredelitev-sheme-z-mongoose code.javascript:eq(1)").markRegExp(/require.+/, options_dodaj);
  });
</script>
<div id="osnovna-opredelitev-sheme" class="section level4 hasAnchor" number="6.1.4.1">
<h4><span class="header-section-number">6.1.4.1</span> Osnovna opredelitev sheme<a href="PB-REST-API.html#osnovna-opredelitev-sheme" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Trenutno imamo testne podatke shranjene v datoteki <code>kulturne-dediscine.csv</code>, ki se nahaja v mapi <code>data</code>. Omenjeni podatki se še ne uporabljajo v naši aplikaciji, lahko pa na njihovi osnovi opredelimo shemo podatkov. Pri tem bomo uporabili <a href="https://mongoosejs.com/docs/validation.html"><i class="fa-regular fa-circle-check"></i>pravila za <strong>preverjanje veljavnosti podatkov</strong></a>, ki nam zagotavljajo določeno stopnjo kakovosti shranjenih podatkov.</p>
<p><code>api/models/locations.js</code></p>
<div class="sourceCode" id="cb414"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb414-1"><a href="PB-REST-API.html#cb414-1" tabindex="-1"></a><span class="kw">const</span> mongoose <span class="op">=</span> <span class="pp">require</span>(<span class="st">&quot;mongoose&quot;</span>)<span class="op">;</span></span>
<span id="cb414-2"><a href="PB-REST-API.html#cb414-2" tabindex="-1"></a></span>
<span id="cb414-3"><a href="PB-REST-API.html#cb414-3" tabindex="-1"></a><span class="kw">const</span> locationSchema <span class="op">=</span> mongoose<span class="op">.</span><span class="fu">Schema</span>({</span>
<span id="cb414-4"><a href="PB-REST-API.html#cb414-4" tabindex="-1"></a>  <span class="dt">id</span><span class="op">:</span> {</span>
<span id="cb414-5"><a href="PB-REST-API.html#cb414-5" tabindex="-1"></a>    <span class="dt">type</span><span class="op">:</span> <span class="bu">Number</span><span class="op">,</span></span>
<span id="cb414-6"><a href="PB-REST-API.html#cb414-6" tabindex="-1"></a>    <span class="dt">required</span><span class="op">:</span> [<span class="kw">true</span><span class="op">,</span> <span class="st">&quot;Unique identifier is required!&quot;</span>]<span class="op">,</span></span>
<span id="cb414-7"><a href="PB-REST-API.html#cb414-7" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb414-8"><a href="PB-REST-API.html#cb414-8" tabindex="-1"></a>  <span class="dt">name</span><span class="op">:</span> { <span class="dt">type</span><span class="op">:</span> <span class="bu">String</span><span class="op">,</span> <span class="dt">required</span><span class="op">:</span> [<span class="kw">true</span><span class="op">,</span> <span class="st">&quot;Name is required!&quot;</span>] }<span class="op">,</span></span>
<span id="cb414-9"><a href="PB-REST-API.html#cb414-9" tabindex="-1"></a>  <span class="dt">synonyms</span><span class="op">:</span> {</span>
<span id="cb414-10"><a href="PB-REST-API.html#cb414-10" tabindex="-1"></a>    <span class="dt">type</span><span class="op">:</span> [<span class="bu">String</span>]<span class="op">,</span></span>
<span id="cb414-11"><a href="PB-REST-API.html#cb414-11" tabindex="-1"></a>    <span class="dt">validate</span><span class="op">:</span> {</span>
<span id="cb414-12"><a href="PB-REST-API.html#cb414-12" tabindex="-1"></a>      <span class="dt">validator</span><span class="op">:</span> (v) <span class="kw">=&gt;</span> v <span class="op">==</span> <span class="kw">undefined</span> <span class="op">||</span> (<span class="bu">Array</span><span class="op">.</span><span class="fu">isArray</span>(v) <span class="op">&amp;&amp;</span> v<span class="op">.</span><span class="at">length</span> <span class="op">&gt;</span> <span class="dv">0</span>)<span class="op">,</span></span>
<span id="cb414-13"><a href="PB-REST-API.html#cb414-13" tabindex="-1"></a>      <span class="dt">message</span><span class="op">:</span> <span class="st">&quot;If synonyms are provided, they must be an array of strings!&quot;</span><span class="op">,</span></span>
<span id="cb414-14"><a href="PB-REST-API.html#cb414-14" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb414-15"><a href="PB-REST-API.html#cb414-15" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb414-16"><a href="PB-REST-API.html#cb414-16" tabindex="-1"></a>  <span class="dt">category</span><span class="op">:</span> { <span class="dt">type</span><span class="op">:</span> <span class="bu">String</span><span class="op">,</span> <span class="dt">required</span><span class="op">:</span> [<span class="kw">true</span><span class="op">,</span> <span class="st">&quot;Category is required!&quot;</span>] }<span class="op">,</span></span>
<span id="cb414-17"><a href="PB-REST-API.html#cb414-17" tabindex="-1"></a>  <span class="dt">type</span><span class="op">:</span> { <span class="dt">type</span><span class="op">:</span> <span class="bu">String</span><span class="op">,</span> <span class="dt">required</span><span class="op">:</span> [<span class="kw">true</span><span class="op">,</span> <span class="st">&quot;Type is required!&quot;</span>] }<span class="op">,</span></span>
<span id="cb414-18"><a href="PB-REST-API.html#cb414-18" tabindex="-1"></a>  <span class="dt">keywords</span><span class="op">:</span> {</span>
<span id="cb414-19"><a href="PB-REST-API.html#cb414-19" tabindex="-1"></a>    <span class="dt">type</span><span class="op">:</span> [<span class="bu">String</span>]<span class="op">,</span></span>
<span id="cb414-20"><a href="PB-REST-API.html#cb414-20" tabindex="-1"></a>    <span class="dt">validate</span><span class="op">:</span> {</span>
<span id="cb414-21"><a href="PB-REST-API.html#cb414-21" tabindex="-1"></a>      <span class="dt">validator</span><span class="op">:</span> (v) <span class="kw">=&gt;</span> <span class="bu">Array</span><span class="op">.</span><span class="fu">isArray</span>(v) <span class="op">&amp;&amp;</span> v<span class="op">.</span><span class="at">length</span> <span class="op">&gt;</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb414-22"><a href="PB-REST-API.html#cb414-22" tabindex="-1"></a>      <span class="dt">message</span><span class="op">:</span> <span class="st">&quot;At least one keyword is required!&quot;</span><span class="op">,</span></span>
<span id="cb414-23"><a href="PB-REST-API.html#cb414-23" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb414-24"><a href="PB-REST-API.html#cb414-24" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb414-25"><a href="PB-REST-API.html#cb414-25" tabindex="-1"></a>  <span class="dt">description</span><span class="op">:</span> {</span>
<span id="cb414-26"><a href="PB-REST-API.html#cb414-26" tabindex="-1"></a>    <span class="dt">type</span><span class="op">:</span> <span class="bu">String</span><span class="op">,</span></span>
<span id="cb414-27"><a href="PB-REST-API.html#cb414-27" tabindex="-1"></a>    <span class="dt">required</span><span class="op">:</span> [<span class="kw">true</span><span class="op">,</span> <span class="st">&quot;Description is required!&quot;</span>]<span class="op">,</span></span>
<span id="cb414-28"><a href="PB-REST-API.html#cb414-28" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb414-29"><a href="PB-REST-API.html#cb414-29" tabindex="-1"></a>  <span class="dt">datation</span><span class="op">:</span> { <span class="dt">type</span><span class="op">:</span> <span class="bu">String</span><span class="op">,</span> <span class="dt">required</span><span class="op">:</span> <span class="kw">false</span> }<span class="op">,</span></span>
<span id="cb414-30"><a href="PB-REST-API.html#cb414-30" tabindex="-1"></a>  <span class="dt">authors</span><span class="op">:</span> { <span class="dt">type</span><span class="op">:</span> <span class="bu">String</span><span class="op">,</span> <span class="dt">required</span><span class="op">:</span> <span class="kw">false</span> }<span class="op">,</span></span>
<span id="cb414-31"><a href="PB-REST-API.html#cb414-31" tabindex="-1"></a>  <span class="dt">location</span><span class="op">:</span> {</span>
<span id="cb414-32"><a href="PB-REST-API.html#cb414-32" tabindex="-1"></a>    <span class="dt">type</span><span class="op">:</span> <span class="bu">String</span><span class="op">,</span></span>
<span id="cb414-33"><a href="PB-REST-API.html#cb414-33" tabindex="-1"></a>    <span class="dt">required</span><span class="op">:</span> [<span class="kw">true</span><span class="op">,</span> <span class="st">&quot;Location description is required!&quot;</span>]<span class="op">,</span></span>
<span id="cb414-34"><a href="PB-REST-API.html#cb414-34" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb414-35"><a href="PB-REST-API.html#cb414-35" tabindex="-1"></a>  <span class="dt">fields</span><span class="op">:</span> {</span>
<span id="cb414-36"><a href="PB-REST-API.html#cb414-36" tabindex="-1"></a>    <span class="dt">type</span><span class="op">:</span> [<span class="bu">String</span>]<span class="op">,</span></span>
<span id="cb414-37"><a href="PB-REST-API.html#cb414-37" tabindex="-1"></a>    <span class="dt">validate</span><span class="op">:</span> {</span>
<span id="cb414-38"><a href="PB-REST-API.html#cb414-38" tabindex="-1"></a>      <span class="dt">validator</span><span class="op">:</span> (v) <span class="kw">=&gt;</span> <span class="bu">Array</span><span class="op">.</span><span class="fu">isArray</span>(v) <span class="op">&amp;&amp;</span> v<span class="op">.</span><span class="at">length</span> <span class="op">&gt;</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb414-39"><a href="PB-REST-API.html#cb414-39" tabindex="-1"></a>      <span class="dt">message</span><span class="op">:</span> <span class="st">&quot;At least one field is required!&quot;</span><span class="op">,</span></span>
<span id="cb414-40"><a href="PB-REST-API.html#cb414-40" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb414-41"><a href="PB-REST-API.html#cb414-41" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb414-42"><a href="PB-REST-API.html#cb414-42" tabindex="-1"></a>  <span class="dt">institution</span><span class="op">:</span> { <span class="dt">type</span><span class="op">:</span> <span class="bu">String</span><span class="op">,</span> <span class="dt">required</span><span class="op">:</span> [<span class="kw">true</span><span class="op">,</span> <span class="st">&quot;Institution is required!&quot;</span>] }<span class="op">,</span></span>
<span id="cb414-43"><a href="PB-REST-API.html#cb414-43" tabindex="-1"></a>  <span class="dt">heritage</span><span class="op">:</span> { <span class="dt">type</span><span class="op">:</span> <span class="bu">String</span><span class="op">,</span> <span class="dt">required</span><span class="op">:</span> [<span class="kw">true</span><span class="op">,</span> <span class="st">&quot;Heritage is required!&quot;</span>] }<span class="op">,</span></span>
<span id="cb414-44"><a href="PB-REST-API.html#cb414-44" tabindex="-1"></a>  <span class="dt">municipality</span><span class="op">:</span> { <span class="dt">type</span><span class="op">:</span> <span class="bu">String</span><span class="op">,</span> <span class="dt">required</span><span class="op">:</span> [<span class="kw">true</span><span class="op">,</span> <span class="st">&quot;Municipality is required!&quot;</span>] }<span class="op">,</span></span>
<span id="cb414-45"><a href="PB-REST-API.html#cb414-45" tabindex="-1"></a>  <span class="dt">coordinates</span><span class="op">:</span> {</span>
<span id="cb414-46"><a href="PB-REST-API.html#cb414-46" tabindex="-1"></a>    <span class="dt">type</span><span class="op">:</span> [<span class="bu">Number</span>]<span class="op">,</span></span>
<span id="cb414-47"><a href="PB-REST-API.html#cb414-47" tabindex="-1"></a>    <span class="dt">validate</span><span class="op">:</span> {</span>
<span id="cb414-48"><a href="PB-REST-API.html#cb414-48" tabindex="-1"></a>      <span class="dt">validator</span><span class="op">:</span> (v) <span class="kw">=&gt;</span> <span class="bu">Array</span><span class="op">.</span><span class="fu">isArray</span>(v) <span class="op">&amp;&amp;</span> v<span class="op">.</span><span class="at">length</span> <span class="op">==</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb414-49"><a href="PB-REST-API.html#cb414-49" tabindex="-1"></a>      <span class="dt">message</span><span class="op">:</span> <span class="st">&quot;Coordinates must be an array of two numbers!&quot;</span><span class="op">,</span></span>
<span id="cb414-50"><a href="PB-REST-API.html#cb414-50" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb414-51"><a href="PB-REST-API.html#cb414-51" tabindex="-1"></a>    <span class="dt">index</span><span class="op">:</span> <span class="st">&quot;2dsphere&quot;</span><span class="op">,</span></span>
<span id="cb414-52"><a href="PB-REST-API.html#cb414-52" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb414-53"><a href="PB-REST-API.html#cb414-53" tabindex="-1"></a>  <span class="dt">rating</span><span class="op">:</span> { <span class="dt">type</span><span class="op">:</span> <span class="bu">Number</span><span class="op">,</span> <span class="cf">default</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">min</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">max</span><span class="op">:</span> <span class="dv">5</span> }<span class="op">,</span></span>
<span id="cb414-54"><a href="PB-REST-API.html#cb414-54" tabindex="-1"></a>})<span class="op">;</span></span></code></pre></div>
<p>V določenih primerih je smiselno opredeliti privzete vrednosti, kot je to prikazano pri podatku <code>rating</code>. V tem primeru je to naravna izbira, saj v trenutku, ko dodamo novo lokacijo, le-ta še nima komentarjev in je zato smiselno povprečno oceno nastaviti na <span class="math inline">\(0\)</span>.</p>
<p>V opredelitev sheme lahko vključimo tudi osnovno preverjanje ustreznosti podatkov, kot je to npr. uporabljeno pri podatku <code>id</code>, saj zahtevamo, da je ta podatek obvezen. Če bi poskušali v podatkovno bazo MongoDB shraniti dokument, ki ne bi vseboval tega podatka, bi pri tem dobili napako s sporočilom <code>Unique identifier is required!</code>. Preverjanje ustreznosti podatkov je uporabljeno tudi pri atributu <code>rating</code>, kjer zahtevamo, da je podano število v intervalu <span class="math inline">\([0, 5]\)</span>. Prav tako pa imamo pri drugih podatkih (npr. <code>coordinates</code>) opredeljene še kompleksnejša pravila, kjer zahtevamo, da je podatek v obliki polja, ki mora vsebovati natanko <span class="math inline">\(2\)</span> vrednosti.</p>
<script>
  $(document).ready(function() {
    $("#osnovna-opredelitev-sheme code.javascript:eq(0)").markRegExp(/const locationSchema[\s\S]+/, options_dodaj);
  });
</script>
</div>
<div id="uporaba-geografskih-podatkov" class="section level4 hasAnchor" number="6.1.4.2">
<h4><span class="header-section-number">6.1.4.2</span> Uporaba geografskih podatkov<a href="PB-REST-API.html#uporaba-geografskih-podatkov" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Izračun razdalje od trenutne lokacije do izbrani lokacij bo potekal v okviru MongoDB podatkovne baze, ki nam omogoča shranjevanje podatkov koordinat z <strong>zemljepisno širino</strong><a href="PB-REST-API.html#fn131" class="footnote-ref" id="fnref131"><sup>131</sup></a> in <strong>dolžino</strong><a href="PB-REST-API.html#fn132" class="footnote-ref" id="fnref132"><sup>132</sup></a> ter celo uporabo <strong>indeksov</strong> nad takšnimi podatki. Tako lahko uporabniki izvajajo performančno učinkovite poizvedbe nad geografskimi podatki, kar je v našem primeru, ko takšno aplikacijo gradimo, zelo koristno.</p>
<p>Geografski podatki so v MongoDB shranjeni skladno s specifikacijo <a href="https://www.rfc-editor.org/rfc/rfc7946"><i class="fa-solid fa-earth-europe"></i><strong>GeoJSON</strong></a>. Pri vključitvi teh podatkov v MongoDB s pomočjo Mongoose je treba:</p>
<ul>
<li>opredeliti pot kot polje podatkovnega tipa <code>Number</code>,</li>
<li>omenjeni poti dodati <a href="https://www.mongodb.com/docs/manual/core/2dsphere/"><i class="fa-solid fa-tag"></i><code>2dsphere</code></a> indeks.</li>
</ul>
<p>Zelo pomembna je vključitev <code>2dsphere</code> indeksa, saj nam omogoča računanje razdalj v realnem času kar pri poizvedovanju po podatkih.</p>
</div>
<div id="Opredelitev-bolj-kompleksne-sheme-z-odvisnimi-dokumenti" class="section level4 hasAnchor" number="6.1.4.3">
<h4><span class="header-section-number">6.1.4.3</span> Opredelitev bolj kompleksne sheme z odvisnimi dokumenti<a href="PB-REST-API.html#Opredelitev-bolj-kompleksne-sheme-z-odvisnimi-dokumenti" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Do sedaj so bili podatki dokaj preprosti in brez odvisnosti. Ko začnemo razmišljati o podrobnostih lokacije v okviru naše aplikacije, pa imamo v mislih bolj kompleksne strukture podatkov, kot so npr. komentarji, ki jih bomo hranili v obliki polja objektov.</p>
<p>V okviru relacijske podatkovne baze bi takšne podatke hranili v ločenih tabelah in bi jih kasneje združili na ravni poizvedbe, vendar dokumentne podatkovne baze ne delujejo na takšen način. Kot prikazuje slika <a href="PB-REST-API.html#fig:slika-Relacijska-PB-vs-dokumentna-NoSQL">6.5</a>, je pri načinu shranjevanja podatkov v dokumentno usmerjeno NoSQL podatkovno bazo kar nekaj razlik v primerjavi z relacijsko podatkovno bazo.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:slika-Relacijska-PB-vs-dokumentna-NoSQL"></span>
<img src="assets/img/Relacijska_PB_vs_dokumentna_NoSQL.png" alt="Razlike med načinom shranjevanja podatkov v relacijsko podatkovno bazo in dokumentno usmerjeno NoSQL podatkovno bazo" width="500" />
<p class="caption">
Slika 6.5: Razlike med načinom shranjevanja podatkov v relacijsko podatkovno bazo in dokumentno usmerjeno NoSQL podatkovno bazo
</p>
</div>
<p>V okviru MongoDB je na voljo koncept <a href="https://mongoosejs.com/docs/subdocs.html"><i class="fa-solid fa-earth-europe"></i><strong>odvisnih dokumentov</strong></a><a href="PB-REST-API.html#fn133" class="footnote-ref" id="fnref133"><sup>133</sup></a>, ki nam omogočajo shranjevanje takšnih ponavljajočih podatkov. Odvisni dokumenti so zelo podobni dokumentom, tako da imajo svoj enolični identifikator <code>_id</code> in svojo shemo, vendar so del drugega dokumenta.</p>
<p>Zato bomo, v skladu z dobro prakso, komentarje modelirali, kot je prikazano v nadaljevanju.</p>
<p><code>api/models/location.js</code></p>
<div class="sourceCode" id="cb415"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb415-1"><a href="PB-REST-API.html#cb415-1" tabindex="-1"></a><span class="kw">const</span> mongoose <span class="op">=</span> <span class="pp">require</span>(<span class="st">&quot;mongoose&quot;</span>)<span class="op">;</span></span>
<span id="cb415-2"><a href="PB-REST-API.html#cb415-2" tabindex="-1"></a></span>
<span id="cb415-3"><a href="PB-REST-API.html#cb415-3" tabindex="-1"></a><span class="kw">const</span> commentSchema <span class="op">=</span> <span class="kw">new</span> mongoose<span class="op">.</span><span class="fu">Schema</span>({</span>
<span id="cb415-4"><a href="PB-REST-API.html#cb415-4" tabindex="-1"></a>  <span class="dt">author</span><span class="op">:</span> { <span class="dt">type</span><span class="op">:</span> <span class="bu">String</span><span class="op">,</span> <span class="dt">required</span><span class="op">:</span> [<span class="kw">true</span><span class="op">,</span> <span class="st">&quot;Author is required!&quot;</span>] }<span class="op">,</span></span>
<span id="cb415-5"><a href="PB-REST-API.html#cb415-5" tabindex="-1"></a>  <span class="dt">rating</span><span class="op">:</span> {</span>
<span id="cb415-6"><a href="PB-REST-API.html#cb415-6" tabindex="-1"></a>    <span class="dt">type</span><span class="op">:</span> <span class="bu">Number</span><span class="op">,</span></span>
<span id="cb415-7"><a href="PB-REST-API.html#cb415-7" tabindex="-1"></a>    <span class="dt">required</span><span class="op">:</span> [<span class="kw">true</span><span class="op">,</span> <span class="st">&quot;Rating is required!&quot;</span>]<span class="op">,</span></span>
<span id="cb415-8"><a href="PB-REST-API.html#cb415-8" tabindex="-1"></a>    <span class="dt">min</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb415-9"><a href="PB-REST-API.html#cb415-9" tabindex="-1"></a>    <span class="dt">max</span><span class="op">:</span> <span class="dv">5</span><span class="op">,</span></span>
<span id="cb415-10"><a href="PB-REST-API.html#cb415-10" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb415-11"><a href="PB-REST-API.html#cb415-11" tabindex="-1"></a>  <span class="dt">comment</span><span class="op">:</span> { <span class="dt">type</span><span class="op">:</span> <span class="bu">String</span><span class="op">,</span> <span class="dt">required</span><span class="op">:</span> [<span class="kw">true</span><span class="op">,</span> <span class="st">&quot;Comment is required!&quot;</span>] }<span class="op">,</span></span>
<span id="cb415-12"><a href="PB-REST-API.html#cb415-12" tabindex="-1"></a>  <span class="dt">createdOn</span><span class="op">:</span> { <span class="dt">type</span><span class="op">:</span> <span class="bu">Date</span><span class="op">,</span> <span class="cf">default</span><span class="op">:</span> <span class="bu">Date</span><span class="op">.</span><span class="at">now</span> }<span class="op">,</span></span>
<span id="cb415-13"><a href="PB-REST-API.html#cb415-13" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb415-14"><a href="PB-REST-API.html#cb415-14" tabindex="-1"></a></span>
<span id="cb415-15"><a href="PB-REST-API.html#cb415-15" tabindex="-1"></a><span class="kw">const</span> locationSchema <span class="op">=</span> mongoose<span class="op">.</span><span class="fu">Schema</span>({</span>
<span id="cb415-16"><a href="PB-REST-API.html#cb415-16" tabindex="-1"></a>  <span class="op">...,</span></span>
<span id="cb415-17"><a href="PB-REST-API.html#cb415-17" tabindex="-1"></a>  <span class="dt">comments</span><span class="op">:</span> {</span>
<span id="cb415-18"><a href="PB-REST-API.html#cb415-18" tabindex="-1"></a>    <span class="dt">type</span><span class="op">:</span> [commentSchema]<span class="op">,</span></span>
<span id="cb415-19"><a href="PB-REST-API.html#cb415-19" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb415-20"><a href="PB-REST-API.html#cb415-20" tabindex="-1"></a>})<span class="op">;</span></span></code></pre></div>
<script>
  $(document).ready(function() {
    $("#Opredelitev-bolj-kompleksne-sheme-z-odvisnimi-dokumenti code.javascript:eq(0)").markRegExp(/const commentSchema[\s\S]+?}\);/, options_dodaj);
    $("#Opredelitev-bolj-kompleksne-sheme-z-odvisnimi-dokumenti code.javascript:eq(0)").markRegExp(/\s+?comments: [\s\S]+?}/, options_dodaj);
  });
</script>
</div>
<div id="prevajanje-sheme-v-model" class="section level4 hasAnchor" number="6.1.4.4">
<h4><span class="header-section-number">6.1.4.4</span> Prevajanje sheme v model<a href="PB-REST-API.html#prevajanje-sheme-v-model" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Prevajanje sheme v model je s pomočjo Mongoose zelo preprosto, in sicer z naslednjim ukazom:</p>
<div class="sourceCode" id="cb416"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb416-1"><a href="PB-REST-API.html#cb416-1" tabindex="-1"></a>mongoose<span class="op">.</span><span class="fu">model</span>(<span class="st">&#39;Location&#39;</span><span class="op">,</span> locationsSchema<span class="op">,</span> <span class="st">&#39;Locations&#39;</span>)<span class="op">;</span></span></code></pre></div>
<p>kjer velja:</p>
<ul>
<li><code>mongoose</code> je ime povezave,</li>
<li><code>Location</code> je ime modela,</li>
<li><code>locationsSchema</code> je shema, ki jo uporabimo in</li>
<li><code>Locations</code> je (opcijsko) ime MongoDB zbirke.</li>
</ul>
<p>Proces prevajanja sheme v model je podrobneje prikazan na sliki <a href="PB-REST-API.html#fig:slika-Prevajanje-sheme-v-model">6.6</a>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:slika-Prevajanje-sheme-v-model"></span>
<img src="assets/img/Prevajanje_sheme_v_model.png" alt="Proces preslikovanja sheme v model pri uporabi Mongoose" width="650" />
<p class="caption">
Slika 6.6: Proces preslikovanja sheme v model pri uporabi Mongoose
</p>
</div>
<p>Zdaj moramo le še dodati ukaz za prevajanje sheme v model.</p>
<p><code>api/models/locations.js</code></p>
<div class="sourceCode" id="cb417"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb417-1"><a href="PB-REST-API.html#cb417-1" tabindex="-1"></a><span class="kw">const</span> mongoose <span class="op">=</span> <span class="pp">require</span>(<span class="st">&quot;mongoose&quot;</span>)<span class="op">;</span></span>
<span id="cb417-2"><a href="PB-REST-API.html#cb417-2" tabindex="-1"></a><span class="kw">const</span> commentSchema <span class="op">=</span> <span class="kw">new</span> mongoose<span class="op">.</span><span class="fu">Schema</span>({</span>
<span id="cb417-3"><a href="PB-REST-API.html#cb417-3" tabindex="-1"></a>  <span class="op">...</span></span>
<span id="cb417-4"><a href="PB-REST-API.html#cb417-4" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb417-5"><a href="PB-REST-API.html#cb417-5" tabindex="-1"></a><span class="kw">const</span> locationSchema <span class="op">=</span> mongoose<span class="op">.</span><span class="fu">Schema</span>({</span>
<span id="cb417-6"><a href="PB-REST-API.html#cb417-6" tabindex="-1"></a>  <span class="op">...</span></span>
<span id="cb417-7"><a href="PB-REST-API.html#cb417-7" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb417-8"><a href="PB-REST-API.html#cb417-8" tabindex="-1"></a>mongoose<span class="op">.</span><span class="fu">model</span>(<span class="st">&quot;Location&quot;</span><span class="op">,</span> locationSchema<span class="op">,</span> <span class="st">&quot;Locations&quot;</span>)<span class="op">;</span></span></code></pre></div>
<p>V nadaljevanju moramo našo prazno podatkovno bazo še napolniti s podatki.</p>
<script>
  $(document).ready(function() {
    $("#prevajanje-sheme-v-model code.javascript:eq(1)").markRegExp(/mongoose\.model.+/, options_dodaj);
  });
</script>
</div>
</div>
<div id="Uporaba-MongoDB-ukazne-lupine-za-dodajanje-podatkov" class="section level3 hasAnchor" number="6.1.5">
<h3><span class="header-section-number">6.1.5</span> Uporaba MongoDB ukazne lupine za dodajanje podatkov<a href="PB-REST-API.html#Uporaba-MongoDB-ukazne-lupine-za-dodajanje-podatkov" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p><strong>Namig</strong>: Za uspešno izvedbo ukazov v nadaljevanju poskrbite, da je vaša podatkovna baza pognana, sicer jo poženite z ukazom <code>docker start sp-mongo-db</code>.</p>
</blockquote>
<p>V lokalnem razvojnem okolju, kjer uporabljamo Docker (glej poglavje <a href="PB-REST-API.html#Namestitev-MongoDB-NavodilaDocker">6.1.1.1</a>), lahko do podatkovne baze MongoDB dostopamo z ukazom <a href="https://www.mongodb.com/docs/mongodb-shell/"><i class="fa-solid fa-database"></i><code>mongosh</code></a> oz. <code>docker exec -it sp-mongo-db mongosh</code>.</p>
<blockquote>
<p><strong>Namig</strong>: Ko do podatkovne baze dostopate iz lokalnega razvojnega okolja, morate za odjemalski dostop kreirati nov proces (tj. <strong>odpreti nov terminal</strong>), v katerem dostopate do obstoječega procesa, kjer se izvaja MongoDB podatkovna baza.</p>
</blockquote>
<p>Ob uspešni povezavi nam sistem izpiše nekaj osnovnih podatkov o MongoDB podatkovni bazi.</p>
<div class="sourceCode" id="cb418"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb418-1"><a href="PB-REST-API.html#cb418-1" tabindex="-1"></a><span class="ex">$</span> docker exec <span class="at">-it</span> sp-mongo-db mongosh</span>
<span id="cb418-2"><a href="PB-REST-API.html#cb418-2" tabindex="-1"></a><span class="ex">Current</span> Mongosh Log ID: 635117ef88b8b6eb62461683</span>
<span id="cb418-3"><a href="PB-REST-API.html#cb418-3" tabindex="-1"></a><span class="ex">Connecting</span> to:          mongodb://127.0.0.1:27017/<span class="pp">?</span>directConnection=true<span class="kw">&amp;</span><span class="va">serverSelectionTimeoutMS</span><span class="op">=</span>2000<span class="kw">&amp;</span><span class="va">appName</span><span class="op">=</span>mongosh+1.6.0</span>
<span id="cb418-4"><a href="PB-REST-API.html#cb418-4" tabindex="-1"></a><span class="ex">Using</span> MongoDB:          6.0.2</span>
<span id="cb418-5"><a href="PB-REST-API.html#cb418-5" tabindex="-1"></a><span class="ex">Using</span> Mongosh:          1.6.0</span>
<span id="cb418-6"><a href="PB-REST-API.html#cb418-6" tabindex="-1"></a></span>
<span id="cb418-7"><a href="PB-REST-API.html#cb418-7" tabindex="-1"></a><span class="bu">test</span><span class="op">&gt;</span> </span></code></pre></div>
<p>Za <strong>prikaz vseh lokalnih MongoDB podatkovnih baz</strong> uporabimo ukaz <i class="fa-solid fa-database"></i><code>show dbs</code>, kjer nam sistem vrne seznam obstoječih podatkovnih baz in velikost, ki jo zasedejo na trdem disku.</p>
<div class="sourceCode" id="cb419"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb419-1"><a href="PB-REST-API.html#cb419-1" tabindex="-1"></a><span class="bu">test</span><span class="op">&gt;</span> show dbs</span>
<span id="cb419-2"><a href="PB-REST-API.html#cb419-2" tabindex="-1"></a><span class="ex">Demo</span>    12.00 KiB</span>
<span id="cb419-3"><a href="PB-REST-API.html#cb419-3" tabindex="-1"></a><span class="ex">admin</span>   40.00 KiB</span>
<span id="cb419-4"><a href="PB-REST-API.html#cb419-4" tabindex="-1"></a><span class="ex">config</span>  72.00 KiB</span>
<span id="cb419-5"><a href="PB-REST-API.html#cb419-5" tabindex="-1"></a><span class="bu">local</span>   40.00 <span class="va">KiB</span></span></code></pre></div>
<p>Nato se z ukazom <i class="fa-solid fa-database"></i><code>use Demo</code> prestavimo v našo podatkovno bazo <code>Demo</code> in povemo, da želimo <strong>uporabljati določeno podatkovno bazo</strong>. Če podatkovna baza še ne obstaja, jo s tem ukazom tudi kreiramo.</p>
<div class="sourceCode" id="cb420"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb420-1"><a href="PB-REST-API.html#cb420-1" tabindex="-1"></a><span class="bu">test</span><span class="op">&gt;</span> use Demo</span>
<span id="cb420-2"><a href="PB-REST-API.html#cb420-2" tabindex="-1"></a><span class="ex">switched</span> to db Demo</span>
<span id="cb420-3"><a href="PB-REST-API.html#cb420-3" tabindex="-1"></a></span>
<span id="cb420-4"><a href="PB-REST-API.html#cb420-4" tabindex="-1"></a><span class="ex">Demo</span><span class="op">&gt;</span> </span></code></pre></div>
<p>Za <strong>prikaz zbirk v podatkovni bazi</strong> uporabimo ukaz <i class="fa-solid fa-database"></i><code>show collections</code>.</p>
<div class="sourceCode" id="cb421"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb421-1"><a href="PB-REST-API.html#cb421-1" tabindex="-1"></a><span class="ex">Demo</span><span class="op">&gt;</span> show collections</span>
<span id="cb421-2"><a href="PB-REST-API.html#cb421-2" tabindex="-1"></a><span class="ex">Locations</span></span>
<span id="cb421-3"><a href="PB-REST-API.html#cb421-3" tabindex="-1"></a></span>
<span id="cb421-4"><a href="PB-REST-API.html#cb421-4" tabindex="-1"></a><span class="ex">Demo</span><span class="op">&gt;</span> </span></code></pre></div>
<p>Sedaj lahko z ukazom <a href="https://www.mongodb.com/docs/manual/reference/method/db.collection.insertOne/"><i class="fa-solid fa-database"></i><code>db.Lokacije.insertOne({ ... })</code></a> v zbirko <code>Locations</code> <strong>dodamo nov zapis</strong>. Pri uspešni izvedbi ukaza je rezultat število kreiranih dokumentov (v našem primeru 1).</p>
<div class="sourceCode" id="cb422"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb422-1"><a href="PB-REST-API.html#cb422-1" tabindex="-1"></a>Demo<span class="op">&gt;</span> db<span class="op">.</span><span class="at">Locations</span><span class="op">.</span><span class="fu">insertOne</span>({</span>
<span id="cb422-2"><a href="PB-REST-API.html#cb422-2" tabindex="-1"></a>  <span class="st">&quot;id&quot;</span><span class="op">:</span> <span class="dv">58</span><span class="op">,</span></span>
<span id="cb422-3"><a href="PB-REST-API.html#cb422-3" tabindex="-1"></a>  <span class="st">&quot;name&quot;</span><span class="op">:</span> <span class="st">&quot;Celje - Celjski grad&quot;</span><span class="op">,</span></span>
<span id="cb422-4"><a href="PB-REST-API.html#cb422-4" tabindex="-1"></a>  <span class="st">&quot;category&quot;</span><span class="op">:</span> <span class="st">&quot;stavbe&quot;</span><span class="op">,</span></span>
<span id="cb422-5"><a href="PB-REST-API.html#cb422-5" tabindex="-1"></a>  <span class="st">&quot;type&quot;</span><span class="op">:</span> <span class="st">&quot;profana stavbna dediščina&quot;</span><span class="op">,</span></span>
<span id="cb422-6"><a href="PB-REST-API.html#cb422-6" tabindex="-1"></a>  <span class="st">&quot;keywords&quot;</span><span class="op">:</span> [</span>
<span id="cb422-7"><a href="PB-REST-API.html#cb422-7" tabindex="-1"></a>    <span class="st">&quot;grad&quot;</span><span class="op">,</span></span>
<span id="cb422-8"><a href="PB-REST-API.html#cb422-8" tabindex="-1"></a>    <span class="st">&quot;ruševina&quot;</span></span>
<span id="cb422-9"><a href="PB-REST-API.html#cb422-9" tabindex="-1"></a>  ]<span class="op">,</span></span>
<span id="cb422-10"><a href="PB-REST-API.html#cb422-10" tabindex="-1"></a>  <span class="st">&quot;description&quot;</span><span class="op">:</span> <span class="st">&quot;Izjemno razsežna srednjeveška trdnjava 14. in 15. stol. s stanovanjskim jedrom, izstopajočim stolpom in obrambnimi zidovi je postavljena na zaščiteno lego na grič nad Savinjo.&quot;</span><span class="op">,</span></span>
<span id="cb422-11"><a href="PB-REST-API.html#cb422-11" tabindex="-1"></a>  <span class="st">&quot;location&quot;</span><span class="op">:</span> <span class="st">&quot;Na JV robu mesta Celje, na naravno dvignjeni legi nad strugo Savinje je postavljena trdnjava.&quot;</span><span class="op">,</span></span>
<span id="cb422-12"><a href="PB-REST-API.html#cb422-12" tabindex="-1"></a>  <span class="st">&quot;institution&quot;</span><span class="op">:</span> <span class="st">&quot;ZVKD Celje&quot;</span><span class="op">,</span></span>
<span id="cb422-13"><a href="PB-REST-API.html#cb422-13" tabindex="-1"></a>  <span class="st">&quot;heritage&quot;</span><span class="op">:</span> <span class="st">&quot;spomenik lokalnega pomena&quot;</span><span class="op">,</span></span>
<span id="cb422-14"><a href="PB-REST-API.html#cb422-14" tabindex="-1"></a>  <span class="st">&quot;municipality&quot;</span><span class="op">:</span> <span class="st">&quot;CELJE&quot;</span><span class="op">,</span></span>
<span id="cb422-15"><a href="PB-REST-API.html#cb422-15" tabindex="-1"></a>  <span class="st">&quot;coordinates&quot;</span><span class="op">:</span> [</span>
<span id="cb422-16"><a href="PB-REST-API.html#cb422-16" tabindex="-1"></a>    <span class="fl">46.2195704036</span><span class="op">,</span></span>
<span id="cb422-17"><a href="PB-REST-API.html#cb422-17" tabindex="-1"></a>    <span class="fl">15.272580993</span></span>
<span id="cb422-18"><a href="PB-REST-API.html#cb422-18" tabindex="-1"></a>  ]<span class="op">,</span></span>
<span id="cb422-19"><a href="PB-REST-API.html#cb422-19" tabindex="-1"></a>  <span class="st">&quot;synonyms&quot;</span><span class="op">:</span> [</span>
<span id="cb422-20"><a href="PB-REST-API.html#cb422-20" tabindex="-1"></a>    <span class="st">&quot;Gornje Celje&quot;</span><span class="op">,</span></span>
<span id="cb422-21"><a href="PB-REST-API.html#cb422-21" tabindex="-1"></a>    <span class="st">&quot;Stari grad&quot;</span><span class="op">,</span></span>
<span id="cb422-22"><a href="PB-REST-API.html#cb422-22" tabindex="-1"></a>    <span class="st">&quot;Cylie&quot;</span></span>
<span id="cb422-23"><a href="PB-REST-API.html#cb422-23" tabindex="-1"></a>  ]<span class="op">,</span></span>
<span id="cb422-24"><a href="PB-REST-API.html#cb422-24" tabindex="-1"></a>  <span class="st">&quot;datation&quot;</span><span class="op">:</span> <span class="st">&quot;12. stol., prva četrtina 14. stol., 1323, druga polovica 16. stol., 1566-1579&quot;</span><span class="op">,</span></span>
<span id="cb422-25"><a href="PB-REST-API.html#cb422-25" tabindex="-1"></a>  <span class="st">&quot;fields&quot;</span><span class="op">:</span> [</span>
<span id="cb422-26"><a href="PB-REST-API.html#cb422-26" tabindex="-1"></a>    <span class="st">&quot;umetnostna zgodovina&quot;</span><span class="op">,</span></span>
<span id="cb422-27"><a href="PB-REST-API.html#cb422-27" tabindex="-1"></a>    <span class="st">&quot;arheologija&quot;</span></span>
<span id="cb422-28"><a href="PB-REST-API.html#cb422-28" tabindex="-1"></a>  ]</span>
<span id="cb422-29"><a href="PB-REST-API.html#cb422-29" tabindex="-1"></a>})</span>
<span id="cb422-30"><a href="PB-REST-API.html#cb422-30" tabindex="-1"></a>{</span>
<span id="cb422-31"><a href="PB-REST-API.html#cb422-31" tabindex="-1"></a>  <span class="dt">acknowledged</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb422-32"><a href="PB-REST-API.html#cb422-32" tabindex="-1"></a>  <span class="dt">insertedId</span><span class="op">:</span> <span class="fu">ObjectId</span>(<span class="st">&quot;63511ab1b6ed459a4a620cb8&quot;</span>)</span>
<span id="cb422-33"><a href="PB-REST-API.html#cb422-33" tabindex="-1"></a>}</span>
<span id="cb422-34"><a href="PB-REST-API.html#cb422-34" tabindex="-1"></a></span>
<span id="cb422-35"><a href="PB-REST-API.html#cb422-35" tabindex="-1"></a>Demo<span class="op">&gt;</span> </span></code></pre></div>
<blockquote>
<p><strong>Namig</strong>: Za <strong>brisanje vseh zapisov</strong> iz zbirke (npr. iz <code>Locations</code>) lahko uporabimo ukaz <a href="https://www.mongodb.com/docs/manual/reference/method/db.collection.remove/"><span class="skupaj"><i class="fa-solid fa-database"></i><code>db.Locations.remove({})</code></span></a>, če pa želimo <strong>zbirko v celoti odstraniti</strong> (npr. <code>Locations</code>), potem uporabimo ukaz <a href="https://www.mongodb.com/docs/manual/reference/method/db.collection.drop/"><i class="fa-solid fa-database"></i><code>db.Locations.drop()</code></a>.</p>
</blockquote>
<p>V podatkovno bazo lahko sedaj posredujemo poizvedbo <a href="https://www.mongodb.com/docs/manual/reference/method/db.collection.find/"><i class="fa-solid fa-database"></i><code>db.Locations.find()</code></a>, ki nam <strong>vrne vse dokumente</strong>, ki so shranjeni v zbirki <code>Locations</code>. V odgovoru lahko opazimo, da nam MongoDB samodejno doda polje <code>_id</code>, ki je enolični identifikator dokumenta v zbirki.</p>
<div class="sourceCode" id="cb423"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb423-1"><a href="PB-REST-API.html#cb423-1" tabindex="-1"></a>Demo<span class="op">&gt;</span> db<span class="op">.</span><span class="at">Locations</span><span class="op">.</span><span class="fu">find</span>()</span>
<span id="cb423-2"><a href="PB-REST-API.html#cb423-2" tabindex="-1"></a>[</span>
<span id="cb423-3"><a href="PB-REST-API.html#cb423-3" tabindex="-1"></a>  {</span>
<span id="cb423-4"><a href="PB-REST-API.html#cb423-4" tabindex="-1"></a>    <span class="dt">_id</span><span class="op">:</span> <span class="fu">ObjectId</span>(<span class="st">&quot;63511ab1b6ed459a4a620cb8&quot;</span>)<span class="op">,</span></span>
<span id="cb423-5"><a href="PB-REST-API.html#cb423-5" tabindex="-1"></a>    <span class="dt">id</span><span class="op">:</span> <span class="dv">58</span><span class="op">,</span></span>
<span id="cb423-6"><a href="PB-REST-API.html#cb423-6" tabindex="-1"></a>    <span class="dt">name</span><span class="op">:</span> <span class="st">&#39;Celje - Celjski grad&#39;</span><span class="op">,</span></span>
<span id="cb423-7"><a href="PB-REST-API.html#cb423-7" tabindex="-1"></a>    <span class="dt">category</span><span class="op">:</span> <span class="st">&#39;stavbe&#39;</span><span class="op">,</span></span>
<span id="cb423-8"><a href="PB-REST-API.html#cb423-8" tabindex="-1"></a>    <span class="dt">type</span><span class="op">:</span> <span class="st">&#39;profana stavbna dediščina&#39;</span><span class="op">,</span></span>
<span id="cb423-9"><a href="PB-REST-API.html#cb423-9" tabindex="-1"></a>    <span class="dt">keywords</span><span class="op">:</span> [ <span class="st">&#39;grad&#39;</span><span class="op">,</span> <span class="st">&#39;ruševina&#39;</span> ]<span class="op">,</span></span>
<span id="cb423-10"><a href="PB-REST-API.html#cb423-10" tabindex="-1"></a>    <span class="dt">description</span><span class="op">:</span> <span class="st">&#39;Izjemno razsežna srednjeveška trdnjava 14. in 15. stol. s stanovanjskim jedrom, izstopajočim stolpom in obrambnimi zidovi je postavljena na zaščiteno lego na grič nad Savinjo.&#39;</span><span class="op">,</span></span>
<span id="cb423-11"><a href="PB-REST-API.html#cb423-11" tabindex="-1"></a>    <span class="dt">location</span><span class="op">:</span> <span class="st">&#39;Na JV robu mesta Celje, na naravno dvignjeni legi nad strugo Savinje je postavljena trdnjava.&#39;</span><span class="op">,</span></span>
<span id="cb423-12"><a href="PB-REST-API.html#cb423-12" tabindex="-1"></a>    <span class="dt">institution</span><span class="op">:</span> <span class="st">&#39;ZVKD Celje&#39;</span><span class="op">,</span></span>
<span id="cb423-13"><a href="PB-REST-API.html#cb423-13" tabindex="-1"></a>    <span class="dt">heritage</span><span class="op">:</span> <span class="st">&#39;spomenik lokalnega pomena&#39;</span><span class="op">,</span></span>
<span id="cb423-14"><a href="PB-REST-API.html#cb423-14" tabindex="-1"></a>    <span class="dt">municipality</span><span class="op">:</span> <span class="st">&#39;CELJE&#39;</span><span class="op">,</span></span>
<span id="cb423-15"><a href="PB-REST-API.html#cb423-15" tabindex="-1"></a>    <span class="dt">coordinates</span><span class="op">:</span> [ <span class="fl">46.2195704036</span><span class="op">,</span> <span class="fl">15.272580993</span> ]<span class="op">,</span></span>
<span id="cb423-16"><a href="PB-REST-API.html#cb423-16" tabindex="-1"></a>    <span class="dt">synonyms</span><span class="op">:</span> [ <span class="st">&#39;Gornje Celje&#39;</span><span class="op">,</span> <span class="st">&#39;Stari grad&#39;</span><span class="op">,</span> <span class="st">&#39;Cylie&#39;</span> ]<span class="op">,</span></span>
<span id="cb423-17"><a href="PB-REST-API.html#cb423-17" tabindex="-1"></a>    <span class="dt">datation</span><span class="op">:</span> <span class="st">&#39;12. stol., prva četrtina 14. stol., 1323, druga polovica 16. stol., 1566-1579&#39;</span><span class="op">,</span></span>
<span id="cb423-18"><a href="PB-REST-API.html#cb423-18" tabindex="-1"></a>    <span class="dt">fields</span><span class="op">:</span> [ <span class="st">&#39;umetnostna zgodovina&#39;</span><span class="op">,</span> <span class="st">&#39;arheologija&#39;</span> ]</span>
<span id="cb423-19"><a href="PB-REST-API.html#cb423-19" tabindex="-1"></a>  }</span>
<span id="cb423-20"><a href="PB-REST-API.html#cb423-20" tabindex="-1"></a>]</span>
<span id="cb423-21"><a href="PB-REST-API.html#cb423-21" tabindex="-1"></a></span>
<span id="cb423-22"><a href="PB-REST-API.html#cb423-22" tabindex="-1"></a>Demo<span class="op">&gt;</span> </span></code></pre></div>
<p>Trenutni dokument, ki hrani podatke o lokaciji, ni popoln, saj ne vsebuje komentarjev. Komentarje želimo hraniti kot odvisne dokumente lokaciji, kar lahko dosežemo s <strong>posodobitvijo obstoječega dokumenta</strong> z ukazom <a href="https://www.mongodb.com/docs/manual/reference/method/db.collection.updateOne/"><span class="skupaj"><i class="fa-solid fa-database"></i><code>db.Locations.updateOne({ ... }, { ... })</code></span></a>.</p>
<p>Z ukazom <code>db.Locations.updateOne({ name: 'Celje - Celjski grad' }, { $push: { ... } })</code> obstoječemu dokumentu lokacije, ki ima naziv <code>Celje - Celjski grad</code>, dodamo nov komentar. Pri uspešni izvedbi ukaza opazimo, da je poizvedba za posodobitev podatkov (1. parameter klica metode) našla 1 zapis in ga tudi spremenila oz. mu dodala podani komentar (2. parameter klica metode).</p>
<div class="sourceCode" id="cb424"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb424-1"><a href="PB-REST-API.html#cb424-1" tabindex="-1"></a><span class="op">&gt;</span> db<span class="op">.</span><span class="at">Locations</span><span class="op">.</span><span class="fu">updateOne</span>({</span>
<span id="cb424-2"><a href="PB-REST-API.html#cb424-2" tabindex="-1"></a>    <span class="dt">name</span><span class="op">:</span> <span class="st">&quot;Celje - Celjski grad&quot;</span></span>
<span id="cb424-3"><a href="PB-REST-API.html#cb424-3" tabindex="-1"></a>  }<span class="op">,</span> {</span>
<span id="cb424-4"><a href="PB-REST-API.html#cb424-4" tabindex="-1"></a>    <span class="dt">$push</span><span class="op">:</span> {</span>
<span id="cb424-5"><a href="PB-REST-API.html#cb424-5" tabindex="-1"></a>      <span class="dt">comments</span><span class="op">:</span> {</span>
<span id="cb424-6"><a href="PB-REST-API.html#cb424-6" tabindex="-1"></a>        <span class="dt">_id</span><span class="op">:</span> <span class="fu">ObjectId</span>()<span class="op">,</span></span>
<span id="cb424-7"><a href="PB-REST-API.html#cb424-7" tabindex="-1"></a>        <span class="dt">author</span><span class="op">:</span> <span class="st">&quot;Dejan Lavbič&quot;</span><span class="op">,</span></span>
<span id="cb424-8"><a href="PB-REST-API.html#cb424-8" tabindex="-1"></a>        <span class="dt">rating</span><span class="op">:</span> <span class="dv">5</span><span class="op">,</span></span>
<span id="cb424-9"><a href="PB-REST-API.html#cb424-9" tabindex="-1"></a>        <span class="dt">datum</span><span class="op">:</span> <span class="kw">new</span> <span class="bu">Date</span>(<span class="st">&quot;Apr 4, 2010&quot;</span>)<span class="op">,</span></span>
<span id="cb424-10"><a href="PB-REST-API.html#cb424-10" tabindex="-1"></a>        <span class="dt">comment</span><span class="op">:</span> <span class="st">&quot;Odlična lokacija, ne morem je prehvaliti.&quot;</span></span>
<span id="cb424-11"><a href="PB-REST-API.html#cb424-11" tabindex="-1"></a>      }</span>
<span id="cb424-12"><a href="PB-REST-API.html#cb424-12" tabindex="-1"></a>    }</span>
<span id="cb424-13"><a href="PB-REST-API.html#cb424-13" tabindex="-1"></a>  })</span>
<span id="cb424-14"><a href="PB-REST-API.html#cb424-14" tabindex="-1"></a>{</span>
<span id="cb424-15"><a href="PB-REST-API.html#cb424-15" tabindex="-1"></a>  <span class="dt">acknowledged</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb424-16"><a href="PB-REST-API.html#cb424-16" tabindex="-1"></a>  <span class="dt">insertedId</span><span class="op">:</span> <span class="kw">null</span><span class="op">,</span></span>
<span id="cb424-17"><a href="PB-REST-API.html#cb424-17" tabindex="-1"></a>  <span class="dt">matchedCount</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb424-18"><a href="PB-REST-API.html#cb424-18" tabindex="-1"></a>  <span class="dt">modifiedCount</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb424-19"><a href="PB-REST-API.html#cb424-19" tabindex="-1"></a>  <span class="dt">upsertedCount</span><span class="op">:</span> <span class="dv">0</span></span>
<span id="cb424-20"><a href="PB-REST-API.html#cb424-20" tabindex="-1"></a>}</span></code></pre></div>
<p>Lahko dodamo še en komentar.</p>
<div class="sourceCode" id="cb425"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb425-1"><a href="PB-REST-API.html#cb425-1" tabindex="-1"></a><span class="op">&gt;</span> db<span class="op">.</span><span class="at">Locations</span><span class="op">.</span><span class="fu">updateOne</span>({</span>
<span id="cb425-2"><a href="PB-REST-API.html#cb425-2" tabindex="-1"></a>    <span class="dt">name</span><span class="op">:</span> <span class="st">&quot;Celje - Celjski grad&quot;</span></span>
<span id="cb425-3"><a href="PB-REST-API.html#cb425-3" tabindex="-1"></a>  }<span class="op">,</span> {</span>
<span id="cb425-4"><a href="PB-REST-API.html#cb425-4" tabindex="-1"></a>    <span class="dt">$push</span><span class="op">:</span> {</span>
<span id="cb425-5"><a href="PB-REST-API.html#cb425-5" tabindex="-1"></a>      <span class="dt">comments</span><span class="op">:</span> {</span>
<span id="cb425-6"><a href="PB-REST-API.html#cb425-6" tabindex="-1"></a>        <span class="dt">_id</span><span class="op">:</span> <span class="fu">ObjectId</span>()<span class="op">,</span></span>
<span id="cb425-7"><a href="PB-REST-API.html#cb425-7" tabindex="-1"></a>        <span class="dt">avtor</span><span class="op">:</span> <span class="st">&quot;Vladimir Putin&quot;</span><span class="op">,</span></span>
<span id="cb425-8"><a href="PB-REST-API.html#cb425-8" tabindex="-1"></a>        <span class="dt">ocena</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb425-9"><a href="PB-REST-API.html#cb425-9" tabindex="-1"></a>        <span class="dt">datum</span><span class="op">:</span> <span class="kw">new</span> <span class="bu">Date</span>(<span class="st">&quot;Jul 30, 2016&quot;</span>)<span class="op">,</span></span>
<span id="cb425-10"><a href="PB-REST-API.html#cb425-10" tabindex="-1"></a>        <span class="dt">besediloKomentarja</span><span class="op">:</span> <span class="st">&quot;Čisti dolgčas, še kava je zanič. Edina svetla točka je razstava mučilnih naprav.&quot;</span></span>
<span id="cb425-11"><a href="PB-REST-API.html#cb425-11" tabindex="-1"></a>      }</span>
<span id="cb425-12"><a href="PB-REST-API.html#cb425-12" tabindex="-1"></a>    }</span>
<span id="cb425-13"><a href="PB-REST-API.html#cb425-13" tabindex="-1"></a>  })</span>
<span id="cb425-14"><a href="PB-REST-API.html#cb425-14" tabindex="-1"></a>{</span>
<span id="cb425-15"><a href="PB-REST-API.html#cb425-15" tabindex="-1"></a>  <span class="dt">acknowledged</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb425-16"><a href="PB-REST-API.html#cb425-16" tabindex="-1"></a>  <span class="dt">insertedId</span><span class="op">:</span> <span class="kw">null</span><span class="op">,</span></span>
<span id="cb425-17"><a href="PB-REST-API.html#cb425-17" tabindex="-1"></a>  <span class="dt">matchedCount</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb425-18"><a href="PB-REST-API.html#cb425-18" tabindex="-1"></a>  <span class="dt">modifiedCount</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb425-19"><a href="PB-REST-API.html#cb425-19" tabindex="-1"></a>  <span class="dt">upsertedCount</span><span class="op">:</span> <span class="dv">0</span></span>
<span id="cb425-20"><a href="PB-REST-API.html#cb425-20" tabindex="-1"></a>}</span></code></pre></div>
<script>
  $(document).ready(function() {
    $("#Uporaba-MongoDB-ukazne-lupine-za-dodajanje-podatkov code:eq(3)").markRegExp(/docker.+/, options_dodaj);
    $("#Uporaba-MongoDB-ukazne-lupine-za-dodajanje-podatkov code:eq(5)").markRegExp(/show dbs/, options_dodaj);
    $("#Uporaba-MongoDB-ukazne-lupine-za-dodajanje-podatkov code:eq(8)").markRegExp(/use .+/, options_dodaj);
    $("#Uporaba-MongoDB-ukazne-lupine-za-dodajanje-podatkov code:eq(10)").markRegExp(/show collections/, options_dodaj);
    $("#Uporaba-MongoDB-ukazne-lupine-za-dodajanje-podatkov code:eq(13)").markRegExp(/db\.Locations\.insertOne[\s\S]+?}\)/, options_dodaj);
    $("#Uporaba-MongoDB-ukazne-lupine-za-dodajanje-podatkov code:eq(21)").markRegExp(/_id:.+?\)/, options_dodaj);
    $("#Uporaba-MongoDB-ukazne-lupine-za-dodajanje-podatkov code:eq(21)").markRegExp(/db\.Locations\.find.+/, options_dodaj);
    $("#Uporaba-MongoDB-ukazne-lupine-za-dodajanje-podatkov code:eq(25)").markRegExp(/db\.Locations\.updateOne[\s\S]+?}\)/, options_dodaj);
    $("#Uporaba-MongoDB-ukazne-lupine-za-dodajanje-podatkov code:eq(26)").markRegExp(/db\.Locations\.updateOne[\s\S]+?}\)/, options_dodaj);
  });
</script>
</div>
<div id="uvoz-testnih-podatkov" class="section level3 hasAnchor" number="6.1.6">
<h3><span class="header-section-number">6.1.6</span> Uvoz testnih podatkov<a href="PB-REST-API.html#uvoz-testnih-podatkov" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Za lažji uvoz testnih podatkov bomo uporabili podatke iz registra kulturne dediščine v obliki CSV iz datoteke <code>kulturne-dediscine.csv</code>, ki smo jih predstavili že v poglavju <a href="PB-REST-API.html#podatki-iz-registra">6.1.3</a>.</p>
<p>Najprej bomo podatke iz oblike <i class="fa-solid fa-file-csv"></i>CSV pretvorili v obliko <i class="fa-solid fa-file-code"></i>JSON in jih nekoliko preoblikovali, da bodo ustrezni za našo shemo. Pomagali si bomo z enostavnim programom v <code>db-import.js</code>, ki je predstavljen v nadaljevanju.</p>
<p><code>data/db-import.js</code></p>
<div class="sourceCode" id="cb426"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb426-1"><a href="PB-REST-API.html#cb426-1" tabindex="-1"></a><span class="kw">const</span> fs <span class="op">=</span> <span class="pp">require</span>(<span class="st">&quot;fs&quot;</span>)<span class="op">;</span></span>
<span id="cb426-2"><a href="PB-REST-API.html#cb426-2" tabindex="-1"></a><span class="kw">const</span> mongoose <span class="op">=</span> <span class="pp">require</span>(<span class="st">&quot;mongoose&quot;</span>)<span class="op">;</span></span>
<span id="cb426-3"><a href="PB-REST-API.html#cb426-3" tabindex="-1"></a></span>
<span id="cb426-4"><a href="PB-REST-API.html#cb426-4" tabindex="-1"></a><span class="kw">let</span> comments <span class="op">=</span> [</span>
<span id="cb426-5"><a href="PB-REST-API.html#cb426-5" tabindex="-1"></a>  {</span>
<span id="cb426-6"><a href="PB-REST-API.html#cb426-6" tabindex="-1"></a>    <span class="dt">name</span><span class="op">:</span> <span class="st">&quot;Celje - Celjski grad&quot;</span><span class="op">,</span></span>
<span id="cb426-7"><a href="PB-REST-API.html#cb426-7" tabindex="-1"></a>    <span class="dt">comments</span><span class="op">:</span> [</span>
<span id="cb426-8"><a href="PB-REST-API.html#cb426-8" tabindex="-1"></a>      {</span>
<span id="cb426-9"><a href="PB-REST-API.html#cb426-9" tabindex="-1"></a>        <span class="dt">_id</span><span class="op">:</span> { <span class="dt">$oid</span><span class="op">:</span> <span class="kw">new</span> mongoose<span class="op">.</span><span class="at">mongo</span><span class="op">.</span><span class="fu">ObjectId</span>() }<span class="op">,</span></span>
<span id="cb426-10"><a href="PB-REST-API.html#cb426-10" tabindex="-1"></a>        <span class="dt">author</span><span class="op">:</span> <span class="st">&quot;Dejan Lavbič&quot;</span><span class="op">,</span></span>
<span id="cb426-11"><a href="PB-REST-API.html#cb426-11" tabindex="-1"></a>        <span class="dt">rating</span><span class="op">:</span> <span class="dv">5</span><span class="op">,</span></span>
<span id="cb426-12"><a href="PB-REST-API.html#cb426-12" tabindex="-1"></a>        <span class="dt">comment</span><span class="op">:</span> <span class="st">&quot;Odlična lokacija, ne morem je prehvaliti.&quot;</span><span class="op">,</span></span>
<span id="cb426-13"><a href="PB-REST-API.html#cb426-13" tabindex="-1"></a>        <span class="dt">createdOn</span><span class="op">:</span> { <span class="dt">$date</span><span class="op">:</span> <span class="st">&quot;2010-04-04T00:00:00Z&quot;</span> }<span class="op">,</span></span>
<span id="cb426-14"><a href="PB-REST-API.html#cb426-14" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb426-15"><a href="PB-REST-API.html#cb426-15" tabindex="-1"></a>      {</span>
<span id="cb426-16"><a href="PB-REST-API.html#cb426-16" tabindex="-1"></a>        <span class="dt">_id</span><span class="op">:</span> { <span class="dt">$oid</span><span class="op">:</span> <span class="kw">new</span> mongoose<span class="op">.</span><span class="at">mongo</span><span class="op">.</span><span class="fu">ObjectId</span>() }<span class="op">,</span></span>
<span id="cb426-17"><a href="PB-REST-API.html#cb426-17" tabindex="-1"></a>        <span class="dt">author</span><span class="op">:</span> <span class="st">&quot;Vladimir Putin&quot;</span><span class="op">,</span></span>
<span id="cb426-18"><a href="PB-REST-API.html#cb426-18" tabindex="-1"></a>        <span class="dt">rating</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb426-19"><a href="PB-REST-API.html#cb426-19" tabindex="-1"></a>        <span class="dt">comment</span><span class="op">:</span></span>
<span id="cb426-20"><a href="PB-REST-API.html#cb426-20" tabindex="-1"></a>          <span class="st">&quot;Čisti dolgčas, še kava je zanič. Edina svetla točka je razstava mučilnih naprav.&quot;</span><span class="op">,</span></span>
<span id="cb426-21"><a href="PB-REST-API.html#cb426-21" tabindex="-1"></a>        <span class="dt">createdOn</span><span class="op">:</span> { <span class="dt">$date</span><span class="op">:</span> <span class="st">&quot;2016-07-30T00:00:00Z&quot;</span> }<span class="op">,</span></span>
<span id="cb426-22"><a href="PB-REST-API.html#cb426-22" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb426-23"><a href="PB-REST-API.html#cb426-23" tabindex="-1"></a>    ]<span class="op">,</span></span>
<span id="cb426-24"><a href="PB-REST-API.html#cb426-24" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb426-25"><a href="PB-REST-API.html#cb426-25" tabindex="-1"></a>  {</span>
<span id="cb426-26"><a href="PB-REST-API.html#cb426-26" tabindex="-1"></a>    <span class="dt">name</span><span class="op">:</span> <span class="st">&quot;Ljubljana - Cankarjeva spominska soba na Rožniku&quot;</span><span class="op">,</span></span>
<span id="cb426-27"><a href="PB-REST-API.html#cb426-27" tabindex="-1"></a>    <span class="dt">comments</span><span class="op">:</span> [</span>
<span id="cb426-28"><a href="PB-REST-API.html#cb426-28" tabindex="-1"></a>      {</span>
<span id="cb426-29"><a href="PB-REST-API.html#cb426-29" tabindex="-1"></a>        <span class="dt">_id</span><span class="op">:</span> { <span class="dt">$oid</span><span class="op">:</span> <span class="kw">new</span> mongoose<span class="op">.</span><span class="at">mongo</span><span class="op">.</span><span class="fu">ObjectId</span>() }<span class="op">,</span></span>
<span id="cb426-30"><a href="PB-REST-API.html#cb426-30" tabindex="-1"></a>        <span class="dt">author</span><span class="op">:</span> <span class="st">&quot;Ivan Cankar&quot;</span><span class="op">,</span></span>
<span id="cb426-31"><a href="PB-REST-API.html#cb426-31" tabindex="-1"></a>        <span class="dt">rating</span><span class="op">:</span> <span class="dv">4</span><span class="op">,</span></span>
<span id="cb426-32"><a href="PB-REST-API.html#cb426-32" tabindex="-1"></a>        <span class="dt">comment</span><span class="op">:</span> <span class="st">&quot;Nič ni več tako kot je bilo.&quot;</span><span class="op">,</span></span>
<span id="cb426-33"><a href="PB-REST-API.html#cb426-33" tabindex="-1"></a>        <span class="dt">createdOn</span><span class="op">:</span> { <span class="dt">$date</span><span class="op">:</span> <span class="st">&quot;1918-12-11T00:00:00Z&quot;</span> }<span class="op">,</span></span>
<span id="cb426-34"><a href="PB-REST-API.html#cb426-34" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb426-35"><a href="PB-REST-API.html#cb426-35" tabindex="-1"></a>    ]<span class="op">,</span></span>
<span id="cb426-36"><a href="PB-REST-API.html#cb426-36" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb426-37"><a href="PB-REST-API.html#cb426-37" tabindex="-1"></a>]<span class="op">;</span></span>
<span id="cb426-38"><a href="PB-REST-API.html#cb426-38" tabindex="-1"></a></span>
<span id="cb426-39"><a href="PB-REST-API.html#cb426-39" tabindex="-1"></a><span class="kw">let</span> locations <span class="op">=</span> fs</span>
<span id="cb426-40"><a href="PB-REST-API.html#cb426-40" tabindex="-1"></a>  <span class="op">.</span><span class="fu">readFileSync</span>(<span class="st">&quot;./kulturne-dediscine.csv&quot;</span><span class="op">,</span> <span class="st">&quot;utf8&quot;</span>)</span>
<span id="cb426-41"><a href="PB-REST-API.html#cb426-41" tabindex="-1"></a>  <span class="op">.</span><span class="fu">split</span>(<span class="st">&quot;</span><span class="sc">\r\n</span><span class="st">&quot;</span>)</span>
<span id="cb426-42"><a href="PB-REST-API.html#cb426-42" tabindex="-1"></a>  <span class="op">.</span><span class="fu">filter</span>((v) <span class="kw">=&gt;</span> v<span class="op">.</span><span class="at">length</span> <span class="op">&gt;</span> <span class="dv">0</span> <span class="op">&amp;&amp;</span> v<span class="op">.</span><span class="fu">indexOf</span>(<span class="st">&quot;ESD&quot;</span>) <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb426-43"><a href="PB-REST-API.html#cb426-43" tabindex="-1"></a>  <span class="op">.</span><span class="fu">map</span>((x) <span class="kw">=&gt;</span> {</span>
<span id="cb426-44"><a href="PB-REST-API.html#cb426-44" tabindex="-1"></a>    <span class="kw">let</span> row <span class="op">=</span> <span class="st">&quot;&quot;</span><span class="op">,</span></span>
<span id="cb426-45"><a href="PB-REST-API.html#cb426-45" tabindex="-1"></a>      split <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb426-46"><a href="PB-REST-API.html#cb426-46" tabindex="-1"></a>    <span class="cf">for</span> (<span class="kw">const</span> element <span class="kw">of</span> x) {</span>
<span id="cb426-47"><a href="PB-REST-API.html#cb426-47" tabindex="-1"></a>      split <span class="op">=</span> element <span class="op">==</span> <span class="st">&#39;&quot;&#39;</span> <span class="op">?</span> <span class="op">!</span>split <span class="op">:</span> split<span class="op">;</span></span>
<span id="cb426-48"><a href="PB-REST-API.html#cb426-48" tabindex="-1"></a>      row <span class="op">+=</span> element <span class="op">==</span> <span class="st">&quot;,&quot;</span> <span class="op">&amp;&amp;</span> <span class="op">!</span>split <span class="op">?</span> <span class="st">&quot;|&quot;</span> <span class="op">:</span> element<span class="op">;</span></span>
<span id="cb426-49"><a href="PB-REST-API.html#cb426-49" tabindex="-1"></a>    }</span>
<span id="cb426-50"><a href="PB-REST-API.html#cb426-50" tabindex="-1"></a>    row <span class="op">=</span> row<span class="op">.</span><span class="fu">replace</span>(<span class="ss">/&quot;/g</span><span class="op">,</span> <span class="st">&quot;&quot;</span>)<span class="op">.</span><span class="fu">replace</span>(<span class="ss">/</span><span class="sc">\s+</span><span class="ss">/g</span><span class="op">,</span> <span class="st">&quot; &quot;</span>)<span class="op">.</span><span class="fu">split</span>(<span class="st">&quot;|&quot;</span>)<span class="op">;</span></span>
<span id="cb426-51"><a href="PB-REST-API.html#cb426-51" tabindex="-1"></a>    <span class="kw">let</span> y <span class="op">=</span> {</span>
<span id="cb426-52"><a href="PB-REST-API.html#cb426-52" tabindex="-1"></a>      <span class="dt">_id</span><span class="op">:</span> { <span class="dt">$oid</span><span class="op">:</span> <span class="kw">new</span> mongoose<span class="op">.</span><span class="at">mongo</span><span class="op">.</span><span class="fu">ObjectId</span>() }<span class="op">,</span></span>
<span id="cb426-53"><a href="PB-REST-API.html#cb426-53" tabindex="-1"></a>      <span class="dt">id</span><span class="op">:</span> <span class="pp">parseInt</span>(row[<span class="dv">0</span>]<span class="op">,</span> <span class="dv">10</span>)<span class="op">,</span></span>
<span id="cb426-54"><a href="PB-REST-API.html#cb426-54" tabindex="-1"></a>      <span class="dt">name</span><span class="op">:</span> row[<span class="dv">1</span>]<span class="op">,</span></span>
<span id="cb426-55"><a href="PB-REST-API.html#cb426-55" tabindex="-1"></a>      <span class="dt">category</span><span class="op">:</span> row[<span class="dv">3</span>]<span class="op">,</span></span>
<span id="cb426-56"><a href="PB-REST-API.html#cb426-56" tabindex="-1"></a>      <span class="dt">type</span><span class="op">:</span> row[<span class="dv">4</span>]<span class="op">,</span></span>
<span id="cb426-57"><a href="PB-REST-API.html#cb426-57" tabindex="-1"></a>      <span class="dt">keywords</span><span class="op">:</span> row[<span class="dv">5</span>]<span class="op">.</span><span class="fu">split</span>(<span class="st">&quot;, &quot;</span>)<span class="op">,</span></span>
<span id="cb426-58"><a href="PB-REST-API.html#cb426-58" tabindex="-1"></a>      <span class="dt">description</span><span class="op">:</span> row[<span class="dv">6</span>]<span class="op">,</span></span>
<span id="cb426-59"><a href="PB-REST-API.html#cb426-59" tabindex="-1"></a>      <span class="dt">location</span><span class="op">:</span> row[<span class="dv">9</span>]<span class="op">,</span></span>
<span id="cb426-60"><a href="PB-REST-API.html#cb426-60" tabindex="-1"></a>      <span class="dt">institution</span><span class="op">:</span> row[<span class="dv">11</span>]<span class="op">,</span></span>
<span id="cb426-61"><a href="PB-REST-API.html#cb426-61" tabindex="-1"></a>      <span class="dt">heritage</span><span class="op">:</span> row[<span class="dv">12</span>]<span class="op">,</span></span>
<span id="cb426-62"><a href="PB-REST-API.html#cb426-62" tabindex="-1"></a>      <span class="dt">municipality</span><span class="op">:</span> row[<span class="dv">13</span>]<span class="op">,</span></span>
<span id="cb426-63"><a href="PB-REST-API.html#cb426-63" tabindex="-1"></a>      <span class="dt">coordinates</span><span class="op">:</span> [<span class="pp">parseFloat</span>(row[<span class="dv">17</span>])<span class="op">,</span> <span class="pp">parseFloat</span>(row[<span class="dv">16</span>])]<span class="op">,</span></span>
<span id="cb426-64"><a href="PB-REST-API.html#cb426-64" tabindex="-1"></a>    }<span class="op">;</span></span>
<span id="cb426-65"><a href="PB-REST-API.html#cb426-65" tabindex="-1"></a>    <span class="cf">if</span> (row[<span class="dv">2</span>]<span class="op">.</span><span class="at">length</span> <span class="op">&gt;</span> <span class="dv">0</span>) y<span class="op">.</span><span class="at">synonyms</span> <span class="op">=</span> row[<span class="dv">2</span>]<span class="op">.</span><span class="fu">split</span>(<span class="st">&quot;, &quot;</span>)<span class="op">;</span></span>
<span id="cb426-66"><a href="PB-REST-API.html#cb426-66" tabindex="-1"></a>    <span class="cf">if</span> (row[<span class="dv">7</span>]<span class="op">.</span><span class="at">length</span> <span class="op">&gt;</span> <span class="dv">0</span>) y<span class="op">.</span><span class="at">datation</span> <span class="op">=</span> row[<span class="dv">7</span>]<span class="op">;</span></span>
<span id="cb426-67"><a href="PB-REST-API.html#cb426-67" tabindex="-1"></a>    <span class="cf">if</span> (row[<span class="dv">8</span>]<span class="op">.</span><span class="at">length</span> <span class="op">&gt;</span> <span class="dv">0</span>) y<span class="op">.</span><span class="at">authors</span> <span class="op">=</span> row[<span class="dv">8</span>]<span class="op">;</span></span>
<span id="cb426-68"><a href="PB-REST-API.html#cb426-68" tabindex="-1"></a>    <span class="cf">if</span> (row[<span class="dv">10</span>]<span class="op">.</span><span class="at">length</span> <span class="op">&gt;</span> <span class="dv">0</span>) y<span class="op">.</span><span class="at">fields</span> <span class="op">=</span> row[<span class="dv">10</span>]<span class="op">.</span><span class="fu">split</span>(<span class="st">&quot;, &quot;</span>)<span class="op">;</span></span>
<span id="cb426-69"><a href="PB-REST-API.html#cb426-69" tabindex="-1"></a>    <span class="kw">let</span> comment <span class="op">=</span> comments<span class="op">.</span><span class="fu">find</span>((v) <span class="kw">=&gt;</span> v<span class="op">.</span><span class="at">name</span> <span class="op">==</span> y<span class="op">.</span><span class="at">name</span>)<span class="op">;</span></span>
<span id="cb426-70"><a href="PB-REST-API.html#cb426-70" tabindex="-1"></a>    <span class="cf">if</span> (comment) {</span>
<span id="cb426-71"><a href="PB-REST-API.html#cb426-71" tabindex="-1"></a>      <span class="kw">let</span> averageRating <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb426-72"><a href="PB-REST-API.html#cb426-72" tabindex="-1"></a>      averageRating <span class="op">=</span> <span class="pp">parseInt</span>(</span>
<span id="cb426-73"><a href="PB-REST-API.html#cb426-73" tabindex="-1"></a>        comment<span class="op">.</span><span class="at">comments</span><span class="op">.</span><span class="fu">reduce</span>((acc<span class="op">,</span> { rating }) <span class="kw">=&gt;</span> {</span>
<span id="cb426-74"><a href="PB-REST-API.html#cb426-74" tabindex="-1"></a>          <span class="cf">return</span> acc <span class="op">+</span> rating<span class="op">;</span></span>
<span id="cb426-75"><a href="PB-REST-API.html#cb426-75" tabindex="-1"></a>        }<span class="op">,</span> <span class="dv">0</span>) <span class="op">/</span> comment<span class="op">.</span><span class="at">comments</span><span class="op">.</span><span class="at">length</span><span class="op">,</span></span>
<span id="cb426-76"><a href="PB-REST-API.html#cb426-76" tabindex="-1"></a>        <span class="dv">10</span></span>
<span id="cb426-77"><a href="PB-REST-API.html#cb426-77" tabindex="-1"></a>      )<span class="op">;</span></span>
<span id="cb426-78"><a href="PB-REST-API.html#cb426-78" tabindex="-1"></a>      y<span class="op">.</span><span class="at">comments</span> <span class="op">=</span> comment<span class="op">.</span><span class="at">comments</span><span class="op">;</span></span>
<span id="cb426-79"><a href="PB-REST-API.html#cb426-79" tabindex="-1"></a>      y<span class="op">.</span><span class="at">rating</span> <span class="op">=</span> averageRating<span class="op">;</span></span>
<span id="cb426-80"><a href="PB-REST-API.html#cb426-80" tabindex="-1"></a>    }</span>
<span id="cb426-81"><a href="PB-REST-API.html#cb426-81" tabindex="-1"></a>    <span class="cf">return</span> y<span class="op">;</span></span>
<span id="cb426-82"><a href="PB-REST-API.html#cb426-82" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb426-83"><a href="PB-REST-API.html#cb426-83" tabindex="-1"></a></span>
<span id="cb426-84"><a href="PB-REST-API.html#cb426-84" tabindex="-1"></a>fs<span class="op">.</span><span class="fu">writeFileSync</span>(</span>
<span id="cb426-85"><a href="PB-REST-API.html#cb426-85" tabindex="-1"></a>  <span class="st">&quot;./kulturne-dediscine.json&quot;</span><span class="op">,</span></span>
<span id="cb426-86"><a href="PB-REST-API.html#cb426-86" tabindex="-1"></a>  <span class="bu">JSON</span><span class="op">.</span><span class="fu">stringify</span>(locations<span class="op">,</span> <span class="kw">null</span><span class="op">,</span> <span class="dv">2</span>)</span>
<span id="cb426-87"><a href="PB-REST-API.html#cb426-87" tabindex="-1"></a>)<span class="op">;</span></span></code></pre></div>
<p>Pretvorbo izvedemo z naslednjimi ukazi:</p>
<div class="sourceCode" id="cb427"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb427-1"><a href="PB-REST-API.html#cb427-1" tabindex="-1"></a><span class="ex">$</span> cd data</span>
<span id="cb427-2"><a href="PB-REST-API.html#cb427-2" tabindex="-1"></a><span class="ex">$</span> node ./db-import.js</span></code></pre></div>
<p>Z omenjenim procesom smo podatke iz vhodne datoteke <code>kulturne-dediscine.csv</code> pretvorili v podatke izhodne datoteko <code>kulturne-dediscine.json</code> ter dodali nekaj testnih komentarjev. V nadaljevanju je prikazan primer podatkov iz obeh datotek.</p>
<p><i class="fa-solid fa-file-import"></i><code>data/kulturne-dediscine.csv</code></p>
<pre class="csv"><code>ESD,Ime,Sinonimi,Zvrst,Tip,Gesla,Opis,Datacija,Avtorji,LokacijaOp,Podrocja,Zavod,Varstvo,Obcina,Y,X,WGS X,WGS Y
29884,Šentrupert na Dolenjskem - Muzej na prostem,,stavbe,profana stavbna dediščina,&quot;muzej na prostem, kozolec na psa, kozolec s plaščem, enojni kozolec, nizki kozolec, toplar, vzporedni kozolec&quot;,Muzej na prostem sestavljajo skupina 17 kozolcev različnih tipov in dve enostavni sušilni napravi (belokranjska ostrv in ribniški kozouček). Postavitev iz 2012 prikazuje genezo kozolca na Slovenskem in raznolikost kozolcev v Mirnski dolini.,&quot;zadnja četrtina 18. stol., 19. stol., prva polovica 20. stol., prva četrtina 21. stol., 2012&quot;,,Muzej na prostem je urejen na južnem obrobju Šentruperta na Dolenjskem.,&quot;etnologija, krajinska arhitektura, tehniška zgodovina&quot;,ZVKD Novo mesto,spomenik lokalnega pomena,ŠENTRUPERT,507458,92302,45.9748324693,15.0914351743
...</code></pre>
<p><i class="fa-solid fa-file-export"></i><code>data/kulturne-dediscine.json</code></p>
<div class="sourceCode" id="cb429"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb429-1"><a href="PB-REST-API.html#cb429-1" tabindex="-1"></a><span class="ot">[</span></span>
<span id="cb429-2"><a href="PB-REST-API.html#cb429-2" tabindex="-1"></a>  <span class="fu">{</span></span>
<span id="cb429-3"><a href="PB-REST-API.html#cb429-3" tabindex="-1"></a>    <span class="dt">&quot;_id&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb429-4"><a href="PB-REST-API.html#cb429-4" tabindex="-1"></a>      <span class="dt">&quot;$oid&quot;</span><span class="fu">:</span> <span class="st">&quot;635a62f5dc5d7968e68464c1&quot;</span></span>
<span id="cb429-5"><a href="PB-REST-API.html#cb429-5" tabindex="-1"></a>    <span class="fu">},</span></span>
<span id="cb429-6"><a href="PB-REST-API.html#cb429-6" tabindex="-1"></a>    <span class="dt">&quot;id&quot;</span><span class="fu">:</span> <span class="dv">29884</span><span class="fu">,</span></span>
<span id="cb429-7"><a href="PB-REST-API.html#cb429-7" tabindex="-1"></a>    <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;Šentrupert na Dolenjskem - Muzej na prostem&quot;</span><span class="fu">,</span></span>
<span id="cb429-8"><a href="PB-REST-API.html#cb429-8" tabindex="-1"></a>    <span class="dt">&quot;category&quot;</span><span class="fu">:</span> <span class="st">&quot;stavbe&quot;</span><span class="fu">,</span></span>
<span id="cb429-9"><a href="PB-REST-API.html#cb429-9" tabindex="-1"></a>    <span class="dt">&quot;type&quot;</span><span class="fu">:</span> <span class="st">&quot;profana stavbna dediščina&quot;</span><span class="fu">,</span></span>
<span id="cb429-10"><a href="PB-REST-API.html#cb429-10" tabindex="-1"></a>    <span class="dt">&quot;keywords&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb429-11"><a href="PB-REST-API.html#cb429-11" tabindex="-1"></a>      <span class="st">&quot;muzej na prostem&quot;</span><span class="ot">,</span></span>
<span id="cb429-12"><a href="PB-REST-API.html#cb429-12" tabindex="-1"></a>      <span class="st">&quot;kozolec na psa&quot;</span><span class="ot">,</span></span>
<span id="cb429-13"><a href="PB-REST-API.html#cb429-13" tabindex="-1"></a>      <span class="st">&quot;kozolec s plaščem&quot;</span><span class="ot">,</span></span>
<span id="cb429-14"><a href="PB-REST-API.html#cb429-14" tabindex="-1"></a>      <span class="st">&quot;enojni kozolec&quot;</span><span class="ot">,</span></span>
<span id="cb429-15"><a href="PB-REST-API.html#cb429-15" tabindex="-1"></a>      <span class="st">&quot;nizki kozolec&quot;</span><span class="ot">,</span></span>
<span id="cb429-16"><a href="PB-REST-API.html#cb429-16" tabindex="-1"></a>      <span class="st">&quot;toplar&quot;</span><span class="ot">,</span></span>
<span id="cb429-17"><a href="PB-REST-API.html#cb429-17" tabindex="-1"></a>      <span class="st">&quot;vzporedni kozolec&quot;</span></span>
<span id="cb429-18"><a href="PB-REST-API.html#cb429-18" tabindex="-1"></a>    <span class="ot">]</span><span class="fu">,</span></span>
<span id="cb429-19"><a href="PB-REST-API.html#cb429-19" tabindex="-1"></a>    <span class="dt">&quot;description&quot;</span><span class="fu">:</span> <span class="st">&quot;Muzej na prostem sestavljajo skupina 17 kozolcev različnih tipov in dve enostavni sušilni napravi (belokranjska ostrv in ribniški kozouček). Postavitev iz 2012 prikazuje genezo kozolca na Slovenskem in raznolikost kozolcev v Mirnski dolini.&quot;</span><span class="fu">,</span></span>
<span id="cb429-20"><a href="PB-REST-API.html#cb429-20" tabindex="-1"></a>    <span class="dt">&quot;location&quot;</span><span class="fu">:</span> <span class="st">&quot;Muzej na prostem je urejen na južnem obrobju Šentruperta na Dolenjskem.&quot;</span><span class="fu">,</span></span>
<span id="cb429-21"><a href="PB-REST-API.html#cb429-21" tabindex="-1"></a>    <span class="dt">&quot;institution&quot;</span><span class="fu">:</span> <span class="st">&quot;ZVKD Novo mesto&quot;</span><span class="fu">,</span></span>
<span id="cb429-22"><a href="PB-REST-API.html#cb429-22" tabindex="-1"></a>    <span class="dt">&quot;heritage&quot;</span><span class="fu">:</span> <span class="st">&quot;spomenik lokalnega pomena&quot;</span><span class="fu">,</span></span>
<span id="cb429-23"><a href="PB-REST-API.html#cb429-23" tabindex="-1"></a>    <span class="dt">&quot;municipality&quot;</span><span class="fu">:</span> <span class="st">&quot;ŠENTRUPERT&quot;</span><span class="fu">,</span></span>
<span id="cb429-24"><a href="PB-REST-API.html#cb429-24" tabindex="-1"></a>    <span class="dt">&quot;coordinates&quot;</span><span class="fu">:</span> <span class="ot">[</span><span class="fl">15.0914351743</span><span class="ot">,</span> <span class="fl">45.9748324693</span><span class="ot">]</span><span class="fu">,</span></span>
<span id="cb429-25"><a href="PB-REST-API.html#cb429-25" tabindex="-1"></a>    <span class="dt">&quot;datation&quot;</span><span class="fu">:</span> <span class="st">&quot;zadnja četrtina 18. stol., 19. stol., prva polovica 20. stol., prva četrtina 21. stol., 2012&quot;</span><span class="fu">,</span></span>
<span id="cb429-26"><a href="PB-REST-API.html#cb429-26" tabindex="-1"></a>    <span class="dt">&quot;fields&quot;</span><span class="fu">:</span> <span class="ot">[</span><span class="st">&quot;etnologija&quot;</span><span class="ot">,</span> <span class="st">&quot;krajinska arhitektura&quot;</span><span class="ot">,</span> <span class="st">&quot;tehniška zgodovina&quot;</span><span class="ot">]</span></span>
<span id="cb429-27"><a href="PB-REST-API.html#cb429-27" tabindex="-1"></a>  <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb429-28"><a href="PB-REST-API.html#cb429-28" tabindex="-1"></a>  <span class="er">...</span></span>
<span id="cb429-29"><a href="PB-REST-API.html#cb429-29" tabindex="-1"></a><span class="ot">]</span></span></code></pre></div>
<p>JSON datoteko <i class="fa-solid fa-file-export"></i><code>kulturne-dediscine.json</code> bomo sedaj najprej prenesli v <i class="fa-brands fa-docker"></i>Docker vsebnik, vse podatke uvozili in nato datoteko izbrisali.</p>
<div class="sourceCode" id="cb430"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb430-1"><a href="PB-REST-API.html#cb430-1" tabindex="-1"></a><span class="ex">$</span> cd data</span>
<span id="cb430-2"><a href="PB-REST-API.html#cb430-2" tabindex="-1"></a><span class="ex">$</span> docker cp ./kulturne-dediscine.json sp-mongo-db:/kulturne-dediscine.json</span>
<span id="cb430-3"><a href="PB-REST-API.html#cb430-3" tabindex="-1"></a><span class="ex">$</span> docker exec <span class="at">-it</span> sp-mongo-db mongoimport <span class="at">--db</span> Demo <span class="at">--collection</span> Locations <span class="at">--mode</span> upsert <span class="at">--upsertFields</span> id <span class="at">--jsonArray</span> <span class="at">--file</span> kulturne-dediscine.json</span>
<span id="cb430-4"><a href="PB-REST-API.html#cb430-4" tabindex="-1"></a><span class="ex">2022-10-20T10:48:46.091+0000</span>    connected to: mongodb://localhost/</span>
<span id="cb430-5"><a href="PB-REST-API.html#cb430-5" tabindex="-1"></a><span class="ex">2022-10-20T10:48:46.809+0000</span>    2144 document<span class="er">(</span><span class="ex">s</span><span class="kw">)</span> <span class="ex">imported</span> successfully. 0 document<span class="er">(</span><span class="ex">s</span><span class="kw">)</span> <span class="ex">failed</span> to import.</span>
<span id="cb430-6"><a href="PB-REST-API.html#cb430-6" tabindex="-1"></a><span class="ex">$</span> docker exec <span class="at">-it</span> sp-mongo-db rm <span class="at">-rf</span> kulturne-dediscine.json</span></code></pre></div>
<p>Z ukazom <code>docker exec -it sp-mongo-db bash -c "mongosh Demo --eval 'db.Locations.find()'"</code> lahko preverimo vsebino podatkovne baze in potrdimo, da je bil uvoz podatkov uspešen.</p>
<p>Za potrebe uvoza podatkov je bilo potrebno izvesti več zaporednih ukazov, ki jih lahko sedaj združimo v skripto <code>import:db-docker</code> in jo vključimo v <code>package.json</code>. Poleg tega dodajmo še skripto <code>delete:db-docker</code>, ki obstoječe lokacije iz podatkovne baze izbriše in skripto <code>view:db-docker</code>, ki nam vrne seznam lokacij v podatkovni bazi.</p>
<p><code>package.json</code></p>
<div class="sourceCode" id="cb431"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb431-1"><a href="PB-REST-API.html#cb431-1" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb431-2"><a href="PB-REST-API.html#cb431-2" tabindex="-1"></a>  <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;demo&quot;</span><span class="fu">,</span></span>
<span id="cb431-3"><a href="PB-REST-API.html#cb431-3" tabindex="-1"></a>  <span class="dt">&quot;description&quot;</span><span class="fu">:</span> <span class="st">&quot;Demo application for Web Programming course&quot;</span><span class="fu">,</span></span>
<span id="cb431-4"><a href="PB-REST-API.html#cb431-4" tabindex="-1"></a>  <span class="dt">&quot;author&quot;</span><span class="fu">:</span> <span class="st">&quot;Dejan Lavbič &lt;dejan@lavbic.net&gt;&quot;</span><span class="fu">,</span></span>
<span id="cb431-5"><a href="PB-REST-API.html#cb431-5" tabindex="-1"></a>  <span class="dt">&quot;version&quot;</span><span class="fu">:</span> <span class="st">&quot;0.1.0&quot;</span><span class="fu">,</span></span>
<span id="cb431-6"><a href="PB-REST-API.html#cb431-6" tabindex="-1"></a>  <span class="dt">&quot;private&quot;</span><span class="fu">:</span> <span class="kw">true</span><span class="fu">,</span></span>
<span id="cb431-7"><a href="PB-REST-API.html#cb431-7" tabindex="-1"></a>  <span class="dt">&quot;scripts&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb431-8"><a href="PB-REST-API.html#cb431-8" tabindex="-1"></a>    <span class="dt">&quot;start&quot;</span><span class="fu">:</span> <span class="st">&quot;node server.js&quot;</span><span class="fu">,</span></span>
<span id="cb431-9"><a href="PB-REST-API.html#cb431-9" tabindex="-1"></a>    <span class="dt">&quot;import:db-docker&quot;</span><span class="fu">:</span> <span class="st">&quot;docker cp ./data/kulturne-dediscine.json sp-mongo-db:/kulturne-dediscine.json; docker exec -it sp-mongo-db mongoimport --db Demo --collection Locations --mode upsert --upsertFields id --jsonArray --file kulturne-dediscine.json; docker exec -it sp-mongo-db rm -rf kulturne-dediscine.json&quot;</span><span class="fu">,</span></span>
<span id="cb431-10"><a href="PB-REST-API.html#cb431-10" tabindex="-1"></a>    <span class="dt">&quot;delete:db-docker&quot;</span><span class="fu">:</span> <span class="st">&quot;docker exec -it sp-mongo-db bash -c </span><span class="ch">\&quot;</span><span class="st">mongosh Demo --eval &#39;db.Locations.deleteMany({})&#39;</span><span class="ch">\&quot;</span><span class="st">&quot;</span><span class="fu">,</span></span>
<span id="cb431-11"><a href="PB-REST-API.html#cb431-11" tabindex="-1"></a>    <span class="dt">&quot;view:db-docker&quot;</span><span class="fu">:</span> <span class="st">&quot;docker exec -it sp-mongo-db bash -c </span><span class="ch">\&quot;</span><span class="st">mongosh Demo --eval &#39;db.Locations.find()&#39;</span><span class="ch">\&quot;</span><span class="st">&quot;</span></span>
<span id="cb431-12"><a href="PB-REST-API.html#cb431-12" tabindex="-1"></a>  <span class="fu">},</span></span>
<span id="cb431-13"><a href="PB-REST-API.html#cb431-13" tabindex="-1"></a>  <span class="dt">&quot;dependencies&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb431-14"><a href="PB-REST-API.html#cb431-14" tabindex="-1"></a>    <span class="dt">&quot;express&quot;</span><span class="fu">:</span> <span class="st">&quot;~4.18.2&quot;</span><span class="fu">,</span></span>
<span id="cb431-15"><a href="PB-REST-API.html#cb431-15" tabindex="-1"></a>    <span class="dt">&quot;hbs&quot;</span><span class="fu">:</span> <span class="st">&quot;~4.2.0&quot;</span><span class="fu">,</span></span>
<span id="cb431-16"><a href="PB-REST-API.html#cb431-16" tabindex="-1"></a>    <span class="dt">&quot;mongoose&quot;</span><span class="fu">:</span> <span class="st">&quot;~6.6.5&quot;</span></span>
<span id="cb431-17"><a href="PB-REST-API.html#cb431-17" tabindex="-1"></a>  <span class="fu">}</span></span>
<span id="cb431-18"><a href="PB-REST-API.html#cb431-18" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
<script>
  $(document).ready(function() {
    $("#uvoz-testnih-podatkov code:eq(2)").markRegExp(/db-import\.js/, options_dodaj)
    $("#uvoz-testnih-podatkov pre.javascript:eq(0)").markRegExp(/.+/, options_dodaj)
    $("#uvoz-testnih-podatkov pre.bash:eq(0)").markRegExp(/(cd|node).+/, options_dodaj)
    $("#uvoz-testnih-podatkov pre.bash:eq(1)").markRegExp(/(docker|cd) .+/, options_dodaj)
    $("#uvoz-testnih-podatkov pre.json:eq(1)").markRegExp(/\s+?".+?:db-docker.+/, options_dodaj)
  });
</script>
<blockquote>
<p><strong>Opomba</strong>: V operacijskih sistemih Microsoft Windows 10 je treba biti pozoren na uporabo narekovajev ukazih v privzeti ukazni vrstici <em>Command prompt</em>.</p>
</blockquote>
</div>
<div id="vključitev-podatkovne-baze" class="section level3 hasAnchor" number="6.1.7">
<h3><span class="header-section-number">6.1.7</span> Vključitev podatkovne baze<a href="PB-REST-API.html#vključitev-podatkovne-baze" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="Gostovanje-MongoDB" class="section level4 hasAnchor" number="6.1.7.1">
<h4><span class="header-section-number">6.1.7.1</span> Gostovanje MongoDB podatkovne baze na MongoDB Atlas<a href="PB-REST-API.html#Gostovanje-MongoDB" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Uporabljali bomo ponudnika MongoDB podatkovne baze v oblaku <a href="https://www.mongodb.com/cloud"><i class="fa-solid fa-database"></i>MongoDB Atlas</a>, ki v okviru <a href="https://www.mongodb.com/pricing"><i class="fa-solid fa-hand-holding-dollar"></i>brezplačnega dostopa</a> omogoča uporabo 1 podatkovne baze z do 512 MB podatkov.</p>
<p>Ko je registracija uspešna in elektronski naslov potrjen, kreiramo novo gručo <em>(angl. Cluster)</em> podatkovnih baz tipa <strong>Shared</strong>, kjer priporočamo nastavitev naslednjih parametrov:</p>
<ul>
<li>Cloud Provider &amp; Region: <strong>AWS, Frankfurt (eu-central-1)</strong>,</li>
<li>Cluster Tier: <strong>M0 Sandbox (Shared RAM, 512 MB Storage)</strong>,</li>
<li>Additional Settings: <strong>MongoDB 5.0, No Backup</strong>,</li>
<li>Cluster Name: <dodaj><strong>Demo</strong></dodaj>.</li>
</ul>
<p>Nato poskrbimo za nastavitev dostopa do podatkovne baze z izbranih lokacij (<code>Security</code> → <code>Network Access</code> → <code>Add IP address</code>), kjer je treba dodati IP naslove, ki jim je dovoljen dostop.</p>
<blockquote>
<p><strong>Priporočilo</strong>: Za potrebe testiranja lahko kot IP naslov dodate <code>0.0.0.0/0</code>, ki dovoljuje dostop s poljubne lokacije, kar sicer ni priporočljivo. To je sicer za produkcijske sisteme zelo nepriporočljivo, ker predstavlja varnostno tveganje.</p>
</blockquote>
<p>Prav tako dodajte novega uporabnika <code>app</code> (<code>Security</code> → <code>Database Access</code>), ki bo dostopal do podatkovne baze in bo imel bralni in pisalni dostop.</p>
<p>Sedaj lahko pridobite povezavo do podatkovne baze (<code>Deployment</code> → <code>Database</code> → <code>Demo</code> → <code>Connect</code> → <code>Connect your application</code> → <code>Drivers</code>), ki je v naslednji obliki:</p>
<div class="sourceCode" id="cb432"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb432-1"><a href="PB-REST-API.html#cb432-1" tabindex="-1"></a><span class="ex">mongodb+srv://app:</span><span class="op">&lt;</span>password<span class="op">&gt;</span>@demo.548y4py.mongodb.net/Demo<span class="pp">?</span>retryWrites=true<span class="kw">&amp;</span><span class="va">w</span><span class="op">=</span>majority</span></code></pre></div>
<p>Z naslednjim ukazom lahko iz lokalnega Docker okolja preverimo delovanje naše oddaljene MongoDB podatkovne baze, ki jo gostujemo na MongoDB Atlas.</p>
<blockquote>
<p><strong>Namig</strong>: Če <i class="fa-brands fa-docker"></i>Docker vsebnik z <i class="fa-solid fa-database"></i>MongoDB podatkovno bazo in odjemalcem <code>mongosh</code> ni pognan, za zagon uporabite ukaz <code>docker start sp-mongo-db</code>.</p>
</blockquote>
<div class="sourceCode" id="cb433"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb433-1"><a href="PB-REST-API.html#cb433-1" tabindex="-1"></a><span class="ex">$</span> docker exec <span class="at">-it</span> sp-mongo-db bash <span class="at">-c</span> <span class="st">&quot;mongosh </span><span class="dt">\&quot;</span><span class="st">mongodb+srv://demo.548y4py.mongodb.net/Demo</span><span class="dt">\&quot;</span><span class="st"> --username app&quot;</span></span>
<span id="cb433-2"><a href="PB-REST-API.html#cb433-2" tabindex="-1"></a><span class="ex">Enter</span> password: <span class="pp">************</span></span>
<span id="cb433-3"><a href="PB-REST-API.html#cb433-3" tabindex="-1"></a><span class="ex">Current</span> Mongosh Log ID: 64f88c9c1295cd0f415444f6</span>
<span id="cb433-4"><a href="PB-REST-API.html#cb433-4" tabindex="-1"></a><span class="ex">Connecting</span> to:          mongodb+srv://<span class="op">&lt;</span>credentials<span class="op">&gt;</span>@demo.548y4py.mongodb.net/Demo<span class="pp">?</span>appName=mongosh+1.10.6</span>
<span id="cb433-5"><a href="PB-REST-API.html#cb433-5" tabindex="-1"></a><span class="ex">Using</span> MongoDB:          6.0.9</span>
<span id="cb433-6"><a href="PB-REST-API.html#cb433-6" tabindex="-1"></a><span class="ex">Using</span> Mongosh:          1.10.6</span>
<span id="cb433-7"><a href="PB-REST-API.html#cb433-7" tabindex="-1"></a></span>
<span id="cb433-8"><a href="PB-REST-API.html#cb433-8" tabindex="-1"></a><span class="ex">Atlas</span> atlas-znx0ni-shard-0 <span class="pp">[</span><span class="ss">primary</span><span class="pp">]</span> Demo<span class="op">&gt;</span></span></code></pre></div>
<blockquote>
<p><strong>Namig</strong>: Bodite pozorni na to, da je verzija vašega odjemalca (MongoDB shell) novejša ali enaka verziji strežnika (MongoDB server), sicer lahko imate težave. V našem primeru je odjemalec novejši kot strežnik, kar je še sprejemljivo.</p>
</blockquote>
<script>
  $(document).ready(function() {
    $("#Gostovanje-MongoDB code.bash:eq(1)").markRegExp(/docker exec.+/, options_dodaj);
  });
</script>
</div>
<div id="Prenos-podatkov-iz-lokalne-podatkovne-baze-na-MongoDB-Atlas" class="section level4 hasAnchor" number="6.1.7.2">
<h4><span class="header-section-number">6.1.7.2</span> Prenos podatkov iz lokalne podatkovne baze na MongoDB Atlas<a href="PB-REST-API.html#Prenos-podatkov-iz-lokalne-podatkovne-baze-na-MongoDB-Atlas" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Ko imamo vzpostavljeno produkcijsko verzijo podatkovne baze na MongoDB Atlas, je treba vzpostaviti mehanizem za prenos podatkov iz razvojne verzije v produkcijsko verzijo podatkovne baze.</p>
<p>Najprej z ukazom <a href="https://www.mongodb.com/docs/database-tools/mongodump/"><i class="fa-solid fa-database"></i><code>mongodump</code></a> naredimo <strong>posnetek stanja razvojne podatkovne baze</strong> v <i class="fa-brands fa-docker"></i>Docker okolju. Vsebina podatkovne baze se izvozi v trenutno mapo (v okolju Docker), kar zahtevamo s parametrom <code>-o ./</code>.</p>
<div class="sourceCode" id="cb434"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb434-1"><a href="PB-REST-API.html#cb434-1" tabindex="-1"></a><span class="ex">$</span> docker exec <span class="at">-it</span> sp-mongo-db bash <span class="at">-c</span> <span class="st">&quot;mongodump -h localhost -d Demo -o ./&quot;</span></span>
<span id="cb434-2"><a href="PB-REST-API.html#cb434-2" tabindex="-1"></a><span class="ex">2022-10-24T09:34:23.015+0000</span>    writing Demo.Locations to Demo/Locations.bson</span>
<span id="cb434-3"><a href="PB-REST-API.html#cb434-3" tabindex="-1"></a><span class="ex">2022-10-24T09:34:23.025+0000</span>    done dumping Demo.Locations <span class="er">(</span><span class="ex">2144</span> documents<span class="kw">)</span></span></code></pre></div>
<p>Sedaj z ukazom <a href="https://www.mongodb.com/docs/database-tools/mongorestore/"><i class="fa-solid fa-database"></i><code>mongorestore</code></a> <strong>obnovimo vsebino razvojne podatkovne baze</strong> na produkcijsko verzijo podatkovne baze na MongoDB Atlas. Pri tem s parametrom <code>--drop</code> pred začetkom uvoza izbrišemo morebitne obstoječe podatke.</p>
<blockquote>
<p><strong>Namig</strong>: Ukaz za obnovitev podatkovne baze <code>mongorestore</code>, vključno z večino potrebnih parametrov, pridobite preko MongoDB Admin konzole, kjer izberete <code>Deployment</code> → <code>Database</code> → vaša podatkovna baza → <code>...</code> → <code>Command Line Tools</code> → <code>Binary Import and Export Tools</code> → <code>mongorestore</code>.</p>
</blockquote>
<div class="sourceCode" id="cb435"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb435-1"><a href="PB-REST-API.html#cb435-1" tabindex="-1"></a><span class="ex">$</span> docker exec <span class="at">-it</span> sp-mongo-db bash <span class="at">-c</span> <span class="st">&quot;mongorestore --drop --uri mongodb+srv://app@demo.548y4py.mongodb.net ./Demo/Locations.bson&quot;</span></span>
<span id="cb435-2"><a href="PB-REST-API.html#cb435-2" tabindex="-1"></a><span class="ex">Enter</span> password for mongo user:</span>
<span id="cb435-3"><a href="PB-REST-API.html#cb435-3" tabindex="-1"></a></span>
<span id="cb435-4"><a href="PB-REST-API.html#cb435-4" tabindex="-1"></a><span class="ex">2023-09-06T14:33:47.201+0000</span>    checking for collection data in Demo/Locations.bson</span>
<span id="cb435-5"><a href="PB-REST-API.html#cb435-5" tabindex="-1"></a><span class="ex">2023-09-06T14:33:47.201+0000</span>    reading metadata for Demo.Locations from Demo/Locations.metadata.json</span>
<span id="cb435-6"><a href="PB-REST-API.html#cb435-6" tabindex="-1"></a><span class="ex">2023-09-06T14:33:47.237+0000</span>    dropping collection Demo.Locations before restoring</span>
<span id="cb435-7"><a href="PB-REST-API.html#cb435-7" tabindex="-1"></a><span class="ex">2023-09-06T14:33:47.403+0000</span>    restoring Demo.Locations from Demo/Locations.bson</span>
<span id="cb435-8"><a href="PB-REST-API.html#cb435-8" tabindex="-1"></a><span class="ex">2023-09-06T14:33:50.100+0000</span>    <span class="pp">[</span><span class="ss">########################</span><span class="pp">]</span>  Demo.Locations  1.69MB/1.69MB  <span class="er">(</span><span class="ex">100.0%</span><span class="kw">)</span></span>
<span id="cb435-9"><a href="PB-REST-API.html#cb435-9" tabindex="-1"></a><span class="ex">2023-09-06T14:33:51.831+0000</span>    <span class="pp">[</span><span class="ss">########################</span><span class="pp">]</span>  Demo.Locations  1.69MB/1.69MB  <span class="er">(</span><span class="ex">100.0%</span><span class="kw">)</span></span>
<span id="cb435-10"><a href="PB-REST-API.html#cb435-10" tabindex="-1"></a><span class="ex">2023-09-06T14:33:51.831+0000</span>    finished restoring Demo.Locations <span class="er">(</span><span class="ex">2144</span> documents, 0 failures<span class="kw">)</span></span>
<span id="cb435-11"><a href="PB-REST-API.html#cb435-11" tabindex="-1"></a><span class="ex">2023-09-06T14:33:51.831+0000</span>    restoring indexes for collection Demo.Locations from metadata</span>
<span id="cb435-12"><a href="PB-REST-API.html#cb435-12" tabindex="-1"></a><span class="ex">2023-09-06T14:33:51.831+0000</span>    index: <span class="kw">&amp;</span><span class="ex">idx.IndexDocument{Options:primitive.M{</span><span class="st">&quot;2dsphereIndexVersion&quot;</span><span class="ex">:3,</span> <span class="st">&quot;background&quot;</span>:true, <span class="st">&quot;name&quot;</span>:<span class="st">&quot;coordinates_2dsphere&quot;</span>, <span class="st">&quot;v&quot;</span>:2}, Key:primitive.D{primitive.E{Key:<span class="st">&quot;coordinates&quot;</span>, Value:<span class="st">&quot;2dsphere&quot;</span>}}, PartialFilterExpression:primitive.D<span class="er">(</span><span class="ex">nil</span><span class="kw">)</span><span class="er">}</span></span>
<span id="cb435-13"><a href="PB-REST-API.html#cb435-13" tabindex="-1"></a><span class="ex">2023-09-06T14:33:52.043+0000</span>    2144 document<span class="er">(</span><span class="ex">s</span><span class="kw">)</span> <span class="ex">restored</span> successfully. 0 document<span class="er">(</span><span class="ex">s</span><span class="kw">)</span> <span class="ex">failed</span> to restore.</span></code></pre></div>
<p>Povežemo se na oddaljeno produkcijsko podatkovno bazo na MongoDB Atlas in <strong>preverimo</strong>, ali so podatki na voljo.</p>
<div class="sourceCode" id="cb436"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb436-1"><a href="PB-REST-API.html#cb436-1" tabindex="-1"></a><span class="ex">$</span> docker exec <span class="at">-it</span> sp-mongo-db bash <span class="at">-c</span> <span class="st">&quot;mongosh </span><span class="dt">\&quot;</span><span class="st">mongodb+srv://demo.548y4py.mongodb.net/Demo</span><span class="dt">\&quot;</span><span class="st"> --username app&quot;</span></span>
<span id="cb436-2"><a href="PB-REST-API.html#cb436-2" tabindex="-1"></a><span class="ex">Enter</span> password: <span class="pp">************</span></span>
<span id="cb436-3"><a href="PB-REST-API.html#cb436-3" tabindex="-1"></a></span>
<span id="cb436-4"><a href="PB-REST-API.html#cb436-4" tabindex="-1"></a><span class="ex">Current</span> Mongosh Log ID: 64f88e100d62c1d7553569df</span>
<span id="cb436-5"><a href="PB-REST-API.html#cb436-5" tabindex="-1"></a><span class="ex">Connecting</span> to:          mongodb+srv://<span class="op">&lt;</span>credentials<span class="op">&gt;</span>@demo.548y4py.mongodb.net/Demo<span class="pp">?</span>appName=mongosh+1.10.6</span>
<span id="cb436-6"><a href="PB-REST-API.html#cb436-6" tabindex="-1"></a><span class="ex">Using</span> MongoDB:          6.0.9</span>
<span id="cb436-7"><a href="PB-REST-API.html#cb436-7" tabindex="-1"></a><span class="ex">Using</span> Mongosh:          1.10.6</span>
<span id="cb436-8"><a href="PB-REST-API.html#cb436-8" tabindex="-1"></a></span>
<span id="cb436-9"><a href="PB-REST-API.html#cb436-9" tabindex="-1"></a><span class="ex">Atlas</span> atlas-znx0ni-shard-0 <span class="pp">[</span><span class="ss">primary</span><span class="pp">]</span> Demo<span class="op">&gt;</span> show collections</span>
<span id="cb436-10"><a href="PB-REST-API.html#cb436-10" tabindex="-1"></a><span class="ex">Locations</span></span>
<span id="cb436-11"><a href="PB-REST-API.html#cb436-11" tabindex="-1"></a><span class="ex">Atlas</span> atlas-znx0ni-shard-0 <span class="pp">[</span><span class="ss">primary</span><span class="pp">]</span> Demo<span class="op">&gt;</span> db.Locations.find<span class="er">(</span><span class="kw">)</span><span class="fu">.count()</span></span>
<span id="cb436-12"><a href="PB-REST-API.html#cb436-12" tabindex="-1"></a><span class="ex">2144</span></span></code></pre></div>
<p>Če je bil uvoz uspešen, se nam prikažejo vsi podatki, ki smo jih že vnesli v lokalno razvojno podatkovno bazo v okolju Docker in so sedaj na voljo tudi v produkcijski podatkovni bazi na MongoDB Atlas.</p>
<p>Nato zaporedje ukazov za izvoz podatkov iz lokalne razvojne podatkovne baze v oddaljeno produkcijsko podatkovno bazo vključimo v skripto <code>transfer:db-docker-atlas</code> v datoteki <code>package.json</code>, kar nam bo olajšalo kasnejše izvoze podatkov.</p>
<p><code>package.json</code></p>
<div class="sourceCode" id="cb437"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb437-1"><a href="PB-REST-API.html#cb437-1" tabindex="-1"></a>{</span>
<span id="cb437-2"><a href="PB-REST-API.html#cb437-2" tabindex="-1"></a>  <span class="op">...</span></span>
<span id="cb437-3"><a href="PB-REST-API.html#cb437-3" tabindex="-1"></a>  <span class="st">&quot;scripts&quot;</span><span class="op">:</span> {</span>
<span id="cb437-4"><a href="PB-REST-API.html#cb437-4" tabindex="-1"></a>    <span class="op">...,</span></span>
<span id="cb437-5"><a href="PB-REST-API.html#cb437-5" tabindex="-1"></a>    <span class="st">&quot;transfer:db-docker-atlas&quot;</span><span class="op">:</span> <span class="st">&quot;docker exec -it sp-mongo-db bash -c </span><span class="sc">\&quot;</span><span class="st">mongodump -h localhost -d Demo -o ./</span><span class="sc">\&quot;</span><span class="st">; docker exec -it sp-mongo-db bash -c </span><span class="sc">\&quot;</span><span class="st">mongorestore --drop --uri mongodb+srv://app@demo.548y4py.mongodb.net ./Demo/Locations.bson</span><span class="sc">\&quot;</span><span class="st">; docker exec -it sp-mongo-db bash -c </span><span class="sc">\&quot;</span><span class="st">rm -rf ./Demo</span><span class="sc">\&quot;</span><span class="st">&quot;</span></span>
<span id="cb437-6"><a href="PB-REST-API.html#cb437-6" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb437-7"><a href="PB-REST-API.html#cb437-7" tabindex="-1"></a>  <span class="op">...</span></span>
<span id="cb437-8"><a href="PB-REST-API.html#cb437-8" tabindex="-1"></a>}</span></code></pre></div>
<script>
  $(document).ready(function() {
    $("#Prenos-podatkov-iz-lokalne-podatkovne-baze-na-MongoDB-Atlas code.bash:eq(0)").markRegExp(/docker exec.+/, options_dodaj);
    $("#Prenos-podatkov-iz-lokalne-podatkovne-baze-na-MongoDB-Atlas code.bash:eq(1)").markRegExp(/docker exec.+/, options_dodaj);
    $("#Prenos-podatkov-iz-lokalne-podatkovne-baze-na-MongoDB-Atlas code.bash:eq(2)").markRegExp(/docker exec.+/, options_dodaj);
    $("#Prenos-podatkov-iz-lokalne-podatkovne-baze-na-MongoDB-Atlas code.bash:eq(2)").markRegExp(/show collections/, options_dodaj);
    $("#Prenos-podatkov-iz-lokalne-podatkovne-baze-na-MongoDB-Atlas code.bash:eq(2)").markRegExp(/db\.Locations.+/, options_dodaj);
    $("#Prenos-podatkov-iz-lokalne-podatkovne-baze-na-MongoDB-Atlas code.javascript:eq(0)").markRegExp(/,[^"]+?"transfer:db-docker-atlas".+/, options_dodaj);
  });
</script>
</div>
<div id="izbira-podatkovne-baze-glede-na-razvojno-okolje" class="section level4 hasAnchor" number="6.1.7.3">
<h4><span class="header-section-number">6.1.7.3</span> Izbira podatkovne baze glede na razvojno okolje<a href="PB-REST-API.html#izbira-podatkovne-baze-glede-na-razvojno-okolje" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>V tem trenutku imamo tako vzpostavljeno ločena lokalno <strong>razvojno</strong>, <strong>testno</strong> in oddaljeno <strong>produkcijsko okolje</strong>, ki imajo vsak svojo podatkovno bazo, kot prikazuje slika <a href="PB-REST-API.html#fig:slika-Razvojna-in-produkcijska-PB">6.7</a>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:slika-Razvojna-in-produkcijska-PB"></span>
<img src="assets/img/Razvojna_in_produkcijska_PB.png" alt="Razvojno, testno in produkcijsko okolje ter pripadajoči podatkovni bazi" width="470" />
<p class="caption">
Slika 6.7: Razvojno, testno in produkcijsko okolje ter pripadajoči podatkovni bazi
</p>
</div>
<p>Glede na naš cilj ločitve izvajalnih okolij mora naša aplikacija v razvojnem in testnem okolju uporabljati lokalno podatkovno bazo v Docker-ju, v produkcijskem okolju na MongoDB Atlas podatkovno bazo.</p>
<p>To bomo dosegli z uporabo spremenljivke <a href="https://nodejs.dev/en/learn/nodejs-the-difference-between-development-and-production/"><i class="fa-brands fa-node-js"></i><strong><code>NODE_ENV</code></strong></a> v okolju Node.js. Pri zagonu aplikacije preprosto preverimo, ali ima okoljska spremenljivka <code>NODE_ENV</code> nastavljeno vrednost na <code>production</code>, saj bomo takrat uporabili povezovalni niz na produkcijsko podatkovno bazo na MongoDB Cloud, ki je opredeljena v okoljski spremenljivki <code>process.env.MONGODB_ATLAS_URI</code>.</p>
<p>Okoljske spremenljivke lahko enostavno shranimo v datoteko <code>.env</code>, kamor v našem primeru dodamo <code>MONGODB_ATLAS_URI</code>.</p>
<p><code>.env</code></p>
<div class="sourceCode" id="cb438"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb438-1"><a href="PB-REST-API.html#cb438-1" tabindex="-1"></a><span class="co"># MongoDB Atlas</span></span>
<span id="cb438-2"><a href="PB-REST-API.html#cb438-2" tabindex="-1"></a><span class="va">MONGODB_ATLAS_URI</span><span class="op">=</span>mongodb+srv://app:<span class="pp">***</span>@demo.548y4py.mongodb.net/Demo<span class="pp">?</span>retryWrites=true<span class="kw">&amp;</span><span class="va">w</span><span class="op">=</span>majority</span></code></pre></div>
<blockquote>
<p><strong>Opomba</strong>: Geslo je v MongoDB Atlas povezavi skrito za zvezdicami (<code>*</code>).</p>
</blockquote>
<p>Pomembno je tudi, da datoteke <code>.env</code> ne vključimo v spremembe izvorne kode, ki jih shranjujemo v oddaljenem GitHub repozitoriju, saj občutljive podatke (kot je npr. povezava na MongoDB Atlas podatkovno bazo z uporabniškim imenom in geslom) hranimo zgolj v okoljskih spremenljivkah. S tem razlogom datoteko <code>.env</code> vključimo med prezrte datoteke v <code>.gitignore</code>.</p>
<p><code>.gitignore</code></p>
<div class="sourceCode" id="cb439"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb439-1"><a href="PB-REST-API.html#cb439-1" tabindex="-1"></a><span class="ex">node_modules</span></span>
<span id="cb439-2"><a href="PB-REST-API.html#cb439-2" tabindex="-1"></a><span class="ex">.env</span></span></code></pre></div>
<p>Okoljske spremenljivke iz omenjene datoteke <code>.env</code> bo <i class="fa-brands fa-docker"></i>Docker samodejno prebral in vrednosti naložil v okolje, medtem ko lahko v okviru <i class="fa-brands fa-node-js"></i>Node.js aplikacije to dosežemo z uporabo knjižnice <code>dotenv</code>, ki jo namestimo.</p>
<div class="sourceCode" id="cb440"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb440-1"><a href="PB-REST-API.html#cb440-1" tabindex="-1"></a><span class="ex">$</span> npm install dotenv <span class="at">--save</span></span></code></pre></div>
<p>Ob zagonu aplikacije v datoteki <code>server.js</code> nato zgolj zahtevamo funkcionalnosti omenjene knjižnice.</p>
<p><code>server.js</code></p>
<div class="sourceCode" id="cb441"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb441-1"><a href="PB-REST-API.html#cb441-1" tabindex="-1"></a><span class="co">/**</span></span>
<span id="cb441-2"><a href="PB-REST-API.html#cb441-2" tabindex="-1"></a><span class="co"> * Load environment variables</span></span>
<span id="cb441-3"><a href="PB-REST-API.html#cb441-3" tabindex="-1"></a><span class="co"> */</span></span>
<span id="cb441-4"><a href="PB-REST-API.html#cb441-4" tabindex="-1"></a><span class="pp">require</span>(<span class="st">&quot;dotenv&quot;</span>)<span class="op">.</span><span class="fu">config</span>()<span class="op">;</span></span>
<span id="cb441-5"><a href="PB-REST-API.html#cb441-5" tabindex="-1"></a></span>
<span id="cb441-6"><a href="PB-REST-API.html#cb441-6" tabindex="-1"></a><span class="kw">const</span> express <span class="op">=</span> <span class="pp">require</span>(<span class="st">&quot;express&quot;</span>)<span class="op">;</span></span>
<span id="cb441-7"><a href="PB-REST-API.html#cb441-7" tabindex="-1"></a><span class="kw">const</span> path <span class="op">=</span> <span class="pp">require</span>(<span class="st">&quot;path&quot;</span>)<span class="op">;</span></span></code></pre></div>
<p>V datoteko <code>db.js</code> dodamo pogoj, kjer preverjamo, ali se aplikacija izvaja v produkcijskem ali testnem okolju. Prav tako popravimo izpis povezovalnega niza na MongoDB podatkovno bazo, kjer pri izpisu skrijemo geslo.</p>
<p><code>api/models/db.js</code></p>
<div class="sourceCode" id="cb442"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb442-1"><a href="PB-REST-API.html#cb442-1" tabindex="-1"></a><span class="kw">const</span> mongoose <span class="op">=</span> <span class="pp">require</span>(<span class="st">&quot;mongoose&quot;</span>)<span class="op">;</span></span>
<span id="cb442-2"><a href="PB-REST-API.html#cb442-2" tabindex="-1"></a></span>
<span id="cb442-3"><a href="PB-REST-API.html#cb442-3" tabindex="-1"></a><span class="kw">let</span> <span class="kw">const</span> dbURI <span class="op">=</span> <span class="st">&quot;mongodb://127.0.0.1/Demo&quot;</span><span class="op">;</span></span>
<span id="cb442-4"><a href="PB-REST-API.html#cb442-4" tabindex="-1"></a><span class="cf">if</span> (<span class="bu">process</span><span class="op">.</span><span class="at">env</span><span class="op">.</span><span class="at">NODE_ENV</span> <span class="op">===</span> <span class="st">&quot;production&quot;</span>)</span>
<span id="cb442-5"><a href="PB-REST-API.html#cb442-5" tabindex="-1"></a>  dbURI <span class="op">=</span> <span class="bu">process</span><span class="op">.</span><span class="at">env</span><span class="op">.</span><span class="at">MONGODB_ATLAS_URI</span><span class="op">;</span></span>
<span id="cb442-6"><a href="PB-REST-API.html#cb442-6" tabindex="-1"></a><span class="cf">else</span> <span class="cf">if</span> (<span class="bu">process</span><span class="op">.</span><span class="at">env</span><span class="op">.</span><span class="at">NODE_ENV</span> <span class="op">===</span> <span class="st">&quot;test&quot;</span>) </span>
<span id="cb442-7"><a href="PB-REST-API.html#cb442-7" tabindex="-1"></a>  dbURI <span class="op">=</span> <span class="st">&quot;mongodb://sp-mongo-db/Demo&quot;</span><span class="op">;</span></span>
<span id="cb442-8"><a href="PB-REST-API.html#cb442-8" tabindex="-1"></a>mongoose<span class="op">.</span><span class="fu">connect</span>(dbURI)<span class="op">;</span></span>
<span id="cb442-9"><a href="PB-REST-API.html#cb442-9" tabindex="-1"></a></span>
<span id="cb442-10"><a href="PB-REST-API.html#cb442-10" tabindex="-1"></a>mongoose<span class="op">.</span><span class="at">connection</span><span class="op">.</span><span class="fu">on</span>(<span class="st">&quot;connected&quot;</span><span class="op">,</span> () <span class="kw">=&gt;</span></span>
<span id="cb442-11"><a href="PB-REST-API.html#cb442-11" tabindex="-1"></a>  <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="vs">`Mongoose connected to </span><span class="sc">${</span>dbURI<span class="op">.</span><span class="fu">replace</span>(<span class="ss">/:.</span><span class="sc">+?</span><span class="ss">@/</span><span class="op">,</span> <span class="st">&quot;:*****@&quot;</span>)<span class="sc">}</span><span class="vs">.`</span>)</span>
<span id="cb442-12"><a href="PB-REST-API.html#cb442-12" tabindex="-1"></a>)<span class="op">;</span></span></code></pre></div>
<p>Uporabniškega imena in gesla za dostop do oddaljene MongoDB podatkovne baze, ki jo gostujemo na MongoDB Atlas, ne razkrivamo v izvorni kodi, ampak uporabimo spremenljivko <code>MONGODB_ATLAS_URI</code>, ki smo jo predhodno nastavili kot okoljsko spremenljivko.</p>
<p>Obstoječe parametre gradnje Docker slike v <code>dockerfile</code> spremenimo tako, da odstranimo privzeto nastavitev okoljske spremenljivke <code>NODE_ENV</code>, ki jo bomo nastavljali po potrebi (v lokalnem okolju Docker in na oddaljenem Fly).</p>
<p><code>dockerfile</code></p>
<div class="sourceCode" id="cb443"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb443-1"><a href="PB-REST-API.html#cb443-1" tabindex="-1"></a><span class="ex">FROM</span> node:18-alpine</span>
<span id="cb443-2"><a href="PB-REST-API.html#cb443-2" tabindex="-1"></a><span class="ex">ARG</span> NODE_ENV=production</span>
<span id="cb443-3"><a href="PB-REST-API.html#cb443-3" tabindex="-1"></a><span class="ex">ENV</span> NODE_ENV=<span class="va">${NODE_ENV}</span></span>
<span id="cb443-4"><a href="PB-REST-API.html#cb443-4" tabindex="-1"></a><span class="co"># Default application directory for all subsequent commands (COPY, RUN, CMD etc.).</span></span>
<span id="cb443-5"><a href="PB-REST-API.html#cb443-5" tabindex="-1"></a><span class="ex">WORKDIR</span> /usr/src/app</span>
<span id="cb443-6"><a href="PB-REST-API.html#cb443-6" tabindex="-1"></a><span class="co"># Copy package.json and install dependencies.</span></span>
<span id="cb443-7"><a href="PB-REST-API.html#cb443-7" tabindex="-1"></a><span class="co"># Docker will cache node_modules, if package.json and package-lock.json are not changed.</span></span>
<span id="cb443-8"><a href="PB-REST-API.html#cb443-8" tabindex="-1"></a><span class="ex">COPY</span> package.json ./</span>
<span id="cb443-9"><a href="PB-REST-API.html#cb443-9" tabindex="-1"></a><span class="ex">RUN</span> npm install</span>
<span id="cb443-10"><a href="PB-REST-API.html#cb443-10" tabindex="-1"></a><span class="co"># Copy source code of the application</span></span>
<span id="cb443-11"><a href="PB-REST-API.html#cb443-11" tabindex="-1"></a><span class="ex">COPY</span> . .</span>
<span id="cb443-12"><a href="PB-REST-API.html#cb443-12" tabindex="-1"></a><span class="ex">EXPOSE</span> 3000</span>
<span id="cb443-13"><a href="PB-REST-API.html#cb443-13" tabindex="-1"></a><span class="ex">CMD</span> [ <span class="st">&quot;npm&quot;</span>, <span class="st">&quot;run&quot;</span>, <span class="st">&quot;start&quot;</span> ]</span></code></pre></div>
<p>V lokalnem testnem okolju bomo vrednost <code>NODE_ENV</code> okoljske spremenljivke nastavili kar v okviru <code>docker-compose.yml</code>.</p>
<p><code>docker-compose.yml</code></p>
<div class="sourceCode" id="cb444"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb444-1"><a href="PB-REST-API.html#cb444-1" tabindex="-1"></a><span class="fu">services</span><span class="kw">:</span></span>
<span id="cb444-2"><a href="PB-REST-API.html#cb444-2" tabindex="-1"></a><span class="at">  </span><span class="fu">node-api</span><span class="kw">:</span></span>
<span id="cb444-3"><a href="PB-REST-API.html#cb444-3" tabindex="-1"></a><span class="at">    </span><span class="fu">container_name</span><span class="kw">:</span><span class="at"> sp-app</span></span>
<span id="cb444-4"><a href="PB-REST-API.html#cb444-4" tabindex="-1"></a><span class="at">    </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb444-5"><a href="PB-REST-API.html#cb444-5" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="st">&quot;3000:3000&quot;</span></span>
<span id="cb444-6"><a href="PB-REST-API.html#cb444-6" tabindex="-1"></a><span class="at">    </span><span class="fu">image</span><span class="kw">:</span><span class="at"> sp-server</span></span>
<span id="cb444-7"><a href="PB-REST-API.html#cb444-7" tabindex="-1"></a><span class="at">    </span><span class="fu">build</span><span class="kw">:</span><span class="at"> ./</span></span>
<span id="cb444-8"><a href="PB-REST-API.html#cb444-8" tabindex="-1"></a><span class="at">    </span><span class="fu">environment</span><span class="kw">:</span></span>
<span id="cb444-9"><a href="PB-REST-API.html#cb444-9" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> NODE_ENV=test</span></span>
<span id="cb444-10"><a href="PB-REST-API.html#cb444-10" tabindex="-1"></a><span class="at">    </span><span class="fu">networks</span><span class="kw">:</span></span>
<span id="cb444-11"><a href="PB-REST-API.html#cb444-11" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> sp-network</span></span></code></pre></div>
<p>Za produkcijsko okolje Fly bomo nastavili privzeti vrednosti okoljskih spremenljivk <code>NODE_ENV</code> in <code>MONGODB_ATLAS_URI</code>.</p>
<div class="sourceCode" id="cb445"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb445-1"><a href="PB-REST-API.html#cb445-1" tabindex="-1"></a><span class="ex">$</span> fly secrets set NODE_ENV=production</span>
<span id="cb445-2"><a href="PB-REST-API.html#cb445-2" tabindex="-1"></a><span class="ex">$</span> fly secrets set MONGODB_ATLAS_URI=<span class="st">&quot;mongodb+srv://app:*****@demo.548y4py.mongodb.net/Demo?retryWrites=true&amp;w=majority&quot;</span></span></code></pre></div>
<p>Nato lahko preverimo ali so okoljse spremenljivke na oddaljenem okolju Fly nastavljene, kjer se prikažejo zgolj zgoščene vrednosti, saj jih sistem ne sme razkrivati.</p>
<div class="sourceCode" id="cb446"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb446-1"><a href="PB-REST-API.html#cb446-1" tabindex="-1"></a><span class="ex">$</span> fly secrets list</span>
<span id="cb446-2"><a href="PB-REST-API.html#cb446-2" tabindex="-1"></a></span>
<span id="cb446-3"><a href="PB-REST-API.html#cb446-3" tabindex="-1"></a><span class="ex">NAME</span>                    DIGEST                  CREATED AT </span>
<span id="cb446-4"><a href="PB-REST-API.html#cb446-4" tabindex="-1"></a><span class="ex">MONGODB_ATLAS_URI</span>       0451df420bb55b6d        1m52s ago </span>
<span id="cb446-5"><a href="PB-REST-API.html#cb446-5" tabindex="-1"></a><span class="ex">NODE_ENV</span>                a331102148f18977        15m50s ago</span></code></pre></div>
<script>
  $(document).ready(function() {
    $("#izbira-podatkovne-baze-glede-na-razvojno-okolje code:eq(6)").markRegExp(/.+/, options_dodaj);
    $("#izbira-podatkovne-baze-glede-na-razvojno-okolje code.bash:eq(0)").markRegExp(/.+/, options_dodaj);
    $("#izbira-podatkovne-baze-glede-na-razvojno-okolje code.bash:eq(1)").markRegExp(/\.env/, options_dodaj);
    $("#izbira-podatkovne-baze-glede-na-razvojno-okolje code.bash:eq(2)").markRegExp(/npm.+/, options_dodaj);
    $("#izbira-podatkovne-baze-glede-na-razvojno-okolje code.bash:eq(3)").markRegExp(/(ARG|ENV).+/, options_izbrisi);
    $("#izbira-podatkovne-baze-glede-na-razvojno-okolje code.bash:eq(4)").markRegExp(/fly.+/, options_dodaj);
    $("#izbira-podatkovne-baze-glede-na-razvojno-okolje code.bash:eq(5)").markRegExp(/fly.+/, options_dodaj);
    $("#izbira-podatkovne-baze-glede-na-razvojno-okolje code.javascript:eq(0)").markRegExp(/\/\*\*[\s\S]+?config.+/, options_dodaj);
    $("#izbira-podatkovne-baze-glede-na-razvojno-okolje code.javascript:eq(1)").markRegExp(/ const/, options_izbrisi);
    $("#izbira-podatkovne-baze-glede-na-razvojno-okolje code.javascript:eq(1)").markRegExp(/let/, options_dodaj);
    $("#izbira-podatkovne-baze-glede-na-razvojno-okolje code.javascript:eq(1)").markRegExp(/if [\s\S]+?Demo";/, options_dodaj);
    $("#izbira-podatkovne-baze-glede-na-razvojno-okolje code.javascript:eq(1)").markRegExp(/\.replace.+?\)/, options_dodaj);
    $("#izbira-podatkovne-baze-glede-na-razvojno-okolje code.yaml:eq(0)").markRegExp(/\s+?environment[\s\S]+?=test/, options_dodaj);
  });
</script>
</div>
<div id="testiranje-delovanja" class="section level4 hasAnchor" number="6.1.7.4">
<h4><span class="header-section-number">6.1.7.4</span> Testiranje delovanja<a href="PB-REST-API.html#testiranje-delovanja" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Pri zagonu strežnika bomo dodali način, v katerem trenutno deluje, da bomo lažje preverili delovanje upoštevanja okoljskih spremenljivk pri razvoju.</p>
<p><code>server.js</code></p>
<div class="sourceCode" id="cb447"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb447-1"><a href="PB-REST-API.html#cb447-1" tabindex="-1"></a><span class="co">/**</span></span>
<span id="cb447-2"><a href="PB-REST-API.html#cb447-2" tabindex="-1"></a><span class="co"> * Start server</span></span>
<span id="cb447-3"><a href="PB-REST-API.html#cb447-3" tabindex="-1"></a><span class="co"> */</span></span>
<span id="cb447-4"><a href="PB-REST-API.html#cb447-4" tabindex="-1"></a>app<span class="op">.</span><span class="fu">listen</span>(port<span class="op">,</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb447-5"><a href="PB-REST-API.html#cb447-5" tabindex="-1"></a>  <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(</span>
<span id="cb447-6"><a href="PB-REST-API.html#cb447-6" tabindex="-1"></a>    <span class="vs">`Demo app started in </span><span class="sc">${</span></span>
<span id="cb447-7"><a href="PB-REST-API.html#cb447-7" tabindex="-1"></a>      <span class="bu">process</span><span class="op">.</span><span class="at">env</span><span class="op">.</span><span class="at">NODE_ENV</span> <span class="op">||</span> <span class="st">&quot;development&quot;</span></span>
<span id="cb447-8"><a href="PB-REST-API.html#cb447-8" tabindex="-1"></a>    <span class="sc">}</span><span class="vs"> mode listening on port </span><span class="sc">${</span>port<span class="sc">}</span><span class="vs">!`</span></span>
<span id="cb447-9"><a href="PB-REST-API.html#cb447-9" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb447-10"><a href="PB-REST-API.html#cb447-10" tabindex="-1"></a>})<span class="op">;</span></span></code></pre></div>
<p>Če aplikacijo poženemo v <i class="fa-solid fa-database"></i>lokalnem <strong>razvojnem okolju</strong> (glej 1. scenarij na sliki <a href="PB-REST-API.html#fig:slika-Razvojna-in-produkcijska-PB">6.7</a>), vidimo iz izpisov, da je strežnik v razvojnem načinu in smo se povezali z lokalno podatkovno bazo.</p>
<div class="sourceCode" id="cb448"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb448-1"><a href="PB-REST-API.html#cb448-1" tabindex="-1"></a><span class="ex">$</span> nodemon</span>
<span id="cb448-2"><a href="PB-REST-API.html#cb448-2" tabindex="-1"></a><span class="ex">...</span></span>
<span id="cb448-3"><a href="PB-REST-API.html#cb448-3" tabindex="-1"></a><span class="ex">Demo</span> app started in development mode listening on port 3000!</span>
<span id="cb448-4"><a href="PB-REST-API.html#cb448-4" tabindex="-1"></a><span class="ex">Mongoose</span> connected to mongodb://127.0.0.1/Demo.</span></code></pre></div>
<p>Sedaj preverimo še povezovanje na <strong>produkcijsko podatkovno bazo na MongoDB Atlas</strong>, kjer pred zagonom aplikacije z <code>nodemon</code> nastavimo okoljsko spremenljivko <code>NODE_ENV</code>.</p>
<div class="sourceCode" id="cb449"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb449-1"><a href="PB-REST-API.html#cb449-1" tabindex="-1"></a><span class="ex">$</span> NODE_ENV=production nodemon</span>
<span id="cb449-2"><a href="PB-REST-API.html#cb449-2" tabindex="-1"></a><span class="ex">...</span></span>
<span id="cb449-3"><a href="PB-REST-API.html#cb449-3" tabindex="-1"></a><span class="ex">Demo</span> app started in production mode listening on port 3000!</span>
<span id="cb449-4"><a href="PB-REST-API.html#cb449-4" tabindex="-1"></a><span class="ex">Mongoose</span> connected to mongodb+srv:<span class="pp">*****</span>@demo.548y4py.mongodb.net/Demo<span class="pp">?</span>retryWrites=true<span class="kw">&amp;</span><span class="va">w</span><span class="op">=</span>majority.</span></code></pre></div>
<blockquote>
<p><strong>Namig</strong>: Če uporabljate okolje Windows, potem boste mogoče morali uporabiti <a href="https://superuser.com/questions/223104/setting-and-using-variable-within-same-command-line-in-windows-cmd-exe"><i class="fa-solid fa-earth-europe"></i>drugačen način</a> hkratnega nastavljanja okoljskih spremenljivk in zagona aplikacije.</p>
</blockquote>
<p>Če aplikacijo poženemo v <i class="fa-solid fa-database"></i>lokalnem <strong>testnem okolju</strong> s pomočjo Docker-ja (glej 2. scenarij na sliki <a href="PB-REST-API.html#fig:slika-Razvojna-in-produkcijska-PB">6.7</a>), lahko iz izpisov vidimo, da smo se povezali s podatkovno bazo znotraj Docker omrežja.</p>
<div class="sourceCode" id="cb450"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb450-1"><a href="PB-REST-API.html#cb450-1" tabindex="-1"></a><span class="ex">$</span> docker-compose stop node-api</span>
<span id="cb450-2"><a href="PB-REST-API.html#cb450-2" tabindex="-1"></a><span class="ex">[+]</span> Running 1/1</span>
<span id="cb450-3"><a href="PB-REST-API.html#cb450-3" tabindex="-1"></a> <span class="ex">⠿</span> Container sp-app  Stopped   </span>
<span id="cb450-4"><a href="PB-REST-API.html#cb450-4" tabindex="-1"></a><span class="ex">$</span> docker-compose rm node-api</span>
<span id="cb450-5"><a href="PB-REST-API.html#cb450-5" tabindex="-1"></a><span class="ex">?</span> Going to remove sp-app Yes</span>
<span id="cb450-6"><a href="PB-REST-API.html#cb450-6" tabindex="-1"></a><span class="ex">[+]</span> Running 1/0</span>
<span id="cb450-7"><a href="PB-REST-API.html#cb450-7" tabindex="-1"></a> <span class="ex">⠿</span> Container sp-app  Removed</span>
<span id="cb450-8"><a href="PB-REST-API.html#cb450-8" tabindex="-1"></a><span class="ex">$</span> docker rmi sp-server</span>
<span id="cb450-9"><a href="PB-REST-API.html#cb450-9" tabindex="-1"></a><span class="ex">Untagged:</span> sp-server:latest</span>
<span id="cb450-10"><a href="PB-REST-API.html#cb450-10" tabindex="-1"></a><span class="ex">Deleted:</span> sha256:ca72824ee79fefb8be9fd1ce54922824d5633c02344583f4f286ad29b84483f2</span>
<span id="cb450-11"><a href="PB-REST-API.html#cb450-11" tabindex="-1"></a><span class="ex">$</span> docker-compose build <span class="at">--no-cache</span> node-api</span>
<span id="cb450-12"><a href="PB-REST-API.html#cb450-12" tabindex="-1"></a><span class="ex">[+]</span> Building 8.0s <span class="er">(</span><span class="ex">11/11</span><span class="kw">)</span> <span class="ex">FINISHED</span></span>
<span id="cb450-13"><a href="PB-REST-API.html#cb450-13" tabindex="-1"></a><span class="ex">$</span> docker-compose up <span class="at">--force-recreate</span> <span class="at">--no-deps</span> <span class="at">-d</span> node-api</span>
<span id="cb450-14"><a href="PB-REST-API.html#cb450-14" tabindex="-1"></a><span class="ex">[+]</span> Running 1/1</span>
<span id="cb450-15"><a href="PB-REST-API.html#cb450-15" tabindex="-1"></a> <span class="ex">⠿</span> Container sp-app  Started</span>
<span id="cb450-16"><a href="PB-REST-API.html#cb450-16" tabindex="-1"></a><span class="ex">$</span> docker logs sp-app</span>
<span id="cb450-17"><a href="PB-REST-API.html#cb450-17" tabindex="-1"></a><span class="op">&gt;</span> demo@0.1.0 <span class="ex">start</span></span>
<span id="cb450-18"><a href="PB-REST-API.html#cb450-18" tabindex="-1"></a><span class="op">&gt;</span> node <span class="ex">server.js</span></span>
<span id="cb450-19"><a href="PB-REST-API.html#cb450-19" tabindex="-1"></a><span class="ex">Demo</span> app started in test mode listening on port 3000!</span>
<span id="cb450-20"><a href="PB-REST-API.html#cb450-20" tabindex="-1"></a><span class="ex">Mongoose</span> connected to mongodb://sp-mongo-db/Demo.</span></code></pre></div>
<blockquote>
<p><strong>Opomba</strong>: Najprej vsebnik ustavimo in odstranimo, nato odstranimo še sliko, in oboje ponovno zgradimo ter poženemo.</p>
</blockquote>
<p>Na koncu preverimo še delovanje v celoti na <i class="fa-solid fa-database"></i><strong>produkcijskem okolju</strong> v oblaku Fly. Po pregledu dnevniških zapisov na oddaljenem sistemu Fly opazimo, da se je aplikacija povezala s produkcijo podatkovno bazo na MongoDB Atlas.</p>
<div class="sourceCode" id="cb451"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb451-1"><a href="PB-REST-API.html#cb451-1" tabindex="-1"></a><span class="ex">$</span> fly deploy</span>
<span id="cb451-2"><a href="PB-REST-API.html#cb451-2" tabindex="-1"></a><span class="ex">...</span></span>
<span id="cb451-3"><a href="PB-REST-API.html#cb451-3" tabindex="-1"></a><span class="ex">$</span> fly logs</span>
<span id="cb451-4"><a href="PB-REST-API.html#cb451-4" tabindex="-1"></a><span class="ex">...</span> Demo app started in production mode listening on port 3000!</span>
<span id="cb451-5"><a href="PB-REST-API.html#cb451-5" tabindex="-1"></a><span class="ex">...</span> Mongoose connected to mongodb+srv:<span class="pp">*****</span>@demo.548y4py.mongodb.net/Demo<span class="pp">?</span>retryWrites=true<span class="kw">&amp;</span><span class="va">w</span><span class="op">=</span>majority.</span></code></pre></div>
<script>
  $(document).ready(function() {
    $("#testiranje-delovanja code.javascript:eq(0)").markRegExp(/ started[\s\S]+?mode/, options_dodaj);
    $("#testiranje-delovanja code.bash:eq(0)").markRegExp(/nodemon/, options_dodaj);
    $("#testiranje-delovanja code.bash:eq(0)").markRegExp(/development mode/, options_dodaj);
    $("#testiranje-delovanja code.bash:eq(0)").markRegExp(/mongodb.+?Demo/, options_dodaj);
    $("#testiranje-delovanja code.bash:eq(1)").markRegExp(/NODE_ENV.+/, options_dodaj);
    $("#testiranje-delovanja code.bash:eq(1)").markRegExp(/production mode/, options_dodaj);
    $("#testiranje-delovanja code.bash:eq(1)").markRegExp(/mongodb.+?majority/, options_dodaj);
    $("#testiranje-delovanja code.bash:eq(2)").markRegExp(/docker.+/, options_dodaj);
    $("#testiranje-delovanja code.bash:eq(2)").markRegExp(/test mode/, options_dodaj);
    $("#testiranje-delovanja code.bash:eq(2)").markRegExp(/mongodb.+?Demo/, options_dodaj);
    $("#testiranje-delovanja code.bash:eq(3)").markRegExp(/fly.+/, options_dodaj);
    $("#testiranje-delovanja code.bash:eq(3)").markRegExp(/production mode/, options_dodaj);
    $("#testiranje-delovanja code.bash:eq(3)").markRegExp(/mongodb.+?majority/, options_dodaj);
  });
</script>
</div>
</div>
</div>
<div id="priprava-rest-api-ja-za-dostop-do-mongodb-podatkovne-baze" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> Priprava REST API-ja za dostop do MongoDB podatkovne baze<a href="PB-REST-API.html#priprava-rest-api-ja-za-dostop-do-mongodb-podatkovne-baze" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Do tega trenutka smo vzpostavili MongoDB podatkovno bazo, vendar lahko do nje dostopamo zgolj preko ukazne vrstice. V nadaljevanju bomo zgradili <a href="https://en.wikipedia.org/wiki/Representational_state_transfer"><i class="fa-brands fa-wikipedia-w"></i><strong>REST API</strong></a> (glej sliko <a href="PB-REST-API.html#fig:slika-Izdelava-REST-API">6.8</a>), ki nam bo omogočal interakcijo s podatkovno bazo s pomočjo HTTP zahtev, ter izvajal standardne <a href="https://en.wikipedia.org/wiki/Create,_read,_update_and_delete"><i class="fa-brands fa-wikipedia-w"></i><strong>CRUD</strong></a><a href="PB-REST-API.html#fn134" class="footnote-ref" id="fnref134"><sup>134</sup></a> <strong>operacije</strong>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:slika-Izdelava-REST-API"></span>
<img src="assets/img/Izdelava_REST_API.png" alt="V nadaljevanju bomo s pomočjo Express, Node.js in Mongoose zgradili REST API za dostop do MongoDB podatkovne baze" width="500" />
<p class="caption">
Slika 6.8: V nadaljevanju bomo s pomočjo Express, Node.js in Mongoose zgradili REST API za dostop do MongoDB podatkovne baze
</p>
</div>
<div id="rest-api" class="section level3 hasAnchor" number="6.2.1">
<h3><span class="header-section-number">6.2.1</span> REST API<a href="PB-REST-API.html#rest-api" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><a href="https://en.wikipedia.org/wiki/Representational_state_transfer"><i class="fa-brands fa-wikipedia-w"></i><strong>REST</strong></a><a href="PB-REST-API.html#fn135" class="footnote-ref" id="fnref135"><sup>135</sup></a> je bolj arhitekturni stil kot striktno določen protokol. REST je brez stanja, t.j. stanja oz. zgodovine trenutnega uporabnika se ne zaveda.</p>
<p><a href="https://en.wikipedia.org/wiki/API"><i class="fa-brands fa-wikipedia-w"></i><strong>API</strong></a><a href="PB-REST-API.html#fn136" class="footnote-ref" id="fnref136"><sup>136</sup></a> omogoča aplikacijam medsebojno komunikacijo.</p>
<p>Iz tega izhaja, da je REST API vmesnik do aplikacije brez stanja. V našem primeru bomo s pomočjo tega pristopa implementirali dostop do podatkovne baze. Pri osnovnem delovanju REST API pričakuje zahtevo, ki se na strani strežnika obdela (po potrebi dostopa do podatkovne baze) in vrne odgovor, kot je prikazano na sliki <a href="PB-REST-API.html#fig:slika-REST-procesiranje">6.9</a>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:slika-REST-procesiranje"></span>
<img src="assets/img/REST_procesiranje.png" alt="Zaporedje procesiranja pri REST zahtevi" width="350" />
<p class="caption">
Slika 6.9: Zaporedje procesiranja pri REST zahtevi
</p>
</div>
</div>
<div id="url-zahteva" class="section level3 hasAnchor" number="6.2.2">
<h3><span class="header-section-number">6.2.2</span> URL zahteva<a href="PB-REST-API.html#url-zahteva" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Kot že omenjeno, želimo z REST API-jem implementirati standardne CRUD operacije:</p>
<ul>
<li>dodajanje novega elementa,</li>
<li>branje seznama več elementov,</li>
<li>branje določenega elementa,</li>
<li>posodabljanje določenega elementa,</li>
<li>brisanje določenega elementa.</li>
</ul>
<p>Za <strong>obvladovanje podatkov v zvezi z lokacijami</strong> bi si lahko zamislili naslednje akcije, predstavljene v tabeli <a href="PB-REST-API.html#tab:tabela-REST-URL-naslovi-in-parametri">6.1</a>.</p>
<table class="tabela-manjsa">
<caption>
<span id="tab:tabela-REST-URL-naslovi-in-parametri">Tabela 6.1: </span>URL naslovi in parametri REST API-ja za lokacijo
</caption>
<thead>
<tr>
<th style="text-align:left;">
Akcija
</th>
<th style="text-align:left;">
URL naslov
</th>
<th style="text-align:left;">
Parametri
</th>
<th style="text-align:left;">
Primer
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Kreiranje nove lokacije
</td>
<td style="text-align:left;">
<code>/locations</code>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<code>http://&lt;streznik&gt;/api/locations</code>
</td>
</tr>
<tr>
<td style="text-align:left;">
Branje seznama lokacij
</td>
<td style="text-align:left;">
<code>/locations</code>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<code>http://&lt;streznik&gt;/api/locations</code>
</td>
</tr>
<tr>
<td style="text-align:left;">
Branje določene lokacije
</td>
<td style="text-align:left;">
<code>/locations</code>
</td>
<td style="text-align:left;">
<code>locationId</code>
</td>
<td style="text-align:left;">
<code>http://&lt;streznik&gt;/api/locations/123</code>
</td>
</tr>
<tr>
<td style="text-align:left;">
Posodobitev določene lokacije
</td>
<td style="text-align:left;">
<code>/locations</code>
</td>
<td style="text-align:left;">
<code>locationId</code>
</td>
<td style="text-align:left;">
<code>http://&lt;streznik&gt;/api/locations/123</code>
</td>
</tr>
<tr>
<td style="text-align:left;">
Brisanje določene lokacije
</td>
<td style="text-align:left;">
<code>/locations</code>
</td>
<td style="text-align:left;">
<code>locationId</code>
</td>
<td style="text-align:left;">
<code>http://&lt;streznik&gt;/api/locations/123</code>
</td>
</tr>
</tbody>
</table>
<p>Kot je razvidno iz tabele <a href="PB-REST-API.html#tab:tabela-REST-URL-naslovi-in-parametri">6.1</a> ima vsaka akcija isti URL naslov, medtem ko 3 akcije pričakujejo tudi dodatni parameter za določitev točne lokacije.</p>
</div>
<div id="metoda-zahteve" class="section level3 hasAnchor" number="6.2.3">
<h3><span class="header-section-number">6.2.3</span> Metoda zahteve<a href="PB-REST-API.html#metoda-zahteve" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Če želimo uporabiti isti URL naslov za vse akcije, je za medsebojno razlikovanje treba uporabiti različne <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods"><i class="fa-solid fa-earth-europe"></i>metode zahtev</a>, ki so predstavljene v tabeli <a href="PB-REST-API.html#tab:tabela-REST-metode-zahteve">6.2</a>. Pri metodi zahteve gre za navodilo strežniku, kakšno akcijo naj izvede.</p>
<table class="tabela-manjsa">
<caption>
<span id="tab:tabela-REST-metode-zahteve">Tabela 6.2: </span>Metode zahteve, ki se uporabljajo pri REST API
</caption>
<thead>
<tr>
<th style="text-align:left;">
Metoda zahteve
</th>
<th style="text-align:left;">
Uporaba
</th>
<th style="text-align:left;">
Odgovor
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods/POST"><i class='fa-solid fa-tag'></i><code>POST</code></a>
</td>
<td style="text-align:left;">
Dodajanje novega dokumenta v podatkovno bazo.
</td>
<td style="text-align:left;">
Nov podatkovni objekt v podatkovni bazi.
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods/GET"><i class='fa-solid fa-tag'></i><code>GET</code></a>
</td>
<td style="text-align:left;">
Branje obstoječega dokumenta iz podatkovne baze.
</td>
<td style="text-align:left;">
Objekt, ki predstavlja odgovor na poizvedbo.
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods/PUT"><i class='fa-solid fa-tag'></i><code>PUT</code></a>
</td>
<td style="text-align:left;">
Posodabljanje dokumenta v podatkovni bazi.
</td>
<td style="text-align:left;">
Posodobljen podatkovni objekt iz podatkovne baze.
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods/DELETE"><i class='fa-solid fa-tag'></i><code>DELETE</code></a>
</td>
<td style="text-align:left;">
Brisanje obstoječega dokumenta iz podatkovne baze.
</td>
<td style="text-align:left;">
NULL
</td>
</tr>
</tbody>
</table>
<p>Poleg najbolj pogosto uporabljenih metod zahtev, predstavljenih v tabeli <a href="PB-REST-API.html#tab:tabela-REST-metode-zahteve">6.2</a>, so na voljo tudi druge, in sicer <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods/HEAD"><i class='fa-solid fa-tag'></i><code>HEAD</code></a>, <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods/CONNECT"><i class='fa-solid fa-tag'></i><code>CONNECT</code></a>, <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods/OPTIONS"><i class='fa-solid fa-tag'></i><code>OPTIONS</code></a>, <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods/TRACE"><i class='fa-solid fa-tag'></i><code>TRACE</code></a> in <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods/PATCH"><i class='fa-solid fa-tag'></i><code>PATCH</code></a>.</p>
<p>Če sedaj posodobimo tabelo <a href="PB-REST-API.html#tab:tabela-REST-URL-naslovi-in-parametri">6.1</a> s podatki o metodah zahtev iz tabele <a href="PB-REST-API.html#tab:tabela-REST-metode-zahteve">6.2</a>, dobimo naslednjo tabelo <a href="PB-REST-API.html#tab:tabela-REST-URL-naslovi-in-parametri-z-metodami">6.3</a>.</p>
<table class="tabela-manjsa">
<caption>
<span id="tab:tabela-REST-URL-naslovi-in-parametri-z-metodami">Tabela 6.3: </span>URL naslovi, parametri in metode REST API za <strong>lokacijo</strong>
</caption>
<thead>
<tr>
<th style="text-align:left;">
Akcija
</th>
<th style="text-align:left;">
Metoda
</th>
<th style="text-align:left;">
URL naslov
</th>
<th style="text-align:left;">
Parametri
</th>
<th style="text-align:left;">
Primer
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Kreiranje nove lokacije
</td>
<td style="text-align:left;">
<code>POST</code>
</td>
<td style="text-align:left;">
<code>/locations</code>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<code>http://&lt;server&gt;/api/locations</code>
</td>
</tr>
<tr>
<td style="text-align:left;">
Branje seznama lokacij
</td>
<td style="text-align:left;">
<code>GET</code>
</td>
<td style="text-align:left;">
<code>/locations</code>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<code>http://&lt;server&gt;/api/locations</code>
</td>
</tr>
<tr>
<td style="text-align:left;">
Branje določene lokacije
</td>
<td style="text-align:left;">
<code>GET</code>
</td>
<td style="text-align:left;">
<code>/locations/:locationId</code>
</td>
<td style="text-align:left;">
<code>locationId</code>
</td>
<td style="text-align:left;">
<code>http://&lt;server&gt;/api/locations/123</code>
</td>
</tr>
<tr>
<td style="text-align:left;">
Posodobitev določene lokacije
</td>
<td style="text-align:left;">
<code>PUT</code>
</td>
<td style="text-align:left;">
<code>/locations/:locationId</code>
</td>
<td style="text-align:left;">
<code>locationId</code>
</td>
<td style="text-align:left;">
<code>http://&lt;server&gt;/api/locations/123</code>
</td>
</tr>
<tr>
<td style="text-align:left;">
Brisanje določene lokacije
</td>
<td style="text-align:left;">
<code>DELETE</code>
</td>
<td style="text-align:left;">
<code>/locations/:locationId</code>
</td>
<td style="text-align:left;">
<code>locationId</code>
</td>
<td style="text-align:left;">
<code>http://&lt;server&gt;/api/locations/123</code>
</td>
</tr>
</tbody>
</table>
<p>V tabeli <a href="PB-REST-API.html#tab:tabela-REST-URL-naslovi-in-parametri-z-metodami">6.3</a> imamo osnovne metode, povezane z lokacijami, manjkajo pa nam še <strong>odvisni dokumenti</strong>, v našem primeru so to <strong>komentarji</strong>, ki so podrobneje opisani v tabeli <a href="PB-REST-API.html#tab:tabela-REST-URL-naslovi-in-parametri-z-metodami-komentarji">6.4</a>.</p>
<table class="tabela-manjsa">
<caption>
<span id="tab:tabela-REST-URL-naslovi-in-parametri-z-metodami-komentarji">Tabela 6.4: </span>URL naslovi, parametri in metode REST API za <strong>komentarje</strong>
</caption>
<thead>
<tr>
<th style="text-align:left;">
Akcija
</th>
<th style="text-align:left;">
Metoda
</th>
<th style="text-align:left;">
URL naslov
</th>
<th style="text-align:left;">
Parametri
</th>
<th style="text-align:left;">
Primer
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Kreiranje novega komentarja
</td>
<td style="text-align:left;">
<code>POST</code>
</td>
<td style="text-align:left;">
<code>/locations/:locationId/</code><br><code>comments</code>
</td>
<td style="text-align:left;">
<code>locationId</code>
</td>
<td style="text-align:left;">
<code>http://&lt;server&gt;/api/</code><br><code>locations/123/comments</code>
</td>
</tr>
<tr>
<td style="text-align:left;">
Branje določenega komentarja
</td>
<td style="text-align:left;">
<code>GET</code>
</td>
<td style="text-align:left;">
<code>/locations/:locationId/</code><br><code>comments/:commentId</code>
</td>
<td style="text-align:left;">
<code>locationId</code>, <code>commentId</code>
</td>
<td style="text-align:left;">
<code>http://&lt;server&gt;/api/</code><br><code>locations/123/comments/abc</code>
</td>
</tr>
<tr>
<td style="text-align:left;">
Posodobitev določenega komentarja
</td>
<td style="text-align:left;">
<code>PUT</code>
</td>
<td style="text-align:left;">
<code>/locations/:locationId/</code><br><code>comments/:commentId</code>
</td>
<td style="text-align:left;">
<code>locationId</code>, <code>commentId</code>
</td>
<td style="text-align:left;">
<code>http://&lt;server&gt;/api/</code><br><code>locations/123/comments/abc</code>
</td>
</tr>
<tr>
<td style="text-align:left;">
Brisanje določenega komentarja
</td>
<td style="text-align:left;">
<code>DELETE</code>
</td>
<td style="text-align:left;">
<code>/locations/:locationId/</code><br><code>comments/:commentId</code>
</td>
<td style="text-align:left;">
<code>locationId</code>, <code>commentId</code>
</td>
<td style="text-align:left;">
<code>http://&lt;server&gt;/api/</code><br><code>locations/123/comments/abc</code>
</td>
</tr>
</tbody>
</table>
</div>
<div id="odgovor-podatek-in-status-api-ja" class="section level3 hasAnchor" number="6.2.4">
<h3><span class="header-section-number">6.2.4</span> Odgovor (podatek in status) API-ja<a href="PB-REST-API.html#odgovor-podatek-in-status-api-ja" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Dobra praksa pri uporabi API-ja je, da pri vsaki zahtevi dobimo odgovor, ki je sestavljen iz <strong>podatkov</strong> in <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status"><i class="fa-solid fa-earth-europe"></i><strong>HTTP šifre statusa</strong></a>. API podatke po navadi vrača v XML ali JSON obliki. V našem primeru bomo uporabljali JSON obliko, ki je skladna z uporabljeno MEAN arhitekturo, prav tako pa zahteva prenos manjše količine podatkov kot XML oblika. Pri odgovoru odjemalec vedno pričakuje tudi HTTP šifro statusa, najbolj pogosto uporabljene so zbrane v tabeli <a href="PB-REST-API.html#tab:tabela-HTTP-status-codes">6.5</a>.</p>
<table class="tabela-manjsa">
<caption>
<span id="tab:tabela-HTTP-status-codes">Tabela 6.5: </span>HTTP šifre statusa
</caption>
<thead>
<tr>
<th style="text-align:center;">
Šifra statusa
</th>
<th style="text-align:left;">
Naziv
</th>
<th style="text-align:left;">
Primer uporabe
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
<a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/200"><i class='fa-solid fa-tag'></i>200</a>
</td>
<td style="text-align:left;">
OK
</td>
<td style="text-align:left;">
Uspešna <code>GET</code> ali <code>PUT</code> zahteva.
</td>
</tr>
<tr>
<td style="text-align:center;">
<a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/201"><i class='fa-solid fa-tag'></i>201</a>
</td>
<td style="text-align:left;">
Created
</td>
<td style="text-align:left;">
Uspešna <code>POST</code> zahteva.
</td>
</tr>
<tr>
<td style="text-align:center;">
<a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/204"><i class='fa-solid fa-tag'></i>204</a>
</td>
<td style="text-align:left;">
No content
</td>
<td style="text-align:left;">
Uspešna <code>DELETE</code> zahteva.
</td>
</tr>
<tr>
<td style="text-align:center;">
<a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400"><i class='fa-solid fa-tag'></i>400</a>
</td>
<td style="text-align:left;">
Bad request
</td>
<td style="text-align:left;">
Neuspešna <code>GET</code>, <code>POST</code> ali <code>PUT</code> zahteva, zaradi napačne vsebine.
</td>
</tr>
<tr>
<td style="text-align:center;">
<a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/401"><i class='fa-solid fa-tag'></i>401</a>
</td>
<td style="text-align:left;">
Unauthorized
</td>
<td style="text-align:left;">
Zahteva zaščitenega URL naslova z napačnimi prijavnimi podatki.
</td>
</tr>
<tr>
<td style="text-align:center;">
<a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/403"><i class='fa-solid fa-tag'></i>403</a>
</td>
<td style="text-align:left;">
Forbidden
</td>
<td style="text-align:left;">
Zahteva, ki ni dovoljena.
</td>
</tr>
<tr>
<td style="text-align:center;">
<a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404"><i class='fa-solid fa-tag'></i>404</a>
</td>
<td style="text-align:left;">
Not found
</td>
<td style="text-align:left;">
Neuspešna zahteva, zaradi napačnega parametra v URL naslovu.
</td>
</tr>
<tr>
<td style="text-align:center;">
<a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/405"><i class='fa-solid fa-tag'></i>405</a>
</td>
<td style="text-align:left;">
Method not allowed
</td>
<td style="text-align:left;">
Metoda zahteve ni dovoljena za zahtevan URL naslov.
</td>
</tr>
<tr>
<td style="text-align:center;">
<a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/409"><i class='fa-solid fa-tag'></i>409</a>
</td>
<td style="text-align:left;">
Conflict
</td>
<td style="text-align:left;">
Neuspešna <code>POST</code> zahteva, ko že obstaja objekt z istimi podatki.
</td>
</tr>
<tr>
<td style="text-align:center;">
<a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/500"><i class='fa-solid fa-tag'></i>500</a>
</td>
<td style="text-align:left;">
Internal server error
</td>
<td style="text-align:left;">
Težava s strežnikom ali podatkovno bazo.
</td>
</tr>
</tbody>
</table>
<p>Verjetno je največ uporabnikom poznana šifra statusa <code>404</code>, ki predstavlja neuspešno zahtevo, ko določene strani, ki jo uporabnik zahteva, ni mogoče najti. Vendar to še zdaleč ni edina, ampak obstajajo še številne druge, povezane z napakami na strani odjemalca oz. strežnika, preusmeritve in uspešne zahteve, kot je razvidno iz tabele <a href="PB-REST-API.html#tab:tabela-HTTP-status-codes">6.5</a>.</p>
</div>
</div>
<div id="Implementacija-API-ja-z-ogrodjem-Express" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> Implementacija API-ja z ogrodjem Express<a href="PB-REST-API.html#Implementacija-API-ja-z-ogrodjem-Express" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Aplikacijo smo že začeli graditi s pomočjo ogrodja Express, zdaj pa bi želeli dodati še dostop do podatkovne baze s pomočjo dostopa preko REST API-ja. Cilj je ločitev dostopa do podatkovne baze od aplikacije, zato bomo celotno izvorno kodo, povezano z implementacijo API-ja, hranili v mapi <code>api</code>, kjer že imamo opredeljeno začetno verzijo modelov, kjer se naša aplikacija poveže na podatkovno bazo.</p>
<div class="sourceCode" id="cb452"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb452-1"><a href="PB-REST-API.html#cb452-1" tabindex="-1"></a><span class="ex">$</span> mkdir api/routes</span>
<span id="cb452-2"><a href="PB-REST-API.html#cb452-2" tabindex="-1"></a><span class="ex">$</span> mkdir api/controllers</span></code></pre></div>
<script>
  $(document).ready(function() {
    $("#Implementacija-API-ja-z-ogrodjem-Express code.bash:eq(0)").markRegExp(/mkdir.+/, options_dodaj);
  });
</script>
<div id="priprava-usmerjevalnika" class="section level3 hasAnchor" number="6.3.1">
<h3><span class="header-section-number">6.3.1</span> Priprava usmerjevalnika<a href="PB-REST-API.html#priprava-usmerjevalnika" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>V začetno datoteko naše aplikacije <code>server.js</code> dodamo referenco na usmerjevalnik v okviru implementacije API-ja.</p>
<p><code>server.js</code></p>
<div class="sourceCode" id="cb453"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb453-1"><a href="PB-REST-API.html#cb453-1" tabindex="-1"></a><span class="kw">const</span> hbsRouter <span class="op">=</span> <span class="pp">require</span>(<span class="st">&quot;./hbs/routes/hbs&quot;</span>)<span class="op">;</span></span>
<span id="cb453-2"><a href="PB-REST-API.html#cb453-2" tabindex="-1"></a><span class="kw">const</span> apiRouter <span class="op">=</span> <span class="pp">require</span>(<span class="st">&quot;./api/routes/api&quot;</span>)<span class="op">;</span></span></code></pre></div>
<p>V aplikacijo dodamo tudi preusmeritev vseh zahtev <code>/api</code> na pravkar opredeljen usmerjevalnik <code>apiRouter</code>.</p>
<p><code>server.js</code></p>
<div class="sourceCode" id="cb454"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb454-1"><a href="PB-REST-API.html#cb454-1" tabindex="-1"></a><span class="co">/**</span></span>
<span id="cb454-2"><a href="PB-REST-API.html#cb454-2" tabindex="-1"></a><span class="co"> * HBS routing</span></span>
<span id="cb454-3"><a href="PB-REST-API.html#cb454-3" tabindex="-1"></a><span class="co"> */</span></span>
<span id="cb454-4"><a href="PB-REST-API.html#cb454-4" tabindex="-1"></a>app<span class="op">.</span><span class="fu">use</span>(<span class="st">&quot;/&quot;</span><span class="op">,</span> hbsRouter)<span class="op">;</span></span>
<span id="cb454-5"><a href="PB-REST-API.html#cb454-5" tabindex="-1"></a><span class="co">/**</span></span>
<span id="cb454-6"><a href="PB-REST-API.html#cb454-6" tabindex="-1"></a><span class="co"> * API routing</span></span>
<span id="cb454-7"><a href="PB-REST-API.html#cb454-7" tabindex="-1"></a><span class="co"> */</span></span>
<span id="cb454-8"><a href="PB-REST-API.html#cb454-8" tabindex="-1"></a>app<span class="op">.</span><span class="fu">use</span>(<span class="st">&quot;/api&quot;</span><span class="op">,</span> apiRouter)<span class="op">;</span></span></code></pre></div>
<p>Nato kreiramo novo datoteko <code>api/routes/api.js</code>, kjer bo implementiran usmerjevalnik za API. Izvorna koda usmerjevalnika je neposredna implementacija predvidenih poti za <strong>lokacije</strong> (glej tabelo <a href="PB-REST-API.html#tab:tabela-REST-URL-naslovi-in-parametri-z-metodami">6.3</a>) in <strong>komentarje</strong> (glej tabelo <a href="PB-REST-API.html#tab:tabela-REST-URL-naslovi-in-parametri-z-metodami-komentarji">6.4</a>).</p>
<p><code>api/routes/api.js</code></p>
<div class="sourceCode" id="cb455"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb455-1"><a href="PB-REST-API.html#cb455-1" tabindex="-1"></a><span class="kw">const</span> express <span class="op">=</span> <span class="pp">require</span>(<span class="st">&quot;express&quot;</span>)<span class="op">;</span></span>
<span id="cb455-2"><a href="PB-REST-API.html#cb455-2" tabindex="-1"></a><span class="kw">const</span> router <span class="op">=</span> express<span class="op">.</span><span class="fu">Router</span>()<span class="op">;</span></span>
<span id="cb455-3"><a href="PB-REST-API.html#cb455-3" tabindex="-1"></a><span class="kw">const</span> ctrlLocations <span class="op">=</span> <span class="pp">require</span>(<span class="st">&quot;../controllers/locations&quot;</span>)<span class="op">;</span></span>
<span id="cb455-4"><a href="PB-REST-API.html#cb455-4" tabindex="-1"></a><span class="kw">const</span> ctrlComments <span class="op">=</span> <span class="pp">require</span>(<span class="st">&quot;../controllers/comments&quot;</span>)<span class="op">;</span></span>
<span id="cb455-5"><a href="PB-REST-API.html#cb455-5" tabindex="-1"></a></span>
<span id="cb455-6"><a href="PB-REST-API.html#cb455-6" tabindex="-1"></a><span class="co">/**</span></span>
<span id="cb455-7"><a href="PB-REST-API.html#cb455-7" tabindex="-1"></a><span class="co"> * Locations</span></span>
<span id="cb455-8"><a href="PB-REST-API.html#cb455-8" tabindex="-1"></a><span class="co"> */</span></span>
<span id="cb455-9"><a href="PB-REST-API.html#cb455-9" tabindex="-1"></a>router<span class="op">.</span><span class="fu">get</span>(<span class="st">&quot;/locations/distance&quot;</span><span class="op">,</span> ctrlLocations<span class="op">.</span><span class="at">locationsListByDistance</span>)<span class="op">;</span></span>
<span id="cb455-10"><a href="PB-REST-API.html#cb455-10" tabindex="-1"></a>router<span class="op">.</span><span class="fu">get</span>(<span class="st">&quot;/locations/search&quot;</span><span class="op">,</span> ctrlLocations<span class="op">.</span><span class="at">locationsListByMultiFilter</span>)<span class="op">;</span></span>
<span id="cb455-11"><a href="PB-REST-API.html#cb455-11" tabindex="-1"></a>router<span class="op">.</span><span class="fu">get</span>(</span>
<span id="cb455-12"><a href="PB-REST-API.html#cb455-12" tabindex="-1"></a>  <span class="st">&quot;/locations/codelist/:codelist&quot;</span><span class="op">,</span></span>
<span id="cb455-13"><a href="PB-REST-API.html#cb455-13" tabindex="-1"></a>  ctrlLocations<span class="op">.</span><span class="at">locationsListCodelist</span></span>
<span id="cb455-14"><a href="PB-REST-API.html#cb455-14" tabindex="-1"></a>)<span class="op">;</span></span>
<span id="cb455-15"><a href="PB-REST-API.html#cb455-15" tabindex="-1"></a>router<span class="op">.</span><span class="fu">post</span>(<span class="st">&quot;/locations&quot;</span><span class="op">,</span> ctrlLocations<span class="op">.</span><span class="at">locationsCreate</span>)<span class="op">;</span></span>
<span id="cb455-16"><a href="PB-REST-API.html#cb455-16" tabindex="-1"></a>router<span class="op">.</span><span class="fu">get</span>(<span class="st">&quot;/locations/:locationId&quot;</span><span class="op">,</span> ctrlLocations<span class="op">.</span><span class="at">locationsReadOne</span>)<span class="op">;</span></span>
<span id="cb455-17"><a href="PB-REST-API.html#cb455-17" tabindex="-1"></a>router<span class="op">.</span><span class="fu">put</span>(<span class="st">&quot;/locations/:locationId&quot;</span><span class="op">,</span> ctrlLocations<span class="op">.</span><span class="at">locationsUpdateOne</span>)<span class="op">;</span></span>
<span id="cb455-18"><a href="PB-REST-API.html#cb455-18" tabindex="-1"></a>router<span class="op">.</span><span class="fu">delete</span>(<span class="st">&quot;/locations/:locationId&quot;</span><span class="op">,</span> ctrlLocations<span class="op">.</span><span class="at">locationsDeleteOne</span>)<span class="op">;</span></span>
<span id="cb455-19"><a href="PB-REST-API.html#cb455-19" tabindex="-1"></a></span>
<span id="cb455-20"><a href="PB-REST-API.html#cb455-20" tabindex="-1"></a><span class="co">/**</span></span>
<span id="cb455-21"><a href="PB-REST-API.html#cb455-21" tabindex="-1"></a><span class="co"> * Comments</span></span>
<span id="cb455-22"><a href="PB-REST-API.html#cb455-22" tabindex="-1"></a><span class="co"> */</span></span>
<span id="cb455-23"><a href="PB-REST-API.html#cb455-23" tabindex="-1"></a>router<span class="op">.</span><span class="fu">post</span>(<span class="st">&quot;/locations/:locationId/comments&quot;</span><span class="op">,</span> ctrlComments<span class="op">.</span><span class="at">commentsCreate</span>)<span class="op">;</span></span>
<span id="cb455-24"><a href="PB-REST-API.html#cb455-24" tabindex="-1"></a>router<span class="op">.</span><span class="fu">get</span>(</span>
<span id="cb455-25"><a href="PB-REST-API.html#cb455-25" tabindex="-1"></a>  <span class="st">&quot;/locations/:locationId/comments/:commentId&quot;</span><span class="op">,</span></span>
<span id="cb455-26"><a href="PB-REST-API.html#cb455-26" tabindex="-1"></a>  ctrlComments<span class="op">.</span><span class="at">commentsReadOne</span></span>
<span id="cb455-27"><a href="PB-REST-API.html#cb455-27" tabindex="-1"></a>)<span class="op">;</span></span>
<span id="cb455-28"><a href="PB-REST-API.html#cb455-28" tabindex="-1"></a>router<span class="op">.</span><span class="fu">put</span>(</span>
<span id="cb455-29"><a href="PB-REST-API.html#cb455-29" tabindex="-1"></a>  <span class="st">&quot;/locations/:locationId/comments/:commentId&quot;</span><span class="op">,</span></span>
<span id="cb455-30"><a href="PB-REST-API.html#cb455-30" tabindex="-1"></a>  ctrlComments<span class="op">.</span><span class="at">commentsUpdateOne</span></span>
<span id="cb455-31"><a href="PB-REST-API.html#cb455-31" tabindex="-1"></a>)<span class="op">;</span></span>
<span id="cb455-32"><a href="PB-REST-API.html#cb455-32" tabindex="-1"></a>router<span class="op">.</span><span class="fu">delete</span>(</span>
<span id="cb455-33"><a href="PB-REST-API.html#cb455-33" tabindex="-1"></a>  <span class="st">&quot;/locations/:locationId/comments/:commentId&quot;</span><span class="op">,</span></span>
<span id="cb455-34"><a href="PB-REST-API.html#cb455-34" tabindex="-1"></a>  ctrlComments<span class="op">.</span><span class="at">commentsDeleteOne</span></span>
<span id="cb455-35"><a href="PB-REST-API.html#cb455-35" tabindex="-1"></a>)<span class="op">;</span></span>
<span id="cb455-36"><a href="PB-REST-API.html#cb455-36" tabindex="-1"></a></span>
<span id="cb455-37"><a href="PB-REST-API.html#cb455-37" tabindex="-1"></a>module<span class="op">.</span><span class="at">exports</span> <span class="op">=</span> router<span class="op">;</span></span></code></pre></div>
<p>Pri opredelitvi API URL naslova se pogosto uporabljajo parametri, s katerimi določimo odvisne dokumente, kot je to v našem primeru komentarjev, ki so odvisni od lokacije. Vključitev parametra v URL naslov je preprosta, in sicer imenu spremenljivke samo dodamo predpono dvopičja <code>:</code>.</p>
<script>
  $(document).ready(function() {
    $("#priprava-usmerjevalnika code.javascript:eq(0)").markRegExp(/const apiRouter.+/, options_dodaj);
    $("#priprava-usmerjevalnika code.javascript:eq(1)").markRegExp(/\/\*\*[^\/]+?API routing[\s\S]+?\);/, options_dodaj);
    $("#priprava-usmerjevalnika code.javascript:eq(1)").markRegExp(/app\.use.+?"\/api.+/, options_dodaj);
    $("#priprava-usmerjevalnika code:eq(7)").markRegExp(/api\.js/, options_dodaj);
    $("#priprava-usmerjevalnika code.javascript:eq(2)").markRegExp(/.+/, options_dodaj);
  });
</script>
</div>
<div id="priprava-osnutka-krmilnika" class="section level3 hasAnchor" number="6.3.2">
<h3><span class="header-section-number">6.3.2</span> Priprava osnutka krmilnika<a href="PB-REST-API.html#priprava-osnutka-krmilnika" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Pri pripravi osnutka krmilnika moramo pripraviti začetno kodo, da bo API sploh deloval, funkcionalnosti pa v krmilniku dejansko ne bo implementirane nobene, zgolj vračanje enostavnega besedila <code>OK</code>.</p>
<p>V nadaljevanju bomo zato pripravili metode v obeh krmilnikih <code>locations.js</code> in <code>comments.js</code>.</p>
<p><code>api/controllers/locations.js</code></p>
<div class="sourceCode" id="cb456"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb456-1"><a href="PB-REST-API.html#cb456-1" tabindex="-1"></a><span class="kw">const</span> locationsListByDistance <span class="op">=</span> (req<span class="op">,</span> res) <span class="kw">=&gt;</span> {</span>
<span id="cb456-2"><a href="PB-REST-API.html#cb456-2" tabindex="-1"></a>  res<span class="op">.</span><span class="fu">status</span>(<span class="dv">200</span>)<span class="op">.</span><span class="fu">json</span>({ <span class="dt">status</span><span class="op">:</span> <span class="st">&quot;OK&quot;</span> })<span class="op">;</span></span>
<span id="cb456-3"><a href="PB-REST-API.html#cb456-3" tabindex="-1"></a>}<span class="op">;</span></span>
<span id="cb456-4"><a href="PB-REST-API.html#cb456-4" tabindex="-1"></a><span class="kw">const</span> locationsListByMultiFilter <span class="op">=</span> (req<span class="op">,</span> res) <span class="kw">=&gt;</span> {</span>
<span id="cb456-5"><a href="PB-REST-API.html#cb456-5" tabindex="-1"></a>  res<span class="op">.</span><span class="fu">status</span>(<span class="dv">200</span>)<span class="op">.</span><span class="fu">json</span>({ <span class="dt">status</span><span class="op">:</span> <span class="st">&quot;OK&quot;</span> })<span class="op">;</span></span>
<span id="cb456-6"><a href="PB-REST-API.html#cb456-6" tabindex="-1"></a>}<span class="op">;</span></span>
<span id="cb456-7"><a href="PB-REST-API.html#cb456-7" tabindex="-1"></a><span class="kw">const</span> locationsCreate <span class="op">=</span> (req<span class="op">,</span> res) <span class="kw">=&gt;</span> {</span>
<span id="cb456-8"><a href="PB-REST-API.html#cb456-8" tabindex="-1"></a>  res<span class="op">.</span><span class="fu">status</span>(<span class="dv">201</span>)<span class="op">.</span><span class="fu">json</span>({ <span class="dt">status</span><span class="op">:</span> <span class="st">&quot;OK&quot;</span> })<span class="op">;</span></span>
<span id="cb456-9"><a href="PB-REST-API.html#cb456-9" tabindex="-1"></a>}<span class="op">;</span></span>
<span id="cb456-10"><a href="PB-REST-API.html#cb456-10" tabindex="-1"></a><span class="kw">const</span> locationsReadOne <span class="op">=</span> (req<span class="op">,</span> res) <span class="kw">=&gt;</span> {</span>
<span id="cb456-11"><a href="PB-REST-API.html#cb456-11" tabindex="-1"></a>  res<span class="op">.</span><span class="fu">status</span>(<span class="dv">200</span>)<span class="op">.</span><span class="fu">json</span>({ <span class="dt">status</span><span class="op">:</span> <span class="st">&quot;OK&quot;</span> })<span class="op">;</span></span>
<span id="cb456-12"><a href="PB-REST-API.html#cb456-12" tabindex="-1"></a>}<span class="op">;</span></span>
<span id="cb456-13"><a href="PB-REST-API.html#cb456-13" tabindex="-1"></a><span class="kw">const</span> locationsListCodelist <span class="op">=</span> (req<span class="op">,</span> res) <span class="kw">=&gt;</span> {</span>
<span id="cb456-14"><a href="PB-REST-API.html#cb456-14" tabindex="-1"></a>  res<span class="op">.</span><span class="fu">status</span>(<span class="dv">200</span>)<span class="op">.</span><span class="fu">json</span>({ <span class="dt">status</span><span class="op">:</span> <span class="st">&quot;OK&quot;</span> })<span class="op">;</span></span>
<span id="cb456-15"><a href="PB-REST-API.html#cb456-15" tabindex="-1"></a>}<span class="op">;</span></span>
<span id="cb456-16"><a href="PB-REST-API.html#cb456-16" tabindex="-1"></a><span class="kw">const</span> locationsUpdateOne <span class="op">=</span> (req<span class="op">,</span> res) <span class="kw">=&gt;</span> {</span>
<span id="cb456-17"><a href="PB-REST-API.html#cb456-17" tabindex="-1"></a>  res<span class="op">.</span><span class="fu">status</span>(<span class="dv">200</span>)<span class="op">.</span><span class="fu">json</span>({ <span class="dt">status</span><span class="op">:</span> <span class="st">&quot;OK&quot;</span> })<span class="op">;</span></span>
<span id="cb456-18"><a href="PB-REST-API.html#cb456-18" tabindex="-1"></a>}<span class="op">;</span></span>
<span id="cb456-19"><a href="PB-REST-API.html#cb456-19" tabindex="-1"></a><span class="kw">const</span> locationsDeleteOne <span class="op">=</span> (req<span class="op">,</span> res) <span class="kw">=&gt;</span> {</span>
<span id="cb456-20"><a href="PB-REST-API.html#cb456-20" tabindex="-1"></a>  res<span class="op">.</span><span class="fu">status</span>(<span class="dv">204</span>)<span class="op">.</span><span class="fu">json</span>({ <span class="dt">status</span><span class="op">:</span> <span class="st">&quot;OK&quot;</span> })<span class="op">;</span></span>
<span id="cb456-21"><a href="PB-REST-API.html#cb456-21" tabindex="-1"></a>}<span class="op">;</span></span>
<span id="cb456-22"><a href="PB-REST-API.html#cb456-22" tabindex="-1"></a>module<span class="op">.</span><span class="at">exports</span> <span class="op">=</span> {</span>
<span id="cb456-23"><a href="PB-REST-API.html#cb456-23" tabindex="-1"></a>  locationsListByDistance<span class="op">,</span></span>
<span id="cb456-24"><a href="PB-REST-API.html#cb456-24" tabindex="-1"></a>  locationsListByMultiFilter<span class="op">,</span></span>
<span id="cb456-25"><a href="PB-REST-API.html#cb456-25" tabindex="-1"></a>  locationsListCodelist<span class="op">,</span></span>
<span id="cb456-26"><a href="PB-REST-API.html#cb456-26" tabindex="-1"></a>  locationsCreate<span class="op">,</span></span>
<span id="cb456-27"><a href="PB-REST-API.html#cb456-27" tabindex="-1"></a>  locationsReadOne<span class="op">,</span></span>
<span id="cb456-28"><a href="PB-REST-API.html#cb456-28" tabindex="-1"></a>  locationsUpdateOne<span class="op">,</span></span>
<span id="cb456-29"><a href="PB-REST-API.html#cb456-29" tabindex="-1"></a>  locationsDeleteOne<span class="op">,</span></span>
<span id="cb456-30"><a href="PB-REST-API.html#cb456-30" tabindex="-1"></a>}<span class="op">;</span></span></code></pre></div>
<p><code>api/controllers/comments.js</code></p>
<div class="sourceCode" id="cb457"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb457-1"><a href="PB-REST-API.html#cb457-1" tabindex="-1"></a><span class="kw">const</span> commentsCreate <span class="op">=</span> (req<span class="op">,</span> res) <span class="kw">=&gt;</span> {</span>
<span id="cb457-2"><a href="PB-REST-API.html#cb457-2" tabindex="-1"></a>  res<span class="op">.</span><span class="fu">status</span>(<span class="dv">201</span>)<span class="op">.</span><span class="fu">json</span>({ <span class="dt">status</span><span class="op">:</span> <span class="st">&quot;OK&quot;</span> })<span class="op">;</span></span>
<span id="cb457-3"><a href="PB-REST-API.html#cb457-3" tabindex="-1"></a>}<span class="op">;</span></span>
<span id="cb457-4"><a href="PB-REST-API.html#cb457-4" tabindex="-1"></a><span class="kw">const</span> commentsReadOne <span class="op">=</span> (req<span class="op">,</span> res) <span class="kw">=&gt;</span> {</span>
<span id="cb457-5"><a href="PB-REST-API.html#cb457-5" tabindex="-1"></a>  res<span class="op">.</span><span class="fu">status</span>(<span class="dv">200</span>)<span class="op">.</span><span class="fu">json</span>({ <span class="dt">status</span><span class="op">:</span> <span class="st">&quot;OK&quot;</span> })<span class="op">;</span></span>
<span id="cb457-6"><a href="PB-REST-API.html#cb457-6" tabindex="-1"></a>}<span class="op">;</span></span>
<span id="cb457-7"><a href="PB-REST-API.html#cb457-7" tabindex="-1"></a><span class="kw">const</span> commentsUpdateOne <span class="op">=</span> (req<span class="op">,</span> res) <span class="kw">=&gt;</span> {</span>
<span id="cb457-8"><a href="PB-REST-API.html#cb457-8" tabindex="-1"></a>  res<span class="op">.</span><span class="fu">status</span>(<span class="dv">200</span>)<span class="op">.</span><span class="fu">json</span>({ <span class="dt">status</span><span class="op">:</span> <span class="st">&quot;OK&quot;</span> })<span class="op">;</span></span>
<span id="cb457-9"><a href="PB-REST-API.html#cb457-9" tabindex="-1"></a>}<span class="op">;</span></span>
<span id="cb457-10"><a href="PB-REST-API.html#cb457-10" tabindex="-1"></a><span class="kw">const</span> commentsDeleteOne <span class="op">=</span> (req<span class="op">,</span> res) <span class="kw">=&gt;</span> {</span>
<span id="cb457-11"><a href="PB-REST-API.html#cb457-11" tabindex="-1"></a>  res<span class="op">.</span><span class="fu">status</span>(<span class="dv">204</span>)<span class="op">.</span><span class="fu">json</span>({ <span class="dt">status</span><span class="op">:</span> <span class="st">&quot;OK&quot;</span> })<span class="op">;</span></span>
<span id="cb457-12"><a href="PB-REST-API.html#cb457-12" tabindex="-1"></a>}<span class="op">;</span></span>
<span id="cb457-13"><a href="PB-REST-API.html#cb457-13" tabindex="-1"></a>module<span class="op">.</span><span class="at">exports</span> <span class="op">=</span> {</span>
<span id="cb457-14"><a href="PB-REST-API.html#cb457-14" tabindex="-1"></a>  commentsCreate<span class="op">,</span></span>
<span id="cb457-15"><a href="PB-REST-API.html#cb457-15" tabindex="-1"></a>  commentsReadOne<span class="op">,</span></span>
<span id="cb457-16"><a href="PB-REST-API.html#cb457-16" tabindex="-1"></a>  commentsUpdateOne<span class="op">,</span></span>
<span id="cb457-17"><a href="PB-REST-API.html#cb457-17" tabindex="-1"></a>  commentsDeleteOne<span class="op">,</span></span>
<span id="cb457-18"><a href="PB-REST-API.html#cb457-18" tabindex="-1"></a>}<span class="op">;</span></span></code></pre></div>
<script>
  $(document).ready(function() {
    $("#priprava-osnutka-krmilnika code:eq(3)").markRegExp(/locations\.js/, options_dodaj);
    $("#priprava-osnutka-krmilnika code:eq(5)").markRegExp(/comments\.js/, options_dodaj);
    $("#priprava-osnutka-krmilnika code.javascript:eq(0)").markRegExp(/.+/, options_dodaj);
    $("#priprava-osnutka-krmilnika code.javascript:eq(1)").markRegExp(/.+/, options_dodaj);
  });
</script>
</div>
<div id="testiranje-osnutka-api-ja" class="section level3 hasAnchor" number="6.3.3">
<h3><span class="header-section-number">6.3.3</span> Testiranje osnutka API-ja<a href="PB-REST-API.html#testiranje-osnutka-api-ja" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Za testiranje enostavnih GET zahtev lahko uporabimo kar spletni brskalnik, kamor vnesemo želeni URL naslov in dobimo pričakovan odgovor, kot je to prikazano na sliki <a href="PB-REST-API.html#fig:slika-REST-API-GET-test">6.10</a>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:slika-REST-API-GET-test"></span>
<img src="assets/img/REST_API_GET_test.png" alt="Testiranje REST API GET zahteve `/locations/distance`" width="400" />
<p class="caption">
Slika 6.10: Testiranje REST API GET zahteve <code>/locations/distance</code>
</p>
</div>
<p>Za bolj kompleksno testiranje vseh metod API vmesnika pa priporočamo bolj napredno orodje, kot sta npr. <a href="https://www.getpostman.com/"><i class="fa-solid fa-earth-europe"></i>Postman</a> ali <a href="https://www.thunderclient.com/"><i class="fa-solid fa-earth-europe"></i>Thunder Client</a>, ki nam omogočata napredno simuliranje različnih REST klicev.</p>
<p>Najboljše razmerje med učinkovitostjo in enostavnostjo uporabe pa nam nudi konzolno orodje <a href="https://curl.se/"><i class="fa-solid fa-earth-europe"></i><strong><code>curl</code></strong></a>, ki ga bomo tudi mi uporabljali v nadaljevanju pri testiranju razvitih REST API metod. Zahtevo, ki smo jo izvedli s pomočjo brskalnika (glej sliko <a href="PB-REST-API.html#fig:slika-REST-API-GET-test">6.10</a>), s pomočjo <code>curl</code> izvedemo tako, kot prikazuje naslednji primer.</p>
<div class="sourceCode" id="cb458"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb458-1"><a href="PB-REST-API.html#cb458-1" tabindex="-1"></a><span class="ex">$</span> curl <span class="at">-X</span> GET http://localhost:3000/api/locations/distance</span>
<span id="cb458-2"><a href="PB-REST-API.html#cb458-2" tabindex="-1"></a><span class="ex">{</span><span class="st">&quot;status&quot;</span><span class="ex">:</span><span class="st">&quot;OK&quot;</span><span class="ex">}</span></span></code></pre></div>
<script>
  $(document).ready(function() {
    $("#testiranje-osnutka-api-ja code.bash:eq(0)").markRegExp(/curl.+/, options_dodaj);
  });
</script>
</div>
<div id="vključitev-modela" class="section level3 hasAnchor" number="6.3.4">
<h3><span class="header-section-number">6.3.4</span> Vključitev modela<a href="PB-REST-API.html#vključitev-modela" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Za API je ključnega pomena, da ima dostop do podatkovne baze, saj nam v nasprotnem primeru ne bi veliko koristil. Dostop do podatkovne baze imamo že omogočen preko modela. Ker bomo do modela dostopali v krmilniku, dodamo odvisnosti v datotekah <code>locations.js</code> in <code>comments.js</code>.</p>
<p><code>api/controllers/locations.js</code></p>
<div class="sourceCode" id="cb459"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb459-1"><a href="PB-REST-API.html#cb459-1" tabindex="-1"></a><span class="kw">const</span> mongoose <span class="op">=</span> <span class="pp">require</span>(<span class="st">&quot;mongoose&quot;</span>)<span class="op">;</span></span>
<span id="cb459-2"><a href="PB-REST-API.html#cb459-2" tabindex="-1"></a><span class="kw">const</span> <span class="bu">Location</span> <span class="op">=</span> mongoose<span class="op">.</span><span class="fu">model</span>(<span class="st">&quot;Location&quot;</span>)<span class="op">;</span></span>
<span id="cb459-3"><a href="PB-REST-API.html#cb459-3" tabindex="-1"></a><span class="kw">const</span> locationsListByDistance <span class="op">=</span> (req<span class="op">,</span> res) <span class="kw">=&gt;</span> {</span>
<span id="cb459-4"><a href="PB-REST-API.html#cb459-4" tabindex="-1"></a>  res<span class="op">.</span><span class="fu">status</span>(<span class="dv">200</span>)<span class="op">.</span><span class="fu">json</span>({ <span class="dt">status</span><span class="op">:</span> <span class="st">&quot;OK&quot;</span> })<span class="op">;</span></span>
<span id="cb459-5"><a href="PB-REST-API.html#cb459-5" tabindex="-1"></a>}<span class="op">;</span></span></code></pre></div>
<p><code>api/controllers/comments.js</code></p>
<div class="sourceCode" id="cb460"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb460-1"><a href="PB-REST-API.html#cb460-1" tabindex="-1"></a><span class="kw">const</span> mongoose <span class="op">=</span> <span class="pp">require</span>(<span class="st">&quot;mongoose&quot;</span>)<span class="op">;</span></span>
<span id="cb460-2"><a href="PB-REST-API.html#cb460-2" tabindex="-1"></a><span class="kw">const</span> <span class="bu">Location</span> <span class="op">=</span> mongoose<span class="op">.</span><span class="fu">model</span>(<span class="st">&quot;Location&quot;</span>)<span class="op">;</span></span>
<span id="cb460-3"><a href="PB-REST-API.html#cb460-3" tabindex="-1"></a><span class="kw">const</span> commentsCreate <span class="op">=</span> (req<span class="op">,</span> res) <span class="kw">=&gt;</span> {</span>
<span id="cb460-4"><a href="PB-REST-API.html#cb460-4" tabindex="-1"></a>  res<span class="op">.</span><span class="fu">status</span>(<span class="dv">201</span>)<span class="op">.</span><span class="fu">json</span>({ <span class="dt">status</span><span class="op">:</span> <span class="st">&quot;OK&quot;</span> })<span class="op">;</span></span>
<span id="cb460-5"><a href="PB-REST-API.html#cb460-5" tabindex="-1"></a>}<span class="op">;</span></span></code></pre></div>
<script>
  $(document).ready(function() {
    $("#vključitev-modela code.javascript:eq(0)").markRegExp(/const (mongoose|Location).+/, options_dodaj);
    $("#vključitev-modela code.javascript:eq(1)").markRegExp(/const (mongoose|Location).+/, options_dodaj);    
  });
</script>
</div>
</div>
<div id="get-metode-za-branje-podatkov-iz-mongodb" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> GET metode za branje podatkov iz MongoDB<a href="PB-REST-API.html#get-metode-za-branje-podatkov-iz-mongodb" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>GET metode se pri REST API vmesniku uporabljajo za poizvedovanje po podatkovni bazi in vračanje rezultatov poizvedb. V našem primeru imamo v usmerjevalniku <code>api/routers/api.js</code> opredeljene 5 GET metod, kot je prikazano v tabeli <a href="PB-REST-API.html#tab:tabela-REST-API-GET-metode">6.6</a>.</p>
<table class="tabela-manjsa">
<caption>
<span id="tab:tabela-REST-API-GET-metode">Tabela 6.6: </span>5 <strong>GET metode</strong> v okviru naše aplikacije
</caption>
<thead>
<tr>
<th style="text-align:left;">
Akcija
</th>
<th style="text-align:left;">
Metoda
</th>
<th style="text-align:left;">
URL naslov
</th>
<th style="text-align:left;">
Parametri
</th>
<th style="text-align:left;">
Primer
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<strong>Branje seznama lokacij glede na lokacijo</strong><br>(glej poglavje <a href="PB-REST-API.html#geografsko-iskanje">6.4.3</a>)
</td>
<td style="text-align:left;">
<code>GET</code>
</td>
<td style="text-align:left;">
<code>/locations/distance</code>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<code>http://&lt;server&gt;/api/</code><br><code>locations/distance</code>
</td>
</tr>
<tr>
<td style="text-align:left;">
<strong>Branje seznama lokacije glede na filter</strong><br>(glej poglavje <a href="PB-REST-API.html#napredno-iskanje">6.4.4</a>)
</td>
<td style="text-align:left;">
<code>GET</code>
</td>
<td style="text-align:left;">
<code>/locations/search</code>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<code>http://&lt;server&gt;/api/</code><br><code>locations/search</code>
</td>
</tr>
<tr>
<td style="text-align:left;">
<strong>Branje vrednosti šifrantov</strong><br>(glej poglavje <a href="PB-REST-API.html#seznami-sifrantov">6.4.5</a>)
</td>
<td style="text-align:left;">
<code>GET</code>
</td>
<td style="text-align:left;">
<code>/locations/codelist/</code><br><code>:codelist</code>
</td>
<td style="text-align:left;">
<code>codelist</code>
</td>
<td style="text-align:left;">
<code>http://&lt;server&gt;/api/</code><br><code>locations/codelist/category</code>
</td>
</tr>
<tr>
<td style="text-align:left;">
<strong>Branje določene lokacije</strong><br>(glej poglavje <a href="PB-REST-API.html#iskanje-dokumenta">6.4.1</a>)
</td>
<td style="text-align:left;">
<code>GET</code>
</td>
<td style="text-align:left;">
<code>/locations/:locationId</code>
</td>
<td style="text-align:left;">
<code>locationId</code>
</td>
<td style="text-align:left;">
<code>http://&lt;server&gt;/api/</code><br><code>locations/123</code>
</td>
</tr>
<tr>
<td style="text-align:left;">
<strong>Branje določenega komentarja</strong><br>(glej poglavje <a href="PB-REST-API.html#iskanje-odvisnega-dokumenta">6.4.2</a>)
</td>
<td style="text-align:left;">
<code>GET</code>
</td>
<td style="text-align:left;">
<code>/locations/:locationId/</code><br><code>comments/:commentId</code>
</td>
<td style="text-align:left;">
<code>locationId</code>, <code>commentId</code>
</td>
<td style="text-align:left;">
<code>http://&lt;server&gt;/api/</code><br><code>locations/123/comments/abc</code>
</td>
</tr>
</tbody>
</table>
<div id="iskanje-dokumenta" class="section level3 hasAnchor" number="6.4.1">
<h3><span class="header-section-number">6.4.1</span> Iskanje dokumenta<a href="PB-REST-API.html#iskanje-dokumenta" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Mongoose dostopa do podatkovne baze preko modelov, kar je tudi razlog, da smo model <code>Locations</code> vključili v oba krmilnika <code>api/controllers/comments.js</code> in <code>api/controllers/locations.js</code>.</p>
<p>MongoDB ima preko dostopa z Mongoose na voljo <a href="https://mongoosejs.com/docs/queries.html"><i class="fa-solid fa-earth-europe"></i>številne metode</a> za iskanje podatkov, kjer so ključne naslednje:</p>
<ul>
<li><a href="https://mongoosejs.com/docs/api.html#model_Model-find"><i class="fa-solid fa-database"></i><strong><code>find</code></strong></a> se uporablja za splošno iskanje, glede na podan filter iskanja,</li>
<li><a href="https://mongoosejs.com/docs/api.html#model_Model-findById"><i class="fa-solid fa-database"></i><strong><code>findById</code></strong></a> išče dokument s podanim enoličnim identifikatorjem,</li>
<li><a href="https://mongoosejs.com/docs/api.html#model_Model-findOne"><i class="fa-solid fa-database"></i><strong><code>findOne</code></strong></a> vrne prvi rezultat ujemanja podanega filtra iskanja,</li>
<li><a href="https://www.mongodb.com/docs/manual/reference/operator/aggregation/geoNear/"><i class="fa-solid fa-database"></i><strong><code>geoNear</code></strong></a> (preko funkcije <a href="https://mongoosejs.com/docs/api.html#model_Model-aggregate"><i class="fa-solid fa-database"></i><code>aggregate</code></a>) išče zadetke, ki so geografsko blizu podani zemljepisni širini in dolžini.</li>
</ul>
<p>Za potrebe <strong>iskanja določene lokacije</strong> bomo uporabili metodo <a href="https://mongoosejs.com/docs/api.html#model_Model-findById"><i class="fa-solid fa-database"></i><code>findById</code></a>.</p>
<p><code>api/controllers/locations.js</code></p>
<div class="sourceCode" id="cb461"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb461-1"><a href="PB-REST-API.html#cb461-1" tabindex="-1"></a><span class="kw">const</span> locationsReadOne <span class="op">=</span> <span class="kw">async</span> (req<span class="op">,</span> res) <span class="kw">=&gt;</span> {</span>
<span id="cb461-2"><a href="PB-REST-API.html#cb461-2" tabindex="-1"></a>  <span class="kw">let</span> location <span class="op">=</span> <span class="cf">await</span> <span class="bu">Location</span><span class="op">.</span><span class="fu">findById</span>(req<span class="op">.</span><span class="at">params</span><span class="op">.</span><span class="at">locationId</span>)</span>
<span id="cb461-3"><a href="PB-REST-API.html#cb461-3" tabindex="-1"></a>    <span class="op">.</span><span class="fu">select</span>(<span class="st">&quot;-id&quot;</span>)</span>
<span id="cb461-4"><a href="PB-REST-API.html#cb461-4" tabindex="-1"></a>    <span class="op">.</span><span class="fu">exec</span>()<span class="op">;</span></span>
<span id="cb461-5"><a href="PB-REST-API.html#cb461-5" tabindex="-1"></a>  res<span class="op">.</span><span class="fu">status</span>(<span class="dv">200</span>)<span class="op">.</span><span class="fu">json</span>(location { <span class="dt">status</span><span class="op">:</span> <span class="st">&quot;OK&quot;</span> })<span class="op">;</span></span>
<span id="cb461-6"><a href="PB-REST-API.html#cb461-6" tabindex="-1"></a>}<span class="op">;</span></span></code></pre></div>
<p>Sedaj lahko preverimo delovanje metode tako, da najprej ugotovimo ID lokacije iz MongoDB podatkovne baze, kjer uporabimo predhodno pripravljeno skripto <code>view:db-docker</code>.</p>
<div class="sourceCode" id="cb462"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb462-1"><a href="PB-REST-API.html#cb462-1" tabindex="-1"></a><span class="ex">$</span> npm run view:db-docker</span>
<span id="cb462-2"><a href="PB-REST-API.html#cb462-2" tabindex="-1"></a><span class="op">&gt;</span> demo@0.1.0 <span class="ex">view:db-docker</span></span>
<span id="cb462-3"><a href="PB-REST-API.html#cb462-3" tabindex="-1"></a><span class="op">&gt;</span> docker <span class="bu">exec</span> <span class="at">-it</span> sp-mongo-db bash <span class="at">-c</span> <span class="st">&quot;mongosh Demo --eval &#39;db.Locations.find()&#39;&quot;</span></span>
<span id="cb462-4"><a href="PB-REST-API.html#cb462-4" tabindex="-1"></a><span class="ex">Current</span> Mongosh Log ID: 635a2a8d85c2a42a4dadfe2b</span>
<span id="cb462-5"><a href="PB-REST-API.html#cb462-5" tabindex="-1"></a><span class="ex">Connecting</span> to:          mongodb://127.0.0.1:27017/Demo<span class="pp">?</span>directConnection=true<span class="kw">&amp;</span><span class="va">serverSelectionTimeoutMS</span><span class="op">=</span>2000<span class="kw">&amp;</span><span class="va">appName</span><span class="op">=</span>mongosh+1.6.0</span>
<span id="cb462-6"><a href="PB-REST-API.html#cb462-6" tabindex="-1"></a><span class="ex">Using</span> MongoDB:          6.0.2</span>
<span id="cb462-7"><a href="PB-REST-API.html#cb462-7" tabindex="-1"></a><span class="ex">Using</span> Mongosh:          1.6.0</span>
<span id="cb462-8"><a href="PB-REST-API.html#cb462-8" tabindex="-1"></a><span class="bu">[</span></span>
<span id="cb462-9"><a href="PB-REST-API.html#cb462-9" tabindex="-1"></a>  {</span>
<span id="cb462-10"><a href="PB-REST-API.html#cb462-10" tabindex="-1"></a>    _id: ObjectId<span class="er">(</span><span class="st">&quot;635a62f5dc5d7968e68464c1&quot;</span><span class="er">)</span>,</span>
<span id="cb462-11"><a href="PB-REST-API.html#cb462-11" tabindex="-1"></a>    <span class="er">id:</span> <span class="er">29884,</span></span>
<span id="cb462-12"><a href="PB-REST-API.html#cb462-12" tabindex="-1"></a>    <span class="ex">name:</span> <span class="st">&#39;Šentrupert na Dolenjskem - Muzej na prostem&#39;</span>,</span>
<span id="cb462-13"><a href="PB-REST-API.html#cb462-13" tabindex="-1"></a>    <span class="ex">...</span></span>
<span id="cb462-14"><a href="PB-REST-API.html#cb462-14" tabindex="-1"></a>  <span class="er">}</span><span class="ex">,</span></span>
<span id="cb462-15"><a href="PB-REST-API.html#cb462-15" tabindex="-1"></a>  <span class="ex">...</span></span>
<span id="cb462-16"><a href="PB-REST-API.html#cb462-16" tabindex="-1"></a><span class="ex">]</span></span></code></pre></div>
<p>Uporabili bomo kar prvo kulturno dediščino na seznamu, in sicer <strong>muzej na prostem v Šentrupertu na Dolenjskem</strong> z ID-jem <code>635a62f5dc5d7968e68464c1</code>.</p>
<blockquote>
<p><strong>Opomba</strong>: Naši podatki v obliki dokumentov v podatkovni bazi MongoDB imajo dva enolična identifikatorja <code>_id</code> in <code>id</code>. V okviru delovanja naše aplikacije bomo vedno uporabljali <code>_id</code>, medtem ko <code>id</code> predstavlja zgolj uvožen podatke iz <a href="https://www.gov.si/teme/register-kulturne-dediscine/"><i class="fa-solid fa-earth-europe"></i>registra kulturne dediščine</a> in v tistem viru predstavlja enolični identifikator, ki ga pri nas hranimo zgolj kot referenco.</p>
</blockquote>
<p>Nato s pomočjo ID-ja dokumenta sestavimo zahtevo, ki nam vrne zahtevan komentar iz podatkovne baze preko REST API-ja.</p>
<div class="sourceCode" id="cb463"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb463-1"><a href="PB-REST-API.html#cb463-1" tabindex="-1"></a><span class="ex">$</span> curl http://localhost:3000/api/locations/635a62f5dc5d7968e68464c1</span></code></pre></div>
<p>Kot odgovor strežnik vrne <i class="fa-regular fa-file-lines"></i>JSON dokument, ki ustreza zapisu v MongoDB podatkovni bazi in je skladen z Mongoose shemo, ki smo jo opredelili v poglavju <a href="PB-REST-API.html#osnovna-opredelitev-sheme">6.1.4.1</a>.</p>
<div class="sourceCode" id="cb464"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb464-1"><a href="PB-REST-API.html#cb464-1" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb464-2"><a href="PB-REST-API.html#cb464-2" tabindex="-1"></a>  <span class="dt">&quot;synonyms&quot;</span><span class="fu">:</span> <span class="ot">[]</span><span class="fu">,</span></span>
<span id="cb464-3"><a href="PB-REST-API.html#cb464-3" tabindex="-1"></a>  <span class="dt">&quot;rating&quot;</span><span class="fu">:</span> <span class="dv">0</span><span class="fu">,</span></span>
<span id="cb464-4"><a href="PB-REST-API.html#cb464-4" tabindex="-1"></a>  <span class="dt">&quot;_id&quot;</span><span class="fu">:</span> <span class="st">&quot;635a62f5dc5d7968e68464c1&quot;</span><span class="fu">,</span></span>
<span id="cb464-5"><a href="PB-REST-API.html#cb464-5" tabindex="-1"></a>  <span class="dt">&quot;id&quot;</span><span class="fu">:</span> <span class="dv">29884</span><span class="fu">,</span></span>
<span id="cb464-6"><a href="PB-REST-API.html#cb464-6" tabindex="-1"></a>  <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;Šentrupert na Dolenjskem - Muzej na prostem&quot;</span><span class="fu">,</span></span>
<span id="cb464-7"><a href="PB-REST-API.html#cb464-7" tabindex="-1"></a>  <span class="dt">&quot;category&quot;</span><span class="fu">:</span> <span class="st">&quot;stavbe&quot;</span><span class="fu">,</span></span>
<span id="cb464-8"><a href="PB-REST-API.html#cb464-8" tabindex="-1"></a>  <span class="dt">&quot;type&quot;</span><span class="fu">:</span> <span class="st">&quot;profana stavbna dediščina&quot;</span><span class="fu">,</span></span>
<span id="cb464-9"><a href="PB-REST-API.html#cb464-9" tabindex="-1"></a>  <span class="dt">&quot;keywords&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb464-10"><a href="PB-REST-API.html#cb464-10" tabindex="-1"></a>    <span class="st">&quot;muzej na prostem&quot;</span><span class="ot">,</span></span>
<span id="cb464-11"><a href="PB-REST-API.html#cb464-11" tabindex="-1"></a>    <span class="st">&quot;kozolec na psa&quot;</span><span class="ot">,</span></span>
<span id="cb464-12"><a href="PB-REST-API.html#cb464-12" tabindex="-1"></a>    <span class="st">&quot;kozolec s plaščem&quot;</span><span class="ot">,</span></span>
<span id="cb464-13"><a href="PB-REST-API.html#cb464-13" tabindex="-1"></a>    <span class="st">&quot;enojni kozolec&quot;</span><span class="ot">,</span></span>
<span id="cb464-14"><a href="PB-REST-API.html#cb464-14" tabindex="-1"></a>    <span class="st">&quot;nizki kozolec&quot;</span><span class="ot">,</span></span>
<span id="cb464-15"><a href="PB-REST-API.html#cb464-15" tabindex="-1"></a>    <span class="st">&quot;toplar&quot;</span><span class="ot">,</span></span>
<span id="cb464-16"><a href="PB-REST-API.html#cb464-16" tabindex="-1"></a>    <span class="st">&quot;vzporedni kozolec&quot;</span></span>
<span id="cb464-17"><a href="PB-REST-API.html#cb464-17" tabindex="-1"></a>  <span class="ot">]</span><span class="fu">,</span></span>
<span id="cb464-18"><a href="PB-REST-API.html#cb464-18" tabindex="-1"></a>  <span class="dt">&quot;description&quot;</span><span class="fu">:</span> <span class="st">&quot;Muzej na prostem sestavljajo skupina 17 kozolcev različnih tipov in dve enostavni sušilni napravi (belokranjska ostrv in ribniški kozouček). Postavitev iz 2012 prikazuje genezo kozolca na Slovenskem in raznolikost kozolcev v Mirnski dolini.&quot;</span><span class="fu">,</span></span>
<span id="cb464-19"><a href="PB-REST-API.html#cb464-19" tabindex="-1"></a>  <span class="dt">&quot;location&quot;</span><span class="fu">:</span> <span class="st">&quot;Muzej na prostem je urejen na južnem obrobju Šentruperta na Dolenjskem.&quot;</span><span class="fu">,</span></span>
<span id="cb464-20"><a href="PB-REST-API.html#cb464-20" tabindex="-1"></a>  <span class="dt">&quot;institution&quot;</span><span class="fu">:</span> <span class="st">&quot;ZVKD Novo mesto&quot;</span><span class="fu">,</span></span>
<span id="cb464-21"><a href="PB-REST-API.html#cb464-21" tabindex="-1"></a>  <span class="dt">&quot;heritage&quot;</span><span class="fu">:</span> <span class="st">&quot;spomenik lokalnega pomena&quot;</span><span class="fu">,</span></span>
<span id="cb464-22"><a href="PB-REST-API.html#cb464-22" tabindex="-1"></a>  <span class="dt">&quot;municipality&quot;</span><span class="fu">:</span> <span class="st">&quot;ŠENTRUPERT&quot;</span><span class="fu">,</span></span>
<span id="cb464-23"><a href="PB-REST-API.html#cb464-23" tabindex="-1"></a>  <span class="dt">&quot;coordinates&quot;</span><span class="fu">:</span> <span class="ot">[</span><span class="fl">45.9748324693</span><span class="ot">,</span> <span class="fl">15.0914351743</span><span class="ot">]</span><span class="fu">,</span></span>
<span id="cb464-24"><a href="PB-REST-API.html#cb464-24" tabindex="-1"></a>  <span class="dt">&quot;datation&quot;</span><span class="fu">:</span> <span class="st">&quot;zadnja četrtina 18. stol., 19. stol., prva polovica 20. stol., prva četrtina 21. stol., 2012&quot;</span><span class="fu">,</span></span>
<span id="cb464-25"><a href="PB-REST-API.html#cb464-25" tabindex="-1"></a>  <span class="dt">&quot;fields&quot;</span><span class="fu">:</span> <span class="ot">[</span><span class="st">&quot;etnologija&quot;</span><span class="ot">,</span> <span class="st">&quot;krajinska arhitektura&quot;</span><span class="ot">,</span> <span class="st">&quot;tehniška zgodovina&quot;</span><span class="ot">]</span><span class="fu">,</span></span>
<span id="cb464-26"><a href="PB-REST-API.html#cb464-26" tabindex="-1"></a>  <span class="dt">&quot;comments&quot;</span><span class="fu">:</span> <span class="ot">[]</span></span>
<span id="cb464-27"><a href="PB-REST-API.html#cb464-27" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
<script>
  $(document).ready(function() {
    $("#iskanje-dokumenta code.javascript:eq(0)").markRegExp(/async /, options_dodaj);
    $("#iskanje-dokumenta code.javascript:eq(0)").markRegExp(/\s+?let location[\s\S]+?exec\(\);/, options_dodaj);
    $("#iskanje-dokumenta code.javascript:eq(0)").markRegExp(/location /, options_dodaj);
    $("#iskanje-dokumenta code.javascript:eq(0)").markRegExp(/{ status: "OK" }/, options_izbrisi);
    $("#iskanje-dokumenta code.bash:eq(0)").markRegExp(/npm run.+/, options_dodaj);
    $("#iskanje-dokumenta code.bash:eq(0)").markRegExp(/635a62f5dc5d7968e68464c1/, options_dodaj);
    $("#iskanje-dokumenta code.bash:eq(1)").markRegExp(/curl.+/, options_dodaj);
  });
</script>
<div id="napake-rest" class="section level4 hasAnchor" number="6.4.1.1">
<h4><span class="header-section-number">6.4.1.1</span> Obvladovanje napak<a href="PB-REST-API.html#napake-rest" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Trenutna težava naše implementacije je, da vrne zgolj uspešen odgovor, v primeru neuspešne zahteve pa ne vrne ničesar. Dobra praksa pri pripravi API-ja je obvladovanje in lovljenje napak, zato moramo poskrbeti tudi za to in odjemalcu vedno vrniti odgovor, tudi ko pride do napake. V našem primeru lahko pride do naslednjih napak:</p>
<ul>
<li>metoda <code>findById</code> <strong>ne vrne nobene lokacije</strong> in</li>
<li><strong>med izvajanjem</strong> metode <code>findById</code> <strong>pride do napake</strong>.</li>
</ul>
<p><code>api/controllers/locations.js</code></p>
<div class="sourceCode" id="cb465"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb465-1"><a href="PB-REST-API.html#cb465-1" tabindex="-1"></a><span class="kw">const</span> locationsReadOne <span class="op">=</span> <span class="kw">async</span> (req<span class="op">,</span> res) <span class="kw">=&gt;</span> {</span>
<span id="cb465-2"><a href="PB-REST-API.html#cb465-2" tabindex="-1"></a>  <span class="cf">try</span> {</span>
<span id="cb465-3"><a href="PB-REST-API.html#cb465-3" tabindex="-1"></a>    <span class="kw">let</span> location <span class="op">=</span> <span class="cf">await</span> <span class="bu">Location</span><span class="op">.</span><span class="fu">findById</span>(req<span class="op">.</span><span class="at">params</span><span class="op">.</span><span class="at">locationId</span>)</span>
<span id="cb465-4"><a href="PB-REST-API.html#cb465-4" tabindex="-1"></a>      <span class="op">.</span><span class="fu">select</span>(<span class="st">&quot;-id&quot;</span>)</span>
<span id="cb465-5"><a href="PB-REST-API.html#cb465-5" tabindex="-1"></a>      <span class="op">.</span><span class="fu">exec</span>()<span class="op">;</span></span>
<span id="cb465-6"><a href="PB-REST-API.html#cb465-6" tabindex="-1"></a>    <span class="cf">if</span> (<span class="op">!</span>location)</span>
<span id="cb465-7"><a href="PB-REST-API.html#cb465-7" tabindex="-1"></a>      res<span class="op">.</span><span class="fu">status</span>(<span class="dv">404</span>)<span class="op">.</span><span class="fu">json</span>({</span>
<span id="cb465-8"><a href="PB-REST-API.html#cb465-8" tabindex="-1"></a>        <span class="dt">message</span><span class="op">:</span> <span class="vs">`Location with id &#39;</span><span class="sc">${</span>req<span class="op">.</span><span class="at">params</span><span class="op">.</span><span class="at">locationId</span><span class="sc">}</span><span class="vs">&#39; not found`</span><span class="op">,</span></span>
<span id="cb465-9"><a href="PB-REST-API.html#cb465-9" tabindex="-1"></a>      })<span class="op">;</span></span>
<span id="cb465-10"><a href="PB-REST-API.html#cb465-10" tabindex="-1"></a>    <span class="cf">else</span> res<span class="op">.</span><span class="fu">status</span>(<span class="dv">200</span>)<span class="op">.</span><span class="fu">json</span>(location)<span class="op">;</span></span>
<span id="cb465-11"><a href="PB-REST-API.html#cb465-11" tabindex="-1"></a>  } <span class="cf">catch</span> (err) {</span>
<span id="cb465-12"><a href="PB-REST-API.html#cb465-12" tabindex="-1"></a>    res<span class="op">.</span><span class="fu">status</span>(<span class="dv">500</span>)<span class="op">.</span><span class="fu">json</span>({ <span class="dt">message</span><span class="op">:</span> err<span class="op">.</span><span class="at">message</span> })<span class="op">;</span></span>
<span id="cb465-13"><a href="PB-REST-API.html#cb465-13" tabindex="-1"></a>  }</span>
<span id="cb465-14"><a href="PB-REST-API.html#cb465-14" tabindex="-1"></a>}<span class="op">;</span></span></code></pre></div>
<p>Sedaj lahko simuliramo obe napaki. Najprej iskanje dokumenta z enoličnim identifikatorjem, ki ne obstaja.</p>
<blockquote>
<p><strong>Opomba</strong>: Pri kreiranju zahteve z ukazom <code>curl</code> bomo uporabili parameter <code>-i</code>, ki v izpisu vrne tudi glavo odgovora strežnika, da lahko preverimo tudi šifro statusa.</p>
</blockquote>
<div class="sourceCode" id="cb466"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb466-1"><a href="PB-REST-API.html#cb466-1" tabindex="-1"></a><span class="ex">$</span> curl <span class="at">-i</span> http://localhost:3000/api/locations/735a62f5dc5d7968e68464c1</span>
<span id="cb466-2"><a href="PB-REST-API.html#cb466-2" tabindex="-1"></a></span>
<span id="cb466-3"><a href="PB-REST-API.html#cb466-3" tabindex="-1"></a><span class="ex">HTTP/1.1</span> 404 Not Found</span>
<span id="cb466-4"><a href="PB-REST-API.html#cb466-4" tabindex="-1"></a><span class="ex">...</span></span>
<span id="cb466-5"><a href="PB-REST-API.html#cb466-5" tabindex="-1"></a><span class="ex">{</span><span class="st">&quot;message&quot;</span><span class="ex">:</span><span class="st">&quot;Location with id &#39;735a62f5dc5d7968e68464c1&#39; not found.&quot;</span><span class="ex">}</span></span></code></pre></div>
<p>Nato pa še iskanje dokumenta z napačno obliko enoličnega identifikatorja, kar povzroči napako na strežniku.</p>
<div class="sourceCode" id="cb467"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb467-1"><a href="PB-REST-API.html#cb467-1" tabindex="-1"></a><span class="ex">$</span> curl <span class="at">-i</span> http://localhost:3000/api/locations/1</span>
<span id="cb467-2"><a href="PB-REST-API.html#cb467-2" tabindex="-1"></a></span>
<span id="cb467-3"><a href="PB-REST-API.html#cb467-3" tabindex="-1"></a><span class="ex">HTTP/1.1</span> 500 Internal Server Error</span>
<span id="cb467-4"><a href="PB-REST-API.html#cb467-4" tabindex="-1"></a><span class="ex">...</span></span>
<span id="cb467-5"><a href="PB-REST-API.html#cb467-5" tabindex="-1"></a><span class="ex">{</span><span class="st">&quot;message&quot;</span><span class="ex">:</span><span class="st">&quot;Cast to ObjectId failed for value </span><span class="dt">\&quot;</span><span class="st">1</span><span class="dt">\&quot;</span><span class="st"> (type string) at path </span><span class="dt">\&quot;</span><span class="st">_id</span><span class="dt">\&quot;</span><span class="st"> for model </span><span class="dt">\&quot;</span><span class="st">Location</span><span class="dt">\&quot;</span><span class="st">&quot;</span><span class="ex">}</span></span></code></pre></div>
<script>
  $(document).ready(function() {
    $("#napake-rest code.javascript:eq(0)").markRegExp(/\s+?try {/, options_dodaj);
    $("#napake-rest code.javascript:eq(0)").markRegExp(/\s+?if \(!location\)[\s\S]+?else /, options_dodaj);
    $("#napake-rest code.javascript:eq(0)").markRegExp(/\s+?} catch[\s\S]+?}\);[\s\S]+?}/, options_dodaj);
    $("#napake-rest code.bash").markRegExp(/curl.+/, options_dodaj);
    $("#napake-rest code.bash").markRegExp(/(404|500).+/, options_dodaj);
    $("#napake-rest code.bash").markRegExp(/{.+?}/, options_dodaj);
  });
</script>
</div>
</div>
<div id="iskanje-odvisnega-dokumenta" class="section level3 hasAnchor" number="6.4.2">
<h3><span class="header-section-number">6.4.2</span> Iskanje odvisnega dokumenta<a href="PB-REST-API.html#iskanje-odvisnega-dokumenta" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Komentarji so v našem primeru shranjeni kot deli dokumenta lokacije (odvisni dokumenti), tako da moramo najprej poiskati lokacijo, nato pa v tem dokumentu poiskati ustrezen komentar. Pri implementaciji metode <code>commentsReadOne</code> v krmilniku <code>api/controllers/comments.js</code> si lahko pomagamo z implementacijo metode <code>locationsReadOne</code> iz prejšnjega poglavja <a href="PB-REST-API.html#iskanje-dokumenta">6.4.1</a>. Ker ne potrebujemo vseh podatkov lokacije, lahko že v poizvedbi z uporabo <code>.select("atribut1 atribut2 ...")</code> omejimo, katere podatke potrebujemo. Prav tako je v okviru MongoDB na voljo metoda <code>id</code>, s pomočjo katere lahko iščemo odvisne dokumente glede na podan enolični identifikator.</p>
<p><code>api/controllers/comments.js</code></p>
<div class="sourceCode" id="cb468"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb468-1"><a href="PB-REST-API.html#cb468-1" tabindex="-1"></a><span class="kw">const</span> commentsReadOne <span class="op">=</span> <span class="kw">async</span> (req<span class="op">,</span> res) <span class="kw">=&gt;</span> {</span>
<span id="cb468-2"><a href="PB-REST-API.html#cb468-2" tabindex="-1"></a>  <span class="cf">try</span> {</span>
<span id="cb468-3"><a href="PB-REST-API.html#cb468-3" tabindex="-1"></a>    <span class="kw">let</span> location <span class="op">=</span> <span class="cf">await</span> <span class="bu">Location</span><span class="op">.</span><span class="fu">findById</span>(req<span class="op">.</span><span class="at">params</span><span class="op">.</span><span class="at">locationId</span>)</span>
<span id="cb468-4"><a href="PB-REST-API.html#cb468-4" tabindex="-1"></a>      <span class="op">.</span><span class="fu">select</span>(<span class="st">&quot;name comments&quot;</span>)</span>
<span id="cb468-5"><a href="PB-REST-API.html#cb468-5" tabindex="-1"></a>      <span class="op">.</span><span class="fu">exec</span>()<span class="op">;</span></span>
<span id="cb468-6"><a href="PB-REST-API.html#cb468-6" tabindex="-1"></a>    <span class="cf">if</span> (<span class="op">!</span>location)</span>
<span id="cb468-7"><a href="PB-REST-API.html#cb468-7" tabindex="-1"></a>      res<span class="op">.</span><span class="fu">status</span>(<span class="dv">404</span>)<span class="op">.</span><span class="fu">json</span>({</span>
<span id="cb468-8"><a href="PB-REST-API.html#cb468-8" tabindex="-1"></a>        <span class="dt">message</span><span class="op">:</span> <span class="vs">`Location with id &#39;</span><span class="sc">${</span>req<span class="op">.</span><span class="at">params</span><span class="op">.</span><span class="at">locationId</span><span class="sc">}</span><span class="vs">&#39; not found`</span><span class="op">,</span></span>
<span id="cb468-9"><a href="PB-REST-API.html#cb468-9" tabindex="-1"></a>      })<span class="op">;</span></span>
<span id="cb468-10"><a href="PB-REST-API.html#cb468-10" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> (<span class="op">!</span>location<span class="op">.</span><span class="at">comments</span> <span class="op">||</span> location<span class="op">.</span><span class="at">comments</span><span class="op">.</span><span class="at">length</span> <span class="op">==</span> <span class="dv">0</span>)</span>
<span id="cb468-11"><a href="PB-REST-API.html#cb468-11" tabindex="-1"></a>      res<span class="op">.</span><span class="fu">status</span>(<span class="dv">404</span>)<span class="op">.</span><span class="fu">json</span>({ <span class="dt">message</span><span class="op">:</span> <span class="st">&quot;No comments found.&quot;</span> })<span class="op">;</span></span>
<span id="cb468-12"><a href="PB-REST-API.html#cb468-12" tabindex="-1"></a>    <span class="cf">else</span> {</span>
<span id="cb468-13"><a href="PB-REST-API.html#cb468-13" tabindex="-1"></a>      <span class="kw">let</span> comment <span class="op">=</span> location<span class="op">.</span><span class="at">comments</span><span class="op">.</span><span class="fu">id</span>(req<span class="op">.</span><span class="at">params</span><span class="op">.</span><span class="at">commentId</span>)<span class="op">;</span></span>
<span id="cb468-14"><a href="PB-REST-API.html#cb468-14" tabindex="-1"></a>      <span class="cf">if</span> (<span class="op">!</span>comment)</span>
<span id="cb468-15"><a href="PB-REST-API.html#cb468-15" tabindex="-1"></a>        res<span class="op">.</span><span class="fu">status</span>(<span class="dv">404</span>)<span class="op">.</span><span class="fu">json</span>({</span>
<span id="cb468-16"><a href="PB-REST-API.html#cb468-16" tabindex="-1"></a>          <span class="dt">message</span><span class="op">:</span> <span class="vs">`Comment with id &#39;</span><span class="sc">${</span>req<span class="op">.</span><span class="at">params</span><span class="op">.</span><span class="at">commentId</span><span class="sc">}</span><span class="vs">&#39; not found.`</span><span class="op">,</span></span>
<span id="cb468-17"><a href="PB-REST-API.html#cb468-17" tabindex="-1"></a>        })<span class="op">;</span></span>
<span id="cb468-18"><a href="PB-REST-API.html#cb468-18" tabindex="-1"></a>      <span class="cf">else</span> {</span>
<span id="cb468-19"><a href="PB-REST-API.html#cb468-19" tabindex="-1"></a>        res<span class="op">.</span><span class="fu">status</span>(<span class="dv">200</span>)<span class="op">.</span><span class="fu">json</span>({</span>
<span id="cb468-20"><a href="PB-REST-API.html#cb468-20" tabindex="-1"></a>          <span class="dt">location</span><span class="op">:</span> {</span>
<span id="cb468-21"><a href="PB-REST-API.html#cb468-21" tabindex="-1"></a>            <span class="dt">_id</span><span class="op">:</span> req<span class="op">.</span><span class="at">params</span><span class="op">.</span><span class="at">locationId</span><span class="op">,</span></span>
<span id="cb468-22"><a href="PB-REST-API.html#cb468-22" tabindex="-1"></a>            <span class="dt">name</span><span class="op">:</span> location<span class="op">.</span><span class="at">name</span><span class="op">,</span></span>
<span id="cb468-23"><a href="PB-REST-API.html#cb468-23" tabindex="-1"></a>          }<span class="op">,</span></span>
<span id="cb468-24"><a href="PB-REST-API.html#cb468-24" tabindex="-1"></a>          comment<span class="op">,</span></span>
<span id="cb468-25"><a href="PB-REST-API.html#cb468-25" tabindex="-1"></a>          <span class="dt">status</span><span class="op">:</span> <span class="st">&quot;OK&quot;</span></span>
<span id="cb468-26"><a href="PB-REST-API.html#cb468-26" tabindex="-1"></a>        })<span class="op">;</span></span>
<span id="cb468-27"><a href="PB-REST-API.html#cb468-27" tabindex="-1"></a>      }</span>
<span id="cb468-28"><a href="PB-REST-API.html#cb468-28" tabindex="-1"></a>    }</span>
<span id="cb468-29"><a href="PB-REST-API.html#cb468-29" tabindex="-1"></a>  } <span class="cf">catch</span> (err) {</span>
<span id="cb468-30"><a href="PB-REST-API.html#cb468-30" tabindex="-1"></a>    res<span class="op">.</span><span class="fu">status</span>(<span class="dv">500</span>)<span class="op">.</span><span class="fu">json</span>({ <span class="dt">message</span><span class="op">:</span> err<span class="op">.</span><span class="at">message</span> })<span class="op">;</span></span>
<span id="cb468-31"><a href="PB-REST-API.html#cb468-31" tabindex="-1"></a>  }</span>
<span id="cb468-32"><a href="PB-REST-API.html#cb468-32" tabindex="-1"></a>}<span class="op">;</span></span></code></pre></div>
<p>Sedaj lahko preverimo delovanje metode tako, da najprej ugotovimo ID lokacije in ID komentarja iz MongoDB podatkovne baze pri lokaciji <code>Celje - Celjski grad</code>, kateri smo pri uvozu podatkov dodali komentarje.</p>
<div class="sourceCode" id="cb469"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb469-1"><a href="PB-REST-API.html#cb469-1" tabindex="-1"></a>$ docker exec <span class="op">-</span>it sp<span class="op">-</span>mongo<span class="op">-</span>db bash <span class="op">-</span>c <span class="st">&quot;mongosh Demo --eval &#39;db.Locations.find({name: </span><span class="sc">\&quot;</span><span class="st">Celje - Celjski grad</span><span class="sc">\&quot;</span><span class="st">})&#39;&quot;</span></span>
<span id="cb469-2"><a href="PB-REST-API.html#cb469-2" tabindex="-1"></a>Connecting to<span class="op">:</span>          mongodb<span class="op">:</span><span class="co">//127.0.0.1:27017/Demo?directConnection=true&amp;serverSelectionTimeoutMS=2000&amp;appName=mongosh+1.6.0</span></span>
<span id="cb469-3"><a href="PB-REST-API.html#cb469-3" tabindex="-1"></a>Using MongoDB<span class="op">:</span>          <span class="fl">6.0.2</span></span>
<span id="cb469-4"><a href="PB-REST-API.html#cb469-4" tabindex="-1"></a>Using Mongosh<span class="op">:</span>          <span class="fl">1.6.0</span></span>
<span id="cb469-5"><a href="PB-REST-API.html#cb469-5" tabindex="-1"></a>[</span>
<span id="cb469-6"><a href="PB-REST-API.html#cb469-6" tabindex="-1"></a>  {</span>
<span id="cb469-7"><a href="PB-REST-API.html#cb469-7" tabindex="-1"></a>    <span class="dt">_id</span><span class="op">:</span> <span class="fu">ObjectId</span>(<span class="st">&quot;635a62f5dc5d7968e6846574&quot;</span>)<span class="op">,</span></span>
<span id="cb469-8"><a href="PB-REST-API.html#cb469-8" tabindex="-1"></a>    <span class="dt">name</span><span class="op">:</span> <span class="st">&#39;Celje - Celjski grad&#39;</span><span class="op">,</span></span>
<span id="cb469-9"><a href="PB-REST-API.html#cb469-9" tabindex="-1"></a>    <span class="op">...,</span></span>
<span id="cb469-10"><a href="PB-REST-API.html#cb469-10" tabindex="-1"></a>    <span class="dt">comments</span><span class="op">:</span> [</span>
<span id="cb469-11"><a href="PB-REST-API.html#cb469-11" tabindex="-1"></a>      {</span>
<span id="cb469-12"><a href="PB-REST-API.html#cb469-12" tabindex="-1"></a>        <span class="dt">_id</span><span class="op">:</span> <span class="fu">ObjectId</span>(<span class="st">&quot;635a62f5dc5d7968e68464be&quot;</span>)<span class="op">,</span></span>
<span id="cb469-13"><a href="PB-REST-API.html#cb469-13" tabindex="-1"></a>        <span class="dt">author</span><span class="op">:</span> <span class="st">&#39;Dejan Lavbič&#39;</span><span class="op">,</span></span>
<span id="cb469-14"><a href="PB-REST-API.html#cb469-14" tabindex="-1"></a>        <span class="dt">rating</span><span class="op">:</span> <span class="dv">5</span><span class="op">,</span></span>
<span id="cb469-15"><a href="PB-REST-API.html#cb469-15" tabindex="-1"></a>        <span class="dt">comment</span><span class="op">:</span> <span class="st">&#39;Odlična lokacija, ne morem je prehvaliti.&#39;</span><span class="op">,</span></span>
<span id="cb469-16"><a href="PB-REST-API.html#cb469-16" tabindex="-1"></a>        <span class="dt">createdOn</span><span class="op">:</span> <span class="fu">ISODate</span>(<span class="st">&quot;2010-04-04T00:00:00.000Z&quot;</span>)</span>
<span id="cb469-17"><a href="PB-REST-API.html#cb469-17" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb469-18"><a href="PB-REST-API.html#cb469-18" tabindex="-1"></a>      {</span>
<span id="cb469-19"><a href="PB-REST-API.html#cb469-19" tabindex="-1"></a>        <span class="dt">_id</span><span class="op">:</span> <span class="fu">ObjectId</span>(<span class="st">&quot;635a62f5dc5d7968e68464bf&quot;</span>)<span class="op">,</span></span>
<span id="cb469-20"><a href="PB-REST-API.html#cb469-20" tabindex="-1"></a>        <span class="dt">author</span><span class="op">:</span> <span class="st">&#39;Vladimir Putin&#39;</span><span class="op">,</span></span>
<span id="cb469-21"><a href="PB-REST-API.html#cb469-21" tabindex="-1"></a>        <span class="dt">rating</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb469-22"><a href="PB-REST-API.html#cb469-22" tabindex="-1"></a>        <span class="dt">comment</span><span class="op">:</span> <span class="st">&#39;Čisti dolgčas, še kava je zanič. Edina svetla točka je razstava mučilnih naprav.&#39;</span><span class="op">,</span></span>
<span id="cb469-23"><a href="PB-REST-API.html#cb469-23" tabindex="-1"></a>        <span class="dt">createdOn</span><span class="op">:</span> <span class="fu">ISODate</span>(<span class="st">&quot;2016-07-30T00:00:00.000Z&quot;</span>)</span>
<span id="cb469-24"><a href="PB-REST-API.html#cb469-24" tabindex="-1"></a>      }</span>
<span id="cb469-25"><a href="PB-REST-API.html#cb469-25" tabindex="-1"></a>    ]</span>
<span id="cb469-26"><a href="PB-REST-API.html#cb469-26" tabindex="-1"></a>  }</span>
<span id="cb469-27"><a href="PB-REST-API.html#cb469-27" tabindex="-1"></a>]</span></code></pre></div>
<p>Nato s pomočjo ID-ja dokumenta sestavimo zahtevo, ki nam <strong>vrne</strong> zahtevano lokacijo in <strong>komentar</strong> iz podatkovne baze preko REST API-ja.</p>
<div class="sourceCode" id="cb470"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb470-1"><a href="PB-REST-API.html#cb470-1" tabindex="-1"></a>$ curl <span class="op">-</span>i http<span class="op">:</span><span class="co">//localhost:3000/api/locations/635a62f5dc5d7968e6846574/comments/635a62f5dc5d7968e68464be</span></span>
<span id="cb470-2"><a href="PB-REST-API.html#cb470-2" tabindex="-1"></a></span>
<span id="cb470-3"><a href="PB-REST-API.html#cb470-3" tabindex="-1"></a>HTTP<span class="op">/</span><span class="fl">1.1</span> <span class="dv">200</span> OK</span>
<span id="cb470-4"><a href="PB-REST-API.html#cb470-4" tabindex="-1"></a><span class="op">...</span></span>
<span id="cb470-5"><a href="PB-REST-API.html#cb470-5" tabindex="-1"></a>{</span>
<span id="cb470-6"><a href="PB-REST-API.html#cb470-6" tabindex="-1"></a>  <span class="st">&quot;location&quot;</span><span class="op">:</span> {</span>
<span id="cb470-7"><a href="PB-REST-API.html#cb470-7" tabindex="-1"></a>    <span class="st">&quot;_id&quot;</span><span class="op">:</span> <span class="st">&quot;635a62f5dc5d7968e6846574&quot;</span><span class="op">,</span></span>
<span id="cb470-8"><a href="PB-REST-API.html#cb470-8" tabindex="-1"></a>    <span class="st">&quot;name&quot;</span><span class="op">:</span> <span class="st">&quot;Celje - Celjski grad&quot;</span></span>
<span id="cb470-9"><a href="PB-REST-API.html#cb470-9" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb470-10"><a href="PB-REST-API.html#cb470-10" tabindex="-1"></a>  <span class="st">&quot;comment&quot;</span><span class="op">:</span> {</span>
<span id="cb470-11"><a href="PB-REST-API.html#cb470-11" tabindex="-1"></a>    <span class="st">&quot;_id&quot;</span><span class="op">:</span> <span class="st">&quot;635a62f5dc5d7968e68464be&quot;</span><span class="op">,</span></span>
<span id="cb470-12"><a href="PB-REST-API.html#cb470-12" tabindex="-1"></a>    <span class="st">&quot;author&quot;</span><span class="op">:</span> <span class="st">&quot;Dejan Lavbič&quot;</span><span class="op">,</span></span>
<span id="cb470-13"><a href="PB-REST-API.html#cb470-13" tabindex="-1"></a>    <span class="st">&quot;rating&quot;</span><span class="op">:</span> <span class="dv">5</span><span class="op">,</span></span>
<span id="cb470-14"><a href="PB-REST-API.html#cb470-14" tabindex="-1"></a>    <span class="st">&quot;comment&quot;</span><span class="op">:</span> <span class="st">&quot;Odlična lokacija, ne morem je prehvaliti.&quot;</span><span class="op">,</span></span>
<span id="cb470-15"><a href="PB-REST-API.html#cb470-15" tabindex="-1"></a>    <span class="st">&quot;createdOn&quot;</span><span class="op">:</span> <span class="st">&quot;2010-04-04T00:00:00.000Z&quot;</span></span>
<span id="cb470-16"><a href="PB-REST-API.html#cb470-16" tabindex="-1"></a>  }</span>
<span id="cb470-17"><a href="PB-REST-API.html#cb470-17" tabindex="-1"></a>}</span></code></pre></div>
<p>Preverimo lahko še napake, in sicer najprej če <strong>lokacija nima nobenega komentarja</strong>.</p>
<div class="sourceCode" id="cb471"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb471-1"><a href="PB-REST-API.html#cb471-1" tabindex="-1"></a>$ curl <span class="op">-</span>i http<span class="op">:</span><span class="co">//localhost:3000/api/locations/635a62f5dc5d7968e6846575/comments/1</span></span>
<span id="cb471-2"><a href="PB-REST-API.html#cb471-2" tabindex="-1"></a></span>
<span id="cb471-3"><a href="PB-REST-API.html#cb471-3" tabindex="-1"></a>HTTP<span class="op">/</span><span class="fl">1.1</span> <span class="dv">404</span> Not Found</span>
<span id="cb471-4"><a href="PB-REST-API.html#cb471-4" tabindex="-1"></a><span class="op">...</span></span>
<span id="cb471-5"><a href="PB-REST-API.html#cb471-5" tabindex="-1"></a>{<span class="st">&quot;message&quot;</span><span class="op">:</span><span class="st">&quot;No comments found.&quot;</span>}</span></code></pre></div>
<p>Do napake pride tudi, če zahtevamo <strong>neobstoječ komentar pri obstoječi lokaciji</strong>.</p>
<div class="sourceCode" id="cb472"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb472-1"><a href="PB-REST-API.html#cb472-1" tabindex="-1"></a>$ curl <span class="op">-</span>i http<span class="op">:</span><span class="co">//localhost:3000/api/locations/635a62f5dc5d7968e6846574/comments/1</span></span>
<span id="cb472-2"><a href="PB-REST-API.html#cb472-2" tabindex="-1"></a></span>
<span id="cb472-3"><a href="PB-REST-API.html#cb472-3" tabindex="-1"></a>HTTP<span class="op">/</span><span class="fl">1.1</span> <span class="dv">404</span> Not Found</span>
<span id="cb472-4"><a href="PB-REST-API.html#cb472-4" tabindex="-1"></a><span class="op">...</span></span>
<span id="cb472-5"><a href="PB-REST-API.html#cb472-5" tabindex="-1"></a>{<span class="st">&quot;message&quot;</span><span class="op">:</span><span class="st">&quot;Comment with id &#39;1&#39; not found.&quot;</span>}</span></code></pre></div>
<p>Naslednja napaka je zahteva po komentarju <strong>neobstoječe lokacije</strong>.</p>
<div class="sourceCode" id="cb473"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb473-1"><a href="PB-REST-API.html#cb473-1" tabindex="-1"></a>$ curl <span class="op">-</span>i http<span class="op">:</span><span class="co">//localhost:3000/api/locations/73512fc5022f6bd9e0dfe53e/comments/2</span></span>
<span id="cb473-2"><a href="PB-REST-API.html#cb473-2" tabindex="-1"></a></span>
<span id="cb473-3"><a href="PB-REST-API.html#cb473-3" tabindex="-1"></a>HTTP<span class="op">/</span><span class="fl">1.1</span> <span class="dv">404</span> Not Found</span>
<span id="cb473-4"><a href="PB-REST-API.html#cb473-4" tabindex="-1"></a><span class="op">...</span></span>
<span id="cb473-5"><a href="PB-REST-API.html#cb473-5" tabindex="-1"></a>{<span class="st">&quot;message&quot;</span><span class="op">:</span><span class="st">&quot;Location with id &#39;73512fc5022f6bd9e0dfe53e&#39; not found.&quot;</span>}</span></code></pre></div>
<p>Še zadnja možna napaka pa je <strong>napaka na strežniku</strong>, ko podamo napačno obliko enoličnega identifikatorja.</p>
<div class="sourceCode" id="cb474"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb474-1"><a href="PB-REST-API.html#cb474-1" tabindex="-1"></a>$ curl <span class="op">-</span>i http<span class="op">:</span><span class="co">//localhost:3000/api/locations/1/comments/2</span></span>
<span id="cb474-2"><a href="PB-REST-API.html#cb474-2" tabindex="-1"></a></span>
<span id="cb474-3"><a href="PB-REST-API.html#cb474-3" tabindex="-1"></a>HTTP<span class="op">/</span><span class="fl">1.1</span> <span class="dv">500</span> Internal <span class="bu">Server</span> <span class="bu">Error</span></span>
<span id="cb474-4"><a href="PB-REST-API.html#cb474-4" tabindex="-1"></a><span class="op">...</span></span>
<span id="cb474-5"><a href="PB-REST-API.html#cb474-5" tabindex="-1"></a>{<span class="st">&quot;message&quot;</span><span class="op">:</span><span class="st">&quot;Cast to ObjectId failed for value </span><span class="sc">\&quot;</span><span class="st">1</span><span class="sc">\&quot;</span><span class="st"> (type string) at path </span><span class="sc">\&quot;</span><span class="st">_id</span><span class="sc">\&quot;</span><span class="st"> for model </span><span class="sc">\&quot;</span><span class="st">Location</span><span class="sc">\&quot;</span><span class="st">&quot;</span>}</span></code></pre></div>
<script>
  $(document).ready(function() {
    $("#iskanje-odvisnega-dokumenta code.javascript:eq(0)").markRegExp(/async /, options_dodaj);
    $("#iskanje-odvisnega-dokumenta code.javascript:eq(0)").markRegExp(/\s+?try {[\s\S]+?else {[\s\S]+?else {/, options_dodaj);
    $("#iskanje-odvisnega-dokumenta code.javascript:eq(0)").markRegExp(/\s+?location: {[\s\S]+?comment,/, options_dodaj);
    $("#iskanje-odvisnega-dokumenta code.javascript:eq(0)").markRegExp(/.+?"OK".*/, options_izbrisi);
    $("#iskanje-odvisnega-dokumenta code.javascript:eq(0)").markRegExp(/\s+?}\);[^_]+?} catch[\s\S]+?}\);[\s\S]+?}/, options_dodaj);
    $("#iskanje-odvisnega-dokumenta code.javascript:eq(1)").markRegExp(/docker.+/, options_dodaj);
    $("#iskanje-odvisnega-dokumenta code.javascript:eq(1)").markRegExp(/(635a62f5dc5d7968e6846574|635a62f5dc5d7968e68464be)/, options_dodaj);
    $("#iskanje-odvisnega-dokumenta code.javascript:eq(2)").markRegExp(/(curl|200 OK).*/, options_dodaj);
    $("#iskanje-odvisnega-dokumenta code.javascript:eq(2)").markRegExp(/{[\s\S]+?createdOn[\s\S]+?}/, options_dodaj);
    $("#iskanje-odvisnega-dokumenta code.javascript:eq(3)").markRegExp(/(curl|404).*/, options_dodaj);
    $("#iskanje-odvisnega-dokumenta code.javascript:eq(3)").markRegExp(/{[\s\S]+?}/, options_dodaj);
    $("#iskanje-odvisnega-dokumenta code.javascript:eq(4)").markRegExp(/(curl|404).*/, options_dodaj);
    $("#iskanje-odvisnega-dokumenta code.javascript:eq(4)").markRegExp(/{[\s\S]+?}/, options_dodaj);
    $("#iskanje-odvisnega-dokumenta code.javascript:eq(5)").markRegExp(/(curl|404).*/, options_dodaj);
    $("#iskanje-odvisnega-dokumenta code.javascript:eq(5)").markRegExp(/{[\s\S]+?}/, options_dodaj);
    $("#iskanje-odvisnega-dokumenta code.javascript:eq(6)").markRegExp(/(curl|500).*/, options_dodaj);
    $("#iskanje-odvisnega-dokumenta code.javascript:eq(6)").markRegExp(/{[\s\S]+?}/, options_dodaj);
  });
</script>
</div>
<div id="geografsko-iskanje" class="section level3 hasAnchor" number="6.4.3">
<h3><span class="header-section-number">6.4.3</span> Geografsko iskanje več dokumentov<a href="PB-REST-API.html#geografsko-iskanje" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Spletna stran aplikacije naj bi prikazala seznam zanimivih lokacij, glede na trenutni položaj uporabnika. MongoDB ima na voljo nekaj geografskih funkcij iskanja, ki nam bodo to opravilo olajšale.</p>
<p>Pri zahtevi za prikaz lokacij bomo imeli naslednje parametre:</p>
<ul>
<li>obvezni parameter <i class="fa-solid fa-tag"></i><code>lng</code> predstavlja <a href="https://en.wikipedia.org/wiki/Longitude"><i class="fa-brands fa-wikipedia-w"></i><strong>zemljepisno dolžino</strong></a> <em>(angl. longitude)</em>,</li>
<li>obvezni parameter <i class="fa-solid fa-tag"></i><code>lat</code> predstavlja <a href="https://en.wikipedia.org/wiki/Latitude"><i class="fa-brands fa-wikipedia-w"></i><strong>zemljepisno širino</strong></a> <em>(angl. latitude)</em> in</li>
<li>opcijski parameter <i class="fa-solid fa-tag"></i><code>maxDistance</code> predstavlja <strong>omejitev iskanja</strong>, do katere <strong>največje razdalje</strong> (v km) od podane točke naj vrača rezultate (privzeta vrednost je <code>5</code>),</li>
<li>opcijski parameter <i class="fa-solid fa-tag"></i><code>nResults</code> predstavlja <strong>omejitev iskanja</strong>, in sicer zgornjo mejo števila zadetkov (privzeta vrednost je <code>10</code>).</li>
</ul>
<p>Celotna implementacija funkcije za prikaz najbližjih lokacij <code>locationsListByDistance</code> je prikazana v nadaljevanju. Uporabili smo <a href="https://www.mongodb.com/docs/manual/aggregation/"><i class="fa-solid fa-database"></i>cevovod združevanja</a> <em>(angl. aggregation pipelines)</em>, kjer lahko nad podatkovno bazo MongoDB v zaporedju izvajamo željene operacije. V našem primeru bo to:</p>
<ul>
<li><a href="https://www.mongodb.com/docs/manual/reference/operator/aggregation/geoNear/"><i class="fa-solid fa-database"></i><strong><code>$geoNear</code></strong></a>, ki vrača vse dokumente z GPS koordinatami v željenem radiju od podane koordinate,</li>
<li><a href="https://www.mongodb.com/docs/manual/reference/operator/aggregation/project/"><i class="fa-solid fa-database"></i><strong><code>$project</code></strong></a> omogoča izbiro ali odstranjevanju atributov iz rezultata in</li>
<li><a href="https://www.mongodb.com/docs/manual/reference/operator/aggregation/limit/"><i class="fa-solid fa-database"></i><strong><code>$limit</code></strong></a>, ki omejuje največje število zadetkov.</li>
</ul>
<p>Rezultat poizvedba predstavlja vse dokumente, ki ustrezajo podanim pogojem, kjer ima vsak dokument dodan atribut <i class="fa-solid fa-tag"></i><code>distance</code> z izračunano razdaljo od točke v parametru do posamezne lokacije.</p>
<p><code>api/controllers/locations.js</code></p>
<div class="sourceCode" id="cb475"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb475-1"><a href="PB-REST-API.html#cb475-1" tabindex="-1"></a><span class="kw">const</span> locationsListByDistance <span class="op">=</span> <span class="kw">async</span> (req<span class="op">,</span> res) <span class="kw">=&gt;</span> {</span>
<span id="cb475-2"><a href="PB-REST-API.html#cb475-2" tabindex="-1"></a>  <span class="kw">let</span> lng <span class="op">=</span> <span class="pp">parseFloat</span>(req<span class="op">.</span><span class="at">query</span><span class="op">.</span><span class="at">lng</span>)<span class="op">;</span></span>
<span id="cb475-3"><a href="PB-REST-API.html#cb475-3" tabindex="-1"></a>  <span class="kw">let</span> lat <span class="op">=</span> <span class="pp">parseFloat</span>(req<span class="op">.</span><span class="at">query</span><span class="op">.</span><span class="at">lat</span>)<span class="op">;</span></span>
<span id="cb475-4"><a href="PB-REST-API.html#cb475-4" tabindex="-1"></a>  <span class="kw">let</span> distance <span class="op">=</span> <span class="pp">parseFloat</span>(req<span class="op">.</span><span class="at">query</span><span class="op">.</span><span class="at">maxDistance</span>)<span class="op">;</span></span>
<span id="cb475-5"><a href="PB-REST-API.html#cb475-5" tabindex="-1"></a>  distance <span class="op">=</span> <span class="dv">1000</span> <span class="op">*</span> (<span class="pp">isNaN</span>(distance) <span class="op">?</span> <span class="dv">5</span> <span class="op">:</span> distance)<span class="op">;</span></span>
<span id="cb475-6"><a href="PB-REST-API.html#cb475-6" tabindex="-1"></a>  <span class="kw">let</span> nResults <span class="op">=</span> <span class="pp">parseInt</span>(req<span class="op">.</span><span class="at">query</span><span class="op">.</span><span class="at">nResults</span>)<span class="op">;</span></span>
<span id="cb475-7"><a href="PB-REST-API.html#cb475-7" tabindex="-1"></a>  nResults <span class="op">=</span> <span class="pp">isNaN</span>(nResults) <span class="op">?</span> <span class="dv">10</span> <span class="op">:</span> nResults<span class="op">;</span></span>
<span id="cb475-8"><a href="PB-REST-API.html#cb475-8" tabindex="-1"></a>  <span class="cf">if</span> (<span class="op">!</span>lng <span class="op">||</span> <span class="op">!</span>lat)</span>
<span id="cb475-9"><a href="PB-REST-API.html#cb475-9" tabindex="-1"></a>    res</span>
<span id="cb475-10"><a href="PB-REST-API.html#cb475-10" tabindex="-1"></a>      <span class="op">.</span><span class="fu">status</span>(<span class="dv">400</span>)</span>
<span id="cb475-11"><a href="PB-REST-API.html#cb475-11" tabindex="-1"></a>      <span class="op">.</span><span class="fu">json</span>({ <span class="dt">message</span><span class="op">:</span> <span class="st">&quot;Query parameters &#39;lng&#39; and &#39;lat&#39; are required.&quot;</span> })<span class="op">;</span></span>
<span id="cb475-12"><a href="PB-REST-API.html#cb475-12" tabindex="-1"></a>  <span class="cf">else</span> {</span>
<span id="cb475-13"><a href="PB-REST-API.html#cb475-13" tabindex="-1"></a>    <span class="cf">try</span> {</span>
<span id="cb475-14"><a href="PB-REST-API.html#cb475-14" tabindex="-1"></a>      <span class="kw">let</span> locations <span class="op">=</span> <span class="cf">await</span> <span class="bu">Location</span><span class="op">.</span><span class="fu">aggregate</span>([</span>
<span id="cb475-15"><a href="PB-REST-API.html#cb475-15" tabindex="-1"></a>        {</span>
<span id="cb475-16"><a href="PB-REST-API.html#cb475-16" tabindex="-1"></a>          <span class="dt">$geoNear</span><span class="op">:</span> {</span>
<span id="cb475-17"><a href="PB-REST-API.html#cb475-17" tabindex="-1"></a>            <span class="dt">near</span><span class="op">:</span> {</span>
<span id="cb475-18"><a href="PB-REST-API.html#cb475-18" tabindex="-1"></a>              <span class="dt">type</span><span class="op">:</span> <span class="st">&quot;Point&quot;</span><span class="op">,</span></span>
<span id="cb475-19"><a href="PB-REST-API.html#cb475-19" tabindex="-1"></a>              <span class="dt">coordinates</span><span class="op">:</span> [lng<span class="op">,</span> lat]<span class="op">,</span></span>
<span id="cb475-20"><a href="PB-REST-API.html#cb475-20" tabindex="-1"></a>            }<span class="op">,</span></span>
<span id="cb475-21"><a href="PB-REST-API.html#cb475-21" tabindex="-1"></a>            <span class="dt">distanceField</span><span class="op">:</span> <span class="st">&quot;distance&quot;</span><span class="op">,</span></span>
<span id="cb475-22"><a href="PB-REST-API.html#cb475-22" tabindex="-1"></a>            <span class="dt">spherical</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb475-23"><a href="PB-REST-API.html#cb475-23" tabindex="-1"></a>            <span class="dt">maxDistance</span><span class="op">:</span> distance<span class="op">,</span></span>
<span id="cb475-24"><a href="PB-REST-API.html#cb475-24" tabindex="-1"></a>          }<span class="op">,</span></span>
<span id="cb475-25"><a href="PB-REST-API.html#cb475-25" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb475-26"><a href="PB-REST-API.html#cb475-26" tabindex="-1"></a>        { <span class="dt">$project</span><span class="op">:</span> { <span class="dt">comments</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span> <span class="dt">id</span><span class="op">:</span> <span class="kw">false</span> } }<span class="op">,</span></span>
<span id="cb475-27"><a href="PB-REST-API.html#cb475-27" tabindex="-1"></a>        { <span class="dt">$limit</span><span class="op">:</span> nResults }<span class="op">,</span></span>
<span id="cb475-28"><a href="PB-REST-API.html#cb475-28" tabindex="-1"></a>      ])<span class="op">;</span></span>
<span id="cb475-29"><a href="PB-REST-API.html#cb475-29" tabindex="-1"></a>      <span class="cf">if</span> (<span class="op">!</span>locations <span class="op">||</span> locations<span class="op">.</span><span class="at">length</span> <span class="op">==</span> <span class="dv">0</span>)</span>
<span id="cb475-30"><a href="PB-REST-API.html#cb475-30" tabindex="-1"></a>        res<span class="op">.</span><span class="fu">status</span>(<span class="dv">404</span>)<span class="op">.</span><span class="fu">json</span>({ <span class="dt">message</span><span class="op">:</span> <span class="st">&quot;No locations found.&quot;</span> })<span class="op">;</span></span>
<span id="cb475-31"><a href="PB-REST-API.html#cb475-31" tabindex="-1"></a>      <span class="cf">else</span> res<span class="op">.</span><span class="fu">status</span>(<span class="dv">200</span>)<span class="op">.</span><span class="fu">json</span>(locations { <span class="dt">status</span><span class="op">:</span> <span class="st">&quot;OK&quot;</span> })<span class="op">;</span></span>
<span id="cb475-32"><a href="PB-REST-API.html#cb475-32" tabindex="-1"></a>    } <span class="cf">catch</span> (err) {</span>
<span id="cb475-33"><a href="PB-REST-API.html#cb475-33" tabindex="-1"></a>      res<span class="op">.</span><span class="fu">status</span>(<span class="dv">500</span>)<span class="op">.</span><span class="fu">json</span>({ <span class="dt">message</span><span class="op">:</span> err<span class="op">.</span><span class="at">message</span> })<span class="op">;</span></span>
<span id="cb475-34"><a href="PB-REST-API.html#cb475-34" tabindex="-1"></a>    }</span>
<span id="cb475-35"><a href="PB-REST-API.html#cb475-35" tabindex="-1"></a>  }</span>
<span id="cb475-36"><a href="PB-REST-API.html#cb475-36" tabindex="-1"></a>}<span class="op">;</span></span></code></pre></div>
<p>Sedaj lahko preverimo delovanje metode s testno zahtevo, kjer kot začetno točko podamo GPS koordinate lokacije <code>UL FRI</code> in zahtevamo največ <code>2</code> lokaciji v radiju <code>5</code> km.</p>
<blockquote>
<p><strong>Opomba</strong>: Pri izračunu oddaljenosti točk se upošteva zračna razdalja.</p>
</blockquote>
<div class="sourceCode" id="cb476"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb476-1"><a href="PB-REST-API.html#cb476-1" tabindex="-1"></a>$ curl <span class="op">-</span>i http<span class="op">:</span><span class="co">//localhost:3000/api/locations/distance?lng=14.469027&amp;lat=46.050129&amp;maxDistance=5&amp;nResults=2</span></span>
<span id="cb476-2"><a href="PB-REST-API.html#cb476-2" tabindex="-1"></a></span>
<span id="cb476-3"><a href="PB-REST-API.html#cb476-3" tabindex="-1"></a>HTTP<span class="op">/</span><span class="fl">1.1</span> <span class="dv">200</span> OK</span>
<span id="cb476-4"><a href="PB-REST-API.html#cb476-4" tabindex="-1"></a><span class="op">...</span></span>
<span id="cb476-5"><a href="PB-REST-API.html#cb476-5" tabindex="-1"></a>[</span>
<span id="cb476-6"><a href="PB-REST-API.html#cb476-6" tabindex="-1"></a>  {</span>
<span id="cb476-7"><a href="PB-REST-API.html#cb476-7" tabindex="-1"></a>    <span class="st">&quot;_id&quot;</span><span class="op">:</span> <span class="st">&quot;635a62f5dc5d7968e68467e3&quot;</span><span class="op">,</span></span>
<span id="cb476-8"><a href="PB-REST-API.html#cb476-8" tabindex="-1"></a>    <span class="st">&quot;name&quot;</span><span class="op">:</span> <span class="st">&quot;Ljubljana - Cankarjeva spominska soba na Rožniku&quot;</span><span class="op">,</span></span>
<span id="cb476-9"><a href="PB-REST-API.html#cb476-9" tabindex="-1"></a>    <span class="op">...</span></span>
<span id="cb476-10"><a href="PB-REST-API.html#cb476-10" tabindex="-1"></a>    <span class="st">&quot;distance&quot;</span><span class="op">:</span> <span class="fl">858.0692052049162</span><span class="op">,</span></span>
<span id="cb476-11"><a href="PB-REST-API.html#cb476-11" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb476-12"><a href="PB-REST-API.html#cb476-12" tabindex="-1"></a>  {</span>
<span id="cb476-13"><a href="PB-REST-API.html#cb476-13" tabindex="-1"></a>    <span class="st">&quot;_id&quot;</span><span class="op">:</span> <span class="st">&quot;635a62f5dc5d7968e6846914&quot;</span><span class="op">,</span></span>
<span id="cb476-14"><a href="PB-REST-API.html#cb476-14" tabindex="-1"></a>    <span class="st">&quot;name&quot;</span><span class="op">:</span> <span class="st">&quot;Ljubljana - Viško pokopališče&quot;</span><span class="op">,</span></span>
<span id="cb476-15"><a href="PB-REST-API.html#cb476-15" tabindex="-1"></a>    <span class="op">...</span></span>
<span id="cb476-16"><a href="PB-REST-API.html#cb476-16" tabindex="-1"></a>    <span class="st">&quot;distance&quot;</span><span class="op">:</span> <span class="fl">1158.460509757077</span><span class="op">,</span></span>
<span id="cb476-17"><a href="PB-REST-API.html#cb476-17" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb476-18"><a href="PB-REST-API.html#cb476-18" tabindex="-1"></a>]</span></code></pre></div>
<p>Kot odgovor dobimo pričakovana 2 zadetka, <code>Cankarjeva spominska soba na Rožniku</code> na razdalji ~ <strong>858 m</strong> in <code>Viško pokopališče</code> na razdalji ~ <strong>1.158 m</strong>.</p>
<p>Če ponovimo iskanje v okolici <code>UL FRI</code>, ampak tokrat v radiju <code>500</code> m, nam sistem vrne napako, saj takšnih <strong>lokacij ni</strong>.</p>
<div class="sourceCode" id="cb477"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb477-1"><a href="PB-REST-API.html#cb477-1" tabindex="-1"></a>$ curl <span class="op">-</span>i http<span class="op">:</span><span class="co">//localhost:3000/api/locations/distance?lng=14.469027&amp;lat=46.050129&amp;maxDistance=0.5</span></span>
<span id="cb477-2"><a href="PB-REST-API.html#cb477-2" tabindex="-1"></a></span>
<span id="cb477-3"><a href="PB-REST-API.html#cb477-3" tabindex="-1"></a>HTTP<span class="op">/</span><span class="fl">1.1</span> <span class="dv">404</span> Not Found</span>
<span id="cb477-4"><a href="PB-REST-API.html#cb477-4" tabindex="-1"></a><span class="op">...</span></span>
<span id="cb477-5"><a href="PB-REST-API.html#cb477-5" tabindex="-1"></a>{<span class="st">&quot;message&quot;</span><span class="op">:</span><span class="st">&quot;No locations found.&quot;</span>}</span></code></pre></div>
<p>Če <strong>manjkata</strong> edina <strong>obvezna parametra</strong> GPS koordinat v obliki <code>lng</code> in <code>lat</code>, sistem ravno tako vrne napako.</p>
<div class="sourceCode" id="cb478"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb478-1"><a href="PB-REST-API.html#cb478-1" tabindex="-1"></a>$ curl <span class="op">-</span>i http<span class="op">:</span><span class="co">//localhost:3000/api/locations/distance</span></span>
<span id="cb478-2"><a href="PB-REST-API.html#cb478-2" tabindex="-1"></a></span>
<span id="cb478-3"><a href="PB-REST-API.html#cb478-3" tabindex="-1"></a>HTTP<span class="op">/</span><span class="fl">1.1</span> <span class="dv">400</span> Bad Request</span>
<span id="cb478-4"><a href="PB-REST-API.html#cb478-4" tabindex="-1"></a><span class="op">...</span></span>
<span id="cb478-5"><a href="PB-REST-API.html#cb478-5" tabindex="-1"></a>{<span class="st">&quot;message&quot;</span><span class="op">:</span><span class="st">&quot;Query parameters &#39;lng&#39; and &#39;lat&#39; are required&quot;</span>}</span></code></pre></div>
<p>Prav tako pa lahko pride do <strong>napake na strežniku</strong>, če podamo neustrezne parametre.</p>
<div class="sourceCode" id="cb479"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb479-1"><a href="PB-REST-API.html#cb479-1" tabindex="-1"></a>$ curl <span class="op">-</span>i http<span class="op">:</span><span class="co">//localhost:3000/api/locations/distance?lng=200&amp;lat=300</span></span>
<span id="cb479-2"><a href="PB-REST-API.html#cb479-2" tabindex="-1"></a></span>
<span id="cb479-3"><a href="PB-REST-API.html#cb479-3" tabindex="-1"></a>HTTP<span class="op">/</span><span class="fl">1.1</span> <span class="dv">500</span> Internal <span class="bu">Server</span> <span class="bu">Error</span></span>
<span id="cb479-4"><a href="PB-REST-API.html#cb479-4" tabindex="-1"></a><span class="op">...</span></span>
<span id="cb479-5"><a href="PB-REST-API.html#cb479-5" tabindex="-1"></a>{<span class="st">&quot;message&quot;</span><span class="op">:</span><span class="st">&quot;geo near accepts just one argument when querying for a GeoJSON point. Extra field found: $maxDistance: 5000.0&quot;</span>}</span></code></pre></div>
<script>
  $(document).ready(function() {
    $("#geografsko-iskanje code.javascript:eq(0)").markRegExp(/async /, options_dodaj);
    $("#geografsko-iskanje code.javascript:eq(0)").markRegExp(/\s+?let lng[\s\S]+?No locations found[\s\S]+?else /, options_dodaj);
    $("#geografsko-iskanje code.javascript:eq(0)").markRegExp(/locations /, options_dodaj);
    $("#geografsko-iskanje code.javascript:eq(0)").markRegExp(/{ status: "OK" }/, options_izbrisi);
    $("#geografsko-iskanje code.javascript:eq(0)").markRegExp(/\s+?} catch[\s\S]+?err\.message }[\s\S]+?}[\s\S]+?}/, options_dodaj);

    $("#geografsko-iskanje code.javascript:eq(1)").markRegExp(/(curl|200).+/, options_dodaj);
    $("#geografsko-iskanje code.javascript:eq(1)").markRegExp(/Ljubljana.+?(Rožniku|pokopališče)/, options_dodaj);
    $("#geografsko-iskanje code.javascript:eq(1)").markRegExp(/(858|1158)\.\d+/, options_dodaj);
    $("#geografsko-iskanje code.javascript:eq(2)").markRegExp(/(curl|404).+/, options_dodaj);
    $("#geografsko-iskanje code.javascript:eq(2)").markRegExp(/{.+?}/, options_dodaj);
    $("#geografsko-iskanje code.javascript:eq(3)").markRegExp(/(curl|400).+/, options_dodaj);
    $("#geografsko-iskanje code.javascript:eq(3)").markRegExp(/{.+?}/, options_dodaj);
    $("#geografsko-iskanje code.javascript:eq(4)").markRegExp(/(curl|500).+/, options_dodaj);
    $("#geografsko-iskanje code.javascript:eq(4)").markRegExp(/{.+?}/, options_dodaj);
  });
</script>
</div>
<div id="napredno-iskanje" class="section level3 hasAnchor" number="6.4.4">
<h3><span class="header-section-number">6.4.4</span> Napredno iskanje<a href="PB-REST-API.html#napredno-iskanje" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Poleg geografskega iskanja, ki smo ga uvedli v prejšnjem poglavju <a href="PB-REST-API.html#geografsko-iskanje">6.4.3</a>, bomo dodali še možnost naprednega iskanja po različnih vrednostih šifrantov. Lokacije, ki so shranjene v podatkovni bazi, so opisane s številnimi atributi; v okviru te funkcionalnosti pa bomo podprli iskanje po naslednjih atributih: <i class="fa-solid fa-tag"></i><code>category</code>, <i class="fa-solid fa-tag"></i><code>type</code>, <i class="fa-solid fa-tag"></i><code>keywords</code>, <span class="skupaj"><i class="fa-solid fa-tag"></i><code>institution</code></span>, <i class="fa-solid fa-tag"></i><code>municipality</code> in <i class="fa-solid fa-tag"></i><code>fields</code> ter <i class="fa-solid fa-tag"></i><code>nResults</code>, ki omeji zgornjo število zadetkov. Vsi parametri so opcijski. Če ne podamo nobene omejitve, sistem vrne prvih <code>10</code> lokacij (privzeta vrednost <code>nResults</code> je <code>10</code>).</p>
<p><code>api/controllers/locations.js</code></p>
<div class="sourceCode" id="cb480"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb480-1"><a href="PB-REST-API.html#cb480-1" tabindex="-1"></a><span class="kw">const</span> mongoose <span class="op">=</span> <span class="pp">require</span>(<span class="st">&quot;mongoose&quot;</span>)<span class="op">;</span></span>
<span id="cb480-2"><a href="PB-REST-API.html#cb480-2" tabindex="-1"></a><span class="kw">const</span> <span class="bu">Location</span> <span class="op">=</span> mongoose<span class="op">.</span><span class="fu">model</span>(<span class="st">&quot;Location&quot;</span>)<span class="op">;</span></span>
<span id="cb480-3"><a href="PB-REST-API.html#cb480-3" tabindex="-1"></a><span class="kw">const</span> allowedCodelists <span class="op">=</span> [</span>
<span id="cb480-4"><a href="PB-REST-API.html#cb480-4" tabindex="-1"></a>  <span class="st">&quot;category&quot;</span><span class="op">,</span></span>
<span id="cb480-5"><a href="PB-REST-API.html#cb480-5" tabindex="-1"></a>  <span class="st">&quot;type&quot;</span><span class="op">,</span></span>
<span id="cb480-6"><a href="PB-REST-API.html#cb480-6" tabindex="-1"></a>  <span class="st">&quot;keywords&quot;</span><span class="op">,</span></span>
<span id="cb480-7"><a href="PB-REST-API.html#cb480-7" tabindex="-1"></a>  <span class="st">&quot;institution&quot;</span><span class="op">,</span></span>
<span id="cb480-8"><a href="PB-REST-API.html#cb480-8" tabindex="-1"></a>  <span class="st">&quot;municipality&quot;</span><span class="op">,</span></span>
<span id="cb480-9"><a href="PB-REST-API.html#cb480-9" tabindex="-1"></a>  <span class="st">&quot;fields&quot;</span><span class="op">,</span></span>
<span id="cb480-10"><a href="PB-REST-API.html#cb480-10" tabindex="-1"></a>]<span class="op">;</span></span>
<span id="cb480-11"><a href="PB-REST-API.html#cb480-11" tabindex="-1"></a><span class="op">...</span></span>
<span id="cb480-12"><a href="PB-REST-API.html#cb480-12" tabindex="-1"></a><span class="kw">const</span> locationsListByMultiFilter <span class="op">=</span> <span class="kw">async</span> (req<span class="op">,</span> res) <span class="kw">=&gt;</span> {</span>
<span id="cb480-13"><a href="PB-REST-API.html#cb480-13" tabindex="-1"></a>  <span class="kw">let</span> filter <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb480-14"><a href="PB-REST-API.html#cb480-14" tabindex="-1"></a>  <span class="co">// Exclude fields</span></span>
<span id="cb480-15"><a href="PB-REST-API.html#cb480-15" tabindex="-1"></a>  filter<span class="op">.</span><span class="fu">push</span>({ <span class="dt">$project</span><span class="op">:</span> { <span class="dt">comments</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span> <span class="dt">id</span><span class="op">:</span> <span class="kw">false</span> } })<span class="op">;</span></span>
<span id="cb480-16"><a href="PB-REST-API.html#cb480-16" tabindex="-1"></a>  <span class="co">// Filter by codelist if provided</span></span>
<span id="cb480-17"><a href="PB-REST-API.html#cb480-17" tabindex="-1"></a>  allowedCodelists<span class="op">.</span><span class="fu">forEach</span>((codelist) <span class="kw">=&gt;</span> {</span>
<span id="cb480-18"><a href="PB-REST-API.html#cb480-18" tabindex="-1"></a>    <span class="kw">let</span> value <span class="op">=</span> req<span class="op">.</span><span class="at">query</span>[codelist]<span class="op">;</span></span>
<span id="cb480-19"><a href="PB-REST-API.html#cb480-19" tabindex="-1"></a>    <span class="cf">if</span> (value) filter<span class="op">.</span><span class="fu">push</span>({ <span class="dt">$match</span><span class="op">:</span> { [codelist]<span class="op">:</span> value } })<span class="op">;</span></span>
<span id="cb480-20"><a href="PB-REST-API.html#cb480-20" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb480-21"><a href="PB-REST-API.html#cb480-21" tabindex="-1"></a>  <span class="co">// Maximum number of results</span></span>
<span id="cb480-22"><a href="PB-REST-API.html#cb480-22" tabindex="-1"></a>  <span class="kw">let</span> nResults <span class="op">=</span> <span class="pp">parseInt</span>(req<span class="op">.</span><span class="at">query</span><span class="op">.</span><span class="at">nResults</span>)<span class="op">;</span></span>
<span id="cb480-23"><a href="PB-REST-API.html#cb480-23" tabindex="-1"></a>  nResults <span class="op">=</span> <span class="pp">isNaN</span>(nResults) <span class="op">?</span> <span class="dv">10</span> <span class="op">:</span> nResults<span class="op">;</span></span>
<span id="cb480-24"><a href="PB-REST-API.html#cb480-24" tabindex="-1"></a>  filter<span class="op">.</span><span class="fu">push</span>({ <span class="dt">$limit</span><span class="op">:</span> nResults })<span class="op">;</span></span>
<span id="cb480-25"><a href="PB-REST-API.html#cb480-25" tabindex="-1"></a>  <span class="co">// Perform database search and return results</span></span>
<span id="cb480-26"><a href="PB-REST-API.html#cb480-26" tabindex="-1"></a>  <span class="cf">try</span> {</span>
<span id="cb480-27"><a href="PB-REST-API.html#cb480-27" tabindex="-1"></a>    <span class="kw">let</span> locations <span class="op">=</span> <span class="cf">await</span> <span class="bu">Location</span><span class="op">.</span><span class="fu">aggregate</span>(filter)<span class="op">.</span><span class="fu">exec</span>()<span class="op">;</span></span>
<span id="cb480-28"><a href="PB-REST-API.html#cb480-28" tabindex="-1"></a>    <span class="cf">if</span> (<span class="op">!</span>locations <span class="op">||</span> locations<span class="op">.</span><span class="at">length</span> <span class="op">===</span> <span class="dv">0</span>)</span>
<span id="cb480-29"><a href="PB-REST-API.html#cb480-29" tabindex="-1"></a>      res<span class="op">.</span><span class="fu">status</span>(<span class="dv">404</span>)<span class="op">.</span><span class="fu">json</span>({ <span class="dt">message</span><span class="op">:</span> <span class="st">&quot;No locations found.&quot;</span> })<span class="op">;</span></span>
<span id="cb480-30"><a href="PB-REST-API.html#cb480-30" tabindex="-1"></a>    <span class="cf">else</span> res<span class="op">.</span><span class="fu">status</span>(<span class="dv">200</span>)<span class="op">.</span><span class="fu">json</span>(locations { <span class="dt">status</span><span class="op">:</span> <span class="st">&quot;OK&quot;</span> })<span class="op">;</span></span>
<span id="cb480-31"><a href="PB-REST-API.html#cb480-31" tabindex="-1"></a>  } <span class="cf">catch</span> (err) {</span>
<span id="cb480-32"><a href="PB-REST-API.html#cb480-32" tabindex="-1"></a>    res<span class="op">.</span><span class="fu">status</span>(<span class="dv">500</span>)<span class="op">.</span><span class="fu">json</span>({ <span class="dt">message</span><span class="op">:</span> err<span class="op">.</span><span class="at">message</span> })<span class="op">;</span></span>
<span id="cb480-33"><a href="PB-REST-API.html#cb480-33" tabindex="-1"></a>  }</span>
<span id="cb480-34"><a href="PB-REST-API.html#cb480-34" tabindex="-1"></a>}<span class="op">;</span></span></code></pre></div>
<p>Pri preverjanju delovanja naprednega iskanja si lahko zamislimo scenarij, kjer nas zanimajo lokacije, ki so kategorizirane (<code>category</code>) kot <strong>parki</strong>, tipa (<code>type</code>) <strong>vrtnoarhitekturna dediščina</strong>, vsebujejo ključno besedo (<code>keywords</code>) <strong>parki</strong> in spadajo v sklop (<code>fields</code>) <strong>krajinska arhitektura</strong>. Pri rezultatih se omejimo (<code>nResults</code>) zgolj na <strong>2</strong> zadetka.</p>
<blockquote>
<p><strong>Opomba</strong>: Pri testiranju spletnih zahtev je treba parametre spletnega naslova ustrezno <a href="https://en.wikipedia.org/wiki/Percent-encoding"><i class="fa-solid fa-earth-europe"></i>kodirati</a>, za kar bi v aplikaciji poskrbeli programsko s pomočjo podpornih knjižnic, v našem primeru ročnega testiranja z orodjem <code>curl</code> pa si lahko pomagamo s spletnim orodjem <a href="https://emn178.github.io/online-tools/url_encode.html"><i class="fa-solid fa-earth-europe"></i>URL Encode</a>.</p>
</blockquote>
<div class="sourceCode" id="cb481"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb481-1"><a href="PB-REST-API.html#cb481-1" tabindex="-1"></a>$ curl http<span class="op">:</span><span class="co">//localhost:3000/api/locations/search?category=parki%20in%20vrtovi&amp;type=vrtnoarhitekturna%20dedi%C5%A1%C4%8Dina&amp;keywords=grad&amp;fields=krajinska%20arhitektura&amp;nResults=2</span></span>
<span id="cb481-2"><a href="PB-REST-API.html#cb481-2" tabindex="-1"></a>[</span>
<span id="cb481-3"><a href="PB-REST-API.html#cb481-3" tabindex="-1"></a>  {</span>
<span id="cb481-4"><a href="PB-REST-API.html#cb481-4" tabindex="-1"></a>    <span class="st">&quot;_id&quot;</span><span class="op">:</span> <span class="st">&quot;635a62f5dc5d7968e68465a0&quot;</span><span class="op">,</span></span>
<span id="cb481-5"><a href="PB-REST-API.html#cb481-5" tabindex="-1"></a>    <span class="st">&quot;name&quot;</span><span class="op">:</span> <span class="st">&quot;Dolane - Park gradu Borl&quot;</span><span class="op">,</span></span>
<span id="cb481-6"><a href="PB-REST-API.html#cb481-6" tabindex="-1"></a>    <span class="st">&quot;category&quot;</span><span class="op">:</span> <span class="st">&quot;parki in vrtovi&quot;</span><span class="op">,</span></span>
<span id="cb481-7"><a href="PB-REST-API.html#cb481-7" tabindex="-1"></a>    <span class="st">&quot;type&quot;</span><span class="op">:</span> <span class="st">&quot;vrtnoarhitekturna dediščina&quot;</span><span class="op">,</span></span>
<span id="cb481-8"><a href="PB-REST-API.html#cb481-8" tabindex="-1"></a>    <span class="st">&quot;keywords&quot;</span><span class="op">:</span> [<span class="st">&quot;park&quot;</span><span class="op">,</span> <span class="st">&quot;vrt&quot;</span><span class="op">,</span> <span class="st">&quot;drevored&quot;</span><span class="op">,</span> <span class="st">&quot;grad&quot;</span>]<span class="op">,</span></span>
<span id="cb481-9"><a href="PB-REST-API.html#cb481-9" tabindex="-1"></a>    <span class="st">&quot;description&quot;</span><span class="op">:</span> <span class="st">&quot;Danes le še delno ohranjena parterna zasnova, do katere je vodil dvostranski drevored. Zaradi pomanjkanja prostora je bila odmaknjena od gradu. Ob gradu je bil urejen manjši vrt.&quot;</span><span class="op">,</span></span>
<span id="cb481-10"><a href="PB-REST-API.html#cb481-10" tabindex="-1"></a>    <span class="st">&quot;location&quot;</span><span class="op">:</span> <span class="st">&quot;Južno in okoli gradu Borl, ob vznožju strmega griča ob Dravi, ob lokalni cesti Dolane - Zavrč.&quot;</span><span class="op">,</span></span>
<span id="cb481-11"><a href="PB-REST-API.html#cb481-11" tabindex="-1"></a>    <span class="st">&quot;institution&quot;</span><span class="op">:</span> <span class="st">&quot;ZVKD Maribor&quot;</span><span class="op">,</span></span>
<span id="cb481-12"><a href="PB-REST-API.html#cb481-12" tabindex="-1"></a>    <span class="st">&quot;heritage&quot;</span><span class="op">:</span> <span class="st">&quot;neznano&quot;</span><span class="op">,</span></span>
<span id="cb481-13"><a href="PB-REST-API.html#cb481-13" tabindex="-1"></a>    <span class="st">&quot;municipality&quot;</span><span class="op">:</span> <span class="st">&quot;CIRKULANE&quot;</span><span class="op">,</span></span>
<span id="cb481-14"><a href="PB-REST-API.html#cb481-14" tabindex="-1"></a>    <span class="st">&quot;coordinates&quot;</span><span class="op">:</span> [<span class="fl">16.000902598</span><span class="op">,</span> <span class="fl">46.3722801631</span>]<span class="op">,</span></span>
<span id="cb481-15"><a href="PB-REST-API.html#cb481-15" tabindex="-1"></a>    <span class="st">&quot;datation&quot;</span><span class="op">:</span> <span class="st">&quot;17. stol.&quot;</span><span class="op">,</span></span>
<span id="cb481-16"><a href="PB-REST-API.html#cb481-16" tabindex="-1"></a>    <span class="st">&quot;fields&quot;</span><span class="op">:</span> [<span class="st">&quot;krajinska arhitektura&quot;</span>]<span class="op">,</span></span>
<span id="cb481-17"><a href="PB-REST-API.html#cb481-17" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb481-18"><a href="PB-REST-API.html#cb481-18" tabindex="-1"></a>  {</span>
<span id="cb481-19"><a href="PB-REST-API.html#cb481-19" tabindex="-1"></a>    <span class="st">&quot;_id&quot;</span><span class="op">:</span> <span class="st">&quot;635a62f5dc5d7968e6846a32&quot;</span><span class="op">,</span></span>
<span id="cb481-20"><a href="PB-REST-API.html#cb481-20" tabindex="-1"></a>    <span class="st">&quot;name&quot;</span><span class="op">:</span> <span class="st">&quot;Otočec - Grajski park&quot;</span><span class="op">,</span></span>
<span id="cb481-21"><a href="PB-REST-API.html#cb481-21" tabindex="-1"></a>    <span class="st">&quot;category&quot;</span><span class="op">:</span> <span class="st">&quot;parki in vrtovi&quot;</span><span class="op">,</span></span>
<span id="cb481-22"><a href="PB-REST-API.html#cb481-22" tabindex="-1"></a>    <span class="st">&quot;type&quot;</span><span class="op">:</span> <span class="st">&quot;vrtnoarhitekturna dediščina&quot;</span><span class="op">,</span></span>
<span id="cb481-23"><a href="PB-REST-API.html#cb481-23" tabindex="-1"></a>    <span class="st">&quot;keywords&quot;</span><span class="op">:</span> [<span class="st">&quot;park&quot;</span><span class="op">,</span> <span class="st">&quot;grad&quot;</span>]<span class="op">,</span></span>
<span id="cb481-24"><a href="PB-REST-API.html#cb481-24" tabindex="-1"></a>    <span class="st">&quot;description&quot;</span><span class="op">:</span> <span class="st">&quot;Park obdaja grad Otočec na otoku reke Krke. Parkovna zasnova se je prilagajala umetni širitvi otoka. Formalne zasnove iz preteklosti se niso ohranile, tako da je park sedaj urejen v duhu krajinskega sloga.&quot;</span><span class="op">,</span></span>
<span id="cb481-25"><a href="PB-REST-API.html#cb481-25" tabindex="-1"></a>    <span class="st">&quot;location&quot;</span><span class="op">:</span> <span class="st">&quot;Park leži na otoku sredi Krke, okoli gradu Otočec pod magistralno cesto Ljubljana-Obrežje. Park seka lokalna cesta.&quot;</span><span class="op">,</span></span>
<span id="cb481-26"><a href="PB-REST-API.html#cb481-26" tabindex="-1"></a>    <span class="st">&quot;institution&quot;</span><span class="op">:</span> <span class="st">&quot;ZVKD Novo mesto&quot;</span><span class="op">,</span></span>
<span id="cb481-27"><a href="PB-REST-API.html#cb481-27" tabindex="-1"></a>    <span class="st">&quot;heritage&quot;</span><span class="op">:</span> <span class="st">&quot;spomenik državnega pomena&quot;</span><span class="op">,</span></span>
<span id="cb481-28"><a href="PB-REST-API.html#cb481-28" tabindex="-1"></a>    <span class="st">&quot;municipality&quot;</span><span class="op">:</span> <span class="st">&quot;NOVO MESTO&quot;</span><span class="op">,</span></span>
<span id="cb481-29"><a href="PB-REST-API.html#cb481-29" tabindex="-1"></a>    <span class="st">&quot;coordinates&quot;</span><span class="op">:</span> [<span class="fl">15.2361221585</span><span class="op">,</span> <span class="fl">45.8380219125</span>]<span class="op">,</span></span>
<span id="cb481-30"><a href="PB-REST-API.html#cb481-30" tabindex="-1"></a>    <span class="st">&quot;synonyms&quot;</span><span class="op">:</span> [<span class="st">&quot;Park gradu Otočec&quot;</span>]<span class="op">,</span></span>
<span id="cb481-31"><a href="PB-REST-API.html#cb481-31" tabindex="-1"></a>    <span class="st">&quot;datation&quot;</span><span class="op">:</span> <span class="st">&quot;19. stol., 20. stol.&quot;</span><span class="op">,</span></span>
<span id="cb481-32"><a href="PB-REST-API.html#cb481-32" tabindex="-1"></a>    <span class="st">&quot;fields&quot;</span><span class="op">:</span> [<span class="st">&quot;krajinska arhitektura&quot;</span>]<span class="op">,</span></span>
<span id="cb481-33"><a href="PB-REST-API.html#cb481-33" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb481-34"><a href="PB-REST-API.html#cb481-34" tabindex="-1"></a>]</span></code></pre></div>
<script>
  $(document).ready(function() {
    $("#napredno-iskanje code.javascript:eq(0)").markRegExp(/async/, options_dodaj);
    $("#napredno-iskanje code.javascript:eq(0)").markRegExp(/const allowedCodelists[\s\S]+?\];/, options_dodaj);
    $("#napredno-iskanje code.javascript:eq(0)").markRegExp(/\s+?let filter[\s\S]+?found\.[\s\S]+?else /, options_dodaj);
    $("#napredno-iskanje code.javascript:eq(0)").markRegExp(/locations /, options_dodaj);
    $("#napredno-iskanje code.javascript:eq(0)").markRegExp(/{ status: "OK" }/, options_izbrisi);
    $("#napredno-iskanje code.javascript:eq(0)").markRegExp(/\s+?} catch[\s\S]+?err\.message }[\s\S]+?}/, options_dodaj);
    $("#napredno-iskanje code.javascript:eq(1)").markRegExp(/curl.+/, options_dodaj);
    $("#napredno-iskanje code.javascript:eq(1)").markRegExp(/"(category|type|keywords|fields)"/, options_dodaj);
    $("#napredno-iskanje code.javascript:eq(1)").markRegExp(/"(parki in vrtovi|park|krajinska arhitektura)"/, options_dodaj);
  });
</script>
</div>
<div id="seznami-sifrantov" class="section level3 hasAnchor" number="6.4.5">
<h3><span class="header-section-number">6.4.5</span> Seznami šifrantov<a href="PB-REST-API.html#seznami-sifrantov" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Za potrebe naprednega iskanja, predstavljenega v prejšnjem poglavju <a href="PB-REST-API.html#napredno-iskanje">6.4.4</a> bomo implementirali metodo krmilnika <code>locationsListCodelist</code>, ki bo vračala vrednosti izbranih šifrantov s katerimi lahko izvajamo napredno iskanje.</p>
<p><code>api/controllers/locations.js</code></p>
<div class="sourceCode" id="cb482"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb482-1"><a href="PB-REST-API.html#cb482-1" tabindex="-1"></a><span class="kw">const</span> locationsListCodelist <span class="op">=</span> <span class="kw">async</span> (req<span class="op">,</span> res) <span class="kw">=&gt;</span> {</span>
<span id="cb482-2"><a href="PB-REST-API.html#cb482-2" tabindex="-1"></a>  <span class="kw">let</span> codelist <span class="op">=</span> req<span class="op">.</span><span class="at">params</span><span class="op">.</span><span class="at">codelist</span><span class="op">;</span></span>
<span id="cb482-3"><a href="PB-REST-API.html#cb482-3" tabindex="-1"></a>  <span class="cf">if</span> (<span class="op">!</span>allowedCodelists<span class="op">.</span><span class="fu">includes</span>(codelist))</span>
<span id="cb482-4"><a href="PB-REST-API.html#cb482-4" tabindex="-1"></a>    res<span class="op">.</span><span class="fu">status</span>(<span class="dv">400</span>)<span class="op">.</span><span class="fu">json</span>({</span>
<span id="cb482-5"><a href="PB-REST-API.html#cb482-5" tabindex="-1"></a>      <span class="dt">message</span><span class="op">:</span> <span class="vs">`Parameter &#39;codelist&#39; must be one of: </span><span class="sc">${</span>allowedCodelists<span class="op">.</span><span class="fu">join</span>(</span>
<span id="cb482-6"><a href="PB-REST-API.html#cb482-6" tabindex="-1"></a>        <span class="st">&quot;, &quot;</span></span>
<span id="cb482-7"><a href="PB-REST-API.html#cb482-7" tabindex="-1"></a>      )<span class="sc">}</span><span class="vs">`</span><span class="op">,</span></span>
<span id="cb482-8"><a href="PB-REST-API.html#cb482-8" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb482-9"><a href="PB-REST-API.html#cb482-9" tabindex="-1"></a>  <span class="cf">else</span> {</span>
<span id="cb482-10"><a href="PB-REST-API.html#cb482-10" tabindex="-1"></a>    <span class="cf">try</span> {</span>
<span id="cb482-11"><a href="PB-REST-API.html#cb482-11" tabindex="-1"></a>      <span class="kw">let</span> codeListValues <span class="op">=</span> <span class="cf">await</span> <span class="bu">Location</span><span class="op">.</span><span class="fu">distinct</span>(codelist)<span class="op">.</span><span class="fu">exec</span>()<span class="op">;</span></span>
<span id="cb482-12"><a href="PB-REST-API.html#cb482-12" tabindex="-1"></a>      <span class="cf">if</span> (<span class="op">!</span>codeListValues <span class="op">||</span> codeListValues<span class="op">.</span><span class="at">length</span> <span class="op">===</span> <span class="dv">0</span>)</span>
<span id="cb482-13"><a href="PB-REST-API.html#cb482-13" tabindex="-1"></a>        res</span>
<span id="cb482-14"><a href="PB-REST-API.html#cb482-14" tabindex="-1"></a>          <span class="op">.</span><span class="fu">status</span>(<span class="dv">404</span>)</span>
<span id="cb482-15"><a href="PB-REST-API.html#cb482-15" tabindex="-1"></a>          <span class="op">.</span><span class="fu">json</span>({ <span class="dt">message</span><span class="op">:</span> <span class="vs">`No codelist found for &#39;</span><span class="sc">${</span>codelist<span class="sc">}</span><span class="vs">.&#39;`</span> })<span class="op">;</span></span>
<span id="cb482-16"><a href="PB-REST-API.html#cb482-16" tabindex="-1"></a>      <span class="cf">else</span> res<span class="op">.</span><span class="fu">status</span>(<span class="dv">200</span>)<span class="op">.</span><span class="fu">json</span>(codeListValues { <span class="dt">status</span><span class="op">:</span> <span class="st">&quot;OK&quot;</span> })<span class="op">;</span></span>
<span id="cb482-17"><a href="PB-REST-API.html#cb482-17" tabindex="-1"></a>    } <span class="cf">catch</span> (err) {</span>
<span id="cb482-18"><a href="PB-REST-API.html#cb482-18" tabindex="-1"></a>      res<span class="op">.</span><span class="fu">status</span>(<span class="dv">500</span>)<span class="op">.</span><span class="fu">json</span>({ <span class="dt">message</span><span class="op">:</span> err<span class="op">.</span><span class="at">message</span> })<span class="op">;</span></span>
<span id="cb482-19"><a href="PB-REST-API.html#cb482-19" tabindex="-1"></a>    }</span>
<span id="cb482-20"><a href="PB-REST-API.html#cb482-20" tabindex="-1"></a>  }</span>
<span id="cb482-21"><a href="PB-REST-API.html#cb482-21" tabindex="-1"></a>}<span class="op">;</span></span></code></pre></div>
<p>S pomočjo parametra zahteve <i class="fa-solid fa-tag"></i><code>codelist</code>, ki sprejme vrednosti <code>category</code>, <code>type</code>, <code>keywords</code>, <code>institution</code>, <code>municipality</code> in <code>fields</code>, lahko zahtevamo vrednosti željenih šifrantov, kot to prikazuje spodnji primer za <code>category</code>.</p>
<div class="sourceCode" id="cb483"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb483-1"><a href="PB-REST-API.html#cb483-1" tabindex="-1"></a>$ curl http<span class="op">:</span><span class="co">//localhost:3000/api/locations/codelist/category</span></span>
<span id="cb483-2"><a href="PB-REST-API.html#cb483-2" tabindex="-1"></a>[</span>
<span id="cb483-3"><a href="PB-REST-API.html#cb483-3" tabindex="-1"></a>  <span class="st">&quot;arheološka najdišča&quot;</span><span class="op">,</span></span>
<span id="cb483-4"><a href="PB-REST-API.html#cb483-4" tabindex="-1"></a>  <span class="st">&quot;drugi objekti in naprave&quot;</span><span class="op">,</span></span>
<span id="cb483-5"><a href="PB-REST-API.html#cb483-5" tabindex="-1"></a>  <span class="st">&quot;kulturna krajina&quot;</span><span class="op">,</span></span>
<span id="cb483-6"><a href="PB-REST-API.html#cb483-6" tabindex="-1"></a>  <span class="st">&quot;naselja in njihovi deli&quot;</span><span class="op">,</span></span>
<span id="cb483-7"><a href="PB-REST-API.html#cb483-7" tabindex="-1"></a>  <span class="st">&quot;ostalo&quot;</span><span class="op">,</span></span>
<span id="cb483-8"><a href="PB-REST-API.html#cb483-8" tabindex="-1"></a>  <span class="st">&quot;parki in vrtovi&quot;</span><span class="op">,</span></span>
<span id="cb483-9"><a href="PB-REST-API.html#cb483-9" tabindex="-1"></a>  <span class="st">&quot;spominski objekti in kraji&quot;</span><span class="op">,</span></span>
<span id="cb483-10"><a href="PB-REST-API.html#cb483-10" tabindex="-1"></a>  <span class="st">&quot;stavbe&quot;</span><span class="op">,</span></span>
<span id="cb483-11"><a href="PB-REST-API.html#cb483-11" tabindex="-1"></a>  <span class="st">&quot;stavbe s parki ali z vrtovi&quot;</span></span>
<span id="cb483-12"><a href="PB-REST-API.html#cb483-12" tabindex="-1"></a>]</span></code></pre></div>
<script>
  $(document).ready(function() {
    $("#seznami-sifrantov code.javascript:eq(0)").markRegExp(/async/, options_dodaj);
    $("#seznami-sifrantov code.javascript:eq(0)").markRegExp(/let codelist[\s\S]+?No codelist[\s\S]+?else /, options_dodaj);
    $("#seznami-sifrantov code.javascript:eq(0)").markRegExp(/codeListValues /, options_dodaj);
    $("#seznami-sifrantov code.javascript:eq(0)").markRegExp(/{ status: "OK" }/, options_izbrisi);
    $("#seznami-sifrantov code.javascript:eq(0)").markRegExp(/\s+?} catch[\s\S]+?}\);[\s\S]+?}[\s\S]+?}/, options_dodaj);
    $("#seznami-sifrantov code.javascript:eq(1)").markRegExp(/curl.+/, options_dodaj);
    $("#seznami-sifrantov code.javascript:eq(1)").markRegExp(/\[[\s\S]+?\]/, options_dodaj);
  });
</script>
<blockquote>
<h4>
<i class="fa-solid fa-trophy" style="padding-right:5px"></i>Naloge iz vsebinskega sklopa <a href="https://teaching.lavbic.net/naloge/mongodb/"><i class="fa-solid fa-database" style="padding-right:5px"></i>MongoDB</a>
</h4>
<p>Interaktivno reševanje praktičnih problemov, kjer izberete enega izmed možnih odgovorov. Po pravilno rešeni nalogi lahko nadaljujete na naslednjo, sproti pa se beleži napredek, kjer se upošteva koliko poskusov v povprečju ste potrebovali za pravilni odgovor.</p>
</blockquote>
<h3>
Dodatno gradivo
</h3>
<table class="dodatnoGradivo">
<tr>
<td>
<p><img src="assets/img/Holmes_2019.jpg" width="200" style="display: block; margin: auto;" /></p>
</td>
<td>
<ul>
<li><strong>Getting MEAN with Mongo, Express, Angular, and Node</strong>, 2<sup>nd</sup> edition <span class="citation">(<a href="literatura.html#ref-holmes2019">Holmes and Herber 2019</a>)</span>
<ul>
<li><strong>Part 2</strong>: Building a Node web application
<ul>
<li><strong>Chapter 5</strong>: Building a data model with MongoDB and Mongoose</li>
<li><strong>Chapter 6</strong>: Writing a REST API: Exposing the MongoDB database to the application</li>
</ul></li>
</ul></li>
</ul>
</td>
</tr>
</table>

</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="124">
<li id="fn124"><p>angl. connection string<a href="PB-REST-API.html#fnref124" class="footnote-back">↩︎</a></p></li>
<li id="fn125"><p>angl. Object-Document Modeler (ODM)<a href="PB-REST-API.html#fnref125" class="footnote-back">↩︎</a></p></li>
<li id="fn126"><p>angl. document<a href="PB-REST-API.html#fnref126" class="footnote-back">↩︎</a></p></li>
<li id="fn127"><p>angl. collection<a href="PB-REST-API.html#fnref127" class="footnote-back">↩︎</a></p></li>
<li id="fn128"><p>angl. schema<a href="PB-REST-API.html#fnref128" class="footnote-back">↩︎</a></p></li>
<li id="fn129"><p>angl. path<a href="PB-REST-API.html#fnref129" class="footnote-back">↩︎</a></p></li>
<li id="fn130"><p><a href="https://docs.mongodb.com/manual/reference/method/Date/" class="uri">https://docs.mongodb.com/manual/reference/method/Date/</a><a href="PB-REST-API.html#fnref130" class="footnote-back">↩︎</a></p></li>
<li id="fn131"><p>angl. latitude<a href="PB-REST-API.html#fnref131" class="footnote-back">↩︎</a></p></li>
<li id="fn132"><p>angl. longitude<a href="PB-REST-API.html#fnref132" class="footnote-back">↩︎</a></p></li>
<li id="fn133"><p>angl. subdocument<a href="PB-REST-API.html#fnref133" class="footnote-back">↩︎</a></p></li>
<li id="fn134"><p>angl. Create, Read, Update, Delete<a href="PB-REST-API.html#fnref134" class="footnote-back">↩︎</a></p></li>
<li id="fn135"><p>angl. REpresentational State Transfer<a href="PB-REST-API.html#fnref135" class="footnote-back">↩︎</a></p></li>
<li id="fn136"><p>angl. Application Program(ming) Interface<a href="PB-REST-API.html#fnref136" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
<script type="text/javascript">
  $(document).ready(function() {
    
    $("a").click(function(e) {
      if (
        $(this).has(".fa-solid").length == 1 || 
        $(this).has(".fa-brands").length == 1 || 
        $(this).has(".fa-regular").length == 1 || 
        $(this).has("img.git").length == 1
      ) {
        e.preventDefault();
        window.open($(this).attr("href"), '_blank');
      }
    });
  });
</script>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Q6109Y2092"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-Q6109Y2092');
</script>
<h3><i class="fas fa-globe-europe" style="padding-right:5px"></i>Choose your language</h3>

<p>Students whose mother tongue is not Slovene can choose to <a onclick="loadGoogleTranslate()" class="google-translate-povezava"><i class="fas fa-sync-alt" style="padding-right:3px"></i>translate the contents of the script</a> into the selected language.</p>

<div id="google_translate_element"></div>

<script type="text/javascript">
  function googleTranslateElementInit() {
    new google.translate.TranslateElement({
      pageLanguage: 'sl', 
      includedLanguages: 'en,mk', 
      layout: google.translate.TranslateElement.InlineLayout.SIMPLE, 
      multilanguagePage: true
    }, 'google_translate_element');
  }
  
  function loadGoogleTranslate() {
    if ($("script[src='//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit']").length == 0) {
      var googleTranslateScript = document.createElement('script');
      googleTranslateScript.type = 'text/javascript';
      googleTranslateScript.async = true;
      googleTranslateScript.src = '//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0] ).appendChild(googleTranslateScript);    
    }
  }
  
  $(document).ready(function() {
    // Če gre za administrativno stran, potem skrij obrazec za komentarje
    $("h1:contains('Administracija'),h1:contains('Komentarji'),h1:contains('Analiza začetnega vprašalnika'),h1:contains('Lastni projekt'),h1:contains('pisni izpit'),h1:contains('Pisni izpiti')").filter(function() {
      $("h3:contains('Choose your language')").next().hide();
      $("h3:contains('Choose your language')").hide();
    });
  });
</script>
            </section>

          </div>
        </div>
      </div>
<a href="Node-js.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="Swagger.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="assets/lib/gitbook-2.6.7/js/app.min.js"></script>
<script src="assets/lib/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="assets/lib/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="assets/lib/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="assets/lib/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="assets/lib/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="assets/lib/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="assets/lib/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": {}
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 1
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
