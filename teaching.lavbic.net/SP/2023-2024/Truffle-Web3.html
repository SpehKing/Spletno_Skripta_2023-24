<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Poglavje 13 P5.2 Truffle in Web3 | Spletno programiranje 2023/2024</title>
  <meta name="description" content="Skripta za pomoč pri predmetu Spletno programiranje 2022/2023" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="Poglavje 13 P5.2 Truffle in Web3 | Spletno programiranje 2023/2024" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Skripta za pomoč pri predmetu Spletno programiranje 2022/2023" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Poglavje 13 P5.2 Truffle in Web3 | Spletno programiranje 2023/2024" />
  
  <meta name="twitter:description" content="Skripta za pomoč pri predmetu Spletno programiranje 2022/2023" />
  

<meta name="author" content="izr. prof. dr. Dejan Lavbič" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="LP2.html"/>
<link rel="next" href="Varnost-testiranje-PWA.html"/>
<script src="assets/lib/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="assets/lib/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="assets/lib/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="assets/lib/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="assets/lib/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="assets/lib/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="assets/lib/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="assets/lib/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="assets/lib/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="assets/lib/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="assets/lib/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="assets/lib/kePrint-0.0.1/kePrint.js"></script>
<link href="assets/lib/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="assets/style/stil.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="index.html#terminski-plan-izvajanja-predmeta">SP 2023/2024 terminski plan</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Uvod</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#splošne-informacije"><i class="fa fa-check"></i>Splošne informacije</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#predavatelj"><i class="fa fa-check"></i>Predavatelj</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#asistent"><i class="fa fa-check"></i>Asistent</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#terminski-plan-izvajanja-predmeta"><i class="fa fa-check"></i>Terminski plan izvajanja predmeta</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#pravila-igre"><i class="fa fa-check"></i>Pravila igre</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#predavanja"><i class="fa fa-check"></i>Predavanja</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#vaje"><i class="fa fa-check"></i>Vaje</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#ocenjevanje"><i class="fa fa-check"></i>Ocenjevanje</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#pisni-izpiti"><i class="fa fa-check"></i>Pisni izpiti</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#priporočena-literatura"><i class="fa fa-check"></i>Priporočena literatura</a></li>
</ul></li>
<li class="part"><span><b>I sklop: Uvod v spletno programiranje</b></span></li>
<li class="chapter" data-level="1" data-path="P11.html"><a href="P11.html"><i class="fa fa-check"></i><b>1</b> <span class="sklop1 oznaka">P1.1</span> Svetovni splet in celostni razvoj programske opreme</a>
<ul>
<li class="chapter" data-level="1.1" data-path="P11.html"><a href="P11.html#infrastrukturni-in-arhitekturni-pogled-na-svetovni-splet"><i class="fa fa-check"></i><b>1.1</b> Infrastrukturni in arhitekturni pogled na svetovni splet</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="P11.html"><a href="P11.html#moorov-zakon"><i class="fa fa-check"></i><b>1.1.1</b> Moorov zakon</a></li>
<li class="chapter" data-level="1.1.2" data-path="P11.html"><a href="P11.html#internet-vs.-svetovni-splet"><i class="fa fa-check"></i><b>1.1.2</b> Internet vs. (svetovni) splet</a></li>
<li class="chapter" data-level="1.1.3" data-path="P11.html"><a href="P11.html#razvoj-interneta"><i class="fa fa-check"></i><b>1.1.3</b> Razvoj interneta</a></li>
<li class="chapter" data-level="1.1.4" data-path="P11.html"><a href="P11.html#razvoj-WWW"><i class="fa fa-check"></i><b>1.1.4</b> Razvoj (svetovnega) spleta</a></li>
<li class="chapter" data-level="1.1.5" data-path="P11.html"><a href="P11.html#arhitektura-odjemalecstrežnik"><i class="fa fa-check"></i><b>1.1.5</b> Arhitektura odjemalec/strežnik</a></li>
<li class="chapter" data-level="1.1.6" data-path="P11.html"><a href="P11.html#večnivojska-arhitektura"><i class="fa fa-check"></i><b>1.1.6</b> Večnivojska arhitektura</a></li>
<li class="chapter" data-level="1.1.7" data-path="P11.html"><a href="P11.html#pomembni-mejniki-in-akterji"><i class="fa fa-check"></i><b>1.1.7</b> Pomembni mejniki in akterji</a></li>
<li class="chapter" data-level="1.1.8" data-path="P11.html"><a href="P11.html#trenutno-stanje-na-trgu"><i class="fa fa-check"></i><b>1.1.8</b> Trenutno stanje na trgu</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="P11.html"><a href="P11.html#uporabljen-pristop-pri-predmetu"><i class="fa fa-check"></i><b>1.2</b> Uporabljen pristop pri predmetu</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="P11.html"><a href="P11.html#tehnologije-ki-jih-bomo-uporabljali"><i class="fa fa-check"></i><b>1.2.1</b> Tehnologije, ki jih bomo uporabljali</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="P11.html"><a href="P11.html#celostni-razvoj-programske-opreme-z-mean-arhitekturo"><i class="fa fa-check"></i><b>1.3</b> Celostni razvoj programske opreme z MEAN arhitekturo</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="P11.html"><a href="P11.html#Node-js-niti"><i class="fa fa-check"></i><b>1.3.1</b> Node.js</a></li>
<li class="chapter" data-level="1.3.2" data-path="P11.html"><a href="P11.html#express"><i class="fa fa-check"></i><b>1.3.2</b> Express</a></li>
<li class="chapter" data-level="1.3.3" data-path="P11.html"><a href="P11.html#MongoDB-uvod"><i class="fa fa-check"></i><b>1.3.3</b> MongoDB</a></li>
<li class="chapter" data-level="1.3.4" data-path="P11.html"><a href="P11.html#angular"><i class="fa fa-check"></i><b>1.3.4</b> Angular</a></li>
<li class="chapter" data-level="1.3.5" data-path="P11.html"><a href="P11.html#podporna-orodja-ogrodja-in-knjižnice"><i class="fa fa-check"></i><b>1.3.5</b> Podporna orodja, ogrodja in knjižnice</a></li>
<li class="chapter" data-level="1.3.6" data-path="P11.html"><a href="P11.html#git"><i class="fa fa-check"></i><b>1.3.6</b> Git</a></li>
<li class="chapter" data-level="1.3.7" data-path="P11.html"><a href="P11.html#heroku"><i class="fa fa-check"></i><b>1.3.7</b> Heroku</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="P11.html"><a href="P11.html#razvoj-dejanske-aplikacije"><i class="fa fa-check"></i><b>1.4</b> Razvoj dejanske aplikacije</a></li>
<li class="chapter" data-level="1.5" data-path="P11.html"><a href="P11.html#nacrtovanje-aplikacije-po-mean-arhitekturi"><i class="fa fa-check"></i><b>1.5</b> Načrtovanje aplikacije po MEAN arhitekturi</a></li>
<li class="chapter" data-level="1.6" data-path="P11.html"><a href="P11.html#dobre-prakse-pri-načrtovanju-in-implementaciji-aplikacije"><i class="fa fa-check"></i><b>1.6</b> Dobre prakse pri načrtovanju in implementaciji aplikacije</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="P11.html"><a href="P11.html#uporaba-api-ja-za-dostop-do-podatkovne-ravni"><i class="fa fa-check"></i><b>1.6.1</b> Uporaba API-ja za dostop do podatkovne ravni</a></li>
<li class="chapter" data-level="1.6.2" data-path="P11.html"><a href="P11.html#koraki-pri-nacrtovanju-nove-spletne-aplikacije"><i class="fa fa-check"></i><b>1.6.2</b> Koraki pri načrtovanju nove spletne aplikacije</a></li>
<li class="chapter" data-level="1.6.3" data-path="P11.html"><a href="P11.html#koraki-pri-implementaciji-nove-spletne-aplikacije"><i class="fa fa-check"></i><b>1.6.3</b> Koraki pri implementaciji nove spletne aplikacije</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="P11.html"><a href="P11.html#okolje"><i class="fa fa-check"></i><b>1.7</b> Okolje</a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="P11.html"><a href="P11.html#razvojno-okolje"><i class="fa fa-check"></i><b>1.7.1</b> Razvojno okolje</a></li>
<li class="chapter" data-level="1.7.2" data-path="P11.html"><a href="P11.html#produkcijsko-okolje"><i class="fa fa-check"></i><b>1.7.2</b> Produkcijsko okolje</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="P11.html"><a href="P11.html#git-1"><i class="fa fa-check"></i><b>1.8</b> Git</a>
<ul>
<li class="chapter" data-level="1.8.1" data-path="P11.html"><a href="P11.html#osnovne-operacije-vcs"><i class="fa fa-check"></i><b>1.8.1</b> Osnovne operacije VCS</a></li>
<li class="chapter" data-level="1.8.2" data-path="P11.html"><a href="P11.html#posebnosti-porazdeljenih-sistemov-za-obvladovanje-verzij-dvcs"><i class="fa fa-check"></i><b>1.8.2</b> Posebnosti porazdeljenih sistemov za obvladovanje verzij (DVCS)</a></li>
<li class="chapter" data-level="1.8.3" data-path="P11.html"><a href="P11.html#dobre-prakse-uporabe-git"><i class="fa fa-check"></i><b>1.8.3</b> Dobre prakse uporabe Git</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="LP1.html"><a href="LP1.html"><i class="fa fa-check"></i><b>2</b> <span class="sklop4 oznaka">1. LP</span> Dinamična spletna aplikacija na strani strežnika in odjemalca</a>
<ul>
<li class="chapter" data-level="2.1" data-path="LP1.html"><a href="LP1.html#pravila-zahteve-in-omejitve"><i class="fa fa-check"></i><b>2.1</b> Pravila, zahteve in omejitve</a></li>
<li class="chapter" data-level="2.2" data-path="LP1.html"><a href="LP1.html#LP11"><i class="fa fa-check"></i><b>2.2</b> <span class="sklop1 oznaka">1. del</span> Osnutek aplikacije in wireframe model</a></li>
<li class="chapter" data-level="2.3" data-path="LP1.html"><a href="LP1.html#LP12"><i class="fa fa-check"></i><b>2.3</b> <span class="sklop2 oznaka">2. del</span> Arhitektura aplikacije in različna razvojna okolja</a></li>
<li class="chapter" data-level="2.4" data-path="LP1.html"><a href="LP1.html#LP13"><i class="fa fa-check"></i><b>2.4</b> <span class="sklop3 oznaka">3. del</span> Zaledni del in dostop do podatkovne baze</a></li>
<li class="chapter" data-level="2.5" data-path="LP1.html"><a href="LP1.html#LP14"><i class="fa fa-check"></i><b>2.5</b> <span class="sklop4 oznaka">4. del</span> Uporabniški vmesnik, SPA in avtentikacija</a></li>
<li class="chapter" data-level="2.6" data-path="LP1.html"><a href="LP1.html#kriteriji-vrednotenja"><i class="fa fa-check"></i><b>2.6</b> Kriteriji vrednotenja</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="HTML-CSS.html"><a href="HTML-CSS.html"><i class="fa fa-check"></i><b>3</b> <span class="sklop1 oznaka">P1.2</span> Osnovna spletna standarda HTML in CSS</a>
<ul>
<li class="chapter" data-level="3.1" data-path="HTML-CSS.html"><a href="HTML-CSS.html#html-tehnologija"><i class="fa fa-check"></i><b>3.1</b> HTML</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="HTML-CSS.html"><a href="HTML-CSS.html#enostaven-primer-html5-dokumenta"><i class="fa fa-check"></i><b>3.1.1</b> Enostaven primer HTML5 dokumenta</a></li>
<li class="chapter" data-level="3.1.2" data-path="HTML-CSS.html"><a href="HTML-CSS.html#ustreznost-html5-dokumenta"><i class="fa fa-check"></i><b>3.1.2</b> Ustreznost HTML5 dokumenta</a></li>
<li class="chapter" data-level="3.1.3" data-path="HTML-CSS.html"><a href="HTML-CSS.html#naslovi"><i class="fa fa-check"></i><b>3.1.3</b> Naslovi</a></li>
<li class="chapter" data-level="3.1.4" data-path="HTML-CSS.html"><a href="HTML-CSS.html#povezave"><i class="fa fa-check"></i><b>3.1.4</b> Povezave</a></li>
<li class="chapter" data-level="3.1.5" data-path="HTML-CSS.html"><a href="HTML-CSS.html#slike"><i class="fa fa-check"></i><b>3.1.5</b> Slike</a></li>
<li class="chapter" data-level="3.1.6" data-path="HTML-CSS.html"><a href="HTML-CSS.html#posebni-znaki-in-vodoravne-črte"><i class="fa fa-check"></i><b>3.1.6</b> Posebni znaki in vodoravne črte</a></li>
<li class="chapter" data-level="3.1.7" data-path="HTML-CSS.html"><a href="HTML-CSS.html#seznami"><i class="fa fa-check"></i><b>3.1.7</b> Seznami</a></li>
<li class="chapter" data-level="3.1.8" data-path="HTML-CSS.html"><a href="HTML-CSS.html#tabele"><i class="fa fa-check"></i><b>3.1.8</b> Tabele</a></li>
<li class="chapter" data-level="3.1.9" data-path="HTML-CSS.html"><a href="HTML-CSS.html#Spletni-obrazci-HTML"><i class="fa fa-check"></i><b>3.1.9</b> Spletni obrazci</a></li>
<li class="chapter" data-level="3.1.10" data-path="HTML-CSS.html"><a href="HTML-CSS.html#interne-povezave"><i class="fa fa-check"></i><b>3.1.10</b> Interne povezave</a></li>
<li class="chapter" data-level="3.1.11" data-path="HTML-CSS.html"><a href="HTML-CSS.html#meta-elementi"><i class="fa fa-check"></i><b>3.1.11</b> Meta elementi</a></li>
<li class="chapter" data-level="3.1.12" data-path="HTML-CSS.html"><a href="HTML-CSS.html#napredni-gradniki-spletnih-obrazcev"><i class="fa fa-check"></i><b>3.1.12</b> Napredni gradniki spletnih obrazcev</a></li>
<li class="chapter" data-level="3.1.13" data-path="HTML-CSS.html"><a href="HTML-CSS.html#samodejno-dopolnjevanje-vrednosti-pri-vnosnih-poljih"><i class="fa fa-check"></i><b>3.1.13</b> Samodejno dopolnjevanje vrednosti pri vnosnih poljih</a></li>
<li class="chapter" data-level="3.1.14" data-path="HTML-CSS.html"><a href="HTML-CSS.html#elementi-za-opredelitev-strukture-strani"><i class="fa fa-check"></i><b>3.1.14</b> Elementi za opredelitev strukture strani</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="HTML-CSS.html"><a href="HTML-CSS.html#prekrivni-slogi-css"><i class="fa fa-check"></i><b>3.2</b> Prekrivni slogi (CSS)</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="HTML-CSS.html"><a href="HTML-CSS.html#uvod-1"><i class="fa fa-check"></i><b>3.2.1</b> Uvod</a></li>
<li class="chapter" data-level="3.2.2" data-path="HTML-CSS.html"><a href="HTML-CSS.html#neposredno-opredeljeni-slogi"><i class="fa fa-check"></i><b>3.2.2</b> Neposredno opredeljeni slogi</a></li>
<li class="chapter" data-level="3.2.3" data-path="HTML-CSS.html"><a href="HTML-CSS.html#vgrajeni-slogi"><i class="fa fa-check"></i><b>3.2.3</b> Vgrajeni slogi</a></li>
<li class="chapter" data-level="3.2.4" data-path="HTML-CSS.html"><a href="HTML-CSS.html#konfliktni-slogi"><i class="fa fa-check"></i><b>3.2.4</b> Konfliktni slogi</a></li>
<li class="chapter" data-level="3.2.5" data-path="HTML-CSS.html"><a href="HTML-CSS.html#zunanji-slogi"><i class="fa fa-check"></i><b>3.2.5</b> Zunanji slogi</a></li>
<li class="chapter" data-level="3.2.6" data-path="HTML-CSS.html"><a href="HTML-CSS.html#pozicioniranje-elementov"><i class="fa fa-check"></i><b>3.2.6</b> Pozicioniranje elementov</a></li>
<li class="chapter" data-level="3.2.7" data-path="HTML-CSS.html"><a href="HTML-CSS.html#ozadje"><i class="fa fa-check"></i><b>3.2.7</b> Ozadje</a></li>
<li class="chapter" data-level="3.2.8" data-path="HTML-CSS.html"><a href="HTML-CSS.html#dimenzije-elementa"><i class="fa fa-check"></i><b>3.2.8</b> Dimenzije elementa</a></li>
<li class="chapter" data-level="3.2.9" data-path="HTML-CSS.html"><a href="HTML-CSS.html#model-škatle"><i class="fa fa-check"></i><b>3.2.9</b> Model škatle</a></li>
<li class="chapter" data-level="3.2.10" data-path="HTML-CSS.html"><a href="HTML-CSS.html#plavajoči-elementi"><i class="fa fa-check"></i><b>3.2.10</b> Plavajoči elementi</a></li>
<li class="chapter" data-level="3.2.11" data-path="HTML-CSS.html"><a href="HTML-CSS.html#vrste-medijev"><i class="fa fa-check"></i><b>3.2.11</b> Vrste medijev</a></li>
<li class="chapter" data-level="3.2.12" data-path="HTML-CSS.html"><a href="HTML-CSS.html#spustni-meniji"><i class="fa fa-check"></i><b>3.2.12</b> Spustni meniji</a></li>
<li class="chapter" data-level="3.2.13" data-path="HTML-CSS.html"><a href="HTML-CSS.html#senca-na-besedilu"><i class="fa fa-check"></i><b>3.2.13</b> Senca na besedilu</a></li>
<li class="chapter" data-level="3.2.14" data-path="HTML-CSS.html"><a href="HTML-CSS.html#zaobljeni-robovi"><i class="fa fa-check"></i><b>3.2.14</b> Zaobljeni robovi</a></li>
<li class="chapter" data-level="3.2.15" data-path="HTML-CSS.html"><a href="HTML-CSS.html#barva"><i class="fa fa-check"></i><b>3.2.15</b> Barva</a></li>
<li class="chapter" data-level="3.2.16" data-path="HTML-CSS.html"><a href="HTML-CSS.html#senca-na-modelu-škatle"><i class="fa fa-check"></i><b>3.2.16</b> Senca na modelu škatle</a></li>
<li class="chapter" data-level="3.2.17" data-path="HTML-CSS.html"><a href="HTML-CSS.html#uporaba-pisav-s-spleta"><i class="fa fa-check"></i><b>3.2.17</b> Uporaba pisav s spleta</a></li>
<li class="chapter" data-level="3.2.18" data-path="HTML-CSS.html"><a href="HTML-CSS.html#prilagodljiv-model-škatle-in-izbira-poljubnega-ugnezdenega-elementa"><i class="fa fa-check"></i><b>3.2.18</b> Prilagodljiv model škatle in izbira poljubnega ugnezdenega elementa</a></li>
<li class="chapter" data-level="3.2.19" data-path="HTML-CSS.html"><a href="HTML-CSS.html#postavitev-v-več-stolpcev"><i class="fa fa-check"></i><b>3.2.19</b> Postavitev v več stolpcev</a></li>
<li class="chapter" data-level="3.2.20" data-path="HTML-CSS.html"><a href="HTML-CSS.html#poizvedovanje-po-medijih"><i class="fa fa-check"></i><b>3.2.20</b> Poizvedovanje po medijih</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="HTML-CSS.html"><a href="HTML-CSS.html#bootstrap-1"><i class="fa fa-check"></i><b>3.3</b> Bootstrap</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="HTML-CSS.html"><a href="HTML-CSS.html#uvod-in-način-uporabe"><i class="fa fa-check"></i><b>3.3.1</b> Uvod in način uporabe</a></li>
<li class="chapter" data-level="3.3.2" data-path="HTML-CSS.html"><a href="HTML-CSS.html#enostavni-primer"><i class="fa fa-check"></i><b>3.3.2</b> Enostavni primer</a></li>
<li class="chapter" data-level="3.3.3" data-path="HTML-CSS.html"><a href="HTML-CSS.html#prilagajanje-vsebine-z-mrežnim-sistemom"><i class="fa fa-check"></i><b>3.3.3</b> Prilagajanje vsebine z mrežnim sistemom</a></li>
<li class="chapter" data-level="3.3.4" data-path="HTML-CSS.html"><a href="HTML-CSS.html#tipografija"><i class="fa fa-check"></i><b>3.3.4</b> Tipografija</a></li>
<li class="chapter" data-level="3.3.5" data-path="HTML-CSS.html"><a href="HTML-CSS.html#tabele-1"><i class="fa fa-check"></i><b>3.3.5</b> Tabele</a></li>
<li class="chapter" data-level="3.3.6" data-path="HTML-CSS.html"><a href="HTML-CSS.html#slike-1"><i class="fa fa-check"></i><b>3.3.6</b> Slike</a></li>
<li class="chapter" data-level="3.3.7" data-path="HTML-CSS.html"><a href="HTML-CSS.html#opozorila"><i class="fa fa-check"></i><b>3.3.7</b> Opozorila</a></li>
<li class="chapter" data-level="3.3.8" data-path="HTML-CSS.html"><a href="HTML-CSS.html#gumbi"><i class="fa fa-check"></i><b>3.3.8</b> Gumbi</a></li>
<li class="chapter" data-level="3.3.9" data-path="HTML-CSS.html"><a href="HTML-CSS.html#ikone"><i class="fa fa-check"></i><b>3.3.9</b> Ikone</a></li>
<li class="chapter" data-level="3.3.10" data-path="HTML-CSS.html"><a href="HTML-CSS.html#oznake"><i class="fa fa-check"></i><b>3.3.10</b> Oznake</a></li>
<li class="chapter" data-level="3.3.11" data-path="HTML-CSS.html"><a href="HTML-CSS.html#kazalnik-poteka"><i class="fa fa-check"></i><b>3.3.11</b> Kazalnik poteka</a></li>
<li class="chapter" data-level="3.3.12" data-path="HTML-CSS.html"><a href="HTML-CSS.html#prehodi-po-straneh"><i class="fa fa-check"></i><b>3.3.12</b> Prehodi po straneh</a></li>
<li class="chapter" data-level="3.3.13" data-path="HTML-CSS.html"><a href="HTML-CSS.html#plošča"><i class="fa fa-check"></i><b>3.3.13</b> Plošča</a></li>
<li class="chapter" data-level="3.3.14" data-path="HTML-CSS.html"><a href="HTML-CSS.html#spustni-meni"><i class="fa fa-check"></i><b>3.3.14</b> Spustni meni</a></li>
<li class="chapter" data-level="3.3.15" data-path="HTML-CSS.html"><a href="HTML-CSS.html#spletni-obrazci"><i class="fa fa-check"></i><b>3.3.15</b> Spletni obrazci</a></li>
<li class="chapter" data-level="3.3.16" data-path="HTML-CSS.html"><a href="HTML-CSS.html#modalno-okno"><i class="fa fa-check"></i><b>3.3.16</b> Modalno okno</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="HTML-CSS.html"><a href="HTML-CSS.html#praktični-prikaz-uporabe-css"><i class="fa fa-check"></i><b>3.4</b> Praktični prikaz uporabe CSS</a></li>
</ul></li>
<li class="part"><span><b>II sklop: JavaScript - programski jezik na strani odjemalca in strežnika</b></span></li>
<li class="chapter" data-level="4" data-path="JavaScript.html"><a href="JavaScript.html"><i class="fa fa-check"></i><b>4</b> <span class="sklop2 oznaka">P2.1</span> JavaScript, jezik svetovnega spleta</a>
<ul>
<li class="chapter" data-level="4.1" data-path="JavaScript.html"><a href="JavaScript.html#razvoj-jezika"><i class="fa fa-check"></i><b>4.1</b> Razvoj jezika</a></li>
<li class="chapter" data-level="4.2" data-path="JavaScript.html"><a href="JavaScript.html#vrednosti-podatkovni-tipi-in-operatorji"><i class="fa fa-check"></i><b>4.2</b> Vrednosti, podatkovni tipi in operatorji</a></li>
<li class="chapter" data-level="4.3" data-path="JavaScript.html"><a href="JavaScript.html#struktura-programa"><i class="fa fa-check"></i><b>4.3</b> Struktura programa</a></li>
<li class="chapter" data-level="4.4" data-path="JavaScript.html"><a href="JavaScript.html#kontrolni-stavki"><i class="fa fa-check"></i><b>4.4</b> Kontrolni stavki</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="JavaScript.html"><a href="JavaScript.html#if-stavek"><i class="fa fa-check"></i><b>4.4.1</b> <code>if</code> stavek</a></li>
<li class="chapter" data-level="4.4.2" data-path="JavaScript.html"><a href="JavaScript.html#if...else-stavek"><i class="fa fa-check"></i><b>4.4.2</b> <code>if...else</code> stavek</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="JavaScript.html"><a href="JavaScript.html#operatorji"><i class="fa fa-check"></i><b>4.5</b> Operatorji</a></li>
<li class="chapter" data-level="4.6" data-path="JavaScript.html"><a href="JavaScript.html#struktura-ponavljanja"><i class="fa fa-check"></i><b>4.6</b> Struktura ponavljanja</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="JavaScript.html"><a href="JavaScript.html#while-stavek"><i class="fa fa-check"></i><b>4.6.1</b> <code>while</code> stavek</a></li>
<li class="chapter" data-level="4.6.2" data-path="JavaScript.html"><a href="JavaScript.html#for-stavek"><i class="fa fa-check"></i><b>4.6.2</b> <code>for</code> stavek</a></li>
<li class="chapter" data-level="4.6.3" data-path="JavaScript.html"><a href="JavaScript.html#do...while-stavek"><i class="fa fa-check"></i><b>4.6.3</b> <code>do...while</code> stavek</a></li>
<li class="chapter" data-level="4.6.4" data-path="JavaScript.html"><a href="JavaScript.html#break-in-continue"><i class="fa fa-check"></i><b>4.6.4</b> <code>break</code> in <code>continue</code></a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="JavaScript.html"><a href="JavaScript.html#funkcije"><i class="fa fa-check"></i><b>4.7</b> Funkcije</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="JavaScript.html"><a href="JavaScript.html#opredelitev-funkcije"><i class="fa fa-check"></i><b>4.7.1</b> Opredelitev funkcije</a></li>
<li class="chapter" data-level="4.7.2" data-path="JavaScript.html"><a href="JavaScript.html#parametri-in-kontekst"><i class="fa fa-check"></i><b>4.7.2</b> Parametri in kontekst</a></li>
<li class="chapter" data-level="4.7.3" data-path="JavaScript.html"><a href="JavaScript.html#zaprtje"><i class="fa fa-check"></i><b>4.7.3</b> Zaprtje</a></li>
<li class="chapter" data-level="4.7.4" data-path="JavaScript.html"><a href="JavaScript.html#rekurzija"><i class="fa fa-check"></i><b>4.7.4</b> Rekurzija</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="JavaScript.html"><a href="JavaScript.html#podatkovne-strukture"><i class="fa fa-check"></i><b>4.8</b> Podatkovne strukture</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="JavaScript.html"><a href="JavaScript.html#nizi-in-njihove-lastnosti"><i class="fa fa-check"></i><b>4.8.1</b> Nizi in njihove lastnosti</a></li>
<li class="chapter" data-level="4.8.2" data-path="JavaScript.html"><a href="JavaScript.html#objekt-argumentov-funkcije"><i class="fa fa-check"></i><b>4.8.2</b> Objekt argumentov funkcije</a></li>
<li class="chapter" data-level="4.8.3" data-path="JavaScript.html"><a href="JavaScript.html#json"><i class="fa fa-check"></i><b>4.8.3</b> JSON</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="JavaScript.html"><a href="JavaScript.html#funkcije-višjega-reda"><i class="fa fa-check"></i><b>4.9</b> Funkcije višjega reda</a>
<ul>
<li class="chapter" data-level="4.9.1" data-path="JavaScript.html"><a href="JavaScript.html#abstrakcija"><i class="fa fa-check"></i><b>4.9.1</b> Abstrakcija</a></li>
<li class="chapter" data-level="4.9.2" data-path="JavaScript.html"><a href="JavaScript.html#funkcije-višjega-reda-1"><i class="fa fa-check"></i><b>4.9.2</b> Funkcije višjega reda</a></li>
<li class="chapter" data-level="4.9.3" data-path="JavaScript.html"><a href="JavaScript.html#posredovanje-argumentov"><i class="fa fa-check"></i><b>4.9.3</b> Posredovanje argumentov</a></li>
</ul></li>
<li class="chapter" data-level="4.10" data-path="JavaScript.html"><a href="JavaScript.html#objekti"><i class="fa fa-check"></i><b>4.10</b> Objekti</a>
<ul>
<li class="chapter" data-level="4.10.1" data-path="JavaScript.html"><a href="JavaScript.html#metode"><i class="fa fa-check"></i><b>4.10.1</b> Metode</a></li>
<li class="chapter" data-level="4.10.2" data-path="JavaScript.html"><a href="JavaScript.html#prototipi"><i class="fa fa-check"></i><b>4.10.2</b> Prototipi</a></li>
<li class="chapter" data-level="4.10.3" data-path="JavaScript.html"><a href="JavaScript.html#konstruktorji"><i class="fa fa-check"></i><b>4.10.3</b> Konstruktorji</a></li>
<li class="chapter" data-level="4.10.4" data-path="JavaScript.html"><a href="JavaScript.html#razredna-notacija"><i class="fa fa-check"></i><b>4.10.4</b> Razredna notacija</a></li>
<li class="chapter" data-level="4.10.5" data-path="JavaScript.html"><a href="JavaScript.html#prekrivanje-lastnosti"><i class="fa fa-check"></i><b>4.10.5</b> Prekrivanje lastnosti</a></li>
<li class="chapter" data-level="4.10.6" data-path="JavaScript.html"><a href="JavaScript.html#get-in-set-metode"><i class="fa fa-check"></i><b>4.10.6</b> <code>Get</code> in <code>set</code> metode</a></li>
<li class="chapter" data-level="4.10.7" data-path="JavaScript.html"><a href="JavaScript.html#primerek"><i class="fa fa-check"></i><b>4.10.7</b> Primerek</a></li>
</ul></li>
<li class="chapter" data-level="4.11" data-path="JavaScript.html"><a href="JavaScript.html#hrošči-in-obvladovanje-napak"><i class="fa fa-check"></i><b>4.11</b> Hrošči in obvladovanje napak</a>
<ul>
<li class="chapter" data-level="4.11.1" data-path="JavaScript.html"><a href="JavaScript.html#strog-način-delovanja"><i class="fa fa-check"></i><b>4.11.1</b> Strog način delovanja</a></li>
<li class="chapter" data-level="4.11.2" data-path="JavaScript.html"><a href="JavaScript.html#testiranje"><i class="fa fa-check"></i><b>4.11.2</b> Testiranje</a></li>
<li class="chapter" data-level="4.11.3" data-path="JavaScript.html"><a href="JavaScript.html#obvladovanje-izjem"><i class="fa fa-check"></i><b>4.11.3</b> Obvladovanje izjem</a></li>
</ul></li>
<li class="chapter" data-level="4.12" data-path="JavaScript.html"><a href="JavaScript.html#regularni-izrazi"><i class="fa fa-check"></i><b>4.12</b> Regularni izrazi</a>
<ul>
<li class="chapter" data-level="4.12.1" data-path="JavaScript.html"><a href="JavaScript.html#kreiranje-regularnega-izraza"><i class="fa fa-check"></i><b>4.12.1</b> Kreiranje regularnega izraza</a></li>
<li class="chapter" data-level="4.12.2" data-path="JavaScript.html"><a href="JavaScript.html#testiranje-ujemanja"><i class="fa fa-check"></i><b>4.12.2</b> Testiranje ujemanja</a></li>
<li class="chapter" data-level="4.12.3" data-path="JavaScript.html"><a href="JavaScript.html#testiranje-ujemanja-množice-znakov"><i class="fa fa-check"></i><b>4.12.3</b> Testiranje ujemanja množice znakov</a></li>
<li class="chapter" data-level="4.12.4" data-path="JavaScript.html"><a href="JavaScript.html#ponavljanje-delov-vzorca"><i class="fa fa-check"></i><b>4.12.4</b> Ponavljanje delov vzorca</a></li>
<li class="chapter" data-level="4.12.5" data-path="JavaScript.html"><a href="JavaScript.html#združevanje-delov-vzorca"><i class="fa fa-check"></i><b>4.12.5</b> Združevanje delov vzorca</a></li>
<li class="chapter" data-level="4.12.6" data-path="JavaScript.html"><a href="JavaScript.html#ujemanje-in-grupiranje"><i class="fa fa-check"></i><b>4.12.6</b> Ujemanje in grupiranje</a></li>
<li class="chapter" data-level="4.12.7" data-path="JavaScript.html"><a href="JavaScript.html#omejevanje-besed"><i class="fa fa-check"></i><b>4.12.7</b> Omejevanje besed</a></li>
<li class="chapter" data-level="4.12.8" data-path="JavaScript.html"><a href="JavaScript.html#vzorci-z-več-možnostmi"><i class="fa fa-check"></i><b>4.12.8</b> Vzorci z več možnostmi</a></li>
<li class="chapter" data-level="4.12.9" data-path="JavaScript.html"><a href="JavaScript.html#zamenjava-podnizov"><i class="fa fa-check"></i><b>4.12.9</b> Zamenjava podnizov</a></li>
<li class="chapter" data-level="4.12.10" data-path="JavaScript.html"><a href="JavaScript.html#požrešna-metoda-ujemanja"><i class="fa fa-check"></i><b>4.12.10</b> Požrešna metoda ujemanja</a></li>
<li class="chapter" data-level="4.12.11" data-path="JavaScript.html"><a href="JavaScript.html#dinamično-kreiranje-regexp-objektov"><i class="fa fa-check"></i><b>4.12.11</b> Dinamično kreiranje <code>RegExp</code> objektov</a></li>
<li class="chapter" data-level="4.12.12" data-path="JavaScript.html"><a href="JavaScript.html#sprehod-po-zadetkih-ujemanja"><i class="fa fa-check"></i><b>4.12.12</b> Sprehod po zadetkih ujemanja</a></li>
</ul></li>
<li class="chapter" data-level="4.13" data-path="JavaScript.html"><a href="JavaScript.html#moduli"><i class="fa fa-check"></i><b>4.13</b> Moduli</a>
<ul>
<li class="chapter" data-level="4.13.1" data-path="JavaScript.html"><a href="JavaScript.html#uporaba-funkcij-v-vlogi-imenskega-prostora"><i class="fa fa-check"></i><b>4.13.1</b> Uporaba funkcij v vlogi imenskega prostora</a></li>
<li class="chapter" data-level="4.13.2" data-path="JavaScript.html"><a href="JavaScript.html#objekti-kot-vmesniki"><i class="fa fa-check"></i><b>4.13.2</b> Objekti kot vmesniki</a></li>
<li class="chapter" data-level="4.13.3" data-path="JavaScript.html"><a href="JavaScript.html#izvajanje-podatkov-v-obliki-kode"><i class="fa fa-check"></i><b>4.13.3</b> Izvajanje podatkov v obliki kode</a></li>
</ul></li>
<li class="chapter" data-level="4.14" data-path="JavaScript.html"><a href="JavaScript.html#javascript-in-spletni-brskalnik"><i class="fa fa-check"></i><b>4.14</b> JavaScript in spletni brskalnik</a>
<ul>
<li class="chapter" data-level="4.14.1" data-path="JavaScript.html"><a href="JavaScript.html#html-in-javascript"><i class="fa fa-check"></i><b>4.14.1</b> HTML in JavaScript</a></li>
<li class="chapter" data-level="4.14.2" data-path="JavaScript.html"><a href="JavaScript.html#zaščiteno-okolje"><i class="fa fa-check"></i><b>4.14.2</b> Zaščiteno okolje</a></li>
</ul></li>
<li class="chapter" data-level="4.15" data-path="JavaScript.html"><a href="JavaScript.html#objektni-model-dokumenta"><i class="fa fa-check"></i><b>4.15</b> Objektni model dokumenta</a>
<ul>
<li class="chapter" data-level="4.15.1" data-path="JavaScript.html"><a href="JavaScript.html#struktura-dokumenta-in-predstavitev-v-obliki-drevesa"><i class="fa fa-check"></i><b>4.15.1</b> Struktura dokumenta in predstavitev v obliki drevesa</a></li>
<li class="chapter" data-level="4.15.2" data-path="JavaScript.html"><a href="JavaScript.html#iskanje-elementov"><i class="fa fa-check"></i><b>4.15.2</b> Iskanje elementov</a></li>
<li class="chapter" data-level="4.15.3" data-path="JavaScript.html"><a href="JavaScript.html#spreminjanje-dokumenta"><i class="fa fa-check"></i><b>4.15.3</b> Spreminjanje dokumenta</a></li>
<li class="chapter" data-level="4.15.4" data-path="JavaScript.html"><a href="JavaScript.html#dodajanje-elementov"><i class="fa fa-check"></i><b>4.15.4</b> Dodajanje elementov</a></li>
<li class="chapter" data-level="4.15.5" data-path="JavaScript.html"><a href="JavaScript.html#uporaba-lastnih-atributov"><i class="fa fa-check"></i><b>4.15.5</b> Uporaba lastnih atributov</a></li>
<li class="chapter" data-level="4.15.6" data-path="JavaScript.html"><a href="JavaScript.html#postavitev-na-strani"><i class="fa fa-check"></i><b>4.15.6</b> Postavitev na strani</a></li>
<li class="chapter" data-level="4.15.7" data-path="JavaScript.html"><a href="JavaScript.html#oblikovanje-in-prekrivni-slogi"><i class="fa fa-check"></i><b>4.15.7</b> Oblikovanje in prekrivni slogi</a></li>
</ul></li>
<li class="chapter" data-level="4.16" data-path="JavaScript.html"><a href="JavaScript.html#obvladovanje-dogodkov"><i class="fa fa-check"></i><b>4.16</b> Obvladovanje dogodkov</a>
<ul>
<li class="chapter" data-level="4.16.1" data-path="JavaScript.html"><a href="JavaScript.html#dogodki-na-html-gradnikih"><i class="fa fa-check"></i><b>4.16.1</b> Dogodki na HTML gradnikih</a></li>
<li class="chapter" data-level="4.16.2" data-path="JavaScript.html"><a href="JavaScript.html#objekt-dogodka"><i class="fa fa-check"></i><b>4.16.2</b> Objekt dogodka</a></li>
<li class="chapter" data-level="4.16.3" data-path="JavaScript.html"><a href="JavaScript.html#širjenje-obvladovanja-dogodkov"><i class="fa fa-check"></i><b>4.16.3</b> Širjenje obvladovanja dogodkov</a></li>
<li class="chapter" data-level="4.16.4" data-path="JavaScript.html"><a href="JavaScript.html#privzete-akcije"><i class="fa fa-check"></i><b>4.16.4</b> Privzete akcije</a></li>
<li class="chapter" data-level="4.16.5" data-path="JavaScript.html"><a href="JavaScript.html#pritisk-tipke-na-tipkovnici"><i class="fa fa-check"></i><b>4.16.5</b> Pritisk tipke na tipkovnici</a></li>
<li class="chapter" data-level="4.16.6" data-path="JavaScript.html"><a href="JavaScript.html#dogodki-z-miško"><i class="fa fa-check"></i><b>4.16.6</b> Dogodki z miško</a></li>
<li class="chapter" data-level="4.16.7" data-path="JavaScript.html"><a href="JavaScript.html#fokusiranje"><i class="fa fa-check"></i><b>4.16.7</b> Fokusiranje</a></li>
<li class="chapter" data-level="4.16.8" data-path="JavaScript.html"><a href="JavaScript.html#dogodek-nalaganja"><i class="fa fa-check"></i><b>4.16.8</b> Dogodek nalaganja</a></li>
<li class="chapter" data-level="4.16.9" data-path="JavaScript.html"><a href="JavaScript.html#časovniki"><i class="fa fa-check"></i><b>4.16.9</b> Časovniki</a></li>
<li class="chapter" data-level="4.16.10" data-path="JavaScript.html"><a href="JavaScript.html#čas-poteka"><i class="fa fa-check"></i><b>4.16.10</b> Čas poteka</a></li>
</ul></li>
<li class="chapter" data-level="4.17" data-path="JavaScript.html"><a href="JavaScript.html#http"><i class="fa fa-check"></i><b>4.17</b> HTTP</a>
<ul>
<li class="chapter" data-level="4.17.1" data-path="JavaScript.html"><a href="JavaScript.html#spletni-brskalniki-in-http"><i class="fa fa-check"></i><b>4.17.1</b> Spletni brskalniki in HTTP</a></li>
<li class="chapter" data-level="4.17.2" data-path="JavaScript.html"><a href="JavaScript.html#posredovanje-zahteve"><i class="fa fa-check"></i><b>4.17.2</b> Posredovanje zahteve</a></li>
<li class="chapter" data-level="4.17.3" data-path="JavaScript.html"><a href="JavaScript.html#http-peskovnik"><i class="fa fa-check"></i><b>4.17.3</b> HTTP peskovnik</a></li>
<li class="chapter" data-level="4.17.4" data-path="JavaScript.html"><a href="JavaScript.html#abstrakcija-zahtev"><i class="fa fa-check"></i><b>4.17.4</b> Abstrakcija zahtev</a></li>
<li class="chapter" data-level="4.17.5" data-path="JavaScript.html"><a href="JavaScript.html#promises"><i class="fa fa-check"></i><b>4.17.5</b> Promises</a></li>
</ul></li>
<li class="chapter" data-level="4.18" data-path="JavaScript.html"><a href="JavaScript.html#spletni-obrazci-in-vnosna-polja"><i class="fa fa-check"></i><b>4.18</b> Spletni obrazci in vnosna polja</a>
<ul>
<li class="chapter" data-level="4.18.1" data-path="JavaScript.html"><a href="JavaScript.html#vnosna-polja"><i class="fa fa-check"></i><b>4.18.1</b> Vnosna polja</a></li>
<li class="chapter" data-level="4.18.2" data-path="JavaScript.html"><a href="JavaScript.html#fokus-vnosa-s-tipkovnico"><i class="fa fa-check"></i><b>4.18.2</b> Fokus vnosa s tipkovnico</a></li>
<li class="chapter" data-level="4.18.3" data-path="JavaScript.html"><a href="JavaScript.html#onemogočeni-elementi-spletnega-obrazca"><i class="fa fa-check"></i><b>4.18.3</b> Onemogočeni elementi spletnega obrazca</a></li>
<li class="chapter" data-level="4.18.4" data-path="JavaScript.html"><a href="JavaScript.html#spletni-obrazec-kot-celota"><i class="fa fa-check"></i><b>4.18.4</b> Spletni obrazec kot celota</a></li>
<li class="chapter" data-level="4.18.5" data-path="JavaScript.html"><a href="JavaScript.html#besedilna-vnosna-polja"><i class="fa fa-check"></i><b>4.18.5</b> Besedilna vnosna polja</a></li>
<li class="chapter" data-level="4.18.6" data-path="JavaScript.html"><a href="JavaScript.html#gradniki-večkratne-izbire"><i class="fa fa-check"></i><b>4.18.6</b> Gradniki (večkratne) izbire</a></li>
<li class="chapter" data-level="4.18.7" data-path="JavaScript.html"><a href="JavaScript.html#izbirna-polja"><i class="fa fa-check"></i><b>4.18.7</b> Izbirna polja</a></li>
<li class="chapter" data-level="4.18.8" data-path="JavaScript.html"><a href="JavaScript.html#vnosno-polje-datoteke"><i class="fa fa-check"></i><b>4.18.8</b> Vnosno polje datoteke</a></li>
<li class="chapter" data-level="4.18.9" data-path="JavaScript.html"><a href="JavaScript.html#shranjevanje-podatkov-na-odjemalcu"><i class="fa fa-check"></i><b>4.18.9</b> Shranjevanje podatkov na odjemalcu</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="Node-js.html"><a href="Node-js.html"><i class="fa fa-check"></i><b>5</b> <span class="sklop2 oznaka">P2.2</span> Node.js, MVC in različna okolja</a>
<ul>
<li class="chapter" data-level="5.1" data-path="Node-js.html"><a href="Node-js.html#node.js"><i class="fa fa-check"></i><b>5.1</b> Node.js</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="Node-js.html"><a href="Node-js.html#ozadje-1"><i class="fa fa-check"></i><b>5.1.1</b> Ozadje</a></li>
<li class="chapter" data-level="5.1.2" data-path="Node-js.html"><a href="Node-js.html#asinhronost"><i class="fa fa-check"></i><b>5.1.2</b> Asinhronost</a></li>
<li class="chapter" data-level="5.1.3" data-path="Node-js.html"><a href="Node-js.html#ukaz-node"><i class="fa fa-check"></i><b>5.1.3</b> Ukaz <code>node</code></a></li>
<li class="chapter" data-level="5.1.4" data-path="Node-js.html"><a href="Node-js.html#moduli-1"><i class="fa fa-check"></i><b>5.1.4</b> Moduli</a></li>
<li class="chapter" data-level="5.1.5" data-path="Node-js.html"><a href="Node-js.html#nameščanje-z-npm"><i class="fa fa-check"></i><b>5.1.5</b> Nameščanje z <code>npm</code></a></li>
<li class="chapter" data-level="5.1.6" data-path="Node-js.html"><a href="Node-js.html#modul-za-dostop-do-datotečnega-sistema"><i class="fa fa-check"></i><b>5.1.6</b> Modul za dostop do datotečnega sistema</a></li>
<li class="chapter" data-level="5.1.7" data-path="Node-js.html"><a href="Node-js.html#modul-http"><i class="fa fa-check"></i><b>5.1.7</b> Modul <code>http</code></a></li>
<li class="chapter" data-level="5.1.8" data-path="Node-js.html"><a href="Node-js.html#tok-podatkov"><i class="fa fa-check"></i><b>5.1.8</b> Tok podatkov</a></li>
<li class="chapter" data-level="5.1.9" data-path="Node-js.html"><a href="Node-js.html#enostavni-datotečni-strežnik"><i class="fa fa-check"></i><b>5.1.9</b> Enostavni datotečni strežnik</a></li>
<li class="chapter" data-level="5.1.10" data-path="Node-js.html"><a href="Node-js.html#obvladovanje-napak"><i class="fa fa-check"></i><b>5.1.10</b> Obvladovanje napak</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="Node-js.html"><a href="Node-js.html#vzpostavitev-in-nastavitev-projekta"><i class="fa fa-check"></i><b>5.2</b> Vzpostavitev in nastavitev projekta</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="Node-js.html"><a href="Node-js.html#pregled-uporabljenih-orodij-express-node-in-npm"><i class="fa fa-check"></i><b>5.2.1</b> Pregled uporabljenih orodij Express, Node in <code>npm</code></a></li>
<li class="chapter" data-level="5.2.2" data-path="Node-js.html"><a href="Node-js.html#kreiranje-projekta-express"><i class="fa fa-check"></i><b>5.2.2</b> Kreiranje projekta Express</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="Node-js.html"><a href="Node-js.html#gradnja-aplikacije-z-mvc"><i class="fa fa-check"></i><b>5.3</b> Gradnja aplikacije z MVC</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="Node-js.html"><a href="Node-js.html#kratek-pregled-mvc-arhitekture"><i class="fa fa-check"></i><b>5.3.1</b> Kratek pregled MVC arhitekture</a></li>
<li class="chapter" data-level="5.3.2" data-path="Node-js.html"><a href="Node-js.html#kako-express-obdela-zahteve"><i class="fa fa-check"></i><b>5.3.2</b> Kako Express obdela zahteve?</a></li>
<li class="chapter" data-level="5.3.3" data-path="Node-js.html"><a href="Node-js.html#gradnja-statične-aplikacije-z-node-in-express"><i class="fa fa-check"></i><b>5.3.3</b> Gradnja statične aplikacije z Node in Express</a></li>
<li class="chapter" data-level="5.3.4" data-path="Node-js.html"><a href="Node-js.html#prilagoditev-ogrodja-express-za-mvc"><i class="fa fa-check"></i><b>5.3.4</b> Prilagoditev ogrodja Express za MVC</a></li>
<li class="chapter" data-level="5.3.5" data-path="Node-js.html"><a href="Node-js.html#dodajanje-zunanjih-knjižnic-za-prilagoditev-izgleda-strani"><i class="fa fa-check"></i><b>5.3.5</b> Dodajanje zunanjih knjižnic za prilagoditev izgleda strani</a></li>
<li class="chapter" data-level="5.3.6" data-path="Node-js.html"><a href="Node-js.html#opredelitev-usmerjevalnikov-v-express"><i class="fa fa-check"></i><b>5.3.6</b> Opredelitev usmerjevalnikov v Express</a></li>
<li class="chapter" data-level="5.3.7" data-path="Node-js.html"><a href="Node-js.html#izdelava-osnovnih-krmilnikov"><i class="fa fa-check"></i><b>5.3.7</b> Izdelava osnovnih krmilnikov</a></li>
<li class="chapter" data-level="5.3.8" data-path="Node-js.html"><a href="Node-js.html#dopolnitev-pogledov"><i class="fa fa-check"></i><b>5.3.8</b> Dopolnitev pogledov</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="Node-js.html"><a href="Node-js.html#strežba-aplikacije-v-različnih-okoljih"><i class="fa fa-check"></i><b>5.4</b> Strežba aplikacije v različnih okoljih</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="Node-js.html"><a href="Node-js.html#docker"><i class="fa fa-check"></i><b>5.4.1</b> Strežba aplikacije v okolju Docker</a></li>
<li class="chapter" data-level="5.4.2" data-path="Node-js.html"><a href="Node-js.html#strežba-aplikacije-na-fly"><i class="fa fa-check"></i><b>5.4.2</b> Strežba aplikacije na Fly</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III sklop: Zaledni del in dostop do podatkov</b></span></li>
<li class="chapter" data-level="6" data-path="PB-REST-API.html"><a href="PB-REST-API.html"><i class="fa fa-check"></i><b>6</b> <span class="sklop3 oznaka">P3.1</span> Podatkovna baza in REST API</a>
<ul>
<li class="chapter" data-level="6.1" data-path="PB-REST-API.html"><a href="PB-REST-API.html#priprava-podatkovnega-modela-za-mongodb-z-mongoose"><i class="fa fa-check"></i><b>6.1</b> Priprava podatkovnega modela za MongoDB z Mongoose</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="PB-REST-API.html"><a href="PB-REST-API.html#Povezovanje-Express-aplikacije-in-MongoDB-z-Mongoose"><i class="fa fa-check"></i><b>6.1.1</b> Povezovanje Express aplikacije in MongoDB z Mongoose</a></li>
<li class="chapter" data-level="6.1.2" data-path="PB-REST-API.html"><a href="PB-REST-API.html#zakaj-je-treba-modelirati-podatke"><i class="fa fa-check"></i><b>6.1.2</b> Zakaj je treba modelirati podatke?</a></li>
<li class="chapter" data-level="6.1.3" data-path="PB-REST-API.html"><a href="PB-REST-API.html#podatki-iz-registra"><i class="fa fa-check"></i><b>6.1.3</b> Podatki iz registra kulturne dediščine</a></li>
<li class="chapter" data-level="6.1.4" data-path="PB-REST-API.html"><a href="PB-REST-API.html#opredelitev-sheme-z-mongoose"><i class="fa fa-check"></i><b>6.1.4</b> Opredelitev sheme z Mongoose</a></li>
<li class="chapter" data-level="6.1.5" data-path="PB-REST-API.html"><a href="PB-REST-API.html#Uporaba-MongoDB-ukazne-lupine-za-dodajanje-podatkov"><i class="fa fa-check"></i><b>6.1.5</b> Uporaba MongoDB ukazne lupine za dodajanje podatkov</a></li>
<li class="chapter" data-level="6.1.6" data-path="PB-REST-API.html"><a href="PB-REST-API.html#uvoz-testnih-podatkov"><i class="fa fa-check"></i><b>6.1.6</b> Uvoz testnih podatkov</a></li>
<li class="chapter" data-level="6.1.7" data-path="PB-REST-API.html"><a href="PB-REST-API.html#vključitev-podatkovne-baze"><i class="fa fa-check"></i><b>6.1.7</b> Vključitev podatkovne baze</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="PB-REST-API.html"><a href="PB-REST-API.html#priprava-rest-api-ja-za-dostop-do-mongodb-podatkovne-baze"><i class="fa fa-check"></i><b>6.2</b> Priprava REST API-ja za dostop do MongoDB podatkovne baze</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="PB-REST-API.html"><a href="PB-REST-API.html#rest-api"><i class="fa fa-check"></i><b>6.2.1</b> REST API</a></li>
<li class="chapter" data-level="6.2.2" data-path="PB-REST-API.html"><a href="PB-REST-API.html#url-zahteva"><i class="fa fa-check"></i><b>6.2.2</b> URL zahteva</a></li>
<li class="chapter" data-level="6.2.3" data-path="PB-REST-API.html"><a href="PB-REST-API.html#metoda-zahteve"><i class="fa fa-check"></i><b>6.2.3</b> Metoda zahteve</a></li>
<li class="chapter" data-level="6.2.4" data-path="PB-REST-API.html"><a href="PB-REST-API.html#odgovor-podatek-in-status-api-ja"><i class="fa fa-check"></i><b>6.2.4</b> Odgovor (podatek in status) API-ja</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="PB-REST-API.html"><a href="PB-REST-API.html#Implementacija-API-ja-z-ogrodjem-Express"><i class="fa fa-check"></i><b>6.3</b> Implementacija API-ja z ogrodjem Express</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="PB-REST-API.html"><a href="PB-REST-API.html#priprava-usmerjevalnika"><i class="fa fa-check"></i><b>6.3.1</b> Priprava usmerjevalnika</a></li>
<li class="chapter" data-level="6.3.2" data-path="PB-REST-API.html"><a href="PB-REST-API.html#priprava-osnutka-krmilnika"><i class="fa fa-check"></i><b>6.3.2</b> Priprava osnutka krmilnika</a></li>
<li class="chapter" data-level="6.3.3" data-path="PB-REST-API.html"><a href="PB-REST-API.html#testiranje-osnutka-api-ja"><i class="fa fa-check"></i><b>6.3.3</b> Testiranje osnutka API-ja</a></li>
<li class="chapter" data-level="6.3.4" data-path="PB-REST-API.html"><a href="PB-REST-API.html#vključitev-modela"><i class="fa fa-check"></i><b>6.3.4</b> Vključitev modela</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="PB-REST-API.html"><a href="PB-REST-API.html#get-metode-za-branje-podatkov-iz-mongodb"><i class="fa fa-check"></i><b>6.4</b> GET metode za branje podatkov iz MongoDB</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="PB-REST-API.html"><a href="PB-REST-API.html#iskanje-dokumenta"><i class="fa fa-check"></i><b>6.4.1</b> Iskanje dokumenta</a></li>
<li class="chapter" data-level="6.4.2" data-path="PB-REST-API.html"><a href="PB-REST-API.html#iskanje-odvisnega-dokumenta"><i class="fa fa-check"></i><b>6.4.2</b> Iskanje odvisnega dokumenta</a></li>
<li class="chapter" data-level="6.4.3" data-path="PB-REST-API.html"><a href="PB-REST-API.html#geografsko-iskanje"><i class="fa fa-check"></i><b>6.4.3</b> Geografsko iskanje več dokumentov</a></li>
<li class="chapter" data-level="6.4.4" data-path="PB-REST-API.html"><a href="PB-REST-API.html#napredno-iskanje"><i class="fa fa-check"></i><b>6.4.4</b> Napredno iskanje</a></li>
<li class="chapter" data-level="6.4.5" data-path="PB-REST-API.html"><a href="PB-REST-API.html#seznami-sifrantov"><i class="fa fa-check"></i><b>6.4.5</b> Seznami šifrantov</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="Swagger.html"><a href="Swagger.html"><i class="fa fa-check"></i><b>7</b> <span class="sklop3 oznaka">P3.2</span> Načrtovanje s Swagger in OpenAPI</a>
<ul>
<li class="chapter" data-level="7.1" data-path="Swagger.html"><a href="Swagger.html#dokumentiranje-rest-api-ja-z-openapi-specifikacijo"><i class="fa fa-check"></i><b>7.1</b> Dokumentiranje REST API-ja z OpenAPI specifikacijo</a></li>
<li class="chapter" data-level="7.2" data-path="Swagger.html"><a href="Swagger.html#post-metode-za-dodajanje-podatkov-v-mongodb"><i class="fa fa-check"></i><b>7.2</b> POST metode za dodajanje podatkov v MongoDB</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="Swagger.html"><a href="Swagger.html#dodajanje-novih-dokumentov-v-mongodb"><i class="fa fa-check"></i><b>7.2.1</b> Dodajanje novih dokumentov v MongoDB</a></li>
<li class="chapter" data-level="7.2.2" data-path="Swagger.html"><a href="Swagger.html#dodajanje-odvisnih-dokumentov-v-mongodb"><i class="fa fa-check"></i><b>7.2.2</b> Dodajanje odvisnih dokumentov v MongoDB</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="Swagger.html"><a href="Swagger.html#put-metode-za-ažuriranje-podatkov-v-mongodb"><i class="fa fa-check"></i><b>7.3</b> PUT metode za ažuriranje podatkov v MongoDB</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="Swagger.html"><a href="Swagger.html#posodobitev-obstoječega-dokumenta-v-mongodb"><i class="fa fa-check"></i><b>7.3.1</b> Posodobitev obstoječega dokumenta v MongoDB</a></li>
<li class="chapter" data-level="7.3.2" data-path="Swagger.html"><a href="Swagger.html#PUT-odvisni-dokument"><i class="fa fa-check"></i><b>7.3.2</b> Posodobitev obstoječega odvisnega dokumenta v MongoDB</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="Swagger.html"><a href="Swagger.html#delete-metode-za-brisanje-podatkov-iz-mongodb"><i class="fa fa-check"></i><b>7.4</b> DELETE metode za brisanje podatkov iz MongoDB</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="Swagger.html"><a href="Swagger.html#DELETE-comment"><i class="fa fa-check"></i><b>7.4.1</b> Brisanje obstoječega komentarja</a></li>
<li class="chapter" data-level="7.4.2" data-path="Swagger.html"><a href="Swagger.html#brisanje-dokumentov"><i class="fa fa-check"></i><b>7.4.2</b> Brisanje dokumentov</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="Swagger.html"><a href="Swagger.html#uporaba-rest-api-ja-v-express-aplikaciji"><i class="fa fa-check"></i><b>7.5</b> Uporaba REST API-ja v Express aplikaciji</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="Swagger.html"><a href="Swagger.html#priprava-na-api-klic-iz-express-aplikacije"><i class="fa fa-check"></i><b>7.5.1</b> Priprava na API klic iz Express aplikacije</a></li>
<li class="chapter" data-level="7.5.2" data-path="Swagger.html"><a href="Swagger.html#pridobitev-seznama-lokacij-preko-api-ja"><i class="fa fa-check"></i><b>7.5.2</b> Pridobitev seznama lokacij preko API-ja</a></li>
<li class="chapter" data-level="7.5.3" data-path="Swagger.html"><a href="Swagger.html#priprava-novega-pogleda-seznama"><i class="fa fa-check"></i><b>7.5.3</b> Priprava novega pogleda seznama</a></li>
<li class="chapter" data-level="7.5.4" data-path="Swagger.html"><a href="Swagger.html#axios-zunanji-viri"><i class="fa fa-check"></i><b>7.5.4</b> Vključitev ostalih podatkov iz zunanjih virov</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="Swagger.html"><a href="Swagger.html#izboljšanje-zmogljivosti-api-ja"><i class="fa fa-check"></i><b>7.6</b> Izboljšanje zmogljivosti API-ja</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="Swagger.html"><a href="Swagger.html#porazdelitev-po-straneh"><i class="fa fa-check"></i><b>7.6.1</b> Porazdelitev po straneh</a></li>
<li class="chapter" data-level="7.6.2" data-path="Swagger.html"><a href="Swagger.html#asinhrono-beleženje"><i class="fa fa-check"></i><b>7.6.2</b> Asinhrono beleženje</a></li>
<li class="chapter" data-level="7.6.3" data-path="Swagger.html"><a href="Swagger.html#predpomnjenje"><i class="fa fa-check"></i><b>7.6.3</b> Predpomnjenje</a></li>
<li class="chapter" data-level="7.6.4" data-path="Swagger.html"><a href="Swagger.html#stiskanje-koristne-vsebine"><i class="fa fa-check"></i><b>7.6.4</b> Stiskanje koristne vsebine</a></li>
<li class="chapter" data-level="7.6.5" data-path="Swagger.html"><a href="Swagger.html#bazen-povezav"><i class="fa fa-check"></i><b>7.6.5</b> Bazen povezav</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV sklop: Uporabniški vmesnik</b></span></li>
<li class="chapter" data-level="8" data-path="Angular.html"><a href="Angular.html"><i class="fa fa-check"></i><b>8</b> <span class="sklop4 oznaka">P4.1</span> TypeScript in Angular</a>
<ul>
<li class="chapter" data-level="8.1" data-path="Angular.html"><a href="Angular.html#Dodajanje-Angular-komponent-v-Express-aplikacijo"><i class="fa fa-check"></i><b>8.1</b> Dodajanje Angular komponent v Express aplikacijo</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="Angular.html"><a href="Angular.html#namestitev-ogrodja-angular"><i class="fa fa-check"></i><b>8.1.1</b> Namestitev ogrodja Angular</a></li>
<li class="chapter" data-level="8.1.2" data-path="Angular.html"><a href="Angular.html#jezik-typescript"><i class="fa fa-check"></i><b>8.1.2</b> Jezik TypeScript</a></li>
<li class="chapter" data-level="8.1.3" data-path="Angular.html"><a href="Angular.html#kreiranje-in-zagon-angular-aplikacije"><i class="fa fa-check"></i><b>8.1.3</b> Kreiranje in zagon Angular aplikacije</a></li>
<li class="chapter" data-level="8.1.4" data-path="Angular.html"><a href="Angular.html#Izvorna-koda-Angular-aplikacije"><i class="fa fa-check"></i><b>8.1.4</b> Izvorna koda Angular aplikacije</a></li>
<li class="chapter" data-level="8.1.5" data-path="Angular.html"><a href="Angular.html#generiranje-angular-aplikacije-v-jeziku-javascript"><i class="fa fa-check"></i><b>8.1.5</b> Generiranje Angular aplikacije v jeziku JavaScript</a></li>
<li class="chapter" data-level="8.1.6" data-path="Angular.html"><a href="Angular.html#komponenta-za-prikaz-podatkov"><i class="fa fa-check"></i><b>8.1.6</b> Komponenta za prikaz podatkov</a></li>
<li class="chapter" data-level="8.1.7" data-path="Angular.html"><a href="Angular.html#Pridobivanje-podatkov-preko-REST-API-ja"><i class="fa fa-check"></i><b>8.1.7</b> Pridobivanje podatkov preko REST API-ja</a></li>
<li class="chapter" data-level="8.1.8" data-path="Angular.html"><a href="Angular.html#prenos-angular-aplikacije-v-produkcijsko-okolje"><i class="fa fa-check"></i><b>8.1.8</b> Prenos Angular aplikacije v produkcijsko okolje</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="Angular.html"><a href="Angular.html#izdelava-angular-spa-aplikacije-na-eni-strani"><i class="fa fa-check"></i><b>8.2</b> Izdelava Angular SPA aplikacije na eni strani</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="Angular.html"><a href="Angular.html#Prehod-iz-Express-usmerjanja-na-Angular-usmerjanje"><i class="fa fa-check"></i><b>8.2.1</b> Prehod iz Express usmerjanja na Angular usmerjanje</a></li>
<li class="chapter" data-level="8.2.2" data-path="Angular.html"><a href="Angular.html#navigacija-med-stranmi"><i class="fa fa-check"></i><b>8.2.2</b> Navigacija med stranmi</a></li>
<li class="chapter" data-level="8.2.3" data-path="Angular.html"><a href="Angular.html#modularna-zasnova-aplikacije-z-vgnezdenimi-komponentami"><i class="fa fa-check"></i><b>8.2.3</b> Modularna zasnova aplikacije z vgnezdenimi komponentami</a></li>
<li class="chapter" data-level="8.2.4" data-path="Angular.html"><a href="Angular.html#dodajanje-html-geolokacije-za-iskanje-bližnjih-lokacij"><i class="fa fa-check"></i><b>8.2.4</b> Dodajanje HTML geolokacije za iskanje bližnjih lokacij</a></li>
<li class="chapter" data-level="8.2.5" data-path="Angular.html"><a href="Angular.html#prikaz-zvezdic-v-obliki-ponovno-uporabne-komponente"><i class="fa fa-check"></i><b>8.2.5</b> Prikaz zvezdic v obliki ponovno uporabne komponente</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="Angular-SPA.html"><a href="Angular-SPA.html"><i class="fa fa-check"></i><b>9</b> <span class="sklop4 oznaka">P4.2</span> Angular SPA</a>
<ul>
<li class="chapter" data-level="9.1" data-path="Angular-SPA.html"><a href="Angular-SPA.html#kompleksnejši-pogledi-s-parametri-usmerjevanja"><i class="fa fa-check"></i><b>9.1</b> Kompleksnejši pogledi s parametri usmerjevanja</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="Angular-SPA.html"><a href="Angular-SPA.html#sprememba-strukture-strani"><i class="fa fa-check"></i><b>9.1.1</b> Sprememba strukture strani</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="Angular-SPA.html"><a href="Angular-SPA.html#dodajanje-usmerjanja-z-url-parametri"><i class="fa fa-check"></i><b>9.2</b> Dodajanje usmerjanja z URL parametri</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="Angular-SPA.html"><a href="Angular-SPA.html#prenos-podatkov-do-komponente-s-podrobnostmi-lokacije"><i class="fa fa-check"></i><b>9.2.1</b> Prenos podatkov do komponente s podrobnostmi lokacije</a></li>
<li class="chapter" data-level="9.2.2" data-path="Angular-SPA.html"><a href="Angular-SPA.html#pogled-podrobnosti-lokacije"><i class="fa fa-check"></i><b>9.2.2</b> Pogled podrobnosti lokacije</a></li>
<li class="chapter" data-level="9.2.3" data-path="Angular-SPA.html"><a href="Angular-SPA.html#varnostne-izjeme-pri-prikazovanju-zunanjih-podatkov"><i class="fa fa-check"></i><b>9.2.3</b> Varnostne izjeme pri prikazovanju zunanjih podatkov</a></li>
<li class="chapter" data-level="9.2.4" data-path="Angular-SPA.html"><a href="Angular-SPA.html#sprememba-vrstnega-reda-prikaza-komentarjev"><i class="fa fa-check"></i><b>9.2.4</b> Sprememba vrstnega reda prikaza komentarjev</a></li>
<li class="chapter" data-level="9.2.5" data-path="Angular-SPA.html"><a href="Angular-SPA.html#formatiranje-datuma"><i class="fa fa-check"></i><b>9.2.5</b> Formatiranje datuma</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="Angular-SPA.html"><a href="Angular-SPA.html#delo-s-spletnimi-obrazci-in-pošiljanje-podatkov"><i class="fa fa-check"></i><b>9.3</b> Delo s spletnimi obrazci in pošiljanje podatkov</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="Angular-SPA.html"><a href="Angular-SPA.html#priprava-modalnega-okna"><i class="fa fa-check"></i><b>9.3.1</b> Priprava modalnega okna</a></li>
<li class="chapter" data-level="9.3.2" data-path="Angular-SPA.html"><a href="Angular-SPA.html#dodajanje-spletnega-obrazca"><i class="fa fa-check"></i><b>9.3.2</b> Dodajanje spletnega obrazca</a></li>
<li class="chapter" data-level="9.3.3" data-path="Angular-SPA.html"><a href="Angular-SPA.html#povezovanje-podatkov-in-vnosnih-polj-obrazca"><i class="fa fa-check"></i><b>9.3.3</b> Povezovanje podatkov in vnosnih polj obrazca</a></li>
<li class="chapter" data-level="9.3.4" data-path="Angular-SPA.html"><a href="Angular-SPA.html#posredovanje-podatkov-spletnega-obrazca-na-rest-api"><i class="fa fa-check"></i><b>9.3.4</b> Posredovanje podatkov spletnega obrazca na REST API</a></li>
<li class="chapter" data-level="9.3.5" data-path="Angular-SPA.html"><a href="Angular-SPA.html#brisanje-komentarjev"><i class="fa fa-check"></i><b>9.3.5</b> Brisanje komentarjev</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="Angular-SPA.html"><a href="Angular-SPA.html#izboljšava-arhitekture"><i class="fa fa-check"></i><b>9.4</b> Izboljšava arhitekture</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="Angular-SPA.html"><a href="Angular-SPA.html#locitev-usmerjanja"><i class="fa fa-check"></i><b>9.4.1</b> Ločitev usmerjanja</a></li>
<li class="chapter" data-level="9.4.2" data-path="Angular-SPA.html"><a href="Angular-SPA.html#opredelitev-razredov"><i class="fa fa-check"></i><b>9.4.2</b> Opredelitev razredov</a></li>
<li class="chapter" data-level="9.4.3" data-path="Angular-SPA.html"><a href="Angular-SPA.html#Organizacija-izvorne-kode-v-mape"><i class="fa fa-check"></i><b>9.4.3</b> Organizacija izvorne kode v mape</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="Angular-SPA.html"><a href="Angular-SPA.html#zamenjava-strežniške-aplikacije-s-spa-aplikacijo"><i class="fa fa-check"></i><b>9.5</b> Zamenjava strežniške aplikacije s SPA aplikacijo</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="Angular-SPA.html"><a href="Angular-SPA.html#preusmeritev-zahtev-na-angular-spa"><i class="fa fa-check"></i><b>9.5.1</b> Preusmeritev zahtev na Angular SPA</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="Angular-SPA.html"><a href="Angular-SPA.html#dodatni-gradniki-angular-aplikacije"><i class="fa fa-check"></i><b>9.6</b> Dodatni gradniki Angular aplikacije</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="Avtentikacija.html"><a href="Avtentikacija.html"><i class="fa fa-check"></i><b>10</b> <span class="sklop4 oznaka">P4.3</span> Preverjanje istovetnosti uporabnika</a>
<ul>
<li class="chapter" data-level="10.1" data-path="Avtentikacija.html"><a href="Avtentikacija.html#način-avtentikacije-z-uporabo-mean-sklada-tehnologij"><i class="fa fa-check"></i><b>10.1</b> Način avtentikacije z uporabo MEAN sklada tehnologij</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="Avtentikacija.html"><a href="Avtentikacija.html#klasični-pristop-avtentikacije-pri-strežniški-aplikaciji"><i class="fa fa-check"></i><b>10.1.1</b> Klasični pristop avtentikacije pri strežniški aplikaciji</a></li>
<li class="chapter" data-level="10.1.2" data-path="Avtentikacija.html"><a href="Avtentikacija.html#avtentikacija-z-mean-skladom-tehnologij"><i class="fa fa-check"></i><b>10.1.2</b> Avtentikacija z MEAN skladom tehnologij</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="Avtentikacija.html"><a href="Avtentikacija.html#kreiranje-sheme-uporabnikov-v-mongodb"><i class="fa fa-check"></i><b>10.2</b> Kreiranje sheme uporabnikov v MongoDB</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="Avtentikacija.html"><a href="Avtentikacija.html#enosmerno-šifriranje-gesel"><i class="fa fa-check"></i><b>10.2.1</b> Enosmerno šifriranje gesel</a></li>
<li class="chapter" data-level="10.2.2" data-path="Avtentikacija.html"><a href="Avtentikacija.html#Kreiranje-sheme-z-Mongoose"><i class="fa fa-check"></i><b>10.2.2</b> Kreiranje sheme z Mongoose</a></li>
<li class="chapter" data-level="10.2.3" data-path="Avtentikacija.html"><a href="Avtentikacija.html#šifriranje-uporabniškega-gesla"><i class="fa fa-check"></i><b>10.2.3</b> Šifriranje uporabniškega gesla</a></li>
<li class="chapter" data-level="10.2.4" data-path="Avtentikacija.html"><a href="Avtentikacija.html#preverjanje-ustreznosti-podanega-gesla"><i class="fa fa-check"></i><b>10.2.4</b> Preverjanje ustreznosti podanega gesla</a></li>
<li class="chapter" data-level="10.2.5" data-path="Avtentikacija.html"><a href="Avtentikacija.html#generiranje-json-spletnega-žetona-jwt"><i class="fa fa-check"></i><b>10.2.5</b> Generiranje JSON spletnega žetona (JWT)</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="Avtentikacija.html"><a href="Avtentikacija.html#Priprava-API-ja-za-avtentikacijo"><i class="fa fa-check"></i><b>10.3</b> Priprava API-ja za avtentikacijo</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="Avtentikacija.html"><a href="Avtentikacija.html#namestitev-in-konfiguracija-passporta"><i class="fa fa-check"></i><b>10.3.1</b> Namestitev in konfiguracija Passporta</a></li>
<li class="chapter" data-level="10.3.2" data-path="Avtentikacija.html"><a href="Avtentikacija.html#kreiranje-api-dostopne-točke-in-vračanje-json-spletnih-žetonov-jwt"><i class="fa fa-check"></i><b>10.3.2</b> Kreiranje API dostopne točke in vračanje JSON spletnih žetonov (JWT)</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="Avtentikacija.html"><a href="Avtentikacija.html#Varnostna-zascita-izbranih-API-dostopnih-tock"><i class="fa fa-check"></i><b>10.4</b> Varnostna zaščita izbranih API dostopnih točk</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="Avtentikacija.html"><a href="Avtentikacija.html#dodajanje-vmesne-avtentikacijske-ravni-pri-express-usmerjanju"><i class="fa fa-check"></i><b>10.4.1</b> Dodajanje vmesne avtentikacijske ravni pri Express usmerjanju</a></li>
<li class="chapter" data-level="10.4.2" data-path="Avtentikacija.html"><a href="Avtentikacija.html#uporaba-informacij-iz-jwt-v-express-krmilniku"><i class="fa fa-check"></i><b>10.4.2</b> Uporaba informacij iz JWT v Express krmilniku</a></li>
<li class="chapter" data-level="10.4.3" data-path="Avtentikacija.html"><a href="Avtentikacija.html#avtorizacija-azuriranje"><i class="fa fa-check"></i><b>10.4.3</b> Avtorizacija pri ažuriranju komentarja</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="Avtentikacija.html"><a href="Avtentikacija.html#Priprava-storitve-avtentikacije-v-Angular"><i class="fa fa-check"></i><b>10.5</b> Priprava storitve avtentikacije v Angular</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="Avtentikacija.html"><a href="Avtentikacija.html#obvladovanje-seje-uporabnika-v-angular"><i class="fa fa-check"></i><b>10.5.1</b> Obvladovanje seje uporabnika v Angular</a></li>
<li class="chapter" data-level="10.5.2" data-path="Avtentikacija.html"><a href="Avtentikacija.html#omogočanje-registracije-prijave-in-odjave-uporabnikov"><i class="fa fa-check"></i><b>10.5.2</b> Omogočanje registracije, prijave in odjave uporabnikov</a></li>
<li class="chapter" data-level="10.5.3" data-path="Avtentikacija.html"><a href="Avtentikacija.html#uporaba-podatkov-iz-jwt-v-angular-storitvi"><i class="fa fa-check"></i><b>10.5.3</b> Uporaba podatkov iz JWT v Angular storitvi</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="Avtentikacija.html"><a href="Avtentikacija.html#Priprava-strani-za-registracijo-in-prijavo-uporabnika"><i class="fa fa-check"></i><b>10.6</b> Priprava strani za registracijo in prijavo uporabnika</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="Avtentikacija.html"><a href="Avtentikacija.html#priprava-strani-za-registracijo"><i class="fa fa-check"></i><b>10.6.1</b> Priprava strani za registracijo</a></li>
<li class="chapter" data-level="10.6.2" data-path="Avtentikacija.html"><a href="Avtentikacija.html#priprava-strani-za-prijavo"><i class="fa fa-check"></i><b>10.6.2</b> Priprava strani za prijavo</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="Avtentikacija.html"><a href="Avtentikacija.html#uporaba-avtentikacije-v-angular-aplikaciji"><i class="fa fa-check"></i><b>10.7</b> Uporaba avtentikacije v Angular aplikaciji</a>
<ul>
<li class="chapter" data-level="10.7.1" data-path="Avtentikacija.html"><a href="Avtentikacija.html#posodobitev-navigacije"><i class="fa fa-check"></i><b>10.7.1</b> Posodobitev navigacije</a></li>
<li class="chapter" data-level="10.7.2" data-path="Avtentikacija.html"><a href="Avtentikacija.html#podpora-zgodovini-brskanja"><i class="fa fa-check"></i><b>10.7.2</b> Podpora zgodovini brskanja</a></li>
<li class="chapter" data-level="10.7.3" data-path="Avtentikacija.html"><a href="Avtentikacija.html#dodajanje-uporabnika-v-komentar"><i class="fa fa-check"></i><b>10.7.3</b> Dodajanje uporabniških podatkov v komentar</a></li>
<li class="chapter" data-level="10.7.4" data-path="Avtentikacija.html"><a href="Avtentikacija.html#brisanje-lastnih-komentarjev"><i class="fa fa-check"></i><b>10.7.4</b> Brisanje lastnih komentarjev</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="Avtentikacija.html"><a href="Avtentikacija.html#nastavitve-v-brskalniku"><i class="fa fa-check"></i><b>10.8</b> Shranjevanje uporabniških nastavitev v brskalniku</a></li>
<li class="chapter" data-level="10.9" data-path="Avtentikacija.html"><a href="Avtentikacija.html#auth-guard"><i class="fa fa-check"></i><b>10.9</b> Auth Guard</a>
<ul>
<li class="chapter" data-level="10.9.1" data-path="Avtentikacija.html"><a href="Avtentikacija.html#vrste"><i class="fa fa-check"></i><b>10.9.1</b> Vrste</a></li>
<li class="chapter" data-level="10.9.2" data-path="Avtentikacija.html"><a href="Avtentikacija.html#canRegister"><i class="fa fa-check"></i><b>10.9.2</b> Onemogočenje registracije prijavljenim uporabnikom</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>V sklop: Decentralizirane aplikacije in veriga blokov</b></span></li>
<li class="chapter" data-level="11" data-path="DApps-pametne-pogodbe.html"><a href="DApps-pametne-pogodbe.html"><i class="fa fa-check"></i><b>11</b> <span class="sklop5 oznaka">P5.1</span> DApps, pametne pogodbe in Solidity</a>
<ul>
<li class="chapter" data-level="11.1" data-path="DApps-pametne-pogodbe.html"><a href="DApps-pametne-pogodbe.html#decentralizirane-aplikacije"><i class="fa fa-check"></i><b>11.1</b> Decentralizirane aplikacije</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="DApps-pametne-pogodbe.html"><a href="DApps-pametne-pogodbe.html#kaj-je-decentralizirana-aplikacija-dapp"><i class="fa fa-check"></i><b>11.1.1</b> Kaj je decentralizirana aplikacija (DApp)?</a></li>
<li class="chapter" data-level="11.1.2" data-path="DApps-pametne-pogodbe.html"><a href="DApps-pametne-pogodbe.html#omrežje-ethereum"><i class="fa fa-check"></i><b>11.1.2</b> Omrežje Ethereum</a></li>
<li class="chapter" data-level="11.1.3" data-path="DApps-pametne-pogodbe.html"><a href="DApps-pametne-pogodbe.html#terminologija-dapp"><i class="fa fa-check"></i><b>11.1.3</b> Terminologija DApp</a></li>
<li class="chapter" data-level="11.1.4" data-path="DApps-pametne-pogodbe.html"><a href="DApps-pametne-pogodbe.html#decentralizirane-in-porazdeljene-aplikacije"><i class="fa fa-check"></i><b>11.1.4</b> Decentralizirane in porazdeljene aplikacije</a></li>
<li class="chapter" data-level="11.1.5" data-path="DApps-pametne-pogodbe.html"><a href="DApps-pametne-pogodbe.html#primeri-dobrih-praks"><i class="fa fa-check"></i><b>11.1.5</b> Primeri dobrih praks</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="DApps-pametne-pogodbe.html"><a href="DApps-pametne-pogodbe.html#veriga-blokov"><i class="fa fa-check"></i><b>11.2</b> Veriga blokov</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="DApps-pametne-pogodbe.html"><a href="DApps-pametne-pogodbe.html#sklad-tehnologij-za-podporo-dapp"><i class="fa fa-check"></i><b>11.2.1</b> Sklad tehnologij za podporo DApp</a></li>
<li class="chapter" data-level="11.2.2" data-path="DApps-pametne-pogodbe.html"><a href="DApps-pametne-pogodbe.html#podrobnosti-vozlišča-ethereum"><i class="fa fa-check"></i><b>11.2.2</b> Podrobnosti vozlišča Ethereum</a></li>
<li class="chapter" data-level="11.2.3" data-path="DApps-pametne-pogodbe.html"><a href="DApps-pametne-pogodbe.html#življenjski-cikel-transakcije"><i class="fa fa-check"></i><b>11.2.3</b> Življenjski cikel transakcije</a></li>
<li class="chapter" data-level="11.2.4" data-path="DApps-pametne-pogodbe.html"><a href="DApps-pametne-pogodbe.html#razvijalski-pogled-na-postavitev-pametne-pogodbe"><i class="fa fa-check"></i><b>11.2.4</b> Razvijalski pogled na postavitev pametne pogodbe</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="DApps-pametne-pogodbe.html"><a href="DApps-pametne-pogodbe.html#platforma-ethereum"><i class="fa fa-check"></i><b>11.3</b> Platforma Ethereum</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="DApps-pametne-pogodbe.html"><a href="DApps-pametne-pogodbe.html#pametne-pogodbe-kot-osnova-dapp"><i class="fa fa-check"></i><b>11.3.1</b> Pametne pogodbe kot osnova DApp</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="DApps-pametne-pogodbe.html"><a href="DApps-pametne-pogodbe.html#programiranje-pametnih-pogodb-s-solidity"><i class="fa fa-check"></i><b>11.4</b> Programiranje pametnih pogodb s Solidity</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="DApps-pametne-pogodbe.html"><a href="DApps-pametne-pogodbe.html#Struktura-pogodbe"><i class="fa fa-check"></i><b>11.4.1</b> Struktura pogodbe</a></li>
<li class="chapter" data-level="11.4.2" data-path="DApps-pametne-pogodbe.html"><a href="DApps-pametne-pogodbe.html#razvoj-enostavne-pogodbe"><i class="fa fa-check"></i><b>11.4.2</b> Razvoj enostavne pogodbe</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="DApps-pametne-pogodbe.html"><a href="DApps-pametne-pogodbe.html#razvoj-kompleksnih-pametnih-pogodb"><i class="fa fa-check"></i><b>11.5</b> Razvoj kompleksnih pametnih pogodb</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="DApps-pametne-pogodbe.html"><a href="DApps-pametne-pogodbe.html#spremenljivke-stanja"><i class="fa fa-check"></i><b>11.5.1</b> Spremenljivke stanja</a></li>
<li class="chapter" data-level="11.5.2" data-path="DApps-pametne-pogodbe.html"><a href="DApps-pametne-pogodbe.html#konstruktor"><i class="fa fa-check"></i><b>11.5.2</b> Konstruktor</a></li>
<li class="chapter" data-level="11.5.3" data-path="DApps-pametne-pogodbe.html"><a href="DApps-pametne-pogodbe.html#funkcije-za-podporo-množični-prodaji"><i class="fa fa-check"></i><b>11.5.3</b> Funkcije za podporo množični prodaji</a></li>
<li class="chapter" data-level="11.5.4" data-path="DApps-pametne-pogodbe.html"><a href="DApps-pametne-pogodbe.html#testiranje-množične-prodaje"><i class="fa fa-check"></i><b>11.5.4</b> Testiranje množične prodaje</a></li>
<li class="chapter" data-level="11.5.5" data-path="DApps-pametne-pogodbe.html"><a href="DApps-pametne-pogodbe.html#večkratno-dedovanje"><i class="fa fa-check"></i><b>11.5.5</b> Večkratno dedovanje</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="DApps-pametne-pogodbe.html"><a href="DApps-pametne-pogodbe.html#objektno-usmerjene-lastnosti-pametnih-pogodb"><i class="fa fa-check"></i><b>11.6</b> Objektno usmerjene lastnosti pametnih pogodb</a>
<ul>
<li class="chapter" data-level="11.6.1" data-path="DApps-pametne-pogodbe.html"><a href="DApps-pametne-pogodbe.html#dedovanje"><i class="fa fa-check"></i><b>11.6.1</b> Dedovanje</a></li>
<li class="chapter" data-level="11.6.2" data-path="DApps-pametne-pogodbe.html"><a href="DApps-pametne-pogodbe.html#abstraktne-pogodbe"><i class="fa fa-check"></i><b>11.6.2</b> Abstraktne pogodbe</a></li>
<li class="chapter" data-level="11.6.3" data-path="DApps-pametne-pogodbe.html"><a href="DApps-pametne-pogodbe.html#vmesniki"><i class="fa fa-check"></i><b>11.6.3</b> Vmesniki</a></li>
<li class="chapter" data-level="11.6.4" data-path="DApps-pametne-pogodbe.html"><a href="DApps-pametne-pogodbe.html#knjižnice"><i class="fa fa-check"></i><b>11.6.4</b> Knjižnice</a></li>
<li class="chapter" data-level="11.6.5" data-path="DApps-pametne-pogodbe.html"><a href="DApps-pametne-pogodbe.html#skladnost-s-standardom-erc20"><i class="fa fa-check"></i><b>11.6.5</b> Skladnost s standardom <code>ERC20</code></a></li>
</ul></li>
<li class="chapter" data-level="11.7" data-path="DApps-pametne-pogodbe.html"><a href="DApps-pametne-pogodbe.html#ekosistem-ethereum"><i class="fa fa-check"></i><b>11.7</b> Ekosistem Ethereum</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="LP2.html"><a href="LP2.html"><i class="fa fa-check"></i><b>12</b> <span class="sklop5 oznaka">2. LP</span> Decentralizirana aplikacija na verigi blokov</a>
<ul>
<li class="chapter" data-level="12.1" data-path="LP2.html"><a href="LP2.html#pravila-zahteve-in-omejitve-1"><i class="fa fa-check"></i><b>12.1</b> Pravila, zahteve in omejitve</a></li>
<li class="chapter" data-level="12.2" data-path="LP2.html"><a href="LP2.html#kriteriji-vrednotenja-1"><i class="fa fa-check"></i><b>12.2</b> Kriteriji vrednotenja</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="Truffle-Web3.html"><a href="Truffle-Web3.html"><i class="fa fa-check"></i><b>13</b> <span class="sklop5 oznaka">P5.2</span> Truffle in Web3</a>
<ul>
<li class="chapter" data-level="13.1" data-path="Truffle-Web3.html"><a href="Truffle-Web3.html#izdelava-decentralizirane-aplikacije"><i class="fa fa-check"></i><b>13.1</b> Izdelava decentralizirane aplikacije</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="Truffle-Web3.html"><a href="Truffle-Web3.html#opredelitev-zahtev-decentralizirane-aplikacije-za-glasovanje"><i class="fa fa-check"></i><b>13.1.1</b> Opredelitev zahtev decentralizirane aplikacije za glasovanje</a></li>
<li class="chapter" data-level="13.1.2" data-path="Truffle-Web3.html"><a href="Truffle-Web3.html#razvojni-načrt"><i class="fa fa-check"></i><b>13.1.2</b> Razvojni načrt</a></li>
<li class="chapter" data-level="13.1.3" data-path="Truffle-Web3.html"><a href="Truffle-Web3.html#Truffle-projekt"><i class="fa fa-check"></i><b>13.1.3</b> Truffle projekt</a></li>
<li class="chapter" data-level="13.1.4" data-path="Truffle-Web3.html"><a href="Truffle-Web3.html#razvoj-pametne-pogodbe"><i class="fa fa-check"></i><b>13.1.4</b> Razvoj pametne pogodbe</a></li>
<li class="chapter" data-level="13.1.5" data-path="Truffle-Web3.html"><a href="Truffle-Web3.html#lastna-privatna-veriga-blokov"><i class="fa fa-check"></i><b>13.1.5</b> Lastna privatna veriga blokov</a></li>
<li class="chapter" data-level="13.1.6" data-path="Truffle-Web3.html"><a href="Truffle-Web3.html#prevajanje-in-postavitev-pametne-pogodbe"><i class="fa fa-check"></i><b>13.1.6</b> Prevajanje in postavitev pametne pogodbe</a></li>
<li class="chapter" data-level="13.1.7" data-path="Truffle-Web3.html"><a href="Truffle-Web3.html#testi-enot"><i class="fa fa-check"></i><b>13.1.7</b> Testi enot</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="Truffle-Web3.html"><a href="Truffle-Web3.html#uporabniški-vmesnik"><i class="fa fa-check"></i><b>13.2</b> Uporabniški vmesnik</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="Truffle-Web3.html"><a href="Truffle-Web3.html#priprava-odvisnosti"><i class="fa fa-check"></i><b>13.2.1</b> Priprava odvisnosti</a></li>
<li class="chapter" data-level="13.2.2" data-path="Truffle-Web3.html"><a href="Truffle-Web3.html#spletna-stran"><i class="fa fa-check"></i><b>13.2.2</b> Spletna stran</a></li>
<li class="chapter" data-level="13.2.3" data-path="Truffle-Web3.html"><a href="Truffle-Web3.html#web3-aplikacija-kot-angular-komponenta"><i class="fa fa-check"></i><b>13.2.3</b> Web3 aplikacija kot Angular komponenta</a></li>
<li class="chapter" data-level="13.2.4" data-path="Truffle-Web3.html"><a href="Truffle-Web3.html#opredelitev-izgleda"><i class="fa fa-check"></i><b>13.2.4</b> Opredelitev izgleda</a></li>
<li class="chapter" data-level="13.2.5" data-path="Truffle-Web3.html"><a href="Truffle-Web3.html#povezava-na-verigo-blokov"><i class="fa fa-check"></i><b>13.2.5</b> Povezava na verigo blokov</a></li>
<li class="chapter" data-level="13.2.6" data-path="Truffle-Web3.html"><a href="Truffle-Web3.html#podpora-funkcionalnostim-neregistriranega-volivca"><i class="fa fa-check"></i><b>13.2.6</b> Podpora funkcionalnostim neregistriranega volivca</a></li>
<li class="chapter" data-level="13.2.7" data-path="Truffle-Web3.html"><a href="Truffle-Web3.html#podpora-funkcionalnostim-registriranega-volivca"><i class="fa fa-check"></i><b>13.2.7</b> Podpora funkcionalnostim registriranega volivca</a></li>
<li class="chapter" data-level="13.2.8" data-path="Truffle-Web3.html"><a href="Truffle-Web3.html#podpora-funkcionalnostim-skrbnika"><i class="fa fa-check"></i><b>13.2.8</b> Podpora funkcionalnostim skrbnika</a></li>
<li class="chapter" data-level="13.2.9" data-path="Truffle-Web3.html"><a href="Truffle-Web3.html#obvladovanje-dogodkov-v-okviru-dapp"><i class="fa fa-check"></i><b>13.2.9</b> Obvladovanje dogodkov v okviru DApp</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="Truffle-Web3.html"><a href="Truffle-Web3.html#testiranje-decentralizirane-aplikacije-za-glasovanje"><i class="fa fa-check"></i><b>13.3</b> Testiranje decentralizirane aplikacije za glasovanje</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="Truffle-Web3.html"><a href="Truffle-Web3.html#zagon-osebne-verige-blokov-ganache"><i class="fa fa-check"></i><b>13.3.1</b> Zagon osebne verige blokov Ganache</a></li>
<li class="chapter" data-level="13.3.2" data-path="Truffle-Web3.html"><a href="Truffle-Web3.html#dostop-do-racunov-metamask"><i class="fa fa-check"></i><b>13.3.2</b> Dostop do računov preko MetaMask</a></li>
<li class="chapter" data-level="13.3.3" data-path="Truffle-Web3.html"><a href="Truffle-Web3.html#postavitev-pametne-pogodbe-na-verigo-blokov"><i class="fa fa-check"></i><b>13.3.3</b> Postavitev pametne pogodbe na verigo blokov</a></li>
<li class="chapter" data-level="13.3.4" data-path="Truffle-Web3.html"><a href="Truffle-Web3.html#povezovanje-metamask-z-dapp"><i class="fa fa-check"></i><b>13.3.4</b> Povezovanje MetaMask z DApp</a></li>
<li class="chapter" data-level="13.3.5" data-path="Truffle-Web3.html"><a href="Truffle-Web3.html#faza-registracije-volivcev"><i class="fa fa-check"></i><b>13.3.5</b> Faza registracije volivcev</a></li>
<li class="chapter" data-level="13.3.6" data-path="Truffle-Web3.html"><a href="Truffle-Web3.html#faza-začetka-sprejemanja-predlogov"><i class="fa fa-check"></i><b>13.3.6</b> Faza začetka sprejemanja predlogov</a></li>
<li class="chapter" data-level="13.3.7" data-path="Truffle-Web3.html"><a href="Truffle-Web3.html#faza-konca-sprejemanja-predlogov"><i class="fa fa-check"></i><b>13.3.7</b> Faza konca sprejemanja predlogov</a></li>
<li class="chapter" data-level="13.3.8" data-path="Truffle-Web3.html"><a href="Truffle-Web3.html#faza-začetka-glasovanja"><i class="fa fa-check"></i><b>13.3.8</b> Faza začetka glasovanja</a></li>
<li class="chapter" data-level="13.3.9" data-path="Truffle-Web3.html"><a href="Truffle-Web3.html#faza-konca-glasovanja"><i class="fa fa-check"></i><b>13.3.9</b> Faza konca glasovanja</a></li>
<li class="chapter" data-level="13.3.10" data-path="Truffle-Web3.html"><a href="Truffle-Web3.html#zaključna-faza-preštetih-glasov"><i class="fa fa-check"></i><b>13.3.10</b> Zaključna faza preštetih glasov</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="Truffle-Web3.html"><a href="Truffle-Web3.html#varna-postavitev"><i class="fa fa-check"></i><b>13.4</b> Postavitev pametne pogodbe na zaščiteno verigo blokov</a></li>
<li class="chapter" data-level="13.5" data-path="Truffle-Web3.html"><a href="Truffle-Web3.html#postavitev-pametne-pogodbe-s-pomočjo-metamask"><i class="fa fa-check"></i><b>13.5</b> Postavitev pametne pogodbe s pomočjo MetaMask</a></li>
</ul></li>
<li class="part"><span><b>VI sklop: Dodatne funkcionalnosti</b></span></li>
<li class="chapter" data-level="14" data-path="Varnost-testiranje-PWA.html"><a href="Varnost-testiranje-PWA.html"><i class="fa fa-check"></i><b>14</b> <span class="sklop6 oznaka">P6.1</span> Varnost spletnih aplikacij, testiranje in progresivne spletne aplikacije</a>
<ul>
<li class="chapter" data-level="14.1" data-path="Varnost-testiranje-PWA.html"><a href="Varnost-testiranje-PWA.html#odprtokodni-projekt-varnosti-spletnih-aplikacij-owasp"><i class="fa fa-check"></i><b>14.1</b> Odprtokodni projekt varnosti spletnih aplikacij OWASP</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="Varnost-testiranje-PWA.html"><a href="Varnost-testiranje-PWA.html#uvod-2"><i class="fa fa-check"></i><b>14.1.1</b> Uvod</a></li>
<li class="chapter" data-level="14.1.2" data-path="Varnost-testiranje-PWA.html"><a href="Varnost-testiranje-PWA.html#trend-največjih-varnostnih-tveganj-spletnih-aplikacij"><i class="fa fa-check"></i><b>14.1.2</b> Trend največjih varnostnih tveganj spletnih aplikacij</a></li>
<li class="chapter" data-level="14.1.3" data-path="Varnost-testiranje-PWA.html"><a href="Varnost-testiranje-PWA.html#ovrednotenje-varnostnih-tveganj-aplikacije"><i class="fa fa-check"></i><b>14.1.3</b> Ovrednotenje varnostnih tveganj aplikacije</a></li>
<li class="chapter" data-level="14.1.4" data-path="Varnost-testiranje-PWA.html"><a href="Varnost-testiranje-PWA.html#A1-2021"><i class="fa fa-check"></i><b>14.1.4</b> A1:2021 - Neustrezen nadzor dostopa</a></li>
<li class="chapter" data-level="14.1.5" data-path="Varnost-testiranje-PWA.html"><a href="Varnost-testiranje-PWA.html#A2-2021"><i class="fa fa-check"></i><b>14.1.5</b> A2:2021 - Kriptografske napake</a></li>
<li class="chapter" data-level="14.1.6" data-path="Varnost-testiranje-PWA.html"><a href="Varnost-testiranje-PWA.html#A3-2021"><i class="fa fa-check"></i><b>14.1.6</b> A3:2021 - Vrivanje zlonamerne kode</a></li>
<li class="chapter" data-level="14.1.7" data-path="Varnost-testiranje-PWA.html"><a href="Varnost-testiranje-PWA.html#A4-2021"><i class="fa fa-check"></i><b>14.1.7</b> A4:2021 - Nevaren načrt</a></li>
<li class="chapter" data-level="14.1.8" data-path="Varnost-testiranje-PWA.html"><a href="Varnost-testiranje-PWA.html#A5-2021"><i class="fa fa-check"></i><b>14.1.8</b> A5:2021 - Napačna varnostna konfiguracija</a></li>
<li class="chapter" data-level="14.1.9" data-path="Varnost-testiranje-PWA.html"><a href="Varnost-testiranje-PWA.html#A6-2021"><i class="fa fa-check"></i><b>14.1.9</b> A6:2021 - Ranljive in zastarele komponente</a></li>
<li class="chapter" data-level="14.1.10" data-path="Varnost-testiranje-PWA.html"><a href="Varnost-testiranje-PWA.html#A7-2021"><i class="fa fa-check"></i><b>14.1.10</b> A7:2021 - Napake pri identifikaciji in avtentikaciji</a></li>
<li class="chapter" data-level="14.1.11" data-path="Varnost-testiranje-PWA.html"><a href="Varnost-testiranje-PWA.html#A8-2021"><i class="fa fa-check"></i><b>14.1.11</b> A8:2021 - Napake v programski opremi in integriteti podatkov</a></li>
<li class="chapter" data-level="14.1.12" data-path="Varnost-testiranje-PWA.html"><a href="Varnost-testiranje-PWA.html#A9-2021"><i class="fa fa-check"></i><b>14.1.12</b> A9:2021 - Varnostno beleženje in spremljanje napak</a></li>
<li class="chapter" data-level="14.1.13" data-path="Varnost-testiranje-PWA.html"><a href="Varnost-testiranje-PWA.html#A10-2021"><i class="fa fa-check"></i><b>14.1.13</b> A10:2021 - Ponarejanje zahtev na strani strežnika (SSRF)</a></li>
<li class="chapter" data-level="14.1.14" data-path="Varnost-testiranje-PWA.html"><a href="Varnost-testiranje-PWA.html#priporočila-za-razvijalce"><i class="fa fa-check"></i><b>14.1.14</b> Priporočila za razvijalce</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="Varnost-testiranje-PWA.html"><a href="Varnost-testiranje-PWA.html#osnovni-varnostni-pregled-demo-aplikacije-z-owasp-zap"><i class="fa fa-check"></i><b>14.2</b> Osnovni varnostni pregled Demo aplikacije z OWASP ZAP</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="Varnost-testiranje-PWA.html"><a href="Varnost-testiranje-PWA.html#priprava-demo-aplikacije-v-lokalnem-okolju"><i class="fa fa-check"></i><b>14.2.1</b> Priprava Demo aplikacije v lokalnem okolju</a></li>
<li class="chapter" data-level="14.2.2" data-path="Varnost-testiranje-PWA.html"><a href="Varnost-testiranje-PWA.html#podpora-ssl"><i class="fa fa-check"></i><b>14.2.2</b> Podpora SSL</a></li>
<li class="chapter" data-level="14.2.3" data-path="Varnost-testiranje-PWA.html"><a href="Varnost-testiranje-PWA.html#zagon-aplikacije"><i class="fa fa-check"></i><b>14.2.3</b> Zagon aplikacije</a></li>
<li class="chapter" data-level="14.2.4" data-path="Varnost-testiranje-PWA.html"><a href="Varnost-testiranje-PWA.html#konfiguracija-orodja-owasp-zap"><i class="fa fa-check"></i><b>14.2.4</b> Konfiguracija orodja OWASP ZAP</a></li>
<li class="chapter" data-level="14.2.5" data-path="Varnost-testiranje-PWA.html"><a href="Varnost-testiranje-PWA.html#tezave-http-odgovori"><i class="fa fa-check"></i><b>14.2.5</b> Odprava težav s HTTP odgovori</a></li>
<li class="chapter" data-level="14.2.6" data-path="Varnost-testiranje-PWA.html"><a href="Varnost-testiranje-PWA.html#tezave-z-registracijo-in-prijavo"><i class="fa fa-check"></i><b>14.2.6</b> Odprava težav z registracijo in prijavo</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="Varnost-testiranje-PWA.html"><a href="Varnost-testiranje-PWA.html#osnovni-funkcionalni-testi-aplikacije-demo-s-selenium"><i class="fa fa-check"></i><b>14.3</b> Osnovni funkcionalni testi aplikacije Demo s Selenium</a></li>
<li class="chapter" data-level="14.4" data-path="Varnost-testiranje-PWA.html"><a href="Varnost-testiranje-PWA.html#Progresivne-spletne-aplikacije"><i class="fa fa-check"></i><b>14.4</b> Progresivne spletne aplikacije</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="Varnost-testiranje-PWA.html"><a href="Varnost-testiranje-PWA.html#uvod-3"><i class="fa fa-check"></i><b>14.4.1</b> Uvod</a></li>
<li class="chapter" data-level="14.4.2" data-path="Varnost-testiranje-PWA.html"><a href="Varnost-testiranje-PWA.html#Lighthouse"><i class="fa fa-check"></i><b>14.4.2</b> Pregled obstoječe aplikacije s pomočjo Lighthouse</a></li>
<li class="chapter" data-level="14.4.3" data-path="Varnost-testiranje-PWA.html"><a href="Varnost-testiranje-PWA.html#nadgradnja-angular"><i class="fa fa-check"></i><b>14.4.3</b> Nadgradnja Angular</a></li>
<li class="chapter" data-level="14.4.4" data-path="Varnost-testiranje-PWA.html"><a href="Varnost-testiranje-PWA.html#vključitev-podpore-za-pwa"><i class="fa fa-check"></i><b>14.4.4</b> Vključitev podpore za PWA</a></li>
<li class="chapter" data-level="14.4.5" data-path="Varnost-testiranje-PWA.html"><a href="Varnost-testiranje-PWA.html#Brskanje-brez-povezave"><i class="fa fa-check"></i><b>14.4.5</b> Brskanje brez povezave</a></li>
<li class="chapter" data-level="14.4.6" data-path="Varnost-testiranje-PWA.html"><a href="Varnost-testiranje-PWA.html#končno-testiranje"><i class="fa fa-check"></i><b>14.4.6</b> Končno testiranje</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="literatura.html"><a href="literatura.html"><i class="fa fa-check"></i>Literatura</a></li>
<li class="divider"></li>
<li><a href="https://ucilnica.fri.uni-lj.si/course/view.php?id=74">eUčilnica</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="index.html">Spletno programiranje 2023/2024</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="Truffle-Web3" class="section level1 hasAnchor" number="13">
<h1><span class="header-section-number">Poglavje 13</span> <span class="sklop5 oznaka">P5.2</span> Truffle in Web3<a href="Truffle-Web3.html#Truffle-Web3" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div class="vrstica">
<img src="assets/img/ninja/ninja_03_go_right.png">
<h3>
<span class="sklop5 oznaka">P5.2</span>
</h3>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js"></script>
<script>
  var options_dodaj = {acrossElements: true, element: "dodaj"};
  var options_izbrisi = {acrossElements: true, element: "izbrisi"};
</script>
<p><a href="https://unilj-my.sharepoint.com/:wb:/g/personal/dejanl_fri1_uni-lj_si/EflZnE0VnxBPhuI_Ud5xniAB-sfA4iYKLG2WfJFdp_fB6g?e=X90G2t"><i class="fa-solid fa-chalkboard-user"></i>Sodelovalna <strong>tabla</strong></a>, ki jo bomo uporabljali pred in med predavanji ter je namenjena odložišču za vprašanja in komentarje. Vsi testni primeri, predstavljeni v okviru predavanja <span class="sklop5">P5.2</span>, so na voljo v GitHub repozitoriju <a href="https://github.com/sp-2023-2024/Demo"><i class="fa-brands fa-github"></i>SP-2023-2024/<strong>Demo</strong></a>.</p>
<div id="izdelava-decentralizirane-aplikacije" class="section level2 hasAnchor" number="13.1">
<h2><span class="header-section-number">13.1</span> Izdelava decentralizirane aplikacije<a href="Truffle-Web3.html#izdelava-decentralizirane-aplikacije" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>V nadaljevanju se bomo lotili celostnega razvoja decentralizirane aplikacije, kjer bomo sledili naslednjim korakom:</p>
<ul>
<li>načrt in implementacija <strong>pametne pogodbe za podporo glasovanju</strong> z uporabo različnih funkcionalnosti programskega jezika <a href="https://soliditylang.org/"><i class="fa-brands fa-ethereum"></i><strong>Solidity</strong></a>,</li>
<li>vključitev pametne pogodbe v <a href="https://trufflesuite.com/"><i class="fa-solid fa-laptop-code"></i>ogrodje <strong>Truffle</strong></a> za potrebe integriranega prevajanja, testiranja in nameščanja,</li>
<li>razvoj asinhronega <strong>spletnega <i class="fa-solid fa-desktop"></i>uporabniškega vmesnika</strong>, ki je preko pametne pogodbe povezan z verigo blokov,</li>
<li><i class="fa-solid fa-share-from-square"></i><strong>postavitev pametne pogodbe</strong> na testno omrežje.</li>
</ul>
<div id="opredelitev-zahtev-decentralizirane-aplikacije-za-glasovanje" class="section level3 hasAnchor" number="13.1.1">
<h3><span class="header-section-number">13.1.1</span> Opredelitev zahtev decentralizirane aplikacije za glasovanje<a href="Truffle-Web3.html#opredelitev-zahtev-decentralizirane-aplikacije-za-glasovanje" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Funkcionalnosti aplikacije si lahko zamislimo v razponu od enostavnega glasovanja do izvedbe kompleksnih <a href="https://en.wikipedia.org/wiki/Voting"><i class="fa-brands fa-wikipedia-w"></i>volitev</a>.</p>
<p>Proces glasovanja poteka na manjšem naboru vnaprej določenih možnosti oz. kandidatov ali na večji množici predlogov, ki jih dinamično predlagajo volivci sami. Volilno telo oz. potencialni uporabniki, ki lahko glasujejo, so lahko zgolj izbrani posamezniki ali pa je glasovanje na voljo za vse uporabnike. V zadnjem primeru bo za učinkovito in transparentno vodenje postopka verjetno treba izvesti tudi registracijo.</p>
<p>O rezultatu lahko odloča navadna večina - zmaga predlog, ki dobi največ glasov. Lahko zahtevamo tudi kvalificirano večino oz. <a href="https://en.wikipedia.org/wiki/Quorum"><i class="fa-brands fa-wikipedia-w"></i>kvorum</a>, kjer je predlog sprejet le, če dobi najmanjši vnaprej določen odstotek glasov.</p>
<p>Oddan glas je lahko tajen ali javen. Pri glasovanju lahko podpremo zgolj neposredno oddajo glasu ali tudi posredno preko prenosa na druge posameznike (npr. preko pooblastila).</p>
<p>V okviru naše aplikacije za glasovanje se bomo omejili na naslednje zahteve:</p>
<ul>
<li>glasovanje bo <strong>omejeno na uporabnike Demo aplikacije</strong>, ki bodo uvrščeni <i class="fa-solid fa-list-check"></i><strong>beli seznam</strong> (<em>angl. <a href="https://en.wikipedia.org/wiki/Whitelist"><i class="fa-brands fa-wikipedia-w"></i>Whitelist</a></em>) preko njihovih naslovov <i class="fa-brands fa-ethereum"></i>Ethereum denarnic,</li>
<li>v <strong>procesu <i class="fa-solid fa-person-chalkboard"></i>sprejemanja predlogov</strong> bodo uporabniki najprej lahko oddali predloge za najbolj zanimive lokacije tekočega leta, in sicer iz nabora lokacij kulturnih dediščin v Sloveniji,</li>
<li>v <strong>procesu <i class="fa-solid fa-person-booth"></i>glasovanja</strong> pa bodo lahko za prej predlagane predloge glasovali,</li>
<li><strong>glasovanje</strong> bo <strong>javno</strong>, kjer lahko vsak vidi, kako je kdo glasoval,</li>
<li><i class="fa-solid fa-trophy"></i><strong>zmagovalec se določi z navadno večino</strong>, kjer zmaga predlog, ki dobi največ glasov.</li>
</ul>
<p>Tudi takšna preprosta zasnova decentralizirane aplikacije za glasovanje ima veliko prednosti pred centraliziranim pristopom. DApp namreč decentralizira obdelavo in shranjevanje glasov, kjer je zlonamerno poseganje v proces glasovanja veliko težje, kot če bi takšen postopek podprli s centraliziranim pristopom.</p>
<p>Na sliki <a href="Truffle-Web3.html#fig:slika-Postopek-glasovanja">13.1</a> je prikazan celoten postopek glasovanja.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:slika-Postopek-glasovanja"></span>
<img src="assets/img/Postopek_glasovanja.png" alt="Postopek glasovanja, kjer nekatere korake opravi skrbnik, druge pa volivci." width="500" />
<p class="caption">
Slika 13.1: Postopek glasovanja, kjer nekatere korake opravi skrbnik, druge pa volivci.
</p>
</div>
</div>
<div id="razvojni-načrt" class="section level3 hasAnchor" number="13.1.2">
<h3><span class="header-section-number">13.1.2</span> Razvojni načrt<a href="Truffle-Web3.html#razvojni-načrt" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Preden začnemo z dejanskim razvojem, si poglejmo razvojni načrt, ki ga bomo uporabili pri razvoju in je predstavljen na sliki <a href="Truffle-Web3.html#fig:slika-DApps-razvojni-nacrt">13.2</a>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:slika-DApps-razvojni-nacrt"></span>
<img src="assets/img/DApps_razvojni_nacrt.png" alt="Razvojni načrt DApp z vsemi koraki, od kreiranja projekta, do postavitve na testno omrežje" width="400" />
<p class="caption">
Slika 13.2: Razvojni načrt DApp z vsemi koraki, od kreiranja projekta, do postavitve na testno omrežje
</p>
</div>
</div>
<div id="Truffle-projekt" class="section level3 hasAnchor" number="13.1.3">
<h3><span class="header-section-number">13.1.3</span> Truffle projekt<a href="Truffle-Web3.html#Truffle-projekt" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>V okviru obstoječega projekta Demo najprej kreiramo novo mapo <code>dapp</code>, kjer bomo razvijali našo decentralizirano aplikacijo za glasovanje.</p>
<div class="sourceCode" id="cb804"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb804-1"><a href="Truffle-Web3.html#cb804-1" tabindex="-1"></a><span class="ex">$</span> mkdir dapp</span>
<span id="cb804-2"><a href="Truffle-Web3.html#cb804-2" tabindex="-1"></a><span class="ex">$</span> cd dapp</span></code></pre></div>
<p>Pri razvoju bomo uporabljali <a href="https://trufflesuite.com/"><i class="fa-solid fa-earth-europe"></i><strong>Truffle Suite</strong></a>, ki ga namestimo s pomočjo naslednjega ukaza.</p>
<div class="sourceCode" id="cb805"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb805-1"><a href="Truffle-Web3.html#cb805-1" tabindex="-1"></a><span class="ex">$</span> npm install <span class="at">-g</span> truffle</span></code></pre></div>
<p>Nato lahko preverimo ali je bila namestitev uspešna in katera verzija je nameščena.</p>
<div class="sourceCode" id="cb806"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb806-1"><a href="Truffle-Web3.html#cb806-1" tabindex="-1"></a><span class="ex">$</span> truffle <span class="at">--version</span></span>
<span id="cb806-2"><a href="Truffle-Web3.html#cb806-2" tabindex="-1"></a></span>
<span id="cb806-3"><a href="Truffle-Web3.html#cb806-3" tabindex="-1"></a><span class="ex">Truffle</span> v5.11.5 <span class="er">(</span><span class="ex">core:</span> 5.11.5<span class="kw">)</span></span>
<span id="cb806-4"><a href="Truffle-Web3.html#cb806-4" tabindex="-1"></a><span class="ex">Ganache</span> v7.9.1</span>
<span id="cb806-5"><a href="Truffle-Web3.html#cb806-5" tabindex="-1"></a><span class="ex">Solidity</span> v0.5.16 <span class="er">(</span><span class="ex">solc-js</span><span class="kw">)</span></span>
<span id="cb806-6"><a href="Truffle-Web3.html#cb806-6" tabindex="-1"></a><span class="ex">Node</span> v18.17.1</span>
<span id="cb806-7"><a href="Truffle-Web3.html#cb806-7" tabindex="-1"></a><span class="ex">Web3.js</span> v1.10.0</span></code></pre></div>
<blockquote>
<p><strong>Opomba</strong>: Za razvojno okolje Visual Studio Code (VSC) je na voljo tudi dodatek <a href="https://trufflesuite.com/blog/build-on-web3-with-truffle-vs-code-extension/"><i class="fa-solid fa-laptop-code"></i><strong>Truffle for VS Code</strong></a>, ki predstavlja neposredno integracijo ogrodja Truffle v razvojno okolje.</p>
</blockquote>
<p>Nato v naši prazni mapi <code>dapp</code> inicializiramo Truffle projekt.</p>
<div class="sourceCode" id="cb807"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb807-1"><a href="Truffle-Web3.html#cb807-1" tabindex="-1"></a><span class="ex">$</span> truffle init</span>
<span id="cb807-2"><a href="Truffle-Web3.html#cb807-2" tabindex="-1"></a></span>
<span id="cb807-3"><a href="Truffle-Web3.html#cb807-3" tabindex="-1"></a><span class="ex">Starting</span> init...</span>
<span id="cb807-4"><a href="Truffle-Web3.html#cb807-4" tabindex="-1"></a><span class="ex">================</span></span>
<span id="cb807-5"><a href="Truffle-Web3.html#cb807-5" tabindex="-1"></a></span>
<span id="cb807-6"><a href="Truffle-Web3.html#cb807-6" tabindex="-1"></a><span class="op">&gt;</span> Copying <span class="ex">project</span> files to /Demo/dapp</span>
<span id="cb807-7"><a href="Truffle-Web3.html#cb807-7" tabindex="-1"></a></span>
<span id="cb807-8"><a href="Truffle-Web3.html#cb807-8" tabindex="-1"></a><span class="ex">Init</span> successful, sweet!</span>
<span id="cb807-9"><a href="Truffle-Web3.html#cb807-9" tabindex="-1"></a></span>
<span id="cb807-10"><a href="Truffle-Web3.html#cb807-10" tabindex="-1"></a><span class="ex">Try</span> our scaffold commands to get started:</span>
<span id="cb807-11"><a href="Truffle-Web3.html#cb807-11" tabindex="-1"></a>  <span class="ex">$</span> truffle create contract YourContractName <span class="co"># scaffold a contract</span></span>
<span id="cb807-12"><a href="Truffle-Web3.html#cb807-12" tabindex="-1"></a>  <span class="ex">$</span> truffle create test YourTestName         <span class="co"># scaffold a test</span></span>
<span id="cb807-13"><a href="Truffle-Web3.html#cb807-13" tabindex="-1"></a></span>
<span id="cb807-14"><a href="Truffle-Web3.html#cb807-14" tabindex="-1"></a><span class="ex">http://trufflesuite.com/docs</span></span></code></pre></div>
<p>Postopek inicializacije je kreiral nekaj novih map in začetno datoteko, ki so podrobneje predstavljene v nadaljevanju.</p>
<ul style="list-style-type: none;">
<li>
<i class="fa-regular fa-folder-open"></i> <b>dapp</b>
<ul style="list-style-type: none;">
<li>
<dodaj><i class="fa-regular fa-folder-open"></i> <b>contracts</b></dodaj>
← Mapa s Solidity pametnimi pogodbami, ki jih želimo prevesti in postaviti na verigo blokov.
</li>
<li>
<dodaj><i class="fa-regular fa-folder-open"></i> <b>migrations</b></dodaj>
← Mapa s konfiguracijskimi datotekami za izvajanje migracije na verigo blokov.
</li>
<li>
<dodaj><i class="fa-regular fa-folder-open"></i> <b>test</b></dodaj>
← Mapa s testi enot (napisani v jeziku Solidity ali JavaScript).
</li>
<li>
<dodaj><i class="fa-brands fa-js"></i> truffle-config.js</dodaj>
← Konfiguracijska datoteka projekta Truffle.
</li>
</ul>
</li>
</ul>
<script>
  $(document).ready(function() {
    $("#Truffle-projekt code:eq(0)").markRegExp(/.+/, options_dodaj);
    $("#Truffle-projekt code.bash:eq(0)").markRegExp(/(mkdir|cd).*/, options_dodaj);
    $("#Truffle-projekt code.bash:eq(1)").markRegExp(/npm.*/, options_dodaj);
    $("#Truffle-projekt code.bash:eq(2)").markRegExp(/truffle --version/, options_dodaj);
    $("#Truffle-projekt code.bash:eq(3)").markRegExp(/truffle init/, options_dodaj);
  });
</script>
</div>
<div id="razvoj-pametne-pogodbe" class="section level3 hasAnchor" number="13.1.4">
<h3><span class="header-section-number">13.1.4</span> Razvoj pametne pogodbe<a href="Truffle-Web3.html#razvoj-pametne-pogodbe" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="načrtovanje-entitet" class="section level4 hasAnchor" number="13.1.4.1">
<h4><span class="header-section-number">13.1.4.1</span> Načrtovanje entitet<a href="Truffle-Web3.html#načrtovanje-entitet" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Najpomembnejše entitete, ki sodelujejo pri glasovanju, so: <strong>predlog</strong> (<code>Proposal</code>), <strong>volivec</strong> (<code>Voter</code>) in <strong>postopek glasovanja</strong> (<code>WorkflowStatus</code>).</p>
<p>Registriran volivec lahko najprej posreduje predlog za glasovanje, ki se samodejno doda na seznam obstoječih predlogov, kar poteka med procesom sprejemanja predlogov.</p>
<p>Podatkovni tip <code>Proposal</code> mora tako vključevati opis (<code>description</code>) in število glasov (<code>voteCount</code>), kjer bo shranjeno število prejetih glasov (v kasnejši fazi glasovanja). Predlagatelja ne bomo shranili, saj mogoče želi ostati anonimen. Prav tako omogočamo oddajo več predlogov s strani istega predlagatelja.</p>
<p>Kreirali bomo novo pametno pogodbo <code>SimpleVoting.sol</code>, kjer najprej opredelimo <strong>licenčne pogoje</strong> naše izvorne kode (<code>MIT</code>) in <strong>verzijo jezika Solidity</strong> (<code>^0.8.23</code>), v katerem je pogodba napisana, ter <strong>pametno pogodbo</strong> <code>SimpleVoting</code> in <strong>entiteto</strong> <code>Proposal</code>.</p>
<p><code>dapp/contracts/SimpleVoting.sol</code></p>
<div class="sourceCode" id="cb808"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb808-1"><a href="Truffle-Web3.html#cb808-1" tabindex="-1"></a><span class="co">// </span><span class="an">SPDX-License-Identifier:</span><span class="co"> MIT</span></span>
<span id="cb808-2"><a href="Truffle-Web3.html#cb808-2" tabindex="-1"></a>pragma solidity <span class="op">^</span><span class="fl">0.8.23</span><span class="op">;</span></span>
<span id="cb808-3"><a href="Truffle-Web3.html#cb808-3" tabindex="-1"></a></span>
<span id="cb808-4"><a href="Truffle-Web3.html#cb808-4" tabindex="-1"></a>contract SimpleVoting {</span>
<span id="cb808-5"><a href="Truffle-Web3.html#cb808-5" tabindex="-1"></a>  struct Proposal {</span>
<span id="cb808-6"><a href="Truffle-Web3.html#cb808-6" tabindex="-1"></a>    string description<span class="op">;</span></span>
<span id="cb808-7"><a href="Truffle-Web3.html#cb808-7" tabindex="-1"></a>    uint256 voteCount<span class="op">;</span></span>
<span id="cb808-8"><a href="Truffle-Web3.html#cb808-8" tabindex="-1"></a>  }</span>
<span id="cb808-9"><a href="Truffle-Web3.html#cb808-9" tabindex="-1"></a>}</span></code></pre></div>
<blockquote>
<p><strong>Opomba</strong>: Pametne pogodbe v jeziku Solidity so zelo podobne razredom v OO programskih jezikih in jih opredelimo s konstruktom <a href="https://docs.soliditylang.org/en/v0.8.23/contracts.html"><i class="fa-brands fa-ethereum"></i><code>contract</code></a>, medtem ko entitete opredelimo s pomočjo <a href="https://docs.soliditylang.org/en/v0.8.23/types.html#structs"><i class="fa-brands fa-ethereum"></i><code>struct</code></a>. Na voljo imamo številne enostavne podatkovne tipe (npr. <a href="https://docs.soliditylang.org/en/latest/types.html#string-literals-and-types"><i class="fa-brands fa-ethereum"></i><code>string</code></a>, <a href="https://docs.soliditylang.org/en/latest/types.html#integers"><i class="fa-brands fa-ethereum"></i><code>uint256</code></a> idr.).</p>
</blockquote>
<p>O volivcu bomo hranili naslednje podatke:</p>
<ul>
<li>ali <strong>je registriran</strong> (glasovanje dovolimo zgolj tistim uporabnikom, ki so na seznamu dovoljenih),</li>
<li>ali <strong>je že glasoval</strong> (da onemogočimo dvojno glasovanje) in</li>
<li><strong>za kateri predlog je glasoval</strong> (v primeru, da je oddal glas).</li>
</ul>
<p><code>dapp/contracts/SimpleVoting.sol</code></p>
<div class="sourceCode" id="cb809"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb809-1"><a href="Truffle-Web3.html#cb809-1" tabindex="-1"></a>contract SimpleVoting {</span>
<span id="cb809-2"><a href="Truffle-Web3.html#cb809-2" tabindex="-1"></a>  <span class="op">...</span></span>
<span id="cb809-3"><a href="Truffle-Web3.html#cb809-3" tabindex="-1"></a>  struct Voter {</span>
<span id="cb809-4"><a href="Truffle-Web3.html#cb809-4" tabindex="-1"></a>    bool isRegistered<span class="op">;</span></span>
<span id="cb809-5"><a href="Truffle-Web3.html#cb809-5" tabindex="-1"></a>    bool hasVoted<span class="op">;</span></span>
<span id="cb809-6"><a href="Truffle-Web3.html#cb809-6" tabindex="-1"></a>    uint256 votedProposalId<span class="op">;</span></span>
<span id="cb809-7"><a href="Truffle-Web3.html#cb809-7" tabindex="-1"></a>  }</span>
<span id="cb809-8"><a href="Truffle-Web3.html#cb809-8" tabindex="-1"></a>}</span></code></pre></div>
<p>Na podlagi postopka glasovanja, prikazanega na sliki <a href="Truffle-Web3.html#fig:slika-Postopek-glasovanja">13.1</a>, lahko opredelimo tudi zalogo vrednosti postopka glasovanja s pomočjo gradnika <a href="https://docs.soliditylang.org/en/v0.8.23/types.html#enums"><i class="fa-brands fa-ethereum"></i>enum</a>.</p>
<p><code>dapp/contracts/SimpleVoting.sol</code></p>
<div class="sourceCode" id="cb810"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb810-1"><a href="Truffle-Web3.html#cb810-1" tabindex="-1"></a>contract SimpleVoting {</span>
<span id="cb810-2"><a href="Truffle-Web3.html#cb810-2" tabindex="-1"></a>  <span class="op">...</span></span>
<span id="cb810-3"><a href="Truffle-Web3.html#cb810-3" tabindex="-1"></a>  <span class="kw">enum</span> WorkflowStatus {</span>
<span id="cb810-4"><a href="Truffle-Web3.html#cb810-4" tabindex="-1"></a>    RegisteringVoters<span class="op">,</span></span>
<span id="cb810-5"><a href="Truffle-Web3.html#cb810-5" tabindex="-1"></a>    ProposalsRegistrationStarted<span class="op">,</span></span>
<span id="cb810-6"><a href="Truffle-Web3.html#cb810-6" tabindex="-1"></a>    ProposalRegistrationEnded<span class="op">,</span></span>
<span id="cb810-7"><a href="Truffle-Web3.html#cb810-7" tabindex="-1"></a>    VotingSessionStarted<span class="op">,</span></span>
<span id="cb810-8"><a href="Truffle-Web3.html#cb810-8" tabindex="-1"></a>    VotingSessionEnded<span class="op">,</span></span>
<span id="cb810-9"><a href="Truffle-Web3.html#cb810-9" tabindex="-1"></a>    VotesTallied</span>
<span id="cb810-10"><a href="Truffle-Web3.html#cb810-10" tabindex="-1"></a>  }</span>
<span id="cb810-11"><a href="Truffle-Web3.html#cb810-11" tabindex="-1"></a>}</span></code></pre></div>
<script>
  $(document).ready(function() {
  $("#načrtovanje-entitet code:eq(11)").markRegExp(/SimpleVoting\.sol/, options_dodaj);
    $("#načrtovanje-entitet code.javascript:eq(0)").markRegExp(/.+/, options_dodaj);
    $("#načrtovanje-entitet code.javascript:eq(1)").markRegExp(/\s+?struct Voter[\s\S]+?}/, options_dodaj);
    $("#načrtovanje-entitet code.javascript:eq(2)").markRegExp(/\s+?enum[\s\S]+?}/, options_dodaj);
  });
</script>
</div>
<div id="stanje-pametne-pogodbe" class="section level4 hasAnchor" number="13.1.4.2">
<h4><span class="header-section-number">13.1.4.2</span> Stanje pametne pogodbe<a href="Truffle-Web3.html#stanje-pametne-pogodbe" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Pri večini pametnih pogodb dodelimo tudi skrbniško vlogo Ethereum naslovu, ki je odgovoren za transakcijo postavitve. V našem primeru bo ta lastnik računa hkrati postal tudi skrbnik glasovanja.</p>
<p><code>dapp/contracts/SimpleVoting.sol</code></p>
<div class="sourceCode" id="cb811"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb811-1"><a href="Truffle-Web3.html#cb811-1" tabindex="-1"></a>contract SimpleVoting {</span>
<span id="cb811-2"><a href="Truffle-Web3.html#cb811-2" tabindex="-1"></a>  <span class="op">...</span></span>
<span id="cb811-3"><a href="Truffle-Web3.html#cb811-3" tabindex="-1"></a>  address <span class="kw">public</span> administrator<span class="op">;</span></span>
<span id="cb811-4"><a href="Truffle-Web3.html#cb811-4" tabindex="-1"></a>}</span></code></pre></div>
<p>V okviru glasovanja potekata dva osrednja postopka:</p>
<ul>
<li><strong>proces sprejemanja predlogov</strong>, kjer lahko vsak registriran volivec posreduje predloge za glasovanje in</li>
<li><strong>proces glasovanja</strong>, ki se začne takoj zatem.</li>
</ul>
<p>Za začetek in konec posameznega procesa je odgovoren skrbnik glasovanja, in sicer na podlagi dogovorjenega časa začetka in konca.</p>
<p>V okviru pametne pogodbe bomo zato hranili status glasovanja v obliki spremenljivke stanja.</p>
<p><code>dapp/contracts/SimpleVoting.sol</code></p>
<div class="sourceCode" id="cb812"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb812-1"><a href="Truffle-Web3.html#cb812-1" tabindex="-1"></a>contract SimpleVoting {</span>
<span id="cb812-2"><a href="Truffle-Web3.html#cb812-2" tabindex="-1"></a>  <span class="op">...</span></span>
<span id="cb812-3"><a href="Truffle-Web3.html#cb812-3" tabindex="-1"></a>  address <span class="kw">public</span> administrator<span class="op">;</span></span>
<span id="cb812-4"><a href="Truffle-Web3.html#cb812-4" tabindex="-1"></a>  WorkflowStatus <span class="kw">public</span> workflowStatus<span class="op">;</span></span>
<span id="cb812-5"><a href="Truffle-Web3.html#cb812-5" tabindex="-1"></a>}</span></code></pre></div>
<p>Najbolj pomembni stanji pametne pogodbe sta povezani z <strong>volivci</strong> (<code>voters</code>) in s <strong>predlogi za glasovanje</strong> (<code>proposals</code>). Pri volivcih uporabljamo preslikavo naslova volivca (njegov enolični identifikator) v objekt <code>Voter</code>. Vsi predlogi glasovanja pa so shranjeni v obliki tabele tipa <code>Proposal</code>, kjer je enolični identifikator predloga enak indeksu elementa tabele.</p>
<p><code>dapp/contracts/SimpleVoting.sol</code></p>
<div class="sourceCode" id="cb813"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb813-1"><a href="Truffle-Web3.html#cb813-1" tabindex="-1"></a>contract SimpleVoting {</span>
<span id="cb813-2"><a href="Truffle-Web3.html#cb813-2" tabindex="-1"></a>  <span class="op">...</span></span>
<span id="cb813-3"><a href="Truffle-Web3.html#cb813-3" tabindex="-1"></a>  address <span class="kw">public</span> administrator<span class="op">;</span></span>
<span id="cb813-4"><a href="Truffle-Web3.html#cb813-4" tabindex="-1"></a>  WorkflowStatus <span class="kw">public</span> workflowStatus<span class="op">;</span></span>
<span id="cb813-5"><a href="Truffle-Web3.html#cb813-5" tabindex="-1"></a>  <span class="fu">mapping</span>(address <span class="kw">=&gt;</span> Voter) <span class="kw">public</span> voters<span class="op">;</span></span>
<span id="cb813-6"><a href="Truffle-Web3.html#cb813-6" tabindex="-1"></a>  Proposal[] <span class="kw">public</span> proposals<span class="op">;</span></span>
<span id="cb813-7"><a href="Truffle-Web3.html#cb813-7" tabindex="-1"></a>}</span></code></pre></div>
<p>Ko bo glasovanje zaključeno in glasovi prešteti, moramo shraniti tudi enolični identifikator zmagovalnega predloga.</p>
<p><code>dapp/contracts/SimpleVoting.sol</code></p>
<div class="sourceCode" id="cb814"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb814-1"><a href="Truffle-Web3.html#cb814-1" tabindex="-1"></a>contract SimpleVoting {</span>
<span id="cb814-2"><a href="Truffle-Web3.html#cb814-2" tabindex="-1"></a>  <span class="op">...</span></span>
<span id="cb814-3"><a href="Truffle-Web3.html#cb814-3" tabindex="-1"></a>  <span class="fu">mapping</span>(address <span class="kw">=&gt;</span> Voter) <span class="kw">public</span> voters<span class="op">;</span></span>
<span id="cb814-4"><a href="Truffle-Web3.html#cb814-4" tabindex="-1"></a>  Proposal[] <span class="kw">public</span> proposals<span class="op">;</span></span>
<span id="cb814-5"><a href="Truffle-Web3.html#cb814-5" tabindex="-1"></a>  uint <span class="kw">private</span> winningProposalId<span class="op">;</span></span>
<span id="cb814-6"><a href="Truffle-Web3.html#cb814-6" tabindex="-1"></a>}</span></code></pre></div>
<script>
  $(document).ready(function() {
    $("#stanje-pametne-pogodbe code.javascript:eq(0)").markRegExp(/\s+?addres.+/, options_dodaj);
    $("#stanje-pametne-pogodbe code.javascript:eq(1)").markRegExp(/\s+?WorkflowStatus.+/, options_dodaj);
    $("#stanje-pametne-pogodbe code.javascript:eq(2)").markRegExp(/.+?(mapping|\[\]).+/, options_dodaj);
    $("#stanje-pametne-pogodbe code.javascript:eq(3)").markRegExp(/\s+?uint.+/, options_dodaj);
  });
</script>
</div>
<div id="funkcijski-modifikatorji" class="section level4 hasAnchor" number="13.1.4.3">
<h4><span class="header-section-number">13.1.4.3</span> Funkcijski modifikatorji<a href="Truffle-Web3.html#funkcijski-modifikatorji" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Za določitev identitete klicatelja funkcij in statusa glasovanja potrebujemo spremenljivke stanja. V okviru razvoja pametnih pogodb z jezikom Solidity so nam na voljo <a href="https://docs.soliditylang.org/en/v0.8.23/contracts.html#function-modifiers"><i class="fa-brands fa-ethereum"></i>funkcijski modifikatorji</a>, ki preverijo pogoje, ki morajo biti izpolnjeni ob klicu funkcije.</p>
<p>Najprej bomo pripravili funkcijski modifikator <code>onlyAdministrator</code> za preverjanje pogoja ali je <strong>klicatelj funkcije skrbnik pametne pogodbe</strong> ter funkcijski modifikator <code>onlyRegisteredVoter</code> za preverjanje pogoja ali je <strong>klicatelj funkcije registriran volivec pametne pogodbe</strong>.</p>
<p><code>dapp/contracts/SimpleVoting.sol</code></p>
<div class="sourceCode" id="cb815"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb815-1"><a href="Truffle-Web3.html#cb815-1" tabindex="-1"></a>contract SimpleVoting {</span>
<span id="cb815-2"><a href="Truffle-Web3.html#cb815-2" tabindex="-1"></a>  <span class="op">...</span></span>
<span id="cb815-3"><a href="Truffle-Web3.html#cb815-3" tabindex="-1"></a>  modifier <span class="fu">onlyAdministrator</span>() {</span>
<span id="cb815-4"><a href="Truffle-Web3.html#cb815-4" tabindex="-1"></a>    <span class="pp">require</span>(</span>
<span id="cb815-5"><a href="Truffle-Web3.html#cb815-5" tabindex="-1"></a>      msg<span class="op">.</span><span class="at">sender</span> <span class="op">==</span> administrator<span class="op">,</span></span>
<span id="cb815-6"><a href="Truffle-Web3.html#cb815-6" tabindex="-1"></a>      <span class="st">&quot;the caller must be the administrator&quot;</span></span>
<span id="cb815-7"><a href="Truffle-Web3.html#cb815-7" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb815-8"><a href="Truffle-Web3.html#cb815-8" tabindex="-1"></a>    _<span class="op">;</span></span>
<span id="cb815-9"><a href="Truffle-Web3.html#cb815-9" tabindex="-1"></a>  }</span>
<span id="cb815-10"><a href="Truffle-Web3.html#cb815-10" tabindex="-1"></a>  modifier <span class="fu">onlyRegisteredVoter</span>() {</span>
<span id="cb815-11"><a href="Truffle-Web3.html#cb815-11" tabindex="-1"></a>    <span class="pp">require</span>(</span>
<span id="cb815-12"><a href="Truffle-Web3.html#cb815-12" tabindex="-1"></a>      voters[msg<span class="op">.</span><span class="at">sender</span>]<span class="op">.</span><span class="at">isRegistered</span><span class="op">,</span></span>
<span id="cb815-13"><a href="Truffle-Web3.html#cb815-13" tabindex="-1"></a>      <span class="st">&quot;the caller must be a registered voter&quot;</span></span>
<span id="cb815-14"><a href="Truffle-Web3.html#cb815-14" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb815-15"><a href="Truffle-Web3.html#cb815-15" tabindex="-1"></a>    _<span class="op">;</span></span>
<span id="cb815-16"><a href="Truffle-Web3.html#cb815-16" tabindex="-1"></a>  }</span>
<span id="cb815-17"><a href="Truffle-Web3.html#cb815-17" tabindex="-1"></a>}</span></code></pre></div>
<blockquote>
<p><strong>Opomba</strong>: Ukaz <a href="https://www.educative.io/answers/what-is-in-solidity"><i class="fa-solid fa-earth-europe"></i><code>_;</code></a> določa mesto, kjer neposredno dovolimo izvajanje funkcije, pri kateri se je funkcijski modifikator zahteval.</p>
</blockquote>
<p>Podobno lahko pripravimo funkcijska modifikatorja za preverjanje statusa glasovanja, in sicer če je <strong>aktiven proces registracije volivcev</strong> ali <strong>posredovanje predlogov za glasovanje</strong>.</p>
<p><code>app_dapp/contracts/Glasovanje.sol</code></p>
<div class="sourceCode" id="cb816"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb816-1"><a href="Truffle-Web3.html#cb816-1" tabindex="-1"></a>contract SimpleVoting {</span>
<span id="cb816-2"><a href="Truffle-Web3.html#cb816-2" tabindex="-1"></a>  <span class="op">...</span></span>
<span id="cb816-3"><a href="Truffle-Web3.html#cb816-3" tabindex="-1"></a>  modifier <span class="fu">onlyDuringVotersRegistration</span>() {</span>
<span id="cb816-4"><a href="Truffle-Web3.html#cb816-4" tabindex="-1"></a>    <span class="pp">require</span>(</span>
<span id="cb816-5"><a href="Truffle-Web3.html#cb816-5" tabindex="-1"></a>      workflowStatus <span class="op">==</span> WorkflowStatus<span class="op">.</span><span class="at">RegisteringVoters</span><span class="op">,</span></span>
<span id="cb816-6"><a href="Truffle-Web3.html#cb816-6" tabindex="-1"></a>      <span class="st">&quot;only before preposals registration has started&quot;</span></span>
<span id="cb816-7"><a href="Truffle-Web3.html#cb816-7" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb816-8"><a href="Truffle-Web3.html#cb816-8" tabindex="-1"></a>    _<span class="op">;</span></span>
<span id="cb816-9"><a href="Truffle-Web3.html#cb816-9" tabindex="-1"></a>  }</span>
<span id="cb816-10"><a href="Truffle-Web3.html#cb816-10" tabindex="-1"></a>  modifier <span class="fu">onlyDuringProposalsRegistration</span>() {</span>
<span id="cb816-11"><a href="Truffle-Web3.html#cb816-11" tabindex="-1"></a>    <span class="pp">require</span>(</span>
<span id="cb816-12"><a href="Truffle-Web3.html#cb816-12" tabindex="-1"></a>      workflowStatus <span class="op">==</span> WorkflowStatus<span class="op">.</span><span class="at">ProposalsRegistrationStarted</span><span class="op">,</span></span>
<span id="cb816-13"><a href="Truffle-Web3.html#cb816-13" tabindex="-1"></a>      <span class="st">&quot;only during proposals registration&quot;</span></span>
<span id="cb816-14"><a href="Truffle-Web3.html#cb816-14" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb816-15"><a href="Truffle-Web3.html#cb816-15" tabindex="-1"></a>    _<span class="op">;</span></span>
<span id="cb816-16"><a href="Truffle-Web3.html#cb816-16" tabindex="-1"></a>  }</span>
<span id="cb816-17"><a href="Truffle-Web3.html#cb816-17" tabindex="-1"></a>}</span></code></pre></div>
<p>Na isti način pripravimo še preostale funkcijske modifikatorje <code>onlyAfterProposalRegistration</code>, <code>onlyDuringVoting</code>, <code>onlyAfterVoting</code> in <code>onlyAfterVotesTallied</code>, ki jih bomo potrebovali v nadaljevanju.</p>
<p><code>app_dapp/contracts/Glasovanje.sol</code></p>
<div class="sourceCode" id="cb817"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb817-1"><a href="Truffle-Web3.html#cb817-1" tabindex="-1"></a>contract SimpleVoting {</span>
<span id="cb817-2"><a href="Truffle-Web3.html#cb817-2" tabindex="-1"></a>  <span class="op">...</span></span>
<span id="cb817-3"><a href="Truffle-Web3.html#cb817-3" tabindex="-1"></a>  modifier <span class="fu">onlyAfterProposalRegistration</span>() {</span>
<span id="cb817-4"><a href="Truffle-Web3.html#cb817-4" tabindex="-1"></a>    <span class="pp">require</span>(</span>
<span id="cb817-5"><a href="Truffle-Web3.html#cb817-5" tabindex="-1"></a>      workflowStatus <span class="op">==</span> WorkflowStatus<span class="op">.</span><span class="at">ProposalRegistrationEnded</span><span class="op">,</span></span>
<span id="cb817-6"><a href="Truffle-Web3.html#cb817-6" tabindex="-1"></a>      <span class="st">&quot;only after proposals registration has ended&quot;</span></span>
<span id="cb817-7"><a href="Truffle-Web3.html#cb817-7" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb817-8"><a href="Truffle-Web3.html#cb817-8" tabindex="-1"></a>    _<span class="op">;</span></span>
<span id="cb817-9"><a href="Truffle-Web3.html#cb817-9" tabindex="-1"></a>  }</span>
<span id="cb817-10"><a href="Truffle-Web3.html#cb817-10" tabindex="-1"></a>  modifier <span class="fu">onlyDuringVoting</span>() {</span>
<span id="cb817-11"><a href="Truffle-Web3.html#cb817-11" tabindex="-1"></a>    <span class="pp">require</span>(</span>
<span id="cb817-12"><a href="Truffle-Web3.html#cb817-12" tabindex="-1"></a>      workflowStatus <span class="op">==</span> WorkflowStatus<span class="op">.</span><span class="at">VotingSessionStarted</span><span class="op">,</span></span>
<span id="cb817-13"><a href="Truffle-Web3.html#cb817-13" tabindex="-1"></a>      <span class="st">&quot;only during voting&quot;</span></span>
<span id="cb817-14"><a href="Truffle-Web3.html#cb817-14" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb817-15"><a href="Truffle-Web3.html#cb817-15" tabindex="-1"></a>    _<span class="op">;</span></span>
<span id="cb817-16"><a href="Truffle-Web3.html#cb817-16" tabindex="-1"></a>  }</span>
<span id="cb817-17"><a href="Truffle-Web3.html#cb817-17" tabindex="-1"></a>  modifier <span class="fu">onlyAfterVoting</span>() {</span>
<span id="cb817-18"><a href="Truffle-Web3.html#cb817-18" tabindex="-1"></a>    <span class="pp">require</span>(</span>
<span id="cb817-19"><a href="Truffle-Web3.html#cb817-19" tabindex="-1"></a>      workflowStatus <span class="op">==</span> WorkflowStatus<span class="op">.</span><span class="at">VotingSessionEnded</span><span class="op">,</span></span>
<span id="cb817-20"><a href="Truffle-Web3.html#cb817-20" tabindex="-1"></a>      <span class="st">&quot;only after voting has ended&quot;</span></span>
<span id="cb817-21"><a href="Truffle-Web3.html#cb817-21" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb817-22"><a href="Truffle-Web3.html#cb817-22" tabindex="-1"></a>    _<span class="op">;</span></span>
<span id="cb817-23"><a href="Truffle-Web3.html#cb817-23" tabindex="-1"></a>  }</span>
<span id="cb817-24"><a href="Truffle-Web3.html#cb817-24" tabindex="-1"></a>  modifier <span class="fu">onlyAfterVotesTallied</span>() {</span>
<span id="cb817-25"><a href="Truffle-Web3.html#cb817-25" tabindex="-1"></a>    <span class="pp">require</span>(</span>
<span id="cb817-26"><a href="Truffle-Web3.html#cb817-26" tabindex="-1"></a>      workflowStatus <span class="op">==</span> WorkflowStatus<span class="op">.</span><span class="at">VotesTallied</span><span class="op">,</span></span>
<span id="cb817-27"><a href="Truffle-Web3.html#cb817-27" tabindex="-1"></a>      <span class="st">&quot;only after votes have been tallied&quot;</span></span>
<span id="cb817-28"><a href="Truffle-Web3.html#cb817-28" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb817-29"><a href="Truffle-Web3.html#cb817-29" tabindex="-1"></a>    _<span class="op">;</span></span>
<span id="cb817-30"><a href="Truffle-Web3.html#cb817-30" tabindex="-1"></a>  }</span>
<span id="cb817-31"><a href="Truffle-Web3.html#cb817-31" tabindex="-1"></a>}</span></code></pre></div>
<script>
  $(document).ready(function() {
    $("#funkcijski-modifikatorji code.javascript:eq(0)").markRegExp(/\s+?modifier[\s\S]+?}/, options_dodaj);
    $("#funkcijski-modifikatorji code.javascript:eq(1)").markRegExp(/\s+?modifier[\s\S]+?}/, options_dodaj);
    $("#funkcijski-modifikatorji code.javascript:eq(2)").markRegExp(/\s+?modifier[\s\S]+?}/, options_dodaj);
  });
</script>
</div>
<div id="dogodki" class="section level4 hasAnchor" number="13.1.4.4">
<h4><span class="header-section-number">13.1.4.4</span> Dogodki<a href="Truffle-Web3.html#dogodki" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Ker pri operacijah na verigi blokov lahko traja dlje časa od trenutka zahteve do dejanske izvedbe, je z vidika uporabniške izkušnje <strong>koristno, da uporabnika obvestimo ob zaključku operacije</strong>. V našem primeru bo zato pametna pogodba za podporo glasovanju ob zaključku vsake operacije objavila <a href="https://docs.soliditylang.org/en/v0.8.23/contracts.html#events"><i class="fa-brands fa-ethereum"></i>dogodek</a>, ki bo spremenil stanje pogodbe. To se bo zgodilo tudi ob vsaki spremembi statusa glasovanja, predvsem zato, da se lahko temu samodejno prilagodi uporabniški vmesnik.</p>
<p>Za potrebe obveščanja bomo opredelili naslednje dogodke:</p>
<p><code>dapp/contracts/SimpleVoting.sol</code></p>
<div class="sourceCode" id="cb818"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb818-1"><a href="Truffle-Web3.html#cb818-1" tabindex="-1"></a>contract SimpleVoting {</span>
<span id="cb818-2"><a href="Truffle-Web3.html#cb818-2" tabindex="-1"></a>  <span class="op">...</span></span>
<span id="cb818-3"><a href="Truffle-Web3.html#cb818-3" tabindex="-1"></a>  <span class="bu">event</span> <span class="fu">VoterRegisteredEvent</span>(address voterAddress)<span class="op">;</span></span>
<span id="cb818-4"><a href="Truffle-Web3.html#cb818-4" tabindex="-1"></a>  <span class="bu">event</span> <span class="fu">ProposalsRegistrationStartedEvent</span>()<span class="op">;</span></span>
<span id="cb818-5"><a href="Truffle-Web3.html#cb818-5" tabindex="-1"></a>  <span class="bu">event</span> <span class="fu">ProposalsRegistrationEndedEvent</span>()<span class="op">;</span></span>
<span id="cb818-6"><a href="Truffle-Web3.html#cb818-6" tabindex="-1"></a>  <span class="bu">event</span> <span class="fu">ProposalRegisteredEvent</span>(uint256 proposalId)<span class="op">;</span></span>
<span id="cb818-7"><a href="Truffle-Web3.html#cb818-7" tabindex="-1"></a>  <span class="bu">event</span> <span class="fu">VotingSessionStartedEvent</span>()<span class="op">;</span></span>
<span id="cb818-8"><a href="Truffle-Web3.html#cb818-8" tabindex="-1"></a>  <span class="bu">event</span> <span class="fu">VotingSessionEndedEvent</span>()<span class="op">;</span></span>
<span id="cb818-9"><a href="Truffle-Web3.html#cb818-9" tabindex="-1"></a>  <span class="bu">event</span> <span class="fu">VotedEvent</span>(address voter<span class="op">,</span> uint256 proposalId)<span class="op">;</span></span>
<span id="cb818-10"><a href="Truffle-Web3.html#cb818-10" tabindex="-1"></a>  <span class="bu">event</span> <span class="fu">VotesTalliedEvent</span>()<span class="op">;</span></span>
<span id="cb818-11"><a href="Truffle-Web3.html#cb818-11" tabindex="-1"></a>  <span class="bu">event</span> <span class="fu">WorkflowStatusChangeEvent</span>(</span>
<span id="cb818-12"><a href="Truffle-Web3.html#cb818-12" tabindex="-1"></a>    WorkflowStatus previousStatus<span class="op">,</span></span>
<span id="cb818-13"><a href="Truffle-Web3.html#cb818-13" tabindex="-1"></a>    WorkflowStatus newStatus</span>
<span id="cb818-14"><a href="Truffle-Web3.html#cb818-14" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb818-15"><a href="Truffle-Web3.html#cb818-15" tabindex="-1"></a>}</span></code></pre></div>
<script>
  $(document).ready(function() {
    $("#dogodki code.javascript:eq(0)").markRegExp(/\s+?event[\s\S]+?\);/, options_dodaj);
  });
</script>
</div>
<div id="konstruktor-1" class="section level4 hasAnchor" number="13.1.4.5">
<h4><span class="header-section-number">13.1.4.5</span> Konstruktor<a href="Truffle-Web3.html#konstruktor-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>V <a href="https://docs.soliditylang.org/en/v0.8.23/contracts.html#constructors"><i class="fa-brands fa-ethereum"></i>konstruktorju</a>, ob kreiranju pametne pogodbe, je treba identificirati pošiljatelja postavitvene transakcije in ga nastaviti za <strong>skrbnika glasovanja</strong> ter hkrati poskrbeti za <strong>inicializacijo začetnega statusa glasovanja</strong>.</p>
<p><code>dapp/contracts/SimpleVoting.sol</code></p>
<div class="sourceCode" id="cb819"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb819-1"><a href="Truffle-Web3.html#cb819-1" tabindex="-1"></a>contract SimpleVoting {</span>
<span id="cb819-2"><a href="Truffle-Web3.html#cb819-2" tabindex="-1"></a>  <span class="op">...</span></span>
<span id="cb819-3"><a href="Truffle-Web3.html#cb819-3" tabindex="-1"></a>  <span class="fu">constructor</span>() {</span>
<span id="cb819-4"><a href="Truffle-Web3.html#cb819-4" tabindex="-1"></a>    administrator <span class="op">=</span> msg<span class="op">.</span><span class="at">sender</span><span class="op">;</span></span>
<span id="cb819-5"><a href="Truffle-Web3.html#cb819-5" tabindex="-1"></a>    workflowStatus <span class="op">=</span> WorkflowStatus<span class="op">.</span><span class="at">RegisteringVoters</span><span class="op">;</span></span>
<span id="cb819-6"><a href="Truffle-Web3.html#cb819-6" tabindex="-1"></a>  }</span>
<span id="cb819-7"><a href="Truffle-Web3.html#cb819-7" tabindex="-1"></a>}</span></code></pre></div>
<script>
  $(document).ready(function() {
    $("#konstruktor-1 code.javascript:eq(0)").markRegExp(/\s+?constructor[\s\S]+?}/, options_dodaj);
  });
</script>
</div>
<div id="funkcije-1" class="section level4 hasAnchor" number="13.1.4.6">
<h4><span class="header-section-number">13.1.4.6</span> Funkcije<a href="Truffle-Web3.html#funkcije-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Če sledimo postopku glasovanja na sliki <a href="Truffle-Web3.html#fig:slika-Postopek-glasovanja">13.1</a>, mora <strong>skrbnik najprej registrirati volivca</strong>, zato bomo pripravili ustrezno <a href="https://docs.soliditylang.org/en/v0.8.23/contracts.html#functions"><i class="fa-brands fa-ethereum"></i>funkcijo</a>.</p>
<p><code>dapp/contracts/SimpleVoting.sol</code></p>
<div class="sourceCode" id="cb820"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb820-1"><a href="Truffle-Web3.html#cb820-1" tabindex="-1"></a>contract SimpleVoting {</span>
<span id="cb820-2"><a href="Truffle-Web3.html#cb820-2" tabindex="-1"></a>  <span class="op">...</span></span>
<span id="cb820-3"><a href="Truffle-Web3.html#cb820-3" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">registerVoter</span>(address _voterAddress)</span>
<span id="cb820-4"><a href="Truffle-Web3.html#cb820-4" tabindex="-1"></a>    <span class="kw">public</span></span>
<span id="cb820-5"><a href="Truffle-Web3.html#cb820-5" tabindex="-1"></a>    onlyAdministrator</span>
<span id="cb820-6"><a href="Truffle-Web3.html#cb820-6" tabindex="-1"></a>    onlyDuringVotersRegistration</span>
<span id="cb820-7"><a href="Truffle-Web3.html#cb820-7" tabindex="-1"></a>  {</span>
<span id="cb820-8"><a href="Truffle-Web3.html#cb820-8" tabindex="-1"></a>    <span class="pp">require</span>(<span class="op">!</span>voters[_voterAddress]<span class="op">.</span><span class="at">isRegistered</span><span class="op">,</span> <span class="st">&quot;voter is already registered&quot;</span>)<span class="op">;</span></span>
<span id="cb820-9"><a href="Truffle-Web3.html#cb820-9" tabindex="-1"></a>    voters[_voterAddress]<span class="op">.</span><span class="at">isRegistered</span> <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb820-10"><a href="Truffle-Web3.html#cb820-10" tabindex="-1"></a>    voters[_voterAddress]<span class="op">.</span><span class="at">hasVoted</span> <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb820-11"><a href="Truffle-Web3.html#cb820-11" tabindex="-1"></a>    voters[_voterAddress]<span class="op">.</span><span class="at">votedProposalId</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb820-12"><a href="Truffle-Web3.html#cb820-12" tabindex="-1"></a>    emit <span class="fu">VoterRegisteredEvent</span>(_voterAddress)<span class="op">;</span></span>
<span id="cb820-13"><a href="Truffle-Web3.html#cb820-13" tabindex="-1"></a>  }</span>
<span id="cb820-14"><a href="Truffle-Web3.html#cb820-14" tabindex="-1"></a>}</span></code></pre></div>
<p>Skrbnik mora prav tako <strong>začeti</strong> in <strong>končati</strong> <strong>sprejemanje predlogov</strong>.</p>
<p><code>dapp/contracts/SimpleVoting.sol</code></p>
<div class="sourceCode" id="cb821"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb821-1"><a href="Truffle-Web3.html#cb821-1" tabindex="-1"></a>contract SimpleVoting {</span>
<span id="cb821-2"><a href="Truffle-Web3.html#cb821-2" tabindex="-1"></a>  <span class="op">...</span></span>
<span id="cb821-3"><a href="Truffle-Web3.html#cb821-3" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">startProposalsRegistration</span>()</span>
<span id="cb821-4"><a href="Truffle-Web3.html#cb821-4" tabindex="-1"></a>    <span class="kw">public</span></span>
<span id="cb821-5"><a href="Truffle-Web3.html#cb821-5" tabindex="-1"></a>    onlyAdministrator</span>
<span id="cb821-6"><a href="Truffle-Web3.html#cb821-6" tabindex="-1"></a>    onlyDuringVotersRegistration</span>
<span id="cb821-7"><a href="Truffle-Web3.html#cb821-7" tabindex="-1"></a>  {</span>
<span id="cb821-8"><a href="Truffle-Web3.html#cb821-8" tabindex="-1"></a>    workflowStatus <span class="op">=</span> WorkflowStatus<span class="op">.</span><span class="at">ProposalsRegistrationStarted</span><span class="op">;</span></span>
<span id="cb821-9"><a href="Truffle-Web3.html#cb821-9" tabindex="-1"></a>    emit <span class="fu">ProposalsRegistrationStartedEvent</span>()<span class="op">;</span></span>
<span id="cb821-10"><a href="Truffle-Web3.html#cb821-10" tabindex="-1"></a>    emit <span class="fu">WorkflowStatusChangeEvent</span>(</span>
<span id="cb821-11"><a href="Truffle-Web3.html#cb821-11" tabindex="-1"></a>      WorkflowStatus<span class="op">.</span><span class="at">RegisteringVoters</span><span class="op">,</span></span>
<span id="cb821-12"><a href="Truffle-Web3.html#cb821-12" tabindex="-1"></a>      workflowStatus</span>
<span id="cb821-13"><a href="Truffle-Web3.html#cb821-13" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb821-14"><a href="Truffle-Web3.html#cb821-14" tabindex="-1"></a>  }</span>
<span id="cb821-15"><a href="Truffle-Web3.html#cb821-15" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">endProposalsRegistration</span>()</span>
<span id="cb821-16"><a href="Truffle-Web3.html#cb821-16" tabindex="-1"></a>    <span class="kw">public</span></span>
<span id="cb821-17"><a href="Truffle-Web3.html#cb821-17" tabindex="-1"></a>    onlyAdministrator</span>
<span id="cb821-18"><a href="Truffle-Web3.html#cb821-18" tabindex="-1"></a>    onlyDuringProposalsRegistration</span>
<span id="cb821-19"><a href="Truffle-Web3.html#cb821-19" tabindex="-1"></a>  {</span>
<span id="cb821-20"><a href="Truffle-Web3.html#cb821-20" tabindex="-1"></a>    workflowStatus <span class="op">=</span> WorkflowStatus<span class="op">.</span><span class="at">ProposalRegistrationEnded</span><span class="op">;</span></span>
<span id="cb821-21"><a href="Truffle-Web3.html#cb821-21" tabindex="-1"></a>    emit <span class="fu">ProposalsRegistrationEndedEvent</span>()<span class="op">;</span></span>
<span id="cb821-22"><a href="Truffle-Web3.html#cb821-22" tabindex="-1"></a>    emit <span class="fu">WorkflowStatusChangeEvent</span>(</span>
<span id="cb821-23"><a href="Truffle-Web3.html#cb821-23" tabindex="-1"></a>      WorkflowStatus<span class="op">.</span><span class="at">ProposalsRegistrationStarted</span><span class="op">,</span></span>
<span id="cb821-24"><a href="Truffle-Web3.html#cb821-24" tabindex="-1"></a>      workflowStatus</span>
<span id="cb821-25"><a href="Truffle-Web3.html#cb821-25" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb821-26"><a href="Truffle-Web3.html#cb821-26" tabindex="-1"></a>  }</span>
<span id="cb821-27"><a href="Truffle-Web3.html#cb821-27" tabindex="-1"></a>}</span></code></pre></div>
<p>Podobno velja tudi za <strong>začetek</strong> in <strong>konec procesa glasovanja</strong>.</p>
<p><code>dapp/contracts/SimpleVoting.sol</code></p>
<div class="sourceCode" id="cb822"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb822-1"><a href="Truffle-Web3.html#cb822-1" tabindex="-1"></a>contract SimpleVoting {</span>
<span id="cb822-2"><a href="Truffle-Web3.html#cb822-2" tabindex="-1"></a>  <span class="op">...</span></span>
<span id="cb822-3"><a href="Truffle-Web3.html#cb822-3" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">startVoteSession</span>()</span>
<span id="cb822-4"><a href="Truffle-Web3.html#cb822-4" tabindex="-1"></a>    <span class="kw">public</span></span>
<span id="cb822-5"><a href="Truffle-Web3.html#cb822-5" tabindex="-1"></a>    onlyAdministrator</span>
<span id="cb822-6"><a href="Truffle-Web3.html#cb822-6" tabindex="-1"></a>    onlyAfterProposalRegistration</span>
<span id="cb822-7"><a href="Truffle-Web3.html#cb822-7" tabindex="-1"></a>  {</span>
<span id="cb822-8"><a href="Truffle-Web3.html#cb822-8" tabindex="-1"></a>    workflowStatus <span class="op">=</span> WorkflowStatus<span class="op">.</span><span class="at">VotingSessionStarted</span><span class="op">;</span></span>
<span id="cb822-9"><a href="Truffle-Web3.html#cb822-9" tabindex="-1"></a>    emit <span class="fu">VotingSessionStartedEvent</span>()<span class="op">;</span></span>
<span id="cb822-10"><a href="Truffle-Web3.html#cb822-10" tabindex="-1"></a>    emit <span class="fu">WorkflowStatusChangeEvent</span>(</span>
<span id="cb822-11"><a href="Truffle-Web3.html#cb822-11" tabindex="-1"></a>      WorkflowStatus<span class="op">.</span><span class="at">ProposalRegistrationEnded</span><span class="op">,</span></span>
<span id="cb822-12"><a href="Truffle-Web3.html#cb822-12" tabindex="-1"></a>      workflowStatus</span>
<span id="cb822-13"><a href="Truffle-Web3.html#cb822-13" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb822-14"><a href="Truffle-Web3.html#cb822-14" tabindex="-1"></a>  }</span>
<span id="cb822-15"><a href="Truffle-Web3.html#cb822-15" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">endVoteSession</span>() </span>
<span id="cb822-16"><a href="Truffle-Web3.html#cb822-16" tabindex="-1"></a>    <span class="kw">public</span> </span>
<span id="cb822-17"><a href="Truffle-Web3.html#cb822-17" tabindex="-1"></a>    onlyAdministrator </span>
<span id="cb822-18"><a href="Truffle-Web3.html#cb822-18" tabindex="-1"></a>    onlyDuringVoting </span>
<span id="cb822-19"><a href="Truffle-Web3.html#cb822-19" tabindex="-1"></a>  {</span>
<span id="cb822-20"><a href="Truffle-Web3.html#cb822-20" tabindex="-1"></a>    workflowStatus <span class="op">=</span> WorkflowStatus<span class="op">.</span><span class="at">VotingSessionEnded</span><span class="op">;</span></span>
<span id="cb822-21"><a href="Truffle-Web3.html#cb822-21" tabindex="-1"></a>    emit <span class="fu">VotingSessionEndedEvent</span>()<span class="op">;</span></span>
<span id="cb822-22"><a href="Truffle-Web3.html#cb822-22" tabindex="-1"></a>    emit <span class="fu">WorkflowStatusChangeEvent</span>(</span>
<span id="cb822-23"><a href="Truffle-Web3.html#cb822-23" tabindex="-1"></a>      WorkflowStatus<span class="op">.</span><span class="at">VotingSessionStarted</span><span class="op">,</span></span>
<span id="cb822-24"><a href="Truffle-Web3.html#cb822-24" tabindex="-1"></a>      workflowStatus</span>
<span id="cb822-25"><a href="Truffle-Web3.html#cb822-25" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb822-26"><a href="Truffle-Web3.html#cb822-26" tabindex="-1"></a>  }</span>
<span id="cb822-27"><a href="Truffle-Web3.html#cb822-27" tabindex="-1"></a>}</span></code></pre></div>
<p>Opazimo lahko, da smo koristno uporabili funkcijske modifikatorje, ki smo jih opredelili v poglavju <a href="Truffle-Web3.html#funkcijski-modifikatorji">13.1.4.3</a>. S takšnim načinom razvoja smo zmanjšali kompleksnost funkcij s kontrolo dostopa zgolj v eni vrstici in z dodanimi nekaj objavami dogodkov.</p>
<p>Medtem ko je aktivno sprejemanje predlogov, lahko <strong>registrirani volivci posredujejo predloge glasovanja</strong>. Najprej preverimo, če je volivec registriran in smo med procesom posredovanja predlogov, nato kreiramo nov predlog za glasovanje in ga dodamo v tabelo predlogov.</p>
<p><code>dapp/contracts/SimpleVoting.sol</code></p>
<div class="sourceCode" id="cb823"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb823-1"><a href="Truffle-Web3.html#cb823-1" tabindex="-1"></a>contract SimpleVoting {</span>
<span id="cb823-2"><a href="Truffle-Web3.html#cb823-2" tabindex="-1"></a>  <span class="op">...</span></span>
<span id="cb823-3"><a href="Truffle-Web3.html#cb823-3" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">registerProposal</span>(string memory proposalDescription)</span>
<span id="cb823-4"><a href="Truffle-Web3.html#cb823-4" tabindex="-1"></a>    <span class="kw">public</span></span>
<span id="cb823-5"><a href="Truffle-Web3.html#cb823-5" tabindex="-1"></a>    onlyRegisteredVoter</span>
<span id="cb823-6"><a href="Truffle-Web3.html#cb823-6" tabindex="-1"></a>    onlyDuringProposalsRegistration</span>
<span id="cb823-7"><a href="Truffle-Web3.html#cb823-7" tabindex="-1"></a>  {</span>
<span id="cb823-8"><a href="Truffle-Web3.html#cb823-8" tabindex="-1"></a>    proposals<span class="op">.</span><span class="fu">push</span>(<span class="fu">Proposal</span>({</span>
<span id="cb823-9"><a href="Truffle-Web3.html#cb823-9" tabindex="-1"></a>      <span class="dt">description</span><span class="op">:</span> proposalDescription<span class="op">,</span> </span>
<span id="cb823-10"><a href="Truffle-Web3.html#cb823-10" tabindex="-1"></a>      <span class="dt">voteCount</span><span class="op">:</span> <span class="dv">0</span></span>
<span id="cb823-11"><a href="Truffle-Web3.html#cb823-11" tabindex="-1"></a>    }))<span class="op">;</span></span>
<span id="cb823-12"><a href="Truffle-Web3.html#cb823-12" tabindex="-1"></a>    emit <span class="fu">ProposalRegisteredEvent</span>(proposals<span class="op">.</span><span class="at">length</span> <span class="op">-</span> <span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb823-13"><a href="Truffle-Web3.html#cb823-13" tabindex="-1"></a>  }</span>
<span id="cb823-14"><a href="Truffle-Web3.html#cb823-14" tabindex="-1"></a>}</span></code></pre></div>
<blockquote>
<p><strong>Opomba</strong>: Pri parametru <code>proposalDescription</code> smo z referenco <a href="https://docs.soliditylang.org/en/v0.8.23/types.html#data-location"><i class="fa-brands fa-ethereum"></i><code>memory</code></a> opredelili, da vrednost ni trajno shranjena, ampak je prisotna zgolj v spominu.</p>
</blockquote>
<p>Ko se glasovanje začne, lahko <strong>registriran volivec odda svoj glas</strong>, kjer preko funkcijskih modifikatorjev najprej preverimo ali gre za upravičenca do glasovanja in ali smo v procesu glasovanja. Nato preverimo ali je volivec mogoče že glasoval, v nasprotnem primeru glasovanje dovolimo in označimo, da je volivec glasoval, ter shranimo njegov glas in povečamo število oddanih glasov za izbrani predlog.</p>
<p><code>dapp/contracts/SimpleVoting.sol</code></p>
<div class="sourceCode" id="cb824"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb824-1"><a href="Truffle-Web3.html#cb824-1" tabindex="-1"></a>contract SimpleVoting {</span>
<span id="cb824-2"><a href="Truffle-Web3.html#cb824-2" tabindex="-1"></a>  <span class="op">...</span></span>
<span id="cb824-3"><a href="Truffle-Web3.html#cb824-3" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">vote</span>(uint256 proposalId)</span>
<span id="cb824-4"><a href="Truffle-Web3.html#cb824-4" tabindex="-1"></a>    <span class="kw">public</span></span>
<span id="cb824-5"><a href="Truffle-Web3.html#cb824-5" tabindex="-1"></a>    onlyRegisteredVoter</span>
<span id="cb824-6"><a href="Truffle-Web3.html#cb824-6" tabindex="-1"></a>    onlyDuringVoting</span>
<span id="cb824-7"><a href="Truffle-Web3.html#cb824-7" tabindex="-1"></a>  {</span>
<span id="cb824-8"><a href="Truffle-Web3.html#cb824-8" tabindex="-1"></a>    <span class="pp">require</span>(<span class="op">!</span>voters[msg<span class="op">.</span><span class="at">sender</span>]<span class="op">.</span><span class="at">hasVoted</span><span class="op">,</span> <span class="st">&quot;the caller has already voted&quot;</span>)<span class="op">;</span></span>
<span id="cb824-9"><a href="Truffle-Web3.html#cb824-9" tabindex="-1"></a>    <span class="pp">require</span>(proposalId <span class="op">&lt;</span> proposals<span class="op">.</span><span class="at">length</span><span class="op">,</span> <span class="st">&quot;the proposal id is out of range&quot;</span>)<span class="op">;</span></span>
<span id="cb824-10"><a href="Truffle-Web3.html#cb824-10" tabindex="-1"></a>    voters[msg<span class="op">.</span><span class="at">sender</span>]<span class="op">.</span><span class="at">hasVoted</span> <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb824-11"><a href="Truffle-Web3.html#cb824-11" tabindex="-1"></a>    voters[msg<span class="op">.</span><span class="at">sender</span>]<span class="op">.</span><span class="at">votedProposalId</span> <span class="op">=</span> proposalId<span class="op">;</span></span>
<span id="cb824-12"><a href="Truffle-Web3.html#cb824-12" tabindex="-1"></a>    proposals[proposalId]<span class="op">.</span><span class="at">voteCount</span><span class="op">++;</span></span>
<span id="cb824-13"><a href="Truffle-Web3.html#cb824-13" tabindex="-1"></a>    emit <span class="fu">VotedEvent</span>(msg<span class="op">.</span><span class="at">sender</span><span class="op">,</span> proposalId)<span class="op">;</span></span>
<span id="cb824-14"><a href="Truffle-Web3.html#cb824-14" tabindex="-1"></a>  }</span>
<span id="cb824-15"><a href="Truffle-Web3.html#cb824-15" tabindex="-1"></a>}</span></code></pre></div>
<blockquote>
<p><strong>Opomba</strong>: Omrežje Ethereum nima težav s sočasnim dostopom, saj rudar v okviru svojega EVM okolja vse transakcije znotraj bloka obdela zaporedno.</p>
</blockquote>
<p>Ko skrbnik zaključi glasovanje, lahko s pomočjo funkcije <code>tallyVotes</code> <strong>pregleda vse glasove</strong> in <strong>določi zmagovalni predlog</strong> tako, da nastavi spremenljivko stanja pametne pogodbe. Na koncu poskrbi za proženje dogodkov, ki ponazarjata zaključek štetja glasov in spremembo statusa glasovanja v zaključno fazo.</p>
<p><code>dapp/contracts/SimpleVoting.sol</code></p>
<div class="sourceCode" id="cb825"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb825-1"><a href="Truffle-Web3.html#cb825-1" tabindex="-1"></a>contract SimpleVoting {</span>
<span id="cb825-2"><a href="Truffle-Web3.html#cb825-2" tabindex="-1"></a>  <span class="op">...</span></span>
<span id="cb825-3"><a href="Truffle-Web3.html#cb825-3" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">tallyVotes</span>() <span class="kw">public</span> onlyAdministrator onlyAfterVoting {</span>
<span id="cb825-4"><a href="Truffle-Web3.html#cb825-4" tabindex="-1"></a>    uint256 winningVoteCount <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb825-5"><a href="Truffle-Web3.html#cb825-5" tabindex="-1"></a>    uint256 winningProposalIndex <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb825-6"><a href="Truffle-Web3.html#cb825-6" tabindex="-1"></a>    <span class="cf">for</span> (uint256 i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> proposals<span class="op">.</span><span class="at">length</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb825-7"><a href="Truffle-Web3.html#cb825-7" tabindex="-1"></a>      <span class="cf">if</span> (proposals[i]<span class="op">.</span><span class="at">voteCount</span> <span class="op">&gt;</span> winningVoteCount) {</span>
<span id="cb825-8"><a href="Truffle-Web3.html#cb825-8" tabindex="-1"></a>        winningVoteCount <span class="op">=</span> proposals[i]<span class="op">.</span><span class="at">voteCount</span><span class="op">;</span></span>
<span id="cb825-9"><a href="Truffle-Web3.html#cb825-9" tabindex="-1"></a>        winningProposalIndex <span class="op">=</span> i<span class="op">;</span></span>
<span id="cb825-10"><a href="Truffle-Web3.html#cb825-10" tabindex="-1"></a>      }</span>
<span id="cb825-11"><a href="Truffle-Web3.html#cb825-11" tabindex="-1"></a>    }</span>
<span id="cb825-12"><a href="Truffle-Web3.html#cb825-12" tabindex="-1"></a>    winningProposalId <span class="op">=</span> winningProposalIndex<span class="op">;</span></span>
<span id="cb825-13"><a href="Truffle-Web3.html#cb825-13" tabindex="-1"></a>    workflowStatus <span class="op">=</span> WorkflowStatus<span class="op">.</span><span class="at">VotesTallied</span><span class="op">;</span></span>
<span id="cb825-14"><a href="Truffle-Web3.html#cb825-14" tabindex="-1"></a>    emit <span class="fu">VotesTalliedEvent</span>()<span class="op">;</span></span>
<span id="cb825-15"><a href="Truffle-Web3.html#cb825-15" tabindex="-1"></a>    emit <span class="fu">WorkflowStatusChangeEvent</span>(</span>
<span id="cb825-16"><a href="Truffle-Web3.html#cb825-16" tabindex="-1"></a>      WorkflowStatus<span class="op">.</span><span class="at">VotingSessionEnded</span><span class="op">,</span></span>
<span id="cb825-17"><a href="Truffle-Web3.html#cb825-17" tabindex="-1"></a>      workflowStatus</span>
<span id="cb825-18"><a href="Truffle-Web3.html#cb825-18" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb825-19"><a href="Truffle-Web3.html#cb825-19" tabindex="-1"></a>  }</span>
<span id="cb825-20"><a href="Truffle-Web3.html#cb825-20" tabindex="-1"></a>}</span></code></pre></div>
<p>Za dostop do podatkov pametne pogodbe je pogosto smiselno pripraviti nabor <strong>pogledov</strong> oz. <strong>funkcij, ki so namenjene zgolj branju</strong> in vračajo izbrane podatke trenutnega stanja pametne pogodbe.</p>
<p>Takšne poglede lahko uporabimo na uporabniškem vmesniku, npr. med registracijo predlogov in po njej lahko preverimo <strong>število predlogov</strong> in <strong>njihove opise</strong>.</p>
<p><code>dapp/contracts/SimpleVoting.sol</code></p>
<div class="sourceCode" id="cb826"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb826-1"><a href="Truffle-Web3.html#cb826-1" tabindex="-1"></a>contract SimpleVoting {</span>
<span id="cb826-2"><a href="Truffle-Web3.html#cb826-2" tabindex="-1"></a>  <span class="op">...</span></span>
<span id="cb826-3"><a href="Truffle-Web3.html#cb826-3" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">getProposalsNumber</span>() <span class="kw">public</span> view <span class="fu">returns</span> (uint256) {</span>
<span id="cb826-4"><a href="Truffle-Web3.html#cb826-4" tabindex="-1"></a>    <span class="cf">return</span> proposals<span class="op">.</span><span class="at">length</span><span class="op">;</span></span>
<span id="cb826-5"><a href="Truffle-Web3.html#cb826-5" tabindex="-1"></a>  }</span>
<span id="cb826-6"><a href="Truffle-Web3.html#cb826-6" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">getProposalDescription</span>(uint256 index)</span>
<span id="cb826-7"><a href="Truffle-Web3.html#cb826-7" tabindex="-1"></a>    <span class="kw">public</span></span>
<span id="cb826-8"><a href="Truffle-Web3.html#cb826-8" tabindex="-1"></a>    view</span>
<span id="cb826-9"><a href="Truffle-Web3.html#cb826-9" tabindex="-1"></a>    <span class="fu">returns</span> (string memory)</span>
<span id="cb826-10"><a href="Truffle-Web3.html#cb826-10" tabindex="-1"></a>  {</span>
<span id="cb826-11"><a href="Truffle-Web3.html#cb826-11" tabindex="-1"></a>    <span class="cf">return</span> proposals[index]<span class="op">.</span><span class="at">description</span><span class="op">;</span></span>
<span id="cb826-12"><a href="Truffle-Web3.html#cb826-12" tabindex="-1"></a>  }</span>
<span id="cb826-13"><a href="Truffle-Web3.html#cb826-13" tabindex="-1"></a>}</span></code></pre></div>
<p>Ko so glasovi prešteti, lahko pripravimo <strong>funkcije</strong>, s pomočjo katerih dostopamo do <strong>rezultatov glasovanja</strong>, in sicer enoličnega identifikatorja zmagovalnega predloga, njegovega opisa in števila glasov.</p>
<p><code>dapp/contracts/SimpleVoting.sol</code></p>
<div class="sourceCode" id="cb827"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb827-1"><a href="Truffle-Web3.html#cb827-1" tabindex="-1"></a>contract SimpleVoting {</span>
<span id="cb827-2"><a href="Truffle-Web3.html#cb827-2" tabindex="-1"></a>  <span class="op">...</span></span>
<span id="cb827-3"><a href="Truffle-Web3.html#cb827-3" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">getWinningProposalId</span>()</span>
<span id="cb827-4"><a href="Truffle-Web3.html#cb827-4" tabindex="-1"></a>    <span class="kw">public</span></span>
<span id="cb827-5"><a href="Truffle-Web3.html#cb827-5" tabindex="-1"></a>    view</span>
<span id="cb827-6"><a href="Truffle-Web3.html#cb827-6" tabindex="-1"></a>    onlyAfterVotesTallied</span>
<span id="cb827-7"><a href="Truffle-Web3.html#cb827-7" tabindex="-1"></a>    <span class="fu">returns</span> (uint256)</span>
<span id="cb827-8"><a href="Truffle-Web3.html#cb827-8" tabindex="-1"></a>  {</span>
<span id="cb827-9"><a href="Truffle-Web3.html#cb827-9" tabindex="-1"></a>    <span class="cf">return</span> winningProposalId<span class="op">;</span></span>
<span id="cb827-10"><a href="Truffle-Web3.html#cb827-10" tabindex="-1"></a>  }</span>
<span id="cb827-11"><a href="Truffle-Web3.html#cb827-11" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">getWinningProposalDescription</span>()</span>
<span id="cb827-12"><a href="Truffle-Web3.html#cb827-12" tabindex="-1"></a>    <span class="kw">public</span></span>
<span id="cb827-13"><a href="Truffle-Web3.html#cb827-13" tabindex="-1"></a>    view</span>
<span id="cb827-14"><a href="Truffle-Web3.html#cb827-14" tabindex="-1"></a>    onlyAfterVotesTallied</span>
<span id="cb827-15"><a href="Truffle-Web3.html#cb827-15" tabindex="-1"></a>    <span class="fu">returns</span> (string memory)</span>
<span id="cb827-16"><a href="Truffle-Web3.html#cb827-16" tabindex="-1"></a>  {</span>
<span id="cb827-17"><a href="Truffle-Web3.html#cb827-17" tabindex="-1"></a>    <span class="cf">return</span> proposals[winningProposalId]<span class="op">.</span><span class="at">description</span><span class="op">;</span></span>
<span id="cb827-18"><a href="Truffle-Web3.html#cb827-18" tabindex="-1"></a>  }</span>
<span id="cb827-19"><a href="Truffle-Web3.html#cb827-19" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">getWinningProposalVoteCounts</span>()</span>
<span id="cb827-20"><a href="Truffle-Web3.html#cb827-20" tabindex="-1"></a>    <span class="kw">public</span></span>
<span id="cb827-21"><a href="Truffle-Web3.html#cb827-21" tabindex="-1"></a>    view</span>
<span id="cb827-22"><a href="Truffle-Web3.html#cb827-22" tabindex="-1"></a>    onlyAfterVotesTallied</span>
<span id="cb827-23"><a href="Truffle-Web3.html#cb827-23" tabindex="-1"></a>    <span class="fu">returns</span> (uint256)</span>
<span id="cb827-24"><a href="Truffle-Web3.html#cb827-24" tabindex="-1"></a>  {</span>
<span id="cb827-25"><a href="Truffle-Web3.html#cb827-25" tabindex="-1"></a>    <span class="cf">return</span> proposals[winningProposalId]<span class="op">.</span><span class="at">voteCount</span><span class="op">;</span></span>
<span id="cb827-26"><a href="Truffle-Web3.html#cb827-26" tabindex="-1"></a>  }</span>
<span id="cb827-27"><a href="Truffle-Web3.html#cb827-27" tabindex="-1"></a>}</span></code></pre></div>
<p>Glede na zahteve naše decentralizirane aplikacije za glasovanje, ki smo jih opredelili v poglavju <a href="Truffle-Web3.html#opredelitev-zahtev-decentralizirane-aplikacije-za-glasovanje">13.1.1</a>, lahko do <strong>rezultata glasovanja</strong> dostopa kdorkoli, ne samo skrbnik ali volivci, zato pri tej funkciji ne bomo dodali funkcijskih modifikatorjev, povezanih s preverjanjem vlog.</p>
<p>Prav tako nam bodo pri razvoju spletne aplikacije prišle prav funkcije, ki preverjajo ali podani Ethereum <strong>naslov pripada skrbniku</strong> ali <strong>registriranemu volivcu</strong>.</p>
<p><code>dapp/contracts/SimpleVoting.sol</code></p>
<div class="sourceCode" id="cb828"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb828-1"><a href="Truffle-Web3.html#cb828-1" tabindex="-1"></a>contract SimpleVoting {</span>
<span id="cb828-2"><a href="Truffle-Web3.html#cb828-2" tabindex="-1"></a>  <span class="op">...</span></span>
<span id="cb828-3"><a href="Truffle-Web3.html#cb828-3" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">isRegisteredVoter</span>(address _voterAddress) <span class="kw">public</span> view <span class="fu">returns</span> (bool) {</span>
<span id="cb828-4"><a href="Truffle-Web3.html#cb828-4" tabindex="-1"></a>    <span class="cf">return</span> voters[_voterAddress]<span class="op">.</span><span class="at">isRegistered</span><span class="op">;</span></span>
<span id="cb828-5"><a href="Truffle-Web3.html#cb828-5" tabindex="-1"></a>  }</span>
<span id="cb828-6"><a href="Truffle-Web3.html#cb828-6" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">isAdministrator</span>(address _address) <span class="kw">public</span> view <span class="fu">returns</span> (bool) {</span>
<span id="cb828-7"><a href="Truffle-Web3.html#cb828-7" tabindex="-1"></a>    <span class="cf">return</span> _address <span class="op">==</span> administrator<span class="op">;</span></span>
<span id="cb828-8"><a href="Truffle-Web3.html#cb828-8" tabindex="-1"></a>  }</span>
<span id="cb828-9"><a href="Truffle-Web3.html#cb828-9" tabindex="-1"></a>}</span></code></pre></div>
<p>Potrebovali bomo tudi funkcijo, ki vrača <strong>trenutni status glasovanja</strong>.</p>
<p><code>dapp/contracts/SimpleVoting.sol</code></p>
<div class="sourceCode" id="cb829"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb829-1"><a href="Truffle-Web3.html#cb829-1" tabindex="-1"></a>contract SimpleVoting {</span>
<span id="cb829-2"><a href="Truffle-Web3.html#cb829-2" tabindex="-1"></a>  <span class="op">...</span></span>
<span id="cb829-3"><a href="Truffle-Web3.html#cb829-3" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">getWorkflowStatus</span>() <span class="kw">public</span> view <span class="fu">returns</span> (WorkflowStatus) {</span>
<span id="cb829-4"><a href="Truffle-Web3.html#cb829-4" tabindex="-1"></a>    <span class="cf">return</span> workflowStatus<span class="op">;</span></span>
<span id="cb829-5"><a href="Truffle-Web3.html#cb829-5" tabindex="-1"></a>  }</span>
<span id="cb829-6"><a href="Truffle-Web3.html#cb829-6" tabindex="-1"></a>}</span></code></pre></div>
<script>
  $(document).ready(function() {
    $("#funkcije-1 code.javascript:eq(0)").markRegExp(/\s+?function[\s\S]+?}/, options_dodaj);
    $("#funkcije-1 code.javascript:eq(1)").markRegExp(/\s+?function[\s\S]+?}/, options_dodaj);
    $("#funkcije-1 code.javascript:eq(2)").markRegExp(/\s+?function[\s\S]+?}/, options_dodaj);
    $("#funkcije-1 code.javascript:eq(3)").markRegExp(/\s+?function[\s\S]+?\);[^}]+?}/, options_dodaj);
    $("#funkcije-1 code.javascript:eq(4)").markRegExp(/\s+?function[\s\S]+?\);[^}]+?}/, options_dodaj);
    $("#funkcije-1 code.javascript:eq(5)").markRegExp(/\s+?function[\s\S]+?\);[^}]+?}/, options_dodaj);
    $("#funkcije-1 code.javascript:eq(6)").markRegExp(/\s+?function[\s\S]+?}/, options_dodaj);
    $("#funkcije-1 code.javascript:eq(7)").markRegExp(/\s+?function[\s\S]+?}/, options_dodaj);
    $("#funkcije-1 code.javascript:eq(8)").markRegExp(/\s+?function[\s\S]+?}/, options_dodaj);
    $("#funkcije-1 code.javascript:eq(9)").markRegExp(/\s+?function[\s\S]+?}/, options_dodaj);
  });
</script>
</div>
</div>
<div id="lastna-privatna-veriga-blokov" class="section level3 hasAnchor" number="13.1.5">
<h3><span class="header-section-number">13.1.5</span> Lastna privatna veriga blokov<a href="Truffle-Web3.html#lastna-privatna-veriga-blokov" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Ogrodje <a href="https://trufflesuite.com/ganache/"><i class="fa-solid fa-earth-europe"></i><strong>Ganache</strong></a> nam omogoča enostavni zagon lastne privatne verige blokov Ethereum. Uporabimo jo lahko za izvajanje testov, ukazov in pregleda stanja ter nam tudi omogoča nadzor nad delovanjem verige blokov. Testni sistem lahko na lastnem računalniku poženemo na več načinov, in sicer:</p>
<ul>
<li>aplikacija ukazne vrstice <a href="https://trufflesuite.com/docs/truffle/how-to/debug-test/use-truffle-develop-and-the-console/"><i class="fa-brands fa-ethereum"></i><strong><code>truffle develop</code></strong></a> (glej poglavje <a href="Truffle-Web3.html#truffle-develop-ukazna-vrstica">13.1.5.1</a>),</li>
<li>samostojna aplikacija <a href="https://trufflesuite.com/ganache/"><i class="fa-brands fa-ethereum"></i><strong>Ganache</strong></a> z grafičnim uporabniškim vmesnikov (glej poglavje <a href="Truffle-Web3.html#ganache-gui-aplikacija">13.1.5.2</a>) in</li>
<li>aplikacija ukazne vrstice <a href="https://github.com/trufflesuite/ganache"><i class="fa-brands fa-ethereum"></i><strong><code>ganache</code></strong></a> (glej poglavje <a href="Truffle-Web3.html#ganache-ukazna-vrstica">13.1.5.3</a>).</li>
</ul>
<div id="truffle-develop-ukazna-vrstica" class="section level4 hasAnchor" number="13.1.5.1">
<h4><span class="header-section-number">13.1.5.1</span> Truffle develop ukazna vrstica<a href="Truffle-Web3.html#truffle-develop-ukazna-vrstica" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Aplikacijo ukazne vrstice <a href="https://trufflesuite.com/docs/truffle/how-to/debug-test/use-truffle-develop-and-the-console/"><i class="fa-brands fa-ethereum"></i><code>truffle develop</code></a>, ki je del ogrodja Truffle, lahko poženemo v ukazni vrstici:</p>
<div class="sourceCode" id="cb830"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb830-1"><a href="Truffle-Web3.html#cb830-1" tabindex="-1"></a><span class="ex">$</span> truffle develop</span>
<span id="cb830-2"><a href="Truffle-Web3.html#cb830-2" tabindex="-1"></a></span>
<span id="cb830-3"><a href="Truffle-Web3.html#cb830-3" tabindex="-1"></a><span class="ex">Truffle</span> Develop started at http://127.0.0.1:9545/</span>
<span id="cb830-4"><a href="Truffle-Web3.html#cb830-4" tabindex="-1"></a></span>
<span id="cb830-5"><a href="Truffle-Web3.html#cb830-5" tabindex="-1"></a><span class="ex">Accounts:</span></span>
<span id="cb830-6"><a href="Truffle-Web3.html#cb830-6" tabindex="-1"></a><span class="kw">(</span><span class="ex">0</span><span class="kw">)</span> <span class="ex">0xdb4f96c0e3e36d0c34abfd63a0b5eaf7c9658d87</span></span>
<span id="cb830-7"><a href="Truffle-Web3.html#cb830-7" tabindex="-1"></a><span class="kw">(</span><span class="ex">1</span><span class="kw">)</span> <span class="ex">0xba30ca754b9993cbb40a5003768aeb51f1805e11</span></span>
<span id="cb830-8"><a href="Truffle-Web3.html#cb830-8" tabindex="-1"></a><span class="kw">(</span><span class="ex">2</span><span class="kw">)</span> <span class="ex">0xc65379daf5d33dad541df3a2de37748887341f0a</span></span>
<span id="cb830-9"><a href="Truffle-Web3.html#cb830-9" tabindex="-1"></a><span class="kw">(</span><span class="ex">3</span><span class="kw">)</span> <span class="ex">0x078dd21d9ad989f2b592a8df6a56559a509d6b9c</span></span>
<span id="cb830-10"><a href="Truffle-Web3.html#cb830-10" tabindex="-1"></a><span class="kw">(</span><span class="ex">4</span><span class="kw">)</span> <span class="ex">0xbf0e9b9743ee39c8634dbfcaacdc7b7576f490ac</span></span>
<span id="cb830-11"><a href="Truffle-Web3.html#cb830-11" tabindex="-1"></a><span class="kw">(</span><span class="ex">5</span><span class="kw">)</span> <span class="ex">0x00a4cb35c83f8d51260ae5537a8632271bf3ba2b</span></span>
<span id="cb830-12"><a href="Truffle-Web3.html#cb830-12" tabindex="-1"></a><span class="kw">(</span><span class="ex">6</span><span class="kw">)</span> <span class="ex">0xc45a2ffbd3683c27f91800f9600a87965d0c3742</span></span>
<span id="cb830-13"><a href="Truffle-Web3.html#cb830-13" tabindex="-1"></a><span class="kw">(</span><span class="ex">7</span><span class="kw">)</span> <span class="ex">0x0d0d23d15d781cc2ce2bd97bbcf5fae84382733c</span></span>
<span id="cb830-14"><a href="Truffle-Web3.html#cb830-14" tabindex="-1"></a><span class="kw">(</span><span class="ex">8</span><span class="kw">)</span> <span class="ex">0x24e8b22d893dd562dfd962b27fbb324e383cf5ea</span></span>
<span id="cb830-15"><a href="Truffle-Web3.html#cb830-15" tabindex="-1"></a><span class="kw">(</span><span class="ex">9</span><span class="kw">)</span> <span class="ex">0x9df91c32812cd8ec3b6def167554642795361651</span></span>
<span id="cb830-16"><a href="Truffle-Web3.html#cb830-16" tabindex="-1"></a></span>
<span id="cb830-17"><a href="Truffle-Web3.html#cb830-17" tabindex="-1"></a><span class="ex">Private</span> Keys:</span>
<span id="cb830-18"><a href="Truffle-Web3.html#cb830-18" tabindex="-1"></a><span class="kw">(</span><span class="ex">0</span><span class="kw">)</span> <span class="ex">a3065d31d4ffb28ca37ad2603a7f028a95f249c277b98108c1a08365c7b3005b</span></span>
<span id="cb830-19"><a href="Truffle-Web3.html#cb830-19" tabindex="-1"></a><span class="kw">(</span><span class="ex">1</span><span class="kw">)</span> <span class="ex">561f37e7e184f049e0bc8d30d46ee43cb428ff3c1968857553be1f72bb535f47</span></span>
<span id="cb830-20"><a href="Truffle-Web3.html#cb830-20" tabindex="-1"></a><span class="kw">(</span><span class="ex">2</span><span class="kw">)</span> <span class="ex">b410410b78ec46bc01ca9f07e6e46919cefb21ecb8c444e3e4f5cef14500b458</span></span>
<span id="cb830-21"><a href="Truffle-Web3.html#cb830-21" tabindex="-1"></a><span class="kw">(</span><span class="ex">3</span><span class="kw">)</span> <span class="ex">8842acab9cefb1c06ca5dfab78f45065a916d0bcb6ec4ed34c4fae6acac05c19</span></span>
<span id="cb830-22"><a href="Truffle-Web3.html#cb830-22" tabindex="-1"></a><span class="kw">(</span><span class="ex">4</span><span class="kw">)</span> <span class="ex">b5aee3927608de6ea884fced6f1f3cf89c7a55095e60841b486721220667f74c</span></span>
<span id="cb830-23"><a href="Truffle-Web3.html#cb830-23" tabindex="-1"></a><span class="kw">(</span><span class="ex">5</span><span class="kw">)</span> <span class="ex">6fecf4309f690ff6846df0963d93873ce9df43a76361a4220cab6040901ce3fd</span></span>
<span id="cb830-24"><a href="Truffle-Web3.html#cb830-24" tabindex="-1"></a><span class="kw">(</span><span class="ex">6</span><span class="kw">)</span> <span class="ex">4c9c8706f1320d5bf7d565fd00f786337b37569a439b5e0fa599ce6768ff4920</span></span>
<span id="cb830-25"><a href="Truffle-Web3.html#cb830-25" tabindex="-1"></a><span class="kw">(</span><span class="ex">7</span><span class="kw">)</span> <span class="ex">8764958f3a2948d3eeb8c31e190b7f7dc164637ef97ae65f37545584f8c63f7a</span></span>
<span id="cb830-26"><a href="Truffle-Web3.html#cb830-26" tabindex="-1"></a><span class="kw">(</span><span class="ex">8</span><span class="kw">)</span> <span class="ex">c283699cdbbe676d76d35d46381e0037385ddd2bf98d3a4bfd9817e6bef89564</span></span>
<span id="cb830-27"><a href="Truffle-Web3.html#cb830-27" tabindex="-1"></a><span class="kw">(</span><span class="ex">9</span><span class="kw">)</span> <span class="ex">ab7a21113e0d6476e7c0e079cdbca99dc4e25f790906a211d865be77d06e65c8</span></span>
<span id="cb830-28"><a href="Truffle-Web3.html#cb830-28" tabindex="-1"></a></span>
<span id="cb830-29"><a href="Truffle-Web3.html#cb830-29" tabindex="-1"></a><span class="ex">Mnemonic:</span> wide food early shy today organ chat true earth jaguar life renew</span>
<span id="cb830-30"><a href="Truffle-Web3.html#cb830-30" tabindex="-1"></a></span>
<span id="cb830-31"><a href="Truffle-Web3.html#cb830-31" tabindex="-1"></a><span class="ex">⚠️</span>  Important ⚠️  : This mnemonic was created for you by Truffle. It is not secure.</span>
<span id="cb830-32"><a href="Truffle-Web3.html#cb830-32" tabindex="-1"></a><span class="ex">Ensure</span> you do not use it on production blockchains, or else you risk losing funds.</span>
<span id="cb830-33"><a href="Truffle-Web3.html#cb830-33" tabindex="-1"></a></span>
<span id="cb830-34"><a href="Truffle-Web3.html#cb830-34" tabindex="-1"></a><span class="ex">truffle</span><span class="er">(</span><span class="ex">develop</span><span class="kw">)</span><span class="op">&gt;</span> </span></code></pre></div>
<p>Ob zagonu se nam prikažejo vse potrebne podrobnosti lastne privatne verige blokov, vključno s konzolo, preko katere lahko posredujemo ukaze za interakcijo z verigo blokov.</p>
<script>
  $(document).ready(function() {
    $("#truffle-develop-ukazna-vrstica code.bash:eq(0)").markRegExp(/truffle develop/, options_dodaj);
  });
</script>
</div>
<div id="ganache-gui-aplikacija" class="section level4 hasAnchor" number="13.1.5.2">
<h4><span class="header-section-number">13.1.5.2</span> Ganache GUI aplikacija<a href="Truffle-Web3.html#ganache-gui-aplikacija" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Samostojna aplikacija <a href="https://trufflesuite.com/ganache/"><i class="fa-brands fa-ethereum"></i><strong>Ganache</strong></a> z grafičnim uporabniškim vmesnikov, kot to prikazuje slika <a href="Truffle-Web3.html#fig:slika-Ganache-okno">13.3</a>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:slika-Ganache-okno"></span>
<img src="assets/img/Ganache_window.png" alt="Zaslonska slika uporabniškega vmesnika samostojne aplikacije Ganache." width="600" />
<p class="caption">
Slika 13.3: Zaslonska slika uporabniškega vmesnika samostojne aplikacije Ganache.
</p>
</div>
<p>Na voljo imamo grafični vmesnik preko katerega lahko pregledujemo vse podrobnosti privatne verige blokov.</p>
</div>
<div id="ganache-ukazna-vrstica" class="section level4 hasAnchor" number="13.1.5.3">
<h4><span class="header-section-number">13.1.5.3</span> Ganache ukazna vrstica<a href="Truffle-Web3.html#ganache-ukazna-vrstica" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Aplikacijo ukazne vrstice <a href="https://github.com/trufflesuite/ganache"><i class="fa-brands fa-ethereum"></i><strong><code>ganache</code></strong></a> lahko namestimo z naslednjim ukazom:</p>
<div class="sourceCode" id="cb831"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb831-1"><a href="Truffle-Web3.html#cb831-1" tabindex="-1"></a><span class="ex">$</span> npm install <span class="at">-g</span> ganache</span></code></pre></div>
<p>in nato tudi požnemo v ukazni vrstici:</p>
<div class="sourceCode" id="cb832"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb832-1"><a href="Truffle-Web3.html#cb832-1" tabindex="-1"></a><span class="ex">$</span> ganache <span class="dt">\</span></span>
<span id="cb832-2"><a href="Truffle-Web3.html#cb832-2" tabindex="-1"></a>    <span class="at">--wallet.totalAccounts</span> 5 <span class="dt">\</span></span>
<span id="cb832-3"><a href="Truffle-Web3.html#cb832-3" tabindex="-1"></a>    <span class="at">--wallet.defaultBalance</span> 100 <span class="dt">\</span></span>
<span id="cb832-4"><a href="Truffle-Web3.html#cb832-4" tabindex="-1"></a>    <span class="at">--wallet.mnemonic</span> <span class="st">&quot;nuclear seat much sketch element fame hard hedgehog local expect speed cinnamon&quot;</span> <span class="dt">\</span></span>
<span id="cb832-5"><a href="Truffle-Web3.html#cb832-5" tabindex="-1"></a>    <span class="at">--wallet.passphrase</span> <span class="st">&quot;my little secret&quot;</span></span>
<span id="cb832-6"><a href="Truffle-Web3.html#cb832-6" tabindex="-1"></a><span class="ex">ganache</span> v7.9.1 <span class="er">(</span><span class="ex">@ganache/cli:</span> 0.10.1, @ganache/core: 0.10.1<span class="kw">)</span></span>
<span id="cb832-7"><a href="Truffle-Web3.html#cb832-7" tabindex="-1"></a><span class="ex">Starting</span> RPC server</span>
<span id="cb832-8"><a href="Truffle-Web3.html#cb832-8" tabindex="-1"></a></span>
<span id="cb832-9"><a href="Truffle-Web3.html#cb832-9" tabindex="-1"></a><span class="ex">Available</span> Accounts</span>
<span id="cb832-10"><a href="Truffle-Web3.html#cb832-10" tabindex="-1"></a><span class="ex">==================</span></span>
<span id="cb832-11"><a href="Truffle-Web3.html#cb832-11" tabindex="-1"></a><span class="kw">(</span><span class="ex">0</span><span class="kw">)</span> <span class="ex">0x818476CEc6a8D017DB14AB0A25EBE4eBdB518eD8</span> <span class="er">(</span><span class="ex">100</span> ETH<span class="kw">)</span></span>
<span id="cb832-12"><a href="Truffle-Web3.html#cb832-12" tabindex="-1"></a><span class="kw">(</span><span class="ex">1</span><span class="kw">)</span> <span class="ex">0xf57FE3f91F261803a24e7092d2806f308DfE1cCe</span> <span class="er">(</span><span class="ex">100</span> ETH<span class="kw">)</span></span>
<span id="cb832-13"><a href="Truffle-Web3.html#cb832-13" tabindex="-1"></a><span class="kw">(</span><span class="ex">2</span><span class="kw">)</span> <span class="ex">0xa61B49C72D7775a6dbe20C3Cc4EE2c211d98D97D</span> <span class="er">(</span><span class="ex">100</span> ETH<span class="kw">)</span></span>
<span id="cb832-14"><a href="Truffle-Web3.html#cb832-14" tabindex="-1"></a><span class="kw">(</span><span class="ex">3</span><span class="kw">)</span> <span class="ex">0xcD1c3Ae672ed5F24f316967057062A957F64b25d</span> <span class="er">(</span><span class="ex">100</span> ETH<span class="kw">)</span></span>
<span id="cb832-15"><a href="Truffle-Web3.html#cb832-15" tabindex="-1"></a><span class="kw">(</span><span class="ex">4</span><span class="kw">)</span> <span class="ex">0x60626BAcF68e0c1Cc5fC09bEA63196D4C5B374e8</span> <span class="er">(</span><span class="ex">100</span> ETH<span class="kw">)</span></span>
<span id="cb832-16"><a href="Truffle-Web3.html#cb832-16" tabindex="-1"></a></span>
<span id="cb832-17"><a href="Truffle-Web3.html#cb832-17" tabindex="-1"></a><span class="ex">Private</span> Keys</span>
<span id="cb832-18"><a href="Truffle-Web3.html#cb832-18" tabindex="-1"></a><span class="ex">==================</span></span>
<span id="cb832-19"><a href="Truffle-Web3.html#cb832-19" tabindex="-1"></a><span class="kw">(</span><span class="ex">0</span><span class="kw">)</span> <span class="ex">0x9474979ddf5fad50ae845de9fffd43baff65aa67c4701d9245fc24f097eea42e</span></span>
<span id="cb832-20"><a href="Truffle-Web3.html#cb832-20" tabindex="-1"></a><span class="kw">(</span><span class="ex">1</span><span class="kw">)</span> <span class="ex">0x867d08d868d5d0e44564ff7bd1a5c4814f160261e3fd1aa5ca38b2e802ad2c33</span></span>
<span id="cb832-21"><a href="Truffle-Web3.html#cb832-21" tabindex="-1"></a><span class="kw">(</span><span class="ex">2</span><span class="kw">)</span> <span class="ex">0xa628cb6805ed47b701a5085cc0ebe59181ff1eda8bb740658b78cb18d2b3a578</span></span>
<span id="cb832-22"><a href="Truffle-Web3.html#cb832-22" tabindex="-1"></a><span class="kw">(</span><span class="ex">3</span><span class="kw">)</span> <span class="ex">0x50abf45326e49d2a0af6e64fc4b4b8f4ee458ff8cf29bef9d70e2d13c53a0beb</span></span>
<span id="cb832-23"><a href="Truffle-Web3.html#cb832-23" tabindex="-1"></a><span class="kw">(</span><span class="ex">4</span><span class="kw">)</span> <span class="ex">0x265d0f7bbe1974d506c0dac9e231d4fe77d8e9fa6298b5bf3baf67fd00a80e64</span></span>
<span id="cb832-24"><a href="Truffle-Web3.html#cb832-24" tabindex="-1"></a></span>
<span id="cb832-25"><a href="Truffle-Web3.html#cb832-25" tabindex="-1"></a><span class="ex">HD</span> Wallet</span>
<span id="cb832-26"><a href="Truffle-Web3.html#cb832-26" tabindex="-1"></a><span class="ex">==================</span></span>
<span id="cb832-27"><a href="Truffle-Web3.html#cb832-27" tabindex="-1"></a><span class="ex">Mnemonic:</span>      nuclear seat much sketch element fame hard hedgehog local expect speed cinnamon</span>
<span id="cb832-28"><a href="Truffle-Web3.html#cb832-28" tabindex="-1"></a><span class="ex">Base</span> HD Path:  m/44<span class="st">&#39;/60&#39;</span>/0<span class="st">&#39;/0/{account_index}</span></span>
<span id="cb832-29"><a href="Truffle-Web3.html#cb832-29" tabindex="-1"></a></span>
<span id="cb832-30"><a href="Truffle-Web3.html#cb832-30" tabindex="-1"></a><span class="st">Default Gas Price</span></span>
<span id="cb832-31"><a href="Truffle-Web3.html#cb832-31" tabindex="-1"></a><span class="st">==================</span></span>
<span id="cb832-32"><a href="Truffle-Web3.html#cb832-32" tabindex="-1"></a><span class="st">2000000000</span></span>
<span id="cb832-33"><a href="Truffle-Web3.html#cb832-33" tabindex="-1"></a></span>
<span id="cb832-34"><a href="Truffle-Web3.html#cb832-34" tabindex="-1"></a><span class="st">BlockGas Limit</span></span>
<span id="cb832-35"><a href="Truffle-Web3.html#cb832-35" tabindex="-1"></a><span class="st">==================</span></span>
<span id="cb832-36"><a href="Truffle-Web3.html#cb832-36" tabindex="-1"></a><span class="st">30000000</span></span>
<span id="cb832-37"><a href="Truffle-Web3.html#cb832-37" tabindex="-1"></a></span>
<span id="cb832-38"><a href="Truffle-Web3.html#cb832-38" tabindex="-1"></a><span class="st">Call Gas Limit</span></span>
<span id="cb832-39"><a href="Truffle-Web3.html#cb832-39" tabindex="-1"></a><span class="st">==================</span></span>
<span id="cb832-40"><a href="Truffle-Web3.html#cb832-40" tabindex="-1"></a><span class="st">50000000</span></span>
<span id="cb832-41"><a href="Truffle-Web3.html#cb832-41" tabindex="-1"></a></span>
<span id="cb832-42"><a href="Truffle-Web3.html#cb832-42" tabindex="-1"></a><span class="st">Chain</span></span>
<span id="cb832-43"><a href="Truffle-Web3.html#cb832-43" tabindex="-1"></a><span class="st">==================</span></span>
<span id="cb832-44"><a href="Truffle-Web3.html#cb832-44" tabindex="-1"></a><span class="st">Hardfork: shanghai</span></span>
<span id="cb832-45"><a href="Truffle-Web3.html#cb832-45" tabindex="-1"></a><span class="st">Id:       1337</span></span>
<span id="cb832-46"><a href="Truffle-Web3.html#cb832-46" tabindex="-1"></a></span>
<span id="cb832-47"><a href="Truffle-Web3.html#cb832-47" tabindex="-1"></a><span class="st">RPC Listening on 127.0.0.1:8545</span></span></code></pre></div>
<p>Zaradi lažje razvoja pri zagonu lahko nastavimo nekatere dodatne lastnosti, in sicer v našem primeru želimo <strong>5 testnih računov</strong> (<code>wallet.totalAccounts</code>) z začetnim stanjem <strong>100 ETH</strong> (<code>wallet-defaultBalance</code>). Generiranje računov naj bo deterministično z <strong>vnaprej določenim <a href="https://en.wikipedia.org/wiki/Mnemonic"><i class="fa-brands fa-wikipedia-w"></i>mnemonskim stavkom</a></strong> (<code>wallet.mnemonic</code>), prav tako določimo tudi enotno <strong>geslo za odklepanje računov</strong> (<code>wallet.passphrase</code>).</p>
<p>Pri našem razvoju bomo uporabljali ta pristop, ker je najbolj prilagodljiv ter ponovljiv. Zaradi lažjega ponovnega zagona si pripravimo skripto <code>ganache</code> v datoteki <code>package.json</code>, s katero bomo lahko z ukazom <code>npm run ganache</code> vedno pognali lastno privatno verigo blokov z željenimi nastavitvami.</p>
<p><code>package.json</code></p>
<div class="sourceCode" id="cb833"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb833-1"><a href="Truffle-Web3.html#cb833-1" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb833-2"><a href="Truffle-Web3.html#cb833-2" tabindex="-1"></a>  <span class="er">...</span></span>
<span id="cb833-3"><a href="Truffle-Web3.html#cb833-3" tabindex="-1"></a>  <span class="dt">&quot;scripts&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb833-4"><a href="Truffle-Web3.html#cb833-4" tabindex="-1"></a>    <span class="er">...</span><span class="fu">,</span></span>
<span id="cb833-5"><a href="Truffle-Web3.html#cb833-5" tabindex="-1"></a>    <span class="dt">&quot;ganache&quot;</span><span class="fu">:</span> <span class="st">&quot;ganache --wallet.totalAccounts 5 --wallet.defaultBalance 100 --wallet.mnemonic </span><span class="ch">\&quot;</span><span class="st">nuclear seat much sketch element fame hard hedgehog local expect speed cinnamon</span><span class="ch">\&quot;</span><span class="st"> --wallet.passphrase </span><span class="ch">\&quot;</span><span class="st">my little secret</span><span class="ch">\&quot;</span><span class="st">&quot;</span></span>
<span id="cb833-6"><a href="Truffle-Web3.html#cb833-6" tabindex="-1"></a>  <span class="fu">},</span></span>
<span id="cb833-7"><a href="Truffle-Web3.html#cb833-7" tabindex="-1"></a>  <span class="er">...</span></span>
<span id="cb833-8"><a href="Truffle-Web3.html#cb833-8" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
<p>Prav tako moramo v našem Truffle projektu, kjer razvijamo dApp, določiti potrebne podatke za povezovanje na to privatno testno verigo blokov. Omenjene nastavitve zapišemo v datoteko <code>truffle-config.js</code>, kjer so že vnaprej pripravljene in jih je treba zgolj oddokumentirati.</p>
<p><code>dapp/truffle-config.js</code></p>
<div class="sourceCode" id="cb834"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb834-1"><a href="Truffle-Web3.html#cb834-1" tabindex="-1"></a>module<span class="op">.</span><span class="at">exports</span> <span class="op">=</span> {</span>
<span id="cb834-2"><a href="Truffle-Web3.html#cb834-2" tabindex="-1"></a>  <span class="op">...</span></span>
<span id="cb834-3"><a href="Truffle-Web3.html#cb834-3" tabindex="-1"></a>  <span class="dt">networks</span><span class="op">:</span> {</span>
<span id="cb834-4"><a href="Truffle-Web3.html#cb834-4" tabindex="-1"></a>    <span class="op">...</span></span>
<span id="cb834-5"><a href="Truffle-Web3.html#cb834-5" tabindex="-1"></a>    <span class="dt">development</span><span class="op">:</span> {</span>
<span id="cb834-6"><a href="Truffle-Web3.html#cb834-6" tabindex="-1"></a>     <span class="dt">host</span><span class="op">:</span> <span class="st">&quot;127.0.0.1&quot;</span><span class="op">,</span>     <span class="co">// Localhost (default: none)</span></span>
<span id="cb834-7"><a href="Truffle-Web3.html#cb834-7" tabindex="-1"></a>     <span class="dt">port</span><span class="op">:</span> <span class="dv">8545</span><span class="op">,</span>            <span class="co">// Standard Ethereum port (default: none)</span></span>
<span id="cb834-8"><a href="Truffle-Web3.html#cb834-8" tabindex="-1"></a>     <span class="dt">network_id</span><span class="op">:</span> <span class="st">&quot;*&quot;</span><span class="op">,</span>       <span class="co">// Any network (default: none)</span></span>
<span id="cb834-9"><a href="Truffle-Web3.html#cb834-9" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb834-10"><a href="Truffle-Web3.html#cb834-10" tabindex="-1"></a>    <span class="op">...</span></span>
<span id="cb834-11"><a href="Truffle-Web3.html#cb834-11" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb834-12"><a href="Truffle-Web3.html#cb834-12" tabindex="-1"></a>  <span class="op">...</span></span>
<span id="cb834-13"><a href="Truffle-Web3.html#cb834-13" tabindex="-1"></a>}<span class="op">;</span></span></code></pre></div>
<p>Po potrebi popravimo tudi verzij prevajalnika jezika Solidity, ki je v našem primeru <code>0.8.23</code>.</p>
<p><code>dapp/truffle-config.js</code></p>
<div class="sourceCode" id="cb835"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb835-1"><a href="Truffle-Web3.html#cb835-1" tabindex="-1"></a>module<span class="op">.</span><span class="at">exports</span> <span class="op">=</span> {</span>
<span id="cb835-2"><a href="Truffle-Web3.html#cb835-2" tabindex="-1"></a>  <span class="op">...</span></span>
<span id="cb835-3"><a href="Truffle-Web3.html#cb835-3" tabindex="-1"></a>  <span class="dt">compilers</span><span class="op">:</span> {</span>
<span id="cb835-4"><a href="Truffle-Web3.html#cb835-4" tabindex="-1"></a>    <span class="dt">solc</span><span class="op">:</span> {</span>
<span id="cb835-5"><a href="Truffle-Web3.html#cb835-5" tabindex="-1"></a>      <span class="dt">version</span><span class="op">:</span> <span class="st">&quot;0.8.213&quot;</span><span class="op">,</span></span>
<span id="cb835-6"><a href="Truffle-Web3.html#cb835-6" tabindex="-1"></a>      <span class="op">...</span></span>
<span id="cb835-7"><a href="Truffle-Web3.html#cb835-7" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb835-8"><a href="Truffle-Web3.html#cb835-8" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb835-9"><a href="Truffle-Web3.html#cb835-9" tabindex="-1"></a>  <span class="op">...</span></span>
<span id="cb835-10"><a href="Truffle-Web3.html#cb835-10" tabindex="-1"></a>}<span class="op">;</span></span></code></pre></div>
<script>
  $(document).ready(function() {
    $("#ganache-ukazna-vrstica code.bash:eq(1)").markRegExp(/(ganache \\|--).*/, options_dodaj);
    $("#ganache-ukazna-vrstica code:eq(10)").markRegExp(/.+/, options_dodaj);
    $("#ganache-ukazna-vrstica code.json:eq(0)").markRegExp(/,[\s\S]+?"ganache":.+/, options_dodaj);
    $("#ganache-ukazna-vrstica code.javascript:eq(0)").markRegExp(/\s+?development[\s\S]+?},/, options_dodaj);
    $("#ganache-ukazna-vrstica code.javascript:eq(1)").markRegExp(/1/, options_izbrisi);
    $("#ganache-ukazna-vrstica code.javascript:eq(1)").markRegExp(/3/, options_dodaj);
  });
</script>
</div>
</div>
<div id="prevajanje-in-postavitev-pametne-pogodbe" class="section level3 hasAnchor" number="13.1.6">
<h3><span class="header-section-number">13.1.6</span> Prevajanje in postavitev pametne pogodbe<a href="Truffle-Web3.html#prevajanje-in-postavitev-pametne-pogodbe" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Pametna pogodba, ki smo jo razvili v prejšnjem poglavju <a href="Truffle-Web3.html#razvoj-pametne-pogodbe">13.1.4</a>, je na voljo v datoteki <code>contracts/SimpleVoting.sol</code>. Sedaj v mapi <code>migrations</code> kreiramo novo datoteko <code>1_deploy_contracts.js</code>, ki bo poskrbela za postavitev prej omenjene pametne pogodbe.</p>
<p><code>dapp/migrations/1_deploy_contracts.js</code></p>
<div class="sourceCode" id="cb836"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb836-1"><a href="Truffle-Web3.html#cb836-1" tabindex="-1"></a><span class="kw">const</span> SimpleVoting <span class="op">=</span> artifacts<span class="op">.</span><span class="fu">require</span>(<span class="st">&quot;SimpleVoting&quot;</span>)<span class="op">;</span></span>
<span id="cb836-2"><a href="Truffle-Web3.html#cb836-2" tabindex="-1"></a></span>
<span id="cb836-3"><a href="Truffle-Web3.html#cb836-3" tabindex="-1"></a>module<span class="op">.</span><span class="at">exports</span> <span class="op">=</span> (deployer) <span class="kw">=&gt;</span> {</span>
<span id="cb836-4"><a href="Truffle-Web3.html#cb836-4" tabindex="-1"></a>  deployer<span class="op">.</span><span class="fu">deploy</span>(SimpleVoting)<span class="op">;</span></span>
<span id="cb836-5"><a href="Truffle-Web3.html#cb836-5" tabindex="-1"></a>}<span class="op">;</span></span></code></pre></div>
<p>Najprej bomo s pomočjo ukaza <a href="https://trufflesuite.com/docs/truffle/how-to/compile-contracts/"><i class="fa-brands fa-ethereum"></i><code>truffle compile</code></a> pametno pogodbo prevedli. Rezultat prevajanja bo prevedena verzija pametne pogodbe <code>SimpleVoting</code>, ki se nahaja v mapi <code>dapp/build/contracts</code>.</p>
<div class="sourceCode" id="cb837"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb837-1"><a href="Truffle-Web3.html#cb837-1" tabindex="-1"></a><span class="ex">$</span> cd dapp</span>
<span id="cb837-2"><a href="Truffle-Web3.html#cb837-2" tabindex="-1"></a><span class="ex">$</span> truffle compile</span>
<span id="cb837-3"><a href="Truffle-Web3.html#cb837-3" tabindex="-1"></a></span>
<span id="cb837-4"><a href="Truffle-Web3.html#cb837-4" tabindex="-1"></a><span class="ex">Compiling</span> your contracts...</span>
<span id="cb837-5"><a href="Truffle-Web3.html#cb837-5" tabindex="-1"></a><span class="ex">===========================</span></span>
<span id="cb837-6"><a href="Truffle-Web3.html#cb837-6" tabindex="-1"></a><span class="op">&gt;</span> Compiling <span class="ex">./contracts/SimpleVoting.sol</span></span>
<span id="cb837-7"><a href="Truffle-Web3.html#cb837-7" tabindex="-1"></a><span class="op">&gt;</span> Artifacts <span class="ex">written</span> to /dapp/build/contracts</span>
<span id="cb837-8"><a href="Truffle-Web3.html#cb837-8" tabindex="-1"></a><span class="op">&gt;</span> Compiled <span class="ex">successfully</span> using:</span>
<span id="cb837-9"><a href="Truffle-Web3.html#cb837-9" tabindex="-1"></a>   <span class="ex">-</span> solc: 0.8.23+commit.f704f362.Emscripten.clang</span></code></pre></div>
<p>Nato se vrnemo nazaj v prvotni terminal in zahtevamo postavitev pametne pogodbe na Ganache osebno verigo blokov z ukazom <code>truffle migrate</code>.</p>
<p>S pomočjo ogrodja <code>truffle</code> se na verigo blokov postavi pametna pogodba <code>SimpleVoting</code>, ki je na voljo na lastnem Ethereum naslovu. Kot je razvidno iz spodnjih dnevniških zapisov, se pametna pogodba na Ganache omrežje posreduje v imenu 1. testnega računa z naslovom <span class="skupaj"><i class="fa-solid fa-user"></i><code>0x818476CEc6a8D017DB14AB0A25EBE4eBdB518eD8</code></span>, kjer skupni stroški znašajo <span class="skupaj"><code>0,00737902575 ETH</code></span>, kar je tudi vrednost, za katero se zmanjša stanje tega naslova Ethereum denarnice.</p>
<p><code>Terminal s pametno pogodbo</code></p>
<div class="sourceCode" id="cb838"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb838-1"><a href="Truffle-Web3.html#cb838-1" tabindex="-1"></a><span class="ex">$</span> truffle migrate</span>
<span id="cb838-2"><a href="Truffle-Web3.html#cb838-2" tabindex="-1"></a></span>
<span id="cb838-3"><a href="Truffle-Web3.html#cb838-3" tabindex="-1"></a><span class="ex">Compiling</span> your contracts...</span>
<span id="cb838-4"><a href="Truffle-Web3.html#cb838-4" tabindex="-1"></a><span class="ex">===========================</span></span>
<span id="cb838-5"><a href="Truffle-Web3.html#cb838-5" tabindex="-1"></a><span class="op">&gt;</span> Everything <span class="ex">is</span> up to date, there is nothing to compile.</span>
<span id="cb838-6"><a href="Truffle-Web3.html#cb838-6" tabindex="-1"></a></span>
<span id="cb838-7"><a href="Truffle-Web3.html#cb838-7" tabindex="-1"></a><span class="ex">Starting</span> migrations...</span>
<span id="cb838-8"><a href="Truffle-Web3.html#cb838-8" tabindex="-1"></a><span class="ex">======================</span></span>
<span id="cb838-9"><a href="Truffle-Web3.html#cb838-9" tabindex="-1"></a><span class="op">&gt;</span> Network <span class="ex">name:</span>    <span class="st">&#39;development&#39;</span></span>
<span id="cb838-10"><a href="Truffle-Web3.html#cb838-10" tabindex="-1"></a><span class="op">&gt;</span> Network <span class="ex">id:</span>      1701851319989</span>
<span id="cb838-11"><a href="Truffle-Web3.html#cb838-11" tabindex="-1"></a><span class="op">&gt;</span> Block <span class="ex">gas</span> limit: 30000000 <span class="er">(</span><span class="ex">0x1c9c380</span><span class="kw">)</span></span>
<span id="cb838-12"><a href="Truffle-Web3.html#cb838-12" tabindex="-1"></a></span>
<span id="cb838-13"><a href="Truffle-Web3.html#cb838-13" tabindex="-1"></a><span class="ex">1_deploy_contracts.js</span></span>
<span id="cb838-14"><a href="Truffle-Web3.html#cb838-14" tabindex="-1"></a><span class="ex">=====================</span></span>
<span id="cb838-15"><a href="Truffle-Web3.html#cb838-15" tabindex="-1"></a>   <span class="ex">Deploying</span> <span class="st">&#39;SimpleVoting&#39;</span></span>
<span id="cb838-16"><a href="Truffle-Web3.html#cb838-16" tabindex="-1"></a>   <span class="ex">------------------------</span></span>
<span id="cb838-17"><a href="Truffle-Web3.html#cb838-17" tabindex="-1"></a>   <span class="op">&gt;</span> transaction <span class="ex">hash:</span>    0x4d62d3d0ec9b099a9f5947daaa24f67e60ba41fd02ec517e4b932a652b780128</span>
<span id="cb838-18"><a href="Truffle-Web3.html#cb838-18" tabindex="-1"></a>   <span class="op">&gt;</span> Blocks: <span class="ex">0</span>            Seconds: 0</span>
<span id="cb838-19"><a href="Truffle-Web3.html#cb838-19" tabindex="-1"></a>   <span class="op">&gt;</span> contract <span class="ex">address:</span>    0xD76d2DF6994C2e515F8e2279CBd4309C144EC395</span>
<span id="cb838-20"><a href="Truffle-Web3.html#cb838-20" tabindex="-1"></a>   <span class="op">&gt;</span> block <span class="ex">number:</span>        1</span>
<span id="cb838-21"><a href="Truffle-Web3.html#cb838-21" tabindex="-1"></a>   <span class="op">&gt;</span> block <span class="ex">timestamp:</span>     1701851893</span>
<span id="cb838-22"><a href="Truffle-Web3.html#cb838-22" tabindex="-1"></a>   <span class="op">&gt;</span> account:             <span class="ex">0x818476CEc6a8D017DB14AB0A25EBE4eBdB518eD8</span></span>
<span id="cb838-23"><a href="Truffle-Web3.html#cb838-23" tabindex="-1"></a>   <span class="op">&gt;</span> balance:             <span class="ex">99.99262097425</span></span>
<span id="cb838-24"><a href="Truffle-Web3.html#cb838-24" tabindex="-1"></a>   <span class="op">&gt;</span> gas <span class="ex">used:</span>            2186378 <span class="er">(</span><span class="ex">0x215c8a</span><span class="kw">)</span></span>
<span id="cb838-25"><a href="Truffle-Web3.html#cb838-25" tabindex="-1"></a>   <span class="op">&gt;</span> gas <span class="ex">price:</span>           3.375 gwei</span>
<span id="cb838-26"><a href="Truffle-Web3.html#cb838-26" tabindex="-1"></a>   <span class="op">&gt;</span> value <span class="ex">sent:</span>          0 ETH</span>
<span id="cb838-27"><a href="Truffle-Web3.html#cb838-27" tabindex="-1"></a>   <span class="op">&gt;</span> total <span class="ex">cost:</span>          0.00737902575 ETH</span>
<span id="cb838-28"><a href="Truffle-Web3.html#cb838-28" tabindex="-1"></a>   <span class="op">&gt;</span> Saving <span class="ex">artifacts</span></span>
<span id="cb838-29"><a href="Truffle-Web3.html#cb838-29" tabindex="-1"></a>   <span class="ex">-------------------------------------</span></span>
<span id="cb838-30"><a href="Truffle-Web3.html#cb838-30" tabindex="-1"></a>   <span class="op">&gt;</span> Total <span class="ex">cost:</span>       0.00737902575 ETH</span>
<span id="cb838-31"><a href="Truffle-Web3.html#cb838-31" tabindex="-1"></a></span>
<span id="cb838-32"><a href="Truffle-Web3.html#cb838-32" tabindex="-1"></a><span class="ex">Summary</span></span>
<span id="cb838-33"><a href="Truffle-Web3.html#cb838-33" tabindex="-1"></a><span class="ex">=======</span></span>
<span id="cb838-34"><a href="Truffle-Web3.html#cb838-34" tabindex="-1"></a><span class="op">&gt;</span> Total <span class="ex">deployments:</span>   1</span>
<span id="cb838-35"><a href="Truffle-Web3.html#cb838-35" tabindex="-1"></a><span class="op">&gt;</span> Final <span class="ex">cost:</span>          0.00737902575 ETH</span></code></pre></div>
<p>Skladno s stanjem na strani odjemalca, ki je posredoval zahtevo na Ganache omrežje, je tudi stanje na strani Ganache privatne verige blokov. Opazimo lahko kreirani pametni pogodbi in pripadajoče stroške transakcije.</p>
<p><code>Ganache terminal</code></p>
<div class="sourceCode" id="cb839"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb839-1"><a href="Truffle-Web3.html#cb839-1" tabindex="-1"></a><span class="ex">eth_blockNumber</span></span>
<span id="cb839-2"><a href="Truffle-Web3.html#cb839-2" tabindex="-1"></a><span class="ex">net_version</span></span>
<span id="cb839-3"><a href="Truffle-Web3.html#cb839-3" tabindex="-1"></a><span class="ex">eth_accounts</span></span>
<span id="cb839-4"><a href="Truffle-Web3.html#cb839-4" tabindex="-1"></a><span class="ex">eth_getBlockByNumber</span></span>
<span id="cb839-5"><a href="Truffle-Web3.html#cb839-5" tabindex="-1"></a><span class="ex">eth_accounts</span></span>
<span id="cb839-6"><a href="Truffle-Web3.html#cb839-6" tabindex="-1"></a><span class="ex">net_version</span></span>
<span id="cb839-7"><a href="Truffle-Web3.html#cb839-7" tabindex="-1"></a><span class="ex">eth_getBlockByNumber</span></span>
<span id="cb839-8"><a href="Truffle-Web3.html#cb839-8" tabindex="-1"></a><span class="ex">eth_getBlockByNumber</span></span>
<span id="cb839-9"><a href="Truffle-Web3.html#cb839-9" tabindex="-1"></a><span class="ex">net_version</span></span>
<span id="cb839-10"><a href="Truffle-Web3.html#cb839-10" tabindex="-1"></a><span class="ex">eth_getBlockByNumber</span></span>
<span id="cb839-11"><a href="Truffle-Web3.html#cb839-11" tabindex="-1"></a><span class="ex">eth_estimateGas</span></span>
<span id="cb839-12"><a href="Truffle-Web3.html#cb839-12" tabindex="-1"></a><span class="ex">net_version</span></span>
<span id="cb839-13"><a href="Truffle-Web3.html#cb839-13" tabindex="-1"></a><span class="ex">eth_blockNumber</span></span>
<span id="cb839-14"><a href="Truffle-Web3.html#cb839-14" tabindex="-1"></a><span class="ex">eth_getBlockByNumber</span></span>
<span id="cb839-15"><a href="Truffle-Web3.html#cb839-15" tabindex="-1"></a><span class="ex">eth_estimateGas</span></span>
<span id="cb839-16"><a href="Truffle-Web3.html#cb839-16" tabindex="-1"></a><span class="ex">eth_getBlockByNumber</span></span>
<span id="cb839-17"><a href="Truffle-Web3.html#cb839-17" tabindex="-1"></a><span class="ex">eth_gasPrice</span></span>
<span id="cb839-18"><a href="Truffle-Web3.html#cb839-18" tabindex="-1"></a><span class="ex">eth_sendTransaction</span></span>
<span id="cb839-19"><a href="Truffle-Web3.html#cb839-19" tabindex="-1"></a></span>
<span id="cb839-20"><a href="Truffle-Web3.html#cb839-20" tabindex="-1"></a>  <span class="ex">Transaction:</span> 0x4d62d3d0ec9b099a9f5947daaa24f67e60ba41fd02ec517e4b932a652b780128</span>
<span id="cb839-21"><a href="Truffle-Web3.html#cb839-21" tabindex="-1"></a>  <span class="ex">Contract</span> created: 0xd76d2df6994c2e515f8e2279cbd4309c144ec395</span>
<span id="cb839-22"><a href="Truffle-Web3.html#cb839-22" tabindex="-1"></a>  <span class="ex">Gas</span> usage: 2186378</span>
<span id="cb839-23"><a href="Truffle-Web3.html#cb839-23" tabindex="-1"></a>  <span class="ex">Block</span> number: 1</span>
<span id="cb839-24"><a href="Truffle-Web3.html#cb839-24" tabindex="-1"></a>  <span class="ex">Block</span> time: Wed Dec 06 2023 09:38:13 GMT+0100 <span class="er">(</span><span class="ex">GMT+01:00</span><span class="kw">)</span></span>
<span id="cb839-25"><a href="Truffle-Web3.html#cb839-25" tabindex="-1"></a></span>
<span id="cb839-26"><a href="Truffle-Web3.html#cb839-26" tabindex="-1"></a><span class="ex">eth_getTransactionReceipt</span></span>
<span id="cb839-27"><a href="Truffle-Web3.html#cb839-27" tabindex="-1"></a><span class="ex">eth_getCode</span></span>
<span id="cb839-28"><a href="Truffle-Web3.html#cb839-28" tabindex="-1"></a><span class="ex">eth_getTransactionByHash</span></span>
<span id="cb839-29"><a href="Truffle-Web3.html#cb839-29" tabindex="-1"></a><span class="ex">eth_getBlockByNumber</span></span>
<span id="cb839-30"><a href="Truffle-Web3.html#cb839-30" tabindex="-1"></a><span class="ex">eth_getBalance</span></span></code></pre></div>
<blockquote>
<p><strong>Opomba</strong>: Če želite izvesti migracijo na novo, kjer podatke najprej izbrišete, lahko uporabite ukaz <code>truffle migrate --reset</code>.</p>
</blockquote>
<script>
  $(document).ready(function() {
    $("#prevajanje-in-postavitev-pametne-pogodbe code:eq(2)").markRegExp(/.+/, options_dodaj);
    $("#prevajanje-in-postavitev-pametne-pogodbe code.javascript:eq(0)").markRegExp(/.+/, options_dodaj);
    $("#prevajanje-in-postavitev-pametne-pogodbe code.bash:eq(0)").markRegExp(/(cd|truffle compile).*/, options_dodaj);
    $("#prevajanje-in-postavitev-pametne-pogodbe code.bash:eq(1)").markRegExp(/truffle migrate/, options_dodaj);
    $("#prevajanje-in-postavitev-pametne-pogodbe code.bash:eq(1)").markRegExp(/Deploying.+/, options_dodaj);
    $("#prevajanje-in-postavitev-pametne-pogodbe code.bash:eq(1)").markRegExp(/(contract address|account|total cost|Final cost):.+/, options_dodaj);
    $("#prevajanje-in-postavitev-pametne-pogodbe code.bash:eq(2)").markRegExp(/(Contract created):.+/, options_dodaj);
    $("#prevajanje-in-postavitev-pametne-pogodbe code:eq(18)").markRegExp(/.+/, options_dodaj);
  });
</script>
</div>
<div id="testi-enot" class="section level3 hasAnchor" number="13.1.7">
<h3><span class="header-section-number">13.1.7</span> Testi enot<a href="Truffle-Web3.html#testi-enot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Pri testiranju pametne pogodbe moramo preveriti delovanje enostavnih funkcionalnosti, prav tako pa se moramo osredotočiti na preverjanje pravic za dostop do klica funkcij. Npr. sprejemanje predlogov in glasovanje se lahko začneta šele, ko skrbnik to omogoči, zato se je treba pri testiranju osredotočiti predvsem na preverjanje teh omejitev. V tabeli <a href="Truffle-Web3.html#tab:tabela-Testi-enot-pametne-pogodbe">13.1</a> je prikazana manjša podmnožica testov, ki jih je smiselno pripraviti.</p>
<table class="tabela-manjsa">
<caption>
<span id="tab:tabela-Testi-enot-pametne-pogodbe">Tabela 13.1: </span>Primeri testov pametne pogodbe <code>SimpleVoting</code>
</caption>
<thead>
<tr>
<th style="text-align:left;">
Testni primer
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Samo skrbnik lahko registrira nove volivce.
</td>
</tr>
<tr>
<td style="text-align:left;">
Istega volivca ne morete registrirati večkrat.
</td>
</tr>
<tr>
<td style="text-align:left;">
Samo skrbnik lahko začne proces sprejemanja predlogov.
</td>
</tr>
<tr>
<td style="text-align:left;">
Aktivni proces sprejemanja predlogov lahko ustavi le skrbnik.
</td>
</tr>
<tr>
<td style="text-align:left;">
Samo registriran volivec lahko posreduje predlog za glasovanje.
</td>
</tr>
<tr>
<td style="text-align:left;">
Registriran volivec lahko posreduje predlog za glasovanje, ko je proces sprejemanja aktiven.
</td>
</tr>
<tr>
<td style="text-align:left;">
Registriran volivec ne more glasovati pred začetkom procesa glasovanja.
</td>
</tr>
</tbody>
</table>
<p>Vsak od teh testnih primerov načeloma zahteva, da napišemo vsaj:</p>
<ul>
<li><strong>negativni test</strong>, ki pokaže, da pride do izjeme, če pogoji niso izpolnjeni in</li>
<li><strong>pozitivni test</strong>, ki preveri delovanje pričakovane funkcionalnosti, ko so izpolnjene omejitve.</li>
</ul>
<p>Pri testnem primeru, kjer preverjamo, da aktivni proces sprejemanja predlogov lahko ustavi le skrbnik, bi morali pripraviti naslednje teste:</p>
<ul>
<li>negativni test,
<ul>
<li>ki potrdi izjemo, do katere pride, ko volivec, ki ni skrbnik, poskuša zaključiti proces sprejemanja predlogov,</li>
<li>ki potrdi izjemo, da skrbnik ne more zaključiti procesa sprejemanja predlogov, če se le-ta še ni začel in</li>
</ul></li>
<li>pozitivni test, ki potrdi, da lahko skrbnik uspešno zaključi sprejemanje predlogov, ko se je le-ta že začela.</li>
</ul>
<p>Teste v okviru naše aplikacije shranimo v mapo <code>dapp/test</code>, in sicer ga v našem primeru poimenujemo <code>testSimpleVoting.js</code>.</p>
<p><code>dapp/test/testSimpleVoting.js</code></p>
<div class="sourceCode" id="cb840"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb840-1"><a href="Truffle-Web3.html#cb840-1" tabindex="-1"></a><span class="kw">const</span> SimpleVoting <span class="op">=</span> artifacts<span class="op">.</span><span class="fu">require</span>(<span class="st">&quot;SimpleVoting&quot;</span>)<span class="op">;</span></span>
<span id="cb840-2"><a href="Truffle-Web3.html#cb840-2" tabindex="-1"></a></span>
<span id="cb840-3"><a href="Truffle-Web3.html#cb840-3" tabindex="-1"></a><span class="fu">contract</span>(<span class="st">&quot;SimpleVoting&quot;</span><span class="op">,</span> (accounts) <span class="kw">=&gt;</span> {</span>
<span id="cb840-4"><a href="Truffle-Web3.html#cb840-4" tabindex="-1"></a>  <span class="fu">contract</span>(<span class="st">&quot;SimpleVoting.endProposalRegistration&quot;</span><span class="op">,</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb840-5"><a href="Truffle-Web3.html#cb840-5" tabindex="-1"></a>    <span class="fu">it</span>(<span class="st">&quot;onlyAdministrator modifier&quot;</span><span class="op">,</span> <span class="kw">async</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb840-6"><a href="Truffle-Web3.html#cb840-6" tabindex="-1"></a>      <span class="co">// Arrange</span></span>
<span id="cb840-7"><a href="Truffle-Web3.html#cb840-7" tabindex="-1"></a>      <span class="kw">let</span> simpleVotingInstance <span class="op">=</span> <span class="cf">await</span> SimpleVoting<span class="op">.</span><span class="fu">deployed</span>()<span class="op">;</span></span>
<span id="cb840-8"><a href="Truffle-Web3.html#cb840-8" tabindex="-1"></a>      <span class="kw">let</span> votingAdministrator <span class="op">=</span> accounts[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb840-9"><a href="Truffle-Web3.html#cb840-9" tabindex="-1"></a>      <span class="kw">let</span> nonVotingAdministrator <span class="op">=</span> accounts[<span class="dv">1</span>]<span class="op">;</span></span>
<span id="cb840-10"><a href="Truffle-Web3.html#cb840-10" tabindex="-1"></a>      <span class="cf">try</span> {</span>
<span id="cb840-11"><a href="Truffle-Web3.html#cb840-11" tabindex="-1"></a>        <span class="co">// Act</span></span>
<span id="cb840-12"><a href="Truffle-Web3.html#cb840-12" tabindex="-1"></a>        <span class="cf">await</span> simpleVotingInstance<span class="op">.</span><span class="fu">endProposalsRegistration</span>({</span>
<span id="cb840-13"><a href="Truffle-Web3.html#cb840-13" tabindex="-1"></a>          <span class="dt">from</span><span class="op">:</span> nonVotingAdministrator<span class="op">,</span></span>
<span id="cb840-14"><a href="Truffle-Web3.html#cb840-14" tabindex="-1"></a>        })<span class="op">;</span></span>
<span id="cb840-15"><a href="Truffle-Web3.html#cb840-15" tabindex="-1"></a>        assert<span class="op">.</span><span class="fu">isTrue</span>(<span class="kw">false</span>)<span class="op">;</span></span>
<span id="cb840-16"><a href="Truffle-Web3.html#cb840-16" tabindex="-1"></a>      } <span class="cf">catch</span> (error) {</span>
<span id="cb840-17"><a href="Truffle-Web3.html#cb840-17" tabindex="-1"></a>        <span class="co">// Assert</span></span>
<span id="cb840-18"><a href="Truffle-Web3.html#cb840-18" tabindex="-1"></a>        assert<span class="op">.</span><span class="fu">isTrue</span>(votingAdministrator <span class="op">!=</span> nonVotingAdministrator)<span class="op">;</span></span>
<span id="cb840-19"><a href="Truffle-Web3.html#cb840-19" tabindex="-1"></a>        assert<span class="op">.</span><span class="fu">isTrue</span>(error<span class="op">.</span><span class="at">hijackedStack</span><span class="op">.</span><span class="fu">indexOf</span>(<span class="st">&quot;the caller must be the administrator&quot;</span>) <span class="op">&gt;</span> <span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb840-20"><a href="Truffle-Web3.html#cb840-20" tabindex="-1"></a>      }</span>
<span id="cb840-21"><a href="Truffle-Web3.html#cb840-21" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb840-22"><a href="Truffle-Web3.html#cb840-22" tabindex="-1"></a></span>
<span id="cb840-23"><a href="Truffle-Web3.html#cb840-23" tabindex="-1"></a>    <span class="fu">it</span>(<span class="st">&quot;onlyDuringProposalsRegistration modifier&quot;</span><span class="op">,</span> <span class="kw">async</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb840-24"><a href="Truffle-Web3.html#cb840-24" tabindex="-1"></a>      <span class="co">// Arrange</span></span>
<span id="cb840-25"><a href="Truffle-Web3.html#cb840-25" tabindex="-1"></a>      <span class="kw">let</span> simpleVotingInstance <span class="op">=</span> <span class="cf">await</span> SimpleVoting<span class="op">.</span><span class="fu">deployed</span>()<span class="op">;</span></span>
<span id="cb840-26"><a href="Truffle-Web3.html#cb840-26" tabindex="-1"></a>      <span class="kw">let</span> votingAdministrator <span class="op">=</span> accounts[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb840-27"><a href="Truffle-Web3.html#cb840-27" tabindex="-1"></a>      <span class="cf">try</span> {</span>
<span id="cb840-28"><a href="Truffle-Web3.html#cb840-28" tabindex="-1"></a>        <span class="co">// Act</span></span>
<span id="cb840-29"><a href="Truffle-Web3.html#cb840-29" tabindex="-1"></a>        <span class="cf">await</span> simpleVotingInstance<span class="op">.</span><span class="fu">endProposalsRegistration</span>({</span>
<span id="cb840-30"><a href="Truffle-Web3.html#cb840-30" tabindex="-1"></a>          <span class="dt">from</span><span class="op">:</span> votingAdministrator<span class="op">,</span></span>
<span id="cb840-31"><a href="Truffle-Web3.html#cb840-31" tabindex="-1"></a>        })<span class="op">;</span></span>
<span id="cb840-32"><a href="Truffle-Web3.html#cb840-32" tabindex="-1"></a>        assert<span class="op">.</span><span class="fu">isTrue</span>(<span class="kw">false</span>)<span class="op">;</span></span>
<span id="cb840-33"><a href="Truffle-Web3.html#cb840-33" tabindex="-1"></a>      } <span class="cf">catch</span> (error) {</span>
<span id="cb840-34"><a href="Truffle-Web3.html#cb840-34" tabindex="-1"></a>        <span class="co">// Assert</span></span>
<span id="cb840-35"><a href="Truffle-Web3.html#cb840-35" tabindex="-1"></a>        assert<span class="op">.</span><span class="fu">isTrue</span>(error<span class="op">.</span><span class="at">hijackedStack</span><span class="op">.</span><span class="fu">indexOf</span>(<span class="st">&quot;only during proposals registration&quot;</span>) <span class="op">&gt;</span> <span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb840-36"><a href="Truffle-Web3.html#cb840-36" tabindex="-1"></a>      }</span>
<span id="cb840-37"><a href="Truffle-Web3.html#cb840-37" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb840-38"><a href="Truffle-Web3.html#cb840-38" tabindex="-1"></a></span>
<span id="cb840-39"><a href="Truffle-Web3.html#cb840-39" tabindex="-1"></a>    <span class="fu">it</span>(<span class="st">&quot;successful&quot;</span><span class="op">,</span> <span class="kw">async</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb840-40"><a href="Truffle-Web3.html#cb840-40" tabindex="-1"></a>      <span class="co">// Arrange</span></span>
<span id="cb840-41"><a href="Truffle-Web3.html#cb840-41" tabindex="-1"></a>      <span class="kw">let</span> simpleVotingInstance <span class="op">=</span> <span class="cf">await</span> SimpleVoting<span class="op">.</span><span class="fu">deployed</span>()<span class="op">;</span></span>
<span id="cb840-42"><a href="Truffle-Web3.html#cb840-42" tabindex="-1"></a>      <span class="kw">let</span> votingAdministrator <span class="op">=</span> accounts[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb840-43"><a href="Truffle-Web3.html#cb840-43" tabindex="-1"></a>      <span class="cf">await</span> simpleVotingInstance<span class="op">.</span><span class="fu">startProposalsRegistration</span>({</span>
<span id="cb840-44"><a href="Truffle-Web3.html#cb840-44" tabindex="-1"></a>        <span class="dt">from</span><span class="op">:</span> votingAdministrator<span class="op">,</span></span>
<span id="cb840-45"><a href="Truffle-Web3.html#cb840-45" tabindex="-1"></a>      })<span class="op">;</span></span>
<span id="cb840-46"><a href="Truffle-Web3.html#cb840-46" tabindex="-1"></a>      <span class="kw">let</span> status <span class="op">=</span> <span class="cf">await</span> simpleVotingInstance<span class="op">.</span><span class="fu">getWorkflowStatus</span>()<span class="op">;</span></span>
<span id="cb840-47"><a href="Truffle-Web3.html#cb840-47" tabindex="-1"></a>      <span class="kw">let</span> expectedWorkflowStatus <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb840-48"><a href="Truffle-Web3.html#cb840-48" tabindex="-1"></a>      assert<span class="op">.</span><span class="fu">equal</span>(</span>
<span id="cb840-49"><a href="Truffle-Web3.html#cb840-49" tabindex="-1"></a>        status<span class="op">.</span><span class="fu">valueOf</span>()<span class="op">,</span></span>
<span id="cb840-50"><a href="Truffle-Web3.html#cb840-50" tabindex="-1"></a>        expectedWorkflowStatus<span class="op">,</span></span>
<span id="cb840-51"><a href="Truffle-Web3.html#cb840-51" tabindex="-1"></a>        <span class="st">&quot;status does not correspond to proposals registration session started&quot;</span></span>
<span id="cb840-52"><a href="Truffle-Web3.html#cb840-52" tabindex="-1"></a>      )<span class="op">;</span></span>
<span id="cb840-53"><a href="Truffle-Web3.html#cb840-53" tabindex="-1"></a>      <span class="co">// Act</span></span>
<span id="cb840-54"><a href="Truffle-Web3.html#cb840-54" tabindex="-1"></a>      <span class="cf">await</span> simpleVotingInstance<span class="op">.</span><span class="fu">endProposalsRegistration</span>({</span>
<span id="cb840-55"><a href="Truffle-Web3.html#cb840-55" tabindex="-1"></a>        <span class="dt">from</span><span class="op">:</span> votingAdministrator<span class="op">,</span></span>
<span id="cb840-56"><a href="Truffle-Web3.html#cb840-56" tabindex="-1"></a>      })<span class="op">;</span></span>
<span id="cb840-57"><a href="Truffle-Web3.html#cb840-57" tabindex="-1"></a>      <span class="kw">let</span> newWorkflowStatus <span class="op">=</span> <span class="cf">await</span> simpleVotingInstance<span class="op">.</span><span class="fu">getWorkflowStatus</span>()<span class="op">;</span></span>
<span id="cb840-58"><a href="Truffle-Web3.html#cb840-58" tabindex="-1"></a>      <span class="kw">let</span> newExpectedWorkflowStatus <span class="op">=</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb840-59"><a href="Truffle-Web3.html#cb840-59" tabindex="-1"></a>      <span class="co">// Assert</span></span>
<span id="cb840-60"><a href="Truffle-Web3.html#cb840-60" tabindex="-1"></a>      assert<span class="op">.</span><span class="fu">equal</span>(</span>
<span id="cb840-61"><a href="Truffle-Web3.html#cb840-61" tabindex="-1"></a>        newWorkflowStatus<span class="op">.</span><span class="fu">valueOf</span>()<span class="op">,</span></span>
<span id="cb840-62"><a href="Truffle-Web3.html#cb840-62" tabindex="-1"></a>        newExpectedWorkflowStatus<span class="op">,</span></span>
<span id="cb840-63"><a href="Truffle-Web3.html#cb840-63" tabindex="-1"></a>        <span class="st">&quot;status does not correspond to proposals registration session ended&quot;</span></span>
<span id="cb840-64"><a href="Truffle-Web3.html#cb840-64" tabindex="-1"></a>      )<span class="op">;</span></span>
<span id="cb840-65"><a href="Truffle-Web3.html#cb840-65" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb840-66"><a href="Truffle-Web3.html#cb840-66" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb840-67"><a href="Truffle-Web3.html#cb840-67" tabindex="-1"></a>})<span class="op">;</span></span></code></pre></div>
<p>Za zagon testov enot lahko zopet uporabimo ogrodje <code>truffle</code>, kjer lahko po izvedbi testov opazimo, da so se vsi testi izvedli uspešno na privatni verigi blokov Ganache.</p>
<div class="sourceCode" id="cb841"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb841-1"><a href="Truffle-Web3.html#cb841-1" tabindex="-1"></a><span class="ex">$</span> cd dapp</span>
<span id="cb841-2"><a href="Truffle-Web3.html#cb841-2" tabindex="-1"></a><span class="ex">$</span> truffle test</span>
<span id="cb841-3"><a href="Truffle-Web3.html#cb841-3" tabindex="-1"></a></span>
<span id="cb841-4"><a href="Truffle-Web3.html#cb841-4" tabindex="-1"></a><span class="ex">Using</span> network <span class="st">&#39;development&#39;</span>.</span>
<span id="cb841-5"><a href="Truffle-Web3.html#cb841-5" tabindex="-1"></a></span>
<span id="cb841-6"><a href="Truffle-Web3.html#cb841-6" tabindex="-1"></a><span class="ex">Compiling</span> your contracts...</span>
<span id="cb841-7"><a href="Truffle-Web3.html#cb841-7" tabindex="-1"></a><span class="ex">===========================</span></span>
<span id="cb841-8"><a href="Truffle-Web3.html#cb841-8" tabindex="-1"></a><span class="op">&gt;</span> Everything <span class="ex">is</span> up to date, there is nothing to compile.</span>
<span id="cb841-9"><a href="Truffle-Web3.html#cb841-9" tabindex="-1"></a></span>
<span id="cb841-10"><a href="Truffle-Web3.html#cb841-10" tabindex="-1"></a>  <span class="ex">Contract:</span> SimpleVoting</span>
<span id="cb841-11"><a href="Truffle-Web3.html#cb841-11" tabindex="-1"></a>    <span class="ex">Contract:</span> SimpleVoting.endProposalRegistration</span>
<span id="cb841-12"><a href="Truffle-Web3.html#cb841-12" tabindex="-1"></a>      <span class="ex">✔</span> onlyAdministrator modifier <span class="er">(</span><span class="ex">105ms</span><span class="kw">)</span></span>
<span id="cb841-13"><a href="Truffle-Web3.html#cb841-13" tabindex="-1"></a>      <span class="ex">✔</span> onlyDuringProposalsRegistration modifier</span>
<span id="cb841-14"><a href="Truffle-Web3.html#cb841-14" tabindex="-1"></a>      <span class="ex">✔</span> successful <span class="er">(</span><span class="ex">48ms</span><span class="kw">)</span></span>
<span id="cb841-15"><a href="Truffle-Web3.html#cb841-15" tabindex="-1"></a></span>
<span id="cb841-16"><a href="Truffle-Web3.html#cb841-16" tabindex="-1"></a>  <span class="ex">3</span> passing <span class="er">(</span><span class="ex">230ms</span><span class="kw">)</span></span></code></pre></div>
<script>
  $(document).ready(function() {
    $("#testi-enot code:eq(2)").markRegExp(/.+/, options_dodaj);
    $("#testi-enot code.javascript:eq(0)").markRegExp(/.+/, options_dodaj);
    $("#testi-enot code.bash:eq(0)").markRegExp(/(cd|truffle).+/, options_dodaj);
  });
</script>
</div>
</div>
<div id="uporabniški-vmesnik" class="section level2 hasAnchor" number="13.2">
<h2><span class="header-section-number">13.2</span> Uporabniški vmesnik<a href="Truffle-Web3.html#uporabniški-vmesnik" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Uporabniški vmesnik aplikacije za glasovanje bo sestavljen iz dveh delov, in sicer za:</p>
<ul>
<li><i class="fa-solid fa-user-gear"></i><strong>skrbnika glasovanja</strong> in</li>
<li><i class="fa-solid fa-user-plus"></i><strong>registrirane volivce</strong>.</li>
</ul>
<p>Aplikacijo bomo razvijali kar kot nadgradnjo obstoječe Angular aplikacije v mapi <code>angular</code>.</p>
<div id="priprava-odvisnosti" class="section level3 hasAnchor" number="13.2.1">
<h3><span class="header-section-number">13.2.1</span> Priprava odvisnosti<a href="Truffle-Web3.html#priprava-odvisnosti" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Za izdelavo uporabniškega vmesnika v obliki spletne aplikacije, ki bo komunicirala s pametno pogodbo, bomo potrebovali knjižnico <a href="https://www.npmjs.com/package/web3"><i class="fa-solid fa-earth-europe"></i><code>web3</code></a>. Omenjena knjižnica <a href="https://docs.web3js.org/"><i class="fa-solid fa-earth-europe"></i><strong>Web3.js</strong></a> je JavaScript API za dostop do verige blokov Ethereum, vključno za interakcijo s pametnimi pogodbami.</p>
<blockquote>
<p><strong>Opomba</strong>: Uporabljali bomo trenutno zadnjo verzijo, ki je na voljo, in sicer <code>4.3.0</code>.</p>
</blockquote>
<div class="sourceCode" id="cb842"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb842-1"><a href="Truffle-Web3.html#cb842-1" tabindex="-1"></a><span class="ex">$</span> cd angular</span>
<span id="cb842-2"><a href="Truffle-Web3.html#cb842-2" tabindex="-1"></a><span class="ex">$</span> npm install web3</span></code></pre></div>
<p>Če želimo poklicati pametno pogodbo <code>Simplevoting</code> iz spletnega uporabniškega vmesnika, se moramo sklicevati na njen <a href="https://en.wikipedia.org/wiki/Application_binary_interface"><i class="fa-brands fa-wikipedia-w"></i><strong>ABI</strong></a>, kar smo v procesu prevajanja že kreirali, in sicer je na voljo v datoteki <code>dapp/build/contracts/SimpleVoting.json</code>.</p>
<blockquote>
<p><strong>Opomba</strong>: <strong>ABI</strong> <em>(angl. <a href="https://docs.soliditylang.org/en/v0.8.23/abi-spec.html"><i class="fa-solid fa-earth-europe"></i>Application Binary Interface</a>)</em> je standardni način za interakcijo s pogodbami v ekosistemu Ethereum, in sicer izven verige blokov, kot tudi za interakcijo med pogodbami.</p>
</blockquote>
<p>Obstoječo Express aplikacijo bomo dopolnili do te mere, da bomo postregli statično vsebino v mapi <code>dapp/build/contracts</code> na naslovu <code>/ABI</code>.</p>
<div class="sourceCode" id="cb843"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb843-1"><a href="Truffle-Web3.html#cb843-1" tabindex="-1"></a><span class="co">/**</span></span>
<span id="cb843-2"><a href="Truffle-Web3.html#cb843-2" tabindex="-1"></a><span class="co"> * Static pages</span></span>
<span id="cb843-3"><a href="Truffle-Web3.html#cb843-3" tabindex="-1"></a><span class="co"> */</span></span>
<span id="cb843-4"><a href="Truffle-Web3.html#cb843-4" tabindex="-1"></a>app<span class="op">.</span><span class="fu">use</span>(<span class="st">&quot;/ABI&quot;</span><span class="op">,</span> express<span class="op">.</span><span class="fu">static</span>(path<span class="op">.</span><span class="fu">join</span>(<span class="bu">__dirname</span><span class="op">,</span> <span class="st">&quot;dapp&quot;</span><span class="op">,</span> <span class="st">&quot;build&quot;</span><span class="op">,</span> <span class="st">&quot;contracts&quot;</span>)))<span class="op">;</span></span>
<span id="cb843-5"><a href="Truffle-Web3.html#cb843-5" tabindex="-1"></a>app<span class="op">.</span><span class="fu">use</span>(express<span class="op">.</span><span class="fu">static</span>(path<span class="op">.</span><span class="fu">join</span>(<span class="bu">__dirname</span><span class="op">,</span> <span class="st">&quot;angular&quot;</span><span class="op">,</span> <span class="st">&quot;build&quot;</span>)))<span class="op">;</span></span></code></pre></div>
<script>
  $(document).ready(function() {
    $("#priprava-odvisnosti code.bash:eq(0)").markRegExp(/cd angular|npm install.*/, options_dodaj);
    $("#priprava-odvisnosti code.javascript:eq(0)").markRegExp(/app\.use\("\/ABI.+?\).+/, options_dodaj);
  });
</script>
</div>
<div id="spletna-stran" class="section level3 hasAnchor" number="13.2.2">
<h3><span class="header-section-number">13.2.2</span> Spletna stran<a href="Truffle-Web3.html#spletna-stran" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Spletna stran (glej sliko <a href="Truffle-Web3.html#fig:slika-Glasovanje-spletna-stran">13.4</a>), ki nam bo omogočala komunikacijo z verigo blokov, združuje funkcionalnosti za vse vrste uporabnikov, in sicer:</p>
<ul>
<li><i class="fa-solid fa-user"></i><strong>neregistriranega volivca</strong>, ki lahko pregleduje status glasovanja, seznam predlogov in rezultat glasovanja,</li>
<li><i class="fa-solid fa-user-plus"></i><strong>registriranega volivca</strong>, ki so mu na voljo vse funkcionalnosti neregistriranega volivca in še oddaja predloga za glasovanje ter oddaja glasu v okviru glasovanja in</li>
<li><i class="fa-solid fa-user-gear"></i><strong>skrbnika volitev</strong>, ki mu je na voljo registracija volivcev, sprememba statusa sprejemanja predlogov in sprememba statusa glasovanja ter štetje glasov in objava rezultatov glasovanja.</li>
</ul>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:slika-Glasovanje-spletna-stran"></span>
<img src="assets/img/Glasovanje_spletna_stran.png" alt="Spletna stran, ki nam omogoča komunikacijo z verigo blokov." width="800" />
<p class="caption">
Slika 13.4: Spletna stran, ki nam omogoča komunikacijo z verigo blokov.
</p>
</div>
</div>
<div id="web3-aplikacija-kot-angular-komponenta" class="section level3 hasAnchor" number="13.2.3">
<h3><span class="header-section-number">13.2.3</span> Web3 aplikacija kot Angular komponenta<a href="Truffle-Web3.html#web3-aplikacija-kot-angular-komponenta" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Web3 aplikacijo bomo razvili kot <strong>novo komponento <code>vote</code></strong> obstoječe Angular aplikacije.</p>
<div class="sourceCode" id="cb844"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb844-1"><a href="Truffle-Web3.html#cb844-1" tabindex="-1"></a><span class="ex">$</span> ng generate component shared/component/vote</span>
<span id="cb844-2"><a href="Truffle-Web3.html#cb844-2" tabindex="-1"></a><span class="ex">CREATE</span> src/app/shared/components/vote/vote.component.ts <span class="er">(</span><span class="ex">186</span> bytes<span class="kw">)</span></span>
<span id="cb844-3"><a href="Truffle-Web3.html#cb844-3" tabindex="-1"></a><span class="ex">UPDATE</span> src/app/app.module.ts <span class="er">(</span><span class="ex">2474</span> bytes<span class="kw">)</span></span></code></pre></div>
<p><strong>Dopolnimo</strong> tudi <strong>usmerjevalno tabelo</strong>, kjer naj bo funkcionalnost glasovanja Web3 aplikacije na voljo na <code>/vote</code>.</p>
<p><code>angular/src/app/modules/app-routing/app-routing.module.ts</code></p>
<div class="sourceCode" id="cb845"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb845-1"><a href="Truffle-Web3.html#cb845-1" tabindex="-1"></a><span class="im">import</span> { LoginComponent } <span class="im">from</span> <span class="st">&quot;src/app/shared/components/login/login.component&quot;</span><span class="op">;</span></span>
<span id="cb845-2"><a href="Truffle-Web3.html#cb845-2" tabindex="-1"></a><span class="im">import</span> { VoteComponent } <span class="im">from</span> <span class="st">&quot;src/app/shared/components/vote/vote.component&quot;</span><span class="op">;</span></span>
<span id="cb845-3"><a href="Truffle-Web3.html#cb845-3" tabindex="-1"></a></span>
<span id="cb845-4"><a href="Truffle-Web3.html#cb845-4" tabindex="-1"></a><span class="kw">const</span> routes<span class="op">:</span> Routes <span class="op">=</span> [</span>
<span id="cb845-5"><a href="Truffle-Web3.html#cb845-5" tabindex="-1"></a>  <span class="op">...,</span></span>
<span id="cb845-6"><a href="Truffle-Web3.html#cb845-6" tabindex="-1"></a>  { <span class="dt">path</span><span class="op">:</span> <span class="st">&quot;login&quot;</span><span class="op">,</span> <span class="dt">component</span><span class="op">:</span> LoginComponent }<span class="op">,</span></span>
<span id="cb845-7"><a href="Truffle-Web3.html#cb845-7" tabindex="-1"></a>  { <span class="dt">path</span><span class="op">:</span> <span class="st">&quot;vote&quot;</span><span class="op">,</span> <span class="dt">component</span><span class="op">:</span> VoteComponent }<span class="op">,</span></span>
<span id="cb845-8"><a href="Truffle-Web3.html#cb845-8" tabindex="-1"></a>]<span class="op">;</span></span></code></pre></div>
<p>Za komunikacijo z verigo blokov pripravimo <strong>novo storitev <code>web3</code></strong>, ki jo tudi vključimo v komponento <code>vote</code>.</p>
<div class="sourceCode" id="cb846"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb846-1"><a href="Truffle-Web3.html#cb846-1" tabindex="-1"></a><span class="ex">$</span> ng generate service shared/services/web3</span>
<span id="cb846-2"><a href="Truffle-Web3.html#cb846-2" tabindex="-1"></a><span class="ex">CREATE</span> src/app/shared/services/web3.service.ts <span class="er">(</span><span class="ex">133</span> bytes<span class="kw">)</span></span></code></pre></div>
<p><code>angular/src/app/shared/components/vote/vote.component.ts</code></p>
<div class="sourceCode" id="cb847"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb847-1"><a href="Truffle-Web3.html#cb847-1" tabindex="-1"></a><span class="im">import</span> { Component<span class="op">,</span> OnInit } <span class="im">from</span> <span class="st">&quot;@angular/core&quot;</span><span class="op">;</span></span>
<span id="cb847-2"><a href="Truffle-Web3.html#cb847-2" tabindex="-1"></a><span class="im">import</span> { Web3Service } <span class="im">from</span> <span class="st">&quot;../../services/web3.service&quot;</span><span class="op">;</span></span>
<span id="cb847-3"><a href="Truffle-Web3.html#cb847-3" tabindex="-1"></a></span>
<span id="cb847-4"><a href="Truffle-Web3.html#cb847-4" tabindex="-1"></a>@<span class="fu">Component</span>({</span>
<span id="cb847-5"><a href="Truffle-Web3.html#cb847-5" tabindex="-1"></a>  <span class="dt">selector</span><span class="op">:</span> <span class="st">&quot;app-vote&quot;</span><span class="op">,</span></span>
<span id="cb847-6"><a href="Truffle-Web3.html#cb847-6" tabindex="-1"></a>  <span class="dt">template</span><span class="op">:</span> <span class="vs">`&lt;p&gt;vote works!&lt;/p&gt;`</span><span class="op">,</span></span>
<span id="cb847-7"><a href="Truffle-Web3.html#cb847-7" tabindex="-1"></a>  <span class="dt">styles</span><span class="op">:</span> []<span class="op">,</span></span>
<span id="cb847-8"><a href="Truffle-Web3.html#cb847-8" tabindex="-1"></a>})</span>
<span id="cb847-9"><a href="Truffle-Web3.html#cb847-9" tabindex="-1"></a><span class="im">export</span> <span class="kw">class</span> VoteComponent {</span>
<span id="cb847-10"><a href="Truffle-Web3.html#cb847-10" tabindex="-1"></a>  <span class="fu">constructor</span>(<span class="kw">public</span> <span class="dt">web3Service</span><span class="op">:</span> Web3Service) {}</span>
<span id="cb847-11"><a href="Truffle-Web3.html#cb847-11" tabindex="-1"></a>}</span></code></pre></div>
<script>
  $(document).ready(function() {
    $("#web3-aplikacija-kot-angular-komponenta code.bash:eq(0)").markRegExp(/ng.*/, options_dodaj);
    $("#web3-aplikacija-kot-angular-komponenta code.bash:eq(1)").markRegExp(/ng.*/, options_dodaj);
    $("#web3-aplikacija-kot-angular-komponenta code.javascript:eq(0)").markRegExp(/.+?VoteComponent.+/, options_dodaj);
    $("#web3-aplikacija-kot-angular-komponenta code.javascript:eq(1)").markRegExp(/import { Web3Service }.+/, options_dodaj);
    $("#web3-aplikacija-kot-angular-komponenta code.javascript:eq(1)").markRegExp(/constructor.+/, options_dodaj);
  });
</script>
</div>
<div id="opredelitev-izgleda" class="section level3 hasAnchor" number="13.2.4">
<h3><span class="header-section-number">13.2.4</span> Opredelitev izgleda<a href="Truffle-Web3.html#opredelitev-izgleda" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Izgled spletne strani bo opredeljen v okviru komponente <code>vote</code>, kjer bomo uporabili Bootstrap gradnike ter sledili že postavljenemu enotneu izgledu obstoječe Angular aplikacije. Kot prikazuje slika <a href="Truffle-Web3.html#fig:slika-Glasovanje-spletna-stran">13.4</a>, bomo prikazali vse korake, ki nastopajo pri glasovanju in vse povezane aktivnosti, ki so na voljo.</p>
<p>Izgled bomo opredelili v ločeni datoteki <code>vote.component.html</code>.</p>
<p><code>angular/src/app/shared/components/vote/vote.component.ts</code></p>
<div class="sourceCode" id="cb848"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb848-1"><a href="Truffle-Web3.html#cb848-1" tabindex="-1"></a>@<span class="fu">Component</span>({</span>
<span id="cb848-2"><a href="Truffle-Web3.html#cb848-2" tabindex="-1"></a>  <span class="dt">selector</span><span class="op">:</span> <span class="st">&quot;app-vote&quot;</span><span class="op">,</span></span>
<span id="cb848-3"><a href="Truffle-Web3.html#cb848-3" tabindex="-1"></a>  <span class="dt">template</span><span class="op">:</span> <span class="vs">`&lt;p&gt;vote works!&lt;/p&gt;`</span><span class="op">,</span></span>
<span id="cb848-4"><a href="Truffle-Web3.html#cb848-4" tabindex="-1"></a>  <span class="dt">templateUrl</span><span class="op">:</span> <span class="st">&quot;./vote.component.html&quot;</span><span class="op">,</span></span>
<span id="cb848-5"><a href="Truffle-Web3.html#cb848-5" tabindex="-1"></a>  <span class="dt">styles</span><span class="op">:</span> []<span class="op">,</span></span>
<span id="cb848-6"><a href="Truffle-Web3.html#cb848-6" tabindex="-1"></a>})</span></code></pre></div>
<p><code>angular/src/app/shared/components/vote/vote.component.html</code></p>
<div class="sourceCode" id="cb849"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb849-1"><a href="Truffle-Web3.html#cb849-1" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">h1</span><span class="dt">&gt;</span>Vote for the best new hidden location<span class="dt">&lt;/</span><span class="kw">h1</span><span class="dt">&gt;</span></span>
<span id="cb849-2"><a href="Truffle-Web3.html#cb849-2" tabindex="-1"></a></span>
<span id="cb849-3"><a href="Truffle-Web3.html#cb849-3" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;row row-cols-2 mt-4&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-4"><a href="Truffle-Web3.html#cb849-4" tabindex="-1"></a>  <span class="co">&lt;!-- START: User&#39;s role --&gt;</span></span>
<span id="cb849-5"><a href="Truffle-Web3.html#cb849-5" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;col-3&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-6"><a href="Truffle-Web3.html#cb849-6" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card h-100&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-7"><a href="Truffle-Web3.html#cb849-7" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card-header bg-light&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-8"><a href="Truffle-Web3.html#cb849-8" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">h4</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;mb-0&quot;</span><span class="dt">&gt;</span>User&#39;s role<span class="dt">&lt;/</span><span class="kw">h4</span><span class="dt">&gt;</span></span>
<span id="cb849-9"><a href="Truffle-Web3.html#cb849-9" tabindex="-1"></a>      <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb849-10"><a href="Truffle-Web3.html#cb849-10" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card-body&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-11"><a href="Truffle-Web3.html#cb849-11" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">div</span></span>
<span id="cb849-12"><a href="Truffle-Web3.html#cb849-12" tabindex="-1"></a><span class="ot">          *ngFor</span><span class="op">=</span><span class="st">&quot;</span></span>
<span id="cb849-13"><a href="Truffle-Web3.html#cb849-13" tabindex="-1"></a><span class="st">            let userType of [</span></span>
<span id="cb849-14"><a href="Truffle-Web3.html#cb849-14" tabindex="-1"></a><span class="st">              { type: &#39;Anonymous user&#39;, icon: &#39;fa-regular fa-user&#39; },</span></span>
<span id="cb849-15"><a href="Truffle-Web3.html#cb849-15" tabindex="-1"></a><span class="st">              { type: &#39;Unregistered voter&#39;, icon: &#39;fa-solid fa-user&#39; },</span></span>
<span id="cb849-16"><a href="Truffle-Web3.html#cb849-16" tabindex="-1"></a><span class="st">              { type: &#39;Registered voter&#39;, icon: &#39;fa-solid fa-user-plus&#39; },</span></span>
<span id="cb849-17"><a href="Truffle-Web3.html#cb849-17" tabindex="-1"></a><span class="st">              { type: &#39;Administrator&#39;, icon: &#39;fa-solid fa-user-gear&#39; }</span></span>
<span id="cb849-18"><a href="Truffle-Web3.html#cb849-18" tabindex="-1"></a><span class="st">            ];</span></span>
<span id="cb849-19"><a href="Truffle-Web3.html#cb849-19" tabindex="-1"></a><span class="st">            let i = index</span></span>
<span id="cb849-20"><a href="Truffle-Web3.html#cb849-20" tabindex="-1"></a><span class="st">          &quot;</span></span>
<span id="cb849-21"><a href="Truffle-Web3.html#cb849-21" tabindex="-1"></a><span class="ot">        </span><span class="dt">&gt;</span></span>
<span id="cb849-22"><a href="Truffle-Web3.html#cb849-22" tabindex="-1"></a>          <span class="dt">&lt;</span><span class="kw">span</span></span>
<span id="cb849-23"><a href="Truffle-Web3.html#cb849-23" tabindex="-1"></a><span class="ot">            </span><span class="dt">&gt;&lt;</span><span class="kw">i</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;{{ userType.icon }} pe-2&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">i</span><span class="dt">&gt;</span>{{ userType.type }}<span class="dt">&lt;/</span><span class="kw">span</span></span>
<span id="cb849-24"><a href="Truffle-Web3.html#cb849-24" tabindex="-1"></a>          <span class="dt">&gt;</span></span>
<span id="cb849-25"><a href="Truffle-Web3.html#cb849-25" tabindex="-1"></a>        <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb849-26"><a href="Truffle-Web3.html#cb849-26" tabindex="-1"></a>      <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb849-27"><a href="Truffle-Web3.html#cb849-27" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card-footer small text-muted&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-28"><a href="Truffle-Web3.html#cb849-28" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">i</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;fa-solid fa-circle-info pe-1&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">i</span><span class="dt">&gt;</span>The role of current user,</span>
<span id="cb849-29"><a href="Truffle-Web3.html#cb849-29" tabindex="-1"></a>        connected to MetaMask wallet.</span>
<span id="cb849-30"><a href="Truffle-Web3.html#cb849-30" tabindex="-1"></a>      <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb849-31"><a href="Truffle-Web3.html#cb849-31" tabindex="-1"></a>    <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb849-32"><a href="Truffle-Web3.html#cb849-32" tabindex="-1"></a>  <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb849-33"><a href="Truffle-Web3.html#cb849-33" tabindex="-1"></a>  <span class="co">&lt;!-- </span><span class="re">END</span><span class="co">: User&#39;s role --&gt;</span></span>
<span id="cb849-34"><a href="Truffle-Web3.html#cb849-34" tabindex="-1"></a></span>
<span id="cb849-35"><a href="Truffle-Web3.html#cb849-35" tabindex="-1"></a>  <span class="co">&lt;!-- START: Current voting status --&gt;</span></span>
<span id="cb849-36"><a href="Truffle-Web3.html#cb849-36" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;col-9&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-37"><a href="Truffle-Web3.html#cb849-37" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card h-100&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-38"><a href="Truffle-Web3.html#cb849-38" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card-header bg-light&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-39"><a href="Truffle-Web3.html#cb849-39" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">h4</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;mb-0&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-40"><a href="Truffle-Web3.html#cb849-40" tabindex="-1"></a>          Current voting status<span class="dt">&lt;</span><span class="kw">sup</span></span>
<span id="cb849-41"><a href="Truffle-Web3.html#cb849-41" tabindex="-1"></a><span class="ot">            </span><span class="dt">&gt;&lt;</span><span class="kw">small</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;text-muted&quot;</span></span>
<span id="cb849-42"><a href="Truffle-Web3.html#cb849-42" tabindex="-1"></a><span class="ot">              </span><span class="dt">&gt;&lt;</span><span class="kw">i</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;fa-solid fa-user ps-2 pe-1&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">i</span><span class="dt">&gt;&lt;/</span><span class="kw">small</span></span>
<span id="cb849-43"><a href="Truffle-Web3.html#cb849-43" tabindex="-1"></a>          <span class="dt">&gt;&lt;/</span><span class="kw">sup</span><span class="dt">&gt;</span></span>
<span id="cb849-44"><a href="Truffle-Web3.html#cb849-44" tabindex="-1"></a>        <span class="dt">&lt;/</span><span class="kw">h4</span><span class="dt">&gt;</span></span>
<span id="cb849-45"><a href="Truffle-Web3.html#cb849-45" tabindex="-1"></a>      <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb849-46"><a href="Truffle-Web3.html#cb849-46" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card-body&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-47"><a href="Truffle-Web3.html#cb849-47" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;d-flex justify-content-between&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-48"><a href="Truffle-Web3.html#cb849-48" tabindex="-1"></a>          <span class="dt">&lt;</span><span class="kw">div</span></span>
<span id="cb849-49"><a href="Truffle-Web3.html#cb849-49" tabindex="-1"></a><span class="ot">            class</span><span class="op">=</span><span class="st">&quot;justify-content-center text-center&quot;</span></span>
<span id="cb849-50"><a href="Truffle-Web3.html#cb849-50" tabindex="-1"></a><span class="ot">            *ngFor</span><span class="op">=</span><span class="st">&quot;</span></span>
<span id="cb849-51"><a href="Truffle-Web3.html#cb849-51" tabindex="-1"></a><span class="st">              let status of [</span></span>
<span id="cb849-52"><a href="Truffle-Web3.html#cb849-52" tabindex="-1"></a><span class="st">                &#39;Not available&#39;,</span></span>
<span id="cb849-53"><a href="Truffle-Web3.html#cb849-53" tabindex="-1"></a><span class="st">                &#39;Registering voters&#39;,</span></span>
<span id="cb849-54"><a href="Truffle-Web3.html#cb849-54" tabindex="-1"></a><span class="st">                &#39;Proposal registration started&#39;,</span></span>
<span id="cb849-55"><a href="Truffle-Web3.html#cb849-55" tabindex="-1"></a><span class="st">                &#39;Proposal registration ended&#39;,</span></span>
<span id="cb849-56"><a href="Truffle-Web3.html#cb849-56" tabindex="-1"></a><span class="st">                &#39;Voting started&#39;,</span></span>
<span id="cb849-57"><a href="Truffle-Web3.html#cb849-57" tabindex="-1"></a><span class="st">                &#39;Voting ended&#39;,</span></span>
<span id="cb849-58"><a href="Truffle-Web3.html#cb849-58" tabindex="-1"></a><span class="st">                &#39;Votes tallied&#39;</span></span>
<span id="cb849-59"><a href="Truffle-Web3.html#cb849-59" tabindex="-1"></a><span class="st">              ];</span></span>
<span id="cb849-60"><a href="Truffle-Web3.html#cb849-60" tabindex="-1"></a><span class="st">              let i = index</span></span>
<span id="cb849-61"><a href="Truffle-Web3.html#cb849-61" tabindex="-1"></a><span class="st">            &quot;</span></span>
<span id="cb849-62"><a href="Truffle-Web3.html#cb849-62" tabindex="-1"></a><span class="ot">          </span><span class="dt">&gt;</span></span>
<span id="cb849-63"><a href="Truffle-Web3.html#cb849-63" tabindex="-1"></a>            <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;badge rounded-circle bg-light text-muted ps-2 pe-2&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-64"><a href="Truffle-Web3.html#cb849-64" tabindex="-1"></a>              {{ i }}</span>
<span id="cb849-65"><a href="Truffle-Web3.html#cb849-65" tabindex="-1"></a>            <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb849-66"><a href="Truffle-Web3.html#cb849-66" tabindex="-1"></a>            <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;m-2&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-67"><a href="Truffle-Web3.html#cb849-67" tabindex="-1"></a>              {{ status }}</span>
<span id="cb849-68"><a href="Truffle-Web3.html#cb849-68" tabindex="-1"></a>            <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb849-69"><a href="Truffle-Web3.html#cb849-69" tabindex="-1"></a>          <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb849-70"><a href="Truffle-Web3.html#cb849-70" tabindex="-1"></a>        <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb849-71"><a href="Truffle-Web3.html#cb849-71" tabindex="-1"></a>      <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb849-72"><a href="Truffle-Web3.html#cb849-72" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card-footer small text-muted&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-73"><a href="Truffle-Web3.html#cb849-73" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">i</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;fa-solid fa-circle-info pe-1&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">i</span><span class="dt">&gt;</span>The current voting status,</span>
<span id="cb849-74"><a href="Truffle-Web3.html#cb849-74" tabindex="-1"></a>        available to all users.</span>
<span id="cb849-75"><a href="Truffle-Web3.html#cb849-75" tabindex="-1"></a>      <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb849-76"><a href="Truffle-Web3.html#cb849-76" tabindex="-1"></a>    <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb849-77"><a href="Truffle-Web3.html#cb849-77" tabindex="-1"></a>  <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb849-78"><a href="Truffle-Web3.html#cb849-78" tabindex="-1"></a>  <span class="co">&lt;!-- </span><span class="re">END</span><span class="co">: Current voting status --&gt;</span></span>
<span id="cb849-79"><a href="Truffle-Web3.html#cb849-79" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb849-80"><a href="Truffle-Web3.html#cb849-80" tabindex="-1"></a></span>
<span id="cb849-81"><a href="Truffle-Web3.html#cb849-81" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;row mt-4&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-82"><a href="Truffle-Web3.html#cb849-82" tabindex="-1"></a>  <span class="co">&lt;!-- START: Registrering voters --&gt;</span></span>
<span id="cb849-83"><a href="Truffle-Web3.html#cb849-83" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;col&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-84"><a href="Truffle-Web3.html#cb849-84" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-85"><a href="Truffle-Web3.html#cb849-85" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card-header bg-light&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-86"><a href="Truffle-Web3.html#cb849-86" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">h4</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;mb-0&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-87"><a href="Truffle-Web3.html#cb849-87" tabindex="-1"></a>          Registering voters<span class="dt">&lt;</span><span class="kw">sup</span></span>
<span id="cb849-88"><a href="Truffle-Web3.html#cb849-88" tabindex="-1"></a><span class="ot">            </span><span class="dt">&gt;&lt;</span><span class="kw">small</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;text-muted&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-89"><a href="Truffle-Web3.html#cb849-89" tabindex="-1"></a>              <span class="dt">&lt;</span><span class="kw">i</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;fa-solid fa-user-gear ps-2 pe-1&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">i</span><span class="dt">&gt;&lt;/</span><span class="kw">small</span></span>
<span id="cb849-90"><a href="Truffle-Web3.html#cb849-90" tabindex="-1"></a>          <span class="dt">&gt;&lt;/</span><span class="kw">sup</span><span class="dt">&gt;</span></span>
<span id="cb849-91"><a href="Truffle-Web3.html#cb849-91" tabindex="-1"></a>        <span class="dt">&lt;/</span><span class="kw">h4</span><span class="dt">&gt;</span></span>
<span id="cb849-92"><a href="Truffle-Web3.html#cb849-92" tabindex="-1"></a>      <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb849-93"><a href="Truffle-Web3.html#cb849-93" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card-body&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-94"><a href="Truffle-Web3.html#cb849-94" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;mb-3&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-95"><a href="Truffle-Web3.html#cb849-95" tabindex="-1"></a>          <span class="dt">&lt;</span><span class="kw">label</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;form-label&quot;</span><span class="dt">&gt;</span>Address of the voter&#39;s account<span class="dt">&lt;/</span><span class="kw">label</span><span class="dt">&gt;</span></span>
<span id="cb849-96"><a href="Truffle-Web3.html#cb849-96" tabindex="-1"></a>          <span class="dt">&lt;</span><span class="kw">input</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;text&quot;</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;form-control form-control-sm&quot;</span><span class="ot"> </span><span class="dt">/&gt;</span></span>
<span id="cb849-97"><a href="Truffle-Web3.html#cb849-97" tabindex="-1"></a>        <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb849-98"><a href="Truffle-Web3.html#cb849-98" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">button</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;btn btn-sm btn-primary&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-99"><a href="Truffle-Web3.html#cb849-99" tabindex="-1"></a>          <span class="dt">&lt;</span><span class="kw">i</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;fa-solid fa-plus me-2&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">i</span><span class="dt">&gt;</span>Register</span>
<span id="cb849-100"><a href="Truffle-Web3.html#cb849-100" tabindex="-1"></a>        <span class="dt">&lt;/</span><span class="kw">button</span><span class="dt">&gt;</span></span>
<span id="cb849-101"><a href="Truffle-Web3.html#cb849-101" tabindex="-1"></a>      <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb849-102"><a href="Truffle-Web3.html#cb849-102" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card-footer small text-muted&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-103"><a href="Truffle-Web3.html#cb849-103" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">i</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;fa-solid fa-circle-info pe-1&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">i</span><span class="dt">&gt;</span>The administrator registers a new</span>
<span id="cb849-104"><a href="Truffle-Web3.html#cb849-104" tabindex="-1"></a>        voter.</span>
<span id="cb849-105"><a href="Truffle-Web3.html#cb849-105" tabindex="-1"></a>      <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb849-106"><a href="Truffle-Web3.html#cb849-106" tabindex="-1"></a>    <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb849-107"><a href="Truffle-Web3.html#cb849-107" tabindex="-1"></a>  <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb849-108"><a href="Truffle-Web3.html#cb849-108" tabindex="-1"></a>  <span class="co">&lt;!-- </span><span class="re">END</span><span class="co">: Registrering voters --&gt;</span></span>
<span id="cb849-109"><a href="Truffle-Web3.html#cb849-109" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb849-110"><a href="Truffle-Web3.html#cb849-110" tabindex="-1"></a></span>
<span id="cb849-111"><a href="Truffle-Web3.html#cb849-111" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;row row-cols-3 mt-4&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-112"><a href="Truffle-Web3.html#cb849-112" tabindex="-1"></a>  <span class="co">&lt;!-- START: Proposal registration --&gt;</span></span>
<span id="cb849-113"><a href="Truffle-Web3.html#cb849-113" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;col&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-114"><a href="Truffle-Web3.html#cb849-114" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card h-100&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-115"><a href="Truffle-Web3.html#cb849-115" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card-header bg-light&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-116"><a href="Truffle-Web3.html#cb849-116" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">h4</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;mb-0&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-117"><a href="Truffle-Web3.html#cb849-117" tabindex="-1"></a>          Proposal registration<span class="dt">&lt;</span><span class="kw">sup</span></span>
<span id="cb849-118"><a href="Truffle-Web3.html#cb849-118" tabindex="-1"></a><span class="ot">            </span><span class="dt">&gt;&lt;</span><span class="kw">small</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;text-muted&quot;</span></span>
<span id="cb849-119"><a href="Truffle-Web3.html#cb849-119" tabindex="-1"></a><span class="ot">              </span><span class="dt">&gt;&lt;</span><span class="kw">i</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;fa-solid fa-user-gear ps-2 pe-1&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">i</span><span class="dt">&gt;&lt;/</span><span class="kw">small</span></span>
<span id="cb849-120"><a href="Truffle-Web3.html#cb849-120" tabindex="-1"></a>          <span class="dt">&gt;&lt;/</span><span class="kw">sup</span><span class="dt">&gt;</span></span>
<span id="cb849-121"><a href="Truffle-Web3.html#cb849-121" tabindex="-1"></a>        <span class="dt">&lt;/</span><span class="kw">h4</span><span class="dt">&gt;</span></span>
<span id="cb849-122"><a href="Truffle-Web3.html#cb849-122" tabindex="-1"></a>      <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb849-123"><a href="Truffle-Web3.html#cb849-123" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card-body&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-124"><a href="Truffle-Web3.html#cb849-124" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">button</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;btn btn-sm btn-primary me-2&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-125"><a href="Truffle-Web3.html#cb849-125" tabindex="-1"></a>          <span class="dt">&lt;</span><span class="kw">i</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;fas fa-play me-2&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">i</span><span class="dt">&gt;</span>Start<span class="dt">&lt;/</span><span class="kw">button</span></span>
<span id="cb849-126"><a href="Truffle-Web3.html#cb849-126" tabindex="-1"></a>        <span class="dt">&gt;&lt;</span><span class="kw">button</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;btn btn-sm btn-primary&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-127"><a href="Truffle-Web3.html#cb849-127" tabindex="-1"></a>          <span class="dt">&lt;</span><span class="kw">i</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;fas fa-stop me-2&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">i</span><span class="dt">&gt;</span>End</span>
<span id="cb849-128"><a href="Truffle-Web3.html#cb849-128" tabindex="-1"></a>        <span class="dt">&lt;/</span><span class="kw">button</span><span class="dt">&gt;</span></span>
<span id="cb849-129"><a href="Truffle-Web3.html#cb849-129" tabindex="-1"></a>      <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb849-130"><a href="Truffle-Web3.html#cb849-130" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card-footer small text-muted&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-131"><a href="Truffle-Web3.html#cb849-131" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">i</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;fa-solid fa-circle-info pe-1&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">i</span><span class="dt">&gt;</span>The administrator starts and ends</span>
<span id="cb849-132"><a href="Truffle-Web3.html#cb849-132" tabindex="-1"></a>        the proposal registration.</span>
<span id="cb849-133"><a href="Truffle-Web3.html#cb849-133" tabindex="-1"></a>      <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb849-134"><a href="Truffle-Web3.html#cb849-134" tabindex="-1"></a>    <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb849-135"><a href="Truffle-Web3.html#cb849-135" tabindex="-1"></a>  <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb849-136"><a href="Truffle-Web3.html#cb849-136" tabindex="-1"></a>  <span class="co">&lt;!-- </span><span class="re">END</span><span class="co">: Proposal registration --&gt;</span></span>
<span id="cb849-137"><a href="Truffle-Web3.html#cb849-137" tabindex="-1"></a></span>
<span id="cb849-138"><a href="Truffle-Web3.html#cb849-138" tabindex="-1"></a>  <span class="co">&lt;!-- START: Submit proposal --&gt;</span></span>
<span id="cb849-139"><a href="Truffle-Web3.html#cb849-139" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;col&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-140"><a href="Truffle-Web3.html#cb849-140" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card h-100&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-141"><a href="Truffle-Web3.html#cb849-141" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card-header bg-light&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-142"><a href="Truffle-Web3.html#cb849-142" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">h4</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;mb-0&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-143"><a href="Truffle-Web3.html#cb849-143" tabindex="-1"></a>          Submit proposal<span class="dt">&lt;</span><span class="kw">sup</span></span>
<span id="cb849-144"><a href="Truffle-Web3.html#cb849-144" tabindex="-1"></a><span class="ot">            </span><span class="dt">&gt;&lt;</span><span class="kw">small</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;text-muted&quot;</span></span>
<span id="cb849-145"><a href="Truffle-Web3.html#cb849-145" tabindex="-1"></a><span class="ot">              </span><span class="dt">&gt;&lt;</span><span class="kw">i</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;fa-solid fa-user-plus ps-2 pe-1&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">i</span><span class="dt">&gt;&lt;/</span><span class="kw">small</span></span>
<span id="cb849-146"><a href="Truffle-Web3.html#cb849-146" tabindex="-1"></a>          <span class="dt">&gt;&lt;/</span><span class="kw">sup</span><span class="dt">&gt;</span></span>
<span id="cb849-147"><a href="Truffle-Web3.html#cb849-147" tabindex="-1"></a>        <span class="dt">&lt;/</span><span class="kw">h4</span><span class="dt">&gt;</span></span>
<span id="cb849-148"><a href="Truffle-Web3.html#cb849-148" tabindex="-1"></a>      <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb849-149"><a href="Truffle-Web3.html#cb849-149" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card-body&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-150"><a href="Truffle-Web3.html#cb849-150" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;mb-3&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-151"><a href="Truffle-Web3.html#cb849-151" tabindex="-1"></a>          <span class="dt">&lt;</span><span class="kw">label</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;form-label&quot;</span><span class="dt">&gt;</span>Proposal description<span class="dt">&lt;/</span><span class="kw">label</span><span class="dt">&gt;</span></span>
<span id="cb849-152"><a href="Truffle-Web3.html#cb849-152" tabindex="-1"></a>          <span class="dt">&lt;</span><span class="kw">input</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;text&quot;</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;form-control form-control-sm&quot;</span><span class="ot"> </span><span class="dt">/&gt;</span></span>
<span id="cb849-153"><a href="Truffle-Web3.html#cb849-153" tabindex="-1"></a>        <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb849-154"><a href="Truffle-Web3.html#cb849-154" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">button</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;btn btn-sm btn-primary&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-155"><a href="Truffle-Web3.html#cb849-155" tabindex="-1"></a>          <span class="dt">&lt;</span><span class="kw">i</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;fa-solid fa-plus me-2&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">i</span><span class="dt">&gt;</span>Submit</span>
<span id="cb849-156"><a href="Truffle-Web3.html#cb849-156" tabindex="-1"></a>        <span class="dt">&lt;/</span><span class="kw">button</span><span class="dt">&gt;</span></span>
<span id="cb849-157"><a href="Truffle-Web3.html#cb849-157" tabindex="-1"></a>      <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb849-158"><a href="Truffle-Web3.html#cb849-158" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card-footer small text-muted&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-159"><a href="Truffle-Web3.html#cb849-159" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">i</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;fa-solid fa-circle-info pe-1&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">i</span><span class="dt">&gt;</span>A registered voter submits a</span>
<span id="cb849-160"><a href="Truffle-Web3.html#cb849-160" tabindex="-1"></a>        proposal for voting.</span>
<span id="cb849-161"><a href="Truffle-Web3.html#cb849-161" tabindex="-1"></a>      <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb849-162"><a href="Truffle-Web3.html#cb849-162" tabindex="-1"></a>    <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb849-163"><a href="Truffle-Web3.html#cb849-163" tabindex="-1"></a>  <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb849-164"><a href="Truffle-Web3.html#cb849-164" tabindex="-1"></a>  <span class="co">&lt;!-- </span><span class="re">END</span><span class="co">: Submit proposal --&gt;</span></span>
<span id="cb849-165"><a href="Truffle-Web3.html#cb849-165" tabindex="-1"></a></span>
<span id="cb849-166"><a href="Truffle-Web3.html#cb849-166" tabindex="-1"></a>  <span class="co">&lt;!-- START: List of proposals --&gt;</span></span>
<span id="cb849-167"><a href="Truffle-Web3.html#cb849-167" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;col&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-168"><a href="Truffle-Web3.html#cb849-168" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card h-100&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-169"><a href="Truffle-Web3.html#cb849-169" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card-header bg-light&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-170"><a href="Truffle-Web3.html#cb849-170" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">h4</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;mb-0&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-171"><a href="Truffle-Web3.html#cb849-171" tabindex="-1"></a>          List of proposals<span class="dt">&lt;</span><span class="kw">sup</span></span>
<span id="cb849-172"><a href="Truffle-Web3.html#cb849-172" tabindex="-1"></a><span class="ot">            </span><span class="dt">&gt;&lt;</span><span class="kw">small</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;text-muted&quot;</span></span>
<span id="cb849-173"><a href="Truffle-Web3.html#cb849-173" tabindex="-1"></a><span class="ot">              </span><span class="dt">&gt;&lt;</span><span class="kw">i</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;fa-solid fa-user ps-2 pe-1&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">i</span><span class="dt">&gt;&lt;/</span><span class="kw">small</span></span>
<span id="cb849-174"><a href="Truffle-Web3.html#cb849-174" tabindex="-1"></a>          <span class="dt">&gt;&lt;/</span><span class="kw">sup</span><span class="dt">&gt;</span></span>
<span id="cb849-175"><a href="Truffle-Web3.html#cb849-175" tabindex="-1"></a>        <span class="dt">&lt;/</span><span class="kw">h4</span><span class="dt">&gt;</span></span>
<span id="cb849-176"><a href="Truffle-Web3.html#cb849-176" tabindex="-1"></a>      <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb849-177"><a href="Truffle-Web3.html#cb849-177" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card-body&quot;</span><span class="dt">&gt;</span>List of proposals is empty.<span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb849-178"><a href="Truffle-Web3.html#cb849-178" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card-footer small text-muted&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-179"><a href="Truffle-Web3.html#cb849-179" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">i</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;fa-solid fa-circle-info pe-1&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">i</span><span class="dt">&gt;</span>List of proposals for voting is</span>
<span id="cb849-180"><a href="Truffle-Web3.html#cb849-180" tabindex="-1"></a>        available to all users.</span>
<span id="cb849-181"><a href="Truffle-Web3.html#cb849-181" tabindex="-1"></a>      <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb849-182"><a href="Truffle-Web3.html#cb849-182" tabindex="-1"></a>    <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb849-183"><a href="Truffle-Web3.html#cb849-183" tabindex="-1"></a>  <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb849-184"><a href="Truffle-Web3.html#cb849-184" tabindex="-1"></a>  <span class="co">&lt;!-- </span><span class="re">END</span><span class="co">: List of proposals --&gt;</span></span>
<span id="cb849-185"><a href="Truffle-Web3.html#cb849-185" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb849-186"><a href="Truffle-Web3.html#cb849-186" tabindex="-1"></a></span>
<span id="cb849-187"><a href="Truffle-Web3.html#cb849-187" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;row row-cols-2 mt-4&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-188"><a href="Truffle-Web3.html#cb849-188" tabindex="-1"></a>  <span class="co">&lt;!-- START: Voting --&gt;</span></span>
<span id="cb849-189"><a href="Truffle-Web3.html#cb849-189" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;col&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-190"><a href="Truffle-Web3.html#cb849-190" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card h-100&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-191"><a href="Truffle-Web3.html#cb849-191" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card-header bg-light&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-192"><a href="Truffle-Web3.html#cb849-192" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">h4</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;mb-0&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-193"><a href="Truffle-Web3.html#cb849-193" tabindex="-1"></a>          Voting<span class="dt">&lt;</span><span class="kw">sup</span></span>
<span id="cb849-194"><a href="Truffle-Web3.html#cb849-194" tabindex="-1"></a><span class="ot">            </span><span class="dt">&gt;&lt;</span><span class="kw">small</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;text-muted&quot;</span></span>
<span id="cb849-195"><a href="Truffle-Web3.html#cb849-195" tabindex="-1"></a><span class="ot">              </span><span class="dt">&gt;&lt;</span><span class="kw">i</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;fa-solid fa-user-gear ps-2 pe-1&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">i</span><span class="dt">&gt;&lt;/</span><span class="kw">small</span></span>
<span id="cb849-196"><a href="Truffle-Web3.html#cb849-196" tabindex="-1"></a>          <span class="dt">&gt;&lt;/</span><span class="kw">sup</span><span class="dt">&gt;</span></span>
<span id="cb849-197"><a href="Truffle-Web3.html#cb849-197" tabindex="-1"></a>        <span class="dt">&lt;/</span><span class="kw">h4</span><span class="dt">&gt;</span></span>
<span id="cb849-198"><a href="Truffle-Web3.html#cb849-198" tabindex="-1"></a>      <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb849-199"><a href="Truffle-Web3.html#cb849-199" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card-body&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-200"><a href="Truffle-Web3.html#cb849-200" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">button</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;btn btn-sm btn-primary me-2&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-201"><a href="Truffle-Web3.html#cb849-201" tabindex="-1"></a>          <span class="dt">&lt;</span><span class="kw">i</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;fas fa-play me-2&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">i</span><span class="dt">&gt;</span>Start<span class="dt">&lt;/</span><span class="kw">button</span></span>
<span id="cb849-202"><a href="Truffle-Web3.html#cb849-202" tabindex="-1"></a>        <span class="dt">&gt;&lt;</span><span class="kw">button</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;btn btn-sm btn-primary&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-203"><a href="Truffle-Web3.html#cb849-203" tabindex="-1"></a>          <span class="dt">&lt;</span><span class="kw">i</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;fas fa-stop me-2&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">i</span><span class="dt">&gt;</span>End</span>
<span id="cb849-204"><a href="Truffle-Web3.html#cb849-204" tabindex="-1"></a>        <span class="dt">&lt;/</span><span class="kw">button</span><span class="dt">&gt;</span></span>
<span id="cb849-205"><a href="Truffle-Web3.html#cb849-205" tabindex="-1"></a>      <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb849-206"><a href="Truffle-Web3.html#cb849-206" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card-footer small text-muted&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-207"><a href="Truffle-Web3.html#cb849-207" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">i</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;fa-solid fa-circle-info pe-1&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">i</span><span class="dt">&gt;</span>The administrator starts and ends</span>
<span id="cb849-208"><a href="Truffle-Web3.html#cb849-208" tabindex="-1"></a>        the voting.</span>
<span id="cb849-209"><a href="Truffle-Web3.html#cb849-209" tabindex="-1"></a>      <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb849-210"><a href="Truffle-Web3.html#cb849-210" tabindex="-1"></a>    <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb849-211"><a href="Truffle-Web3.html#cb849-211" tabindex="-1"></a>  <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb849-212"><a href="Truffle-Web3.html#cb849-212" tabindex="-1"></a>  <span class="co">&lt;!-- </span><span class="re">END</span><span class="co">: Voting --&gt;</span></span>
<span id="cb849-213"><a href="Truffle-Web3.html#cb849-213" tabindex="-1"></a></span>
<span id="cb849-214"><a href="Truffle-Web3.html#cb849-214" tabindex="-1"></a>  <span class="co">&lt;!-- START: Cast vote --&gt;</span></span>
<span id="cb849-215"><a href="Truffle-Web3.html#cb849-215" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;col&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-216"><a href="Truffle-Web3.html#cb849-216" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card h-100&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-217"><a href="Truffle-Web3.html#cb849-217" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card-header bg-light&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-218"><a href="Truffle-Web3.html#cb849-218" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">h4</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;mb-0&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-219"><a href="Truffle-Web3.html#cb849-219" tabindex="-1"></a>          Cast vote<span class="dt">&lt;</span><span class="kw">sup</span></span>
<span id="cb849-220"><a href="Truffle-Web3.html#cb849-220" tabindex="-1"></a><span class="ot">            </span><span class="dt">&gt;&lt;</span><span class="kw">small</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;text-muted&quot;</span></span>
<span id="cb849-221"><a href="Truffle-Web3.html#cb849-221" tabindex="-1"></a><span class="ot">              </span><span class="dt">&gt;&lt;</span><span class="kw">i</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;fa-solid fa-user-plus ps-2 pe-1&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">i</span><span class="dt">&gt;&lt;/</span><span class="kw">small</span></span>
<span id="cb849-222"><a href="Truffle-Web3.html#cb849-222" tabindex="-1"></a>          <span class="dt">&gt;&lt;/</span><span class="kw">sup</span><span class="dt">&gt;</span></span>
<span id="cb849-223"><a href="Truffle-Web3.html#cb849-223" tabindex="-1"></a>        <span class="dt">&lt;/</span><span class="kw">h4</span><span class="dt">&gt;</span></span>
<span id="cb849-224"><a href="Truffle-Web3.html#cb849-224" tabindex="-1"></a>      <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb849-225"><a href="Truffle-Web3.html#cb849-225" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card-body&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-226"><a href="Truffle-Web3.html#cb849-226" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;mb-3&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-227"><a href="Truffle-Web3.html#cb849-227" tabindex="-1"></a>          <span class="dt">&lt;</span><span class="kw">select</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;form-select form-select-sm&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-228"><a href="Truffle-Web3.html#cb849-228" tabindex="-1"></a>            <span class="dt">&lt;</span><span class="kw">option</span><span class="ot"> [ngValue]</span><span class="op">=</span><span class="st">&quot;-1&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">option</span><span class="dt">&gt;</span></span>
<span id="cb849-229"><a href="Truffle-Web3.html#cb849-229" tabindex="-1"></a>          <span class="dt">&lt;/</span><span class="kw">select</span><span class="dt">&gt;</span></span>
<span id="cb849-230"><a href="Truffle-Web3.html#cb849-230" tabindex="-1"></a>        <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb849-231"><a href="Truffle-Web3.html#cb849-231" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">button</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;btn btn-sm btn-primary&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-232"><a href="Truffle-Web3.html#cb849-232" tabindex="-1"></a>          <span class="dt">&lt;</span><span class="kw">i</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;fa-solid fa-plus me-2&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">i</span><span class="dt">&gt;</span>Vote</span>
<span id="cb849-233"><a href="Truffle-Web3.html#cb849-233" tabindex="-1"></a>        <span class="dt">&lt;/</span><span class="kw">button</span><span class="dt">&gt;</span></span>
<span id="cb849-234"><a href="Truffle-Web3.html#cb849-234" tabindex="-1"></a>      <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb849-235"><a href="Truffle-Web3.html#cb849-235" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card-footer small text-muted&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-236"><a href="Truffle-Web3.html#cb849-236" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">i</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;fa-solid fa-circle-info pe-1&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">i</span><span class="dt">&gt;</span>A registered voter casts vote.</span>
<span id="cb849-237"><a href="Truffle-Web3.html#cb849-237" tabindex="-1"></a>      <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb849-238"><a href="Truffle-Web3.html#cb849-238" tabindex="-1"></a>    <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb849-239"><a href="Truffle-Web3.html#cb849-239" tabindex="-1"></a>  <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb849-240"><a href="Truffle-Web3.html#cb849-240" tabindex="-1"></a>  <span class="co">&lt;!-- </span><span class="re">END</span><span class="co">: Cast vote --&gt;</span></span>
<span id="cb849-241"><a href="Truffle-Web3.html#cb849-241" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb849-242"><a href="Truffle-Web3.html#cb849-242" tabindex="-1"></a></span>
<span id="cb849-243"><a href="Truffle-Web3.html#cb849-243" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;row row-cols-2 mt-4&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-244"><a href="Truffle-Web3.html#cb849-244" tabindex="-1"></a>  <span class="co">&lt;!-- START: Tally votes --&gt;</span></span>
<span id="cb849-245"><a href="Truffle-Web3.html#cb849-245" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;col&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-246"><a href="Truffle-Web3.html#cb849-246" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card h-100&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-247"><a href="Truffle-Web3.html#cb849-247" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card-header bg-light&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-248"><a href="Truffle-Web3.html#cb849-248" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">h4</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;mb-0&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-249"><a href="Truffle-Web3.html#cb849-249" tabindex="-1"></a>          Tally votes<span class="dt">&lt;</span><span class="kw">sup</span></span>
<span id="cb849-250"><a href="Truffle-Web3.html#cb849-250" tabindex="-1"></a><span class="ot">            </span><span class="dt">&gt;&lt;</span><span class="kw">small</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;text-muted&quot;</span></span>
<span id="cb849-251"><a href="Truffle-Web3.html#cb849-251" tabindex="-1"></a><span class="ot">              </span><span class="dt">&gt;&lt;</span><span class="kw">i</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;fa-solid fa-user-gear ps-2 pe-1&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">i</span><span class="dt">&gt;&lt;/</span><span class="kw">small</span></span>
<span id="cb849-252"><a href="Truffle-Web3.html#cb849-252" tabindex="-1"></a>          <span class="dt">&gt;&lt;/</span><span class="kw">sup</span><span class="dt">&gt;</span></span>
<span id="cb849-253"><a href="Truffle-Web3.html#cb849-253" tabindex="-1"></a>        <span class="dt">&lt;/</span><span class="kw">h4</span><span class="dt">&gt;</span></span>
<span id="cb849-254"><a href="Truffle-Web3.html#cb849-254" tabindex="-1"></a>      <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb849-255"><a href="Truffle-Web3.html#cb849-255" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card-body&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-256"><a href="Truffle-Web3.html#cb849-256" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">button</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;btn btn-sm btn-primary me-2&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-257"><a href="Truffle-Web3.html#cb849-257" tabindex="-1"></a>          <span class="dt">&lt;</span><span class="kw">i</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;fas fa-play me-2&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">i</span><span class="dt">&gt;</span>Tally votes</span>
<span id="cb849-258"><a href="Truffle-Web3.html#cb849-258" tabindex="-1"></a>        <span class="dt">&lt;/</span><span class="kw">button</span><span class="dt">&gt;</span></span>
<span id="cb849-259"><a href="Truffle-Web3.html#cb849-259" tabindex="-1"></a>      <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb849-260"><a href="Truffle-Web3.html#cb849-260" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card-footer small text-muted&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-261"><a href="Truffle-Web3.html#cb849-261" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">i</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;fa-solid fa-circle-info pe-1&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">i</span><span class="dt">&gt;</span>After the voting is completed,</span>
<span id="cb849-262"><a href="Truffle-Web3.html#cb849-262" tabindex="-1"></a>        the administrator counts the votes.</span>
<span id="cb849-263"><a href="Truffle-Web3.html#cb849-263" tabindex="-1"></a>      <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb849-264"><a href="Truffle-Web3.html#cb849-264" tabindex="-1"></a>    <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb849-265"><a href="Truffle-Web3.html#cb849-265" tabindex="-1"></a>  <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb849-266"><a href="Truffle-Web3.html#cb849-266" tabindex="-1"></a>  <span class="co">&lt;!-- </span><span class="re">END</span><span class="co">: Tally votes --&gt;</span></span>
<span id="cb849-267"><a href="Truffle-Web3.html#cb849-267" tabindex="-1"></a></span>
<span id="cb849-268"><a href="Truffle-Web3.html#cb849-268" tabindex="-1"></a>  <span class="co">&lt;!-- START: Voting results --&gt;</span></span>
<span id="cb849-269"><a href="Truffle-Web3.html#cb849-269" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;col&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-270"><a href="Truffle-Web3.html#cb849-270" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card h-100&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-271"><a href="Truffle-Web3.html#cb849-271" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card-header bg-light&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-272"><a href="Truffle-Web3.html#cb849-272" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">h4</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;mb-0&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-273"><a href="Truffle-Web3.html#cb849-273" tabindex="-1"></a>          Voting results<span class="dt">&lt;</span><span class="kw">sup</span></span>
<span id="cb849-274"><a href="Truffle-Web3.html#cb849-274" tabindex="-1"></a><span class="ot">            </span><span class="dt">&gt;&lt;</span><span class="kw">small</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;text-muted&quot;</span></span>
<span id="cb849-275"><a href="Truffle-Web3.html#cb849-275" tabindex="-1"></a><span class="ot">              </span><span class="dt">&gt;&lt;</span><span class="kw">i</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;fa-solid fa-user ps-2 pe-1&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">i</span><span class="dt">&gt;&lt;/</span><span class="kw">small</span></span>
<span id="cb849-276"><a href="Truffle-Web3.html#cb849-276" tabindex="-1"></a>          <span class="dt">&gt;&lt;/</span><span class="kw">sup</span><span class="dt">&gt;</span></span>
<span id="cb849-277"><a href="Truffle-Web3.html#cb849-277" tabindex="-1"></a>        <span class="dt">&lt;/</span><span class="kw">h4</span><span class="dt">&gt;</span></span>
<span id="cb849-278"><a href="Truffle-Web3.html#cb849-278" tabindex="-1"></a>      <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb849-279"><a href="Truffle-Web3.html#cb849-279" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card-body&quot;</span><span class="dt">&gt;</span>The voting result is not yet available.<span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb849-280"><a href="Truffle-Web3.html#cb849-280" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card-footer small text-muted&quot;</span><span class="dt">&gt;</span></span>
<span id="cb849-281"><a href="Truffle-Web3.html#cb849-281" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">i</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;fa-solid fa-circle-info pe-1&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">i</span><span class="dt">&gt;</span>The voting result is available to</span>
<span id="cb849-282"><a href="Truffle-Web3.html#cb849-282" tabindex="-1"></a>        all users.</span>
<span id="cb849-283"><a href="Truffle-Web3.html#cb849-283" tabindex="-1"></a>      <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb849-284"><a href="Truffle-Web3.html#cb849-284" tabindex="-1"></a>    <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb849-285"><a href="Truffle-Web3.html#cb849-285" tabindex="-1"></a>  <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb849-286"><a href="Truffle-Web3.html#cb849-286" tabindex="-1"></a>  <span class="co">&lt;!-- </span><span class="re">END</span><span class="co">: Voting results --&gt;</span></span>
<span id="cb849-287"><a href="Truffle-Web3.html#cb849-287" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span></code></pre></div>
<script>
  $(document).ready(function() {
    $("#opredelitev-izgleda code.javascript:eq(0)").markRegExp(/.+?template:.+/, options_izbrisi);
    $("#opredelitev-izgleda code.javascript:eq(0)").markRegExp(/.+?templateUrl:.+/, options_dodaj);
    $("#opredelitev-izgleda code.html:eq(0)").markRegExp(/.+/, options_dodaj);
  });
</script>
</div>
<div id="povezava-na-verigo-blokov" class="section level3 hasAnchor" number="13.2.5">
<h3><span class="header-section-number">13.2.5</span> Povezava na verigo blokov<a href="Truffle-Web3.html#povezava-na-verigo-blokov" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="postavitev-pametne-pogodbe" class="section level4 hasAnchor" number="13.2.5.1">
<h4><span class="header-section-number">13.2.5.1</span> Postavitev pametne pogodbe<a href="Truffle-Web3.html#postavitev-pametne-pogodbe" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Pametno pogodbo smo že razvili in jo bomo s pomočjo ogrodja Truffle še enkrat <strong>postavili na</strong> naše <strong>privatno omrežje</strong>.</p>
<div class="sourceCode" id="cb850"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb850-1"><a href="Truffle-Web3.html#cb850-1" tabindex="-1"></a><span class="ex">$</span> cd dapp</span>
<span id="cb850-2"><a href="Truffle-Web3.html#cb850-2" tabindex="-1"></a><span class="ex">$</span> truffle migrate</span>
<span id="cb850-3"><a href="Truffle-Web3.html#cb850-3" tabindex="-1"></a></span>
<span id="cb850-4"><a href="Truffle-Web3.html#cb850-4" tabindex="-1"></a><span class="ex">Compiling</span> your contracts...</span>
<span id="cb850-5"><a href="Truffle-Web3.html#cb850-5" tabindex="-1"></a><span class="ex">===========================</span></span>
<span id="cb850-6"><a href="Truffle-Web3.html#cb850-6" tabindex="-1"></a><span class="op">&gt;</span> Everything <span class="ex">is</span> up to date, there is nothing to compile.</span>
<span id="cb850-7"><a href="Truffle-Web3.html#cb850-7" tabindex="-1"></a></span>
<span id="cb850-8"><a href="Truffle-Web3.html#cb850-8" tabindex="-1"></a><span class="ex">Starting</span> migrations...</span>
<span id="cb850-9"><a href="Truffle-Web3.html#cb850-9" tabindex="-1"></a><span class="ex">======================</span></span>
<span id="cb850-10"><a href="Truffle-Web3.html#cb850-10" tabindex="-1"></a><span class="op">&gt;</span> Network <span class="ex">name:</span>    <span class="st">&#39;development&#39;</span></span>
<span id="cb850-11"><a href="Truffle-Web3.html#cb850-11" tabindex="-1"></a><span class="op">&gt;</span> Network <span class="ex">id:</span>      1701851319989</span>
<span id="cb850-12"><a href="Truffle-Web3.html#cb850-12" tabindex="-1"></a><span class="op">&gt;</span> Block <span class="ex">gas</span> limit: 30000000 <span class="er">(</span><span class="ex">0x1c9c380</span><span class="kw">)</span></span>
<span id="cb850-13"><a href="Truffle-Web3.html#cb850-13" tabindex="-1"></a></span>
<span id="cb850-14"><a href="Truffle-Web3.html#cb850-14" tabindex="-1"></a><span class="ex">1_deploy_contracts.js</span></span>
<span id="cb850-15"><a href="Truffle-Web3.html#cb850-15" tabindex="-1"></a><span class="ex">=====================</span></span>
<span id="cb850-16"><a href="Truffle-Web3.html#cb850-16" tabindex="-1"></a>   <span class="ex">Replacing</span> <span class="st">&#39;SimpleVoting&#39;</span></span>
<span id="cb850-17"><a href="Truffle-Web3.html#cb850-17" tabindex="-1"></a>   <span class="ex">------------------------</span></span>
<span id="cb850-18"><a href="Truffle-Web3.html#cb850-18" tabindex="-1"></a>   <span class="op">&gt;</span> transaction <span class="ex">hash:</span>    0xba85825dba7dc878b3b5cf6332d2f2c52e6178b40a8b0fe501cb418123d65b37</span>
<span id="cb850-19"><a href="Truffle-Web3.html#cb850-19" tabindex="-1"></a>   <span class="op">&gt;</span> Blocks: <span class="ex">0</span>            Seconds: 0</span>
<span id="cb850-20"><a href="Truffle-Web3.html#cb850-20" tabindex="-1"></a>   <span class="op">&gt;</span> contract <span class="ex">address:</span>    0xc5BAF6E151433B6027C0D3a8d684b495E748503B</span>
<span id="cb850-21"><a href="Truffle-Web3.html#cb850-21" tabindex="-1"></a>   <span class="op">&gt;</span> block <span class="ex">number:</span>        5</span>
<span id="cb850-22"><a href="Truffle-Web3.html#cb850-22" tabindex="-1"></a>   <span class="op">&gt;</span> block <span class="ex">timestamp:</span>     1701854098</span>
<span id="cb850-23"><a href="Truffle-Web3.html#cb850-23" tabindex="-1"></a>   <span class="op">&gt;</span> account:             <span class="ex">0x818476CEc6a8D017DB14AB0A25EBE4eBdB518eD8</span></span>
<span id="cb850-24"><a href="Truffle-Web3.html#cb850-24" tabindex="-1"></a>   <span class="op">&gt;</span> balance:             <span class="ex">99.978624988314351824</span></span>
<span id="cb850-25"><a href="Truffle-Web3.html#cb850-25" tabindex="-1"></a>   <span class="op">&gt;</span> gas <span class="ex">used:</span>            2186378 <span class="er">(</span><span class="ex">0x215c8a</span><span class="kw">)</span></span>
<span id="cb850-26"><a href="Truffle-Web3.html#cb850-26" tabindex="-1"></a>   <span class="op">&gt;</span> gas <span class="ex">price:</span>           3.034791813 gwei</span>
<span id="cb850-27"><a href="Truffle-Web3.html#cb850-27" tabindex="-1"></a>   <span class="op">&gt;</span> value <span class="ex">sent:</span>          0 ETH</span>
<span id="cb850-28"><a href="Truffle-Web3.html#cb850-28" tabindex="-1"></a>   <span class="op">&gt;</span> total <span class="ex">cost:</span>          0.006635202054523314 ETH</span>
<span id="cb850-29"><a href="Truffle-Web3.html#cb850-29" tabindex="-1"></a>   <span class="op">&gt;</span> Saving <span class="ex">artifacts</span></span>
<span id="cb850-30"><a href="Truffle-Web3.html#cb850-30" tabindex="-1"></a>   <span class="ex">-------------------------------------</span></span>
<span id="cb850-31"><a href="Truffle-Web3.html#cb850-31" tabindex="-1"></a>   <span class="op">&gt;</span> Total <span class="ex">cost:</span>     0.006635202054523314 ETH</span>
<span id="cb850-32"><a href="Truffle-Web3.html#cb850-32" tabindex="-1"></a></span>
<span id="cb850-33"><a href="Truffle-Web3.html#cb850-33" tabindex="-1"></a><span class="ex">Summary</span></span>
<span id="cb850-34"><a href="Truffle-Web3.html#cb850-34" tabindex="-1"></a><span class="ex">=======</span></span>
<span id="cb850-35"><a href="Truffle-Web3.html#cb850-35" tabindex="-1"></a><span class="op">&gt;</span> Total <span class="ex">deployments:</span>   1</span>
<span id="cb850-36"><a href="Truffle-Web3.html#cb850-36" tabindex="-1"></a><span class="op">&gt;</span> Final <span class="ex">cost:</span>          0.006635202054523314 ETH</span></code></pre></div>
<p>Pomembno je, da zabeležimo <strong>naslov</strong> (<code>0xc5BAF6E151433B6027C0D3a8d684b495E748503B</code>), na katerem se nahaja <strong>postavljena pogodba</strong>, saj je to eden izmed potrebnih podatkov za povezavo Web3 aplikacije na verigo blokov in komunikacijo s pametno pogodbo.</p>
<script>
  $(document).ready(function() {
    $("#postavitev-pametne-pogodbe code.bash:eq(0)").markRegExp(/cd dapp|truffle migrate/, options_dodaj);
    $("#postavitev-pametne-pogodbe code.bash:eq(0)").markRegExp(/0x.+?48503B/, options_dodaj);
  });
</script>
</div>
<div id="povezava-na-verigo-blokov-preko-denarnice-metamask" class="section level4 hasAnchor" number="13.2.5.2">
<h4><span class="header-section-number">13.2.5.2</span> Povezava na verigo blokov preko denarnice MetaMask<a href="Truffle-Web3.html#povezava-na-verigo-blokov-preko-denarnice-metamask" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Med globalnimi spremenljivkami Angular aplikacije bomo opredelili <strong>naslov</strong> (<code>contractAddress</code>), na katerem je <strong>postavljena pametna pogodba</strong>, <strong>povezava</strong> do <strong>vmesnika ABI</strong> pametne pogodbe (<code>contractUrl</code>) in <strong>identifikator verige</strong> (<code>allowedChainId</code>), kjer pametna pogodba postavljena.</p>
<p><code>angular/src/environments/environment.ts</code></p>
<div class="sourceCode" id="cb851"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb851-1"><a href="Truffle-Web3.html#cb851-1" tabindex="-1"></a><span class="im">export</span> <span class="kw">const</span> environment <span class="op">=</span> {</span>
<span id="cb851-2"><a href="Truffle-Web3.html#cb851-2" tabindex="-1"></a>  <span class="dt">apiUrl</span><span class="op">:</span> <span class="st">&quot;http://localhost:3000/api&quot;</span><span class="op">,</span></span>
<span id="cb851-3"><a href="Truffle-Web3.html#cb851-3" tabindex="-1"></a>  <span class="dt">production</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb851-4"><a href="Truffle-Web3.html#cb851-4" tabindex="-1"></a>  <span class="dt">allowedChainId</span><span class="op">:</span> <span class="dv">1337</span><span class="op">,</span></span>
<span id="cb851-5"><a href="Truffle-Web3.html#cb851-5" tabindex="-1"></a>  <span class="dt">contractUrl</span><span class="op">:</span> <span class="st">&quot;http://localhost:3000/ABI/SimpleVoting.json&quot;</span><span class="op">,</span></span>
<span id="cb851-6"><a href="Truffle-Web3.html#cb851-6" tabindex="-1"></a>  <span class="dt">contractAddress</span><span class="op">:</span> <span class="st">&quot;0xc5BAF6E151433B6027C0D3a8d684b495E748503B&quot;</span><span class="op">,</span></span>
<span id="cb851-7"><a href="Truffle-Web3.html#cb851-7" tabindex="-1"></a>}<span class="op">;</span></span></code></pre></div>
<p>Za povezovanje na verigo blokov bomo uporabili <a href="https://metamask.io/"><i class="fa-solid fa-wallet"></i>denarnico <strong>MetaMask</strong></a>, kjer od uporabnika zahtevamo, da že ima vzpostavljeno povezavo z zahtevano verigo blokov (tj. lokalna zasebna veriga blokov z enoličnim identifikatorjem verige (<code>allowedChainId</code>) <code>1337</code>.</p>
<blockquote>
<p><strong>Opomba</strong>: Po namestitvi <a href="https://chromewebstore.google.com/detail/metamask/nkbihfbeogaeaoehlefnkodbefgpgknn"><i class="fa-solid fa-wallet"></i>vtičnika MetaMask</a> za Google Chrome, v MetaMask-u dodamo omrežje, tako da izberemo <i class="fa-solid fa-ellipsis-vertical"></i> → <code>Nastavitve</code> → <code>Omrežja</code> → <code>Dodaj omrežje</code>. Pri zahtevanih podatkih vnesemo naslednje vrednosti: <code>Ime omrežja</code>: <strong><code>Ganache</code></strong>, <code>Nov URL RPC</code>: <strong><code>http://127.0.0.1:8545</code></strong>, <code>ID verige</code>: <strong><code>1337</code></strong> in <code>Currency symbol</code>: <strong><code>ETH</code></strong>.</p>
</blockquote>
<p>Če ima uporabnik v spletnem brskalniku nameščen vtičnik MetaMask, potem lahko iz Web3 aplikacije dostopamo do objekta <a href="https://docs.metamask.io/guide/ethereum-provider.html"><i class="fa-solid fa-tag"></i><code>window.ethereum</code></a>. Nato s klicem <a href="https://docs.metamask.io/guide/ethereum-provider.html#methods"><i class="fa-solid fa-tag"></i><code>window.ethereum.request({ method: "eth_requestAccounts" })</code></a> zahtevamo od uporabnika, da izbere račun s katerim se želi identificirati na verigi blokov. V nadaljevanju preverimo ali je uporabnik povezan na ustrezno verigo blokov ter pridobimo referenco na postavljeno pametno pogodbo (na podlagi vmesnika ABI v obliki JSON in naslova postavljene pametne pogodbe na verigi blokov).</p>
<p><code>angular/src/app/shared/services/web3.service.ts</code></p>
<div class="sourceCode" id="cb852"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb852-1"><a href="Truffle-Web3.html#cb852-1" tabindex="-1"></a><span class="im">import</span> { Injectable } <span class="im">from</span> <span class="st">&quot;@angular/core&quot;</span><span class="op">;</span></span>
<span id="cb852-2"><a href="Truffle-Web3.html#cb852-2" tabindex="-1"></a><span class="im">import</span> { Web3 } <span class="im">from</span> <span class="st">&quot;web3&quot;</span><span class="op">;</span></span>
<span id="cb852-3"><a href="Truffle-Web3.html#cb852-3" tabindex="-1"></a><span class="im">import</span> { Contract } <span class="im">from</span> <span class="st">&quot;web3-eth-contract&quot;</span><span class="op">;</span></span>
<span id="cb852-4"><a href="Truffle-Web3.html#cb852-4" tabindex="-1"></a><span class="im">import</span> { environment } <span class="im">from</span> <span class="st">&quot;../../../environments/environment&quot;</span><span class="op">;</span></span>
<span id="cb852-5"><a href="Truffle-Web3.html#cb852-5" tabindex="-1"></a>declare <span class="kw">let</span> <span class="bu">window</span><span class="op">:</span> any<span class="op">;</span></span>
<span id="cb852-6"><a href="Truffle-Web3.html#cb852-6" tabindex="-1"></a>@<span class="fu">Injectable</span>({</span>
<span id="cb852-7"><a href="Truffle-Web3.html#cb852-7" tabindex="-1"></a>  <span class="dt">providedIn</span><span class="op">:</span> <span class="st">&quot;root&quot;</span><span class="op">,</span></span>
<span id="cb852-8"><a href="Truffle-Web3.html#cb852-8" tabindex="-1"></a>})</span>
<span id="cb852-9"><a href="Truffle-Web3.html#cb852-9" tabindex="-1"></a><span class="im">export</span> <span class="kw">class</span> Web3Service {</span>
<span id="cb852-10"><a href="Truffle-Web3.html#cb852-10" tabindex="-1"></a>  <span class="kw">public</span> userAddress<span class="op">!:</span> string<span class="op">;</span></span>
<span id="cb852-11"><a href="Truffle-Web3.html#cb852-11" tabindex="-1"></a>  <span class="kw">private</span> web3<span class="op">!:</span> any<span class="op">;</span></span>
<span id="cb852-12"><a href="Truffle-Web3.html#cb852-12" tabindex="-1"></a>  <span class="kw">private</span> contract<span class="op">!:</span> Contract<span class="op">&lt;</span>any<span class="op">&gt;;</span></span>
<span id="cb852-13"><a href="Truffle-Web3.html#cb852-13" tabindex="-1"></a>  <span class="fu">constructor</span>() {}</span>
<span id="cb852-14"><a href="Truffle-Web3.html#cb852-14" tabindex="-1"></a>  <span class="kw">public</span> <span class="kw">async</span> <span class="fu">connectToBC</span>()<span class="op">:</span> <span class="bu">Promise</span><span class="op">&lt;</span>string<span class="op">&gt;</span> {</span>
<span id="cb852-15"><a href="Truffle-Web3.html#cb852-15" tabindex="-1"></a>    <span class="kw">let</span> message <span class="op">=</span> <span class="st">&quot;&quot;</span><span class="op">;</span></span>
<span id="cb852-16"><a href="Truffle-Web3.html#cb852-16" tabindex="-1"></a>    <span class="cf">try</span> {</span>
<span id="cb852-17"><a href="Truffle-Web3.html#cb852-17" tabindex="-1"></a>      <span class="co">// Check if MetaMask is installed</span></span>
<span id="cb852-18"><a href="Truffle-Web3.html#cb852-18" tabindex="-1"></a>      <span class="cf">if</span> (<span class="op">!</span><span class="bu">window</span><span class="op">.</span><span class="at">ethereum</span><span class="op">?.</span><span class="at">isMetaMask</span>)</span>
<span id="cb852-19"><a href="Truffle-Web3.html#cb852-19" tabindex="-1"></a>        <span class="cf">throw</span> <span class="kw">new</span> <span class="bu">Error</span>(<span class="st">&quot;Please install MetaMask wallet!&quot;</span>)<span class="op">;</span></span>
<span id="cb852-20"><a href="Truffle-Web3.html#cb852-20" tabindex="-1"></a>      <span class="co">// Check if MetaMask is connected and get the user address</span></span>
<span id="cb852-21"><a href="Truffle-Web3.html#cb852-21" tabindex="-1"></a>      <span class="kw">this</span><span class="op">.</span><span class="at">userAddress</span> <span class="op">=</span> (</span>
<span id="cb852-22"><a href="Truffle-Web3.html#cb852-22" tabindex="-1"></a>        <span class="cf">await</span> <span class="bu">window</span><span class="op">.</span><span class="at">ethereum</span><span class="op">.</span><span class="fu">request</span>({</span>
<span id="cb852-23"><a href="Truffle-Web3.html#cb852-23" tabindex="-1"></a>          <span class="dt">method</span><span class="op">:</span> <span class="st">&quot;eth_requestAccounts&quot;</span><span class="op">,</span></span>
<span id="cb852-24"><a href="Truffle-Web3.html#cb852-24" tabindex="-1"></a>        })</span>
<span id="cb852-25"><a href="Truffle-Web3.html#cb852-25" tabindex="-1"></a>      )[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb852-26"><a href="Truffle-Web3.html#cb852-26" tabindex="-1"></a>      <span class="co">// Check the chain ID</span></span>
<span id="cb852-27"><a href="Truffle-Web3.html#cb852-27" tabindex="-1"></a>      <span class="cf">if</span> (</span>
<span id="cb852-28"><a href="Truffle-Web3.html#cb852-28" tabindex="-1"></a>        Web3<span class="op">.</span><span class="at">utils</span><span class="op">.</span><span class="fu">toDecimal</span>(</span>
<span id="cb852-29"><a href="Truffle-Web3.html#cb852-29" tabindex="-1"></a>          <span class="cf">await</span> <span class="bu">window</span><span class="op">.</span><span class="at">ethereum</span><span class="op">.</span><span class="fu">request</span>({ <span class="dt">method</span><span class="op">:</span> <span class="st">&quot;eth_chainId&quot;</span> })</span>
<span id="cb852-30"><a href="Truffle-Web3.html#cb852-30" tabindex="-1"></a>        ) <span class="op">!==</span> environment<span class="op">.</span><span class="at">allowedChainId</span></span>
<span id="cb852-31"><a href="Truffle-Web3.html#cb852-31" tabindex="-1"></a>      )</span>
<span id="cb852-32"><a href="Truffle-Web3.html#cb852-32" tabindex="-1"></a>        <span class="cf">throw</span> <span class="kw">new</span> <span class="bu">Error</span>(<span class="st">&quot;Chain not allowed, please reconnect MetaMask wallet!&quot;</span>)<span class="op">;</span></span>
<span id="cb852-33"><a href="Truffle-Web3.html#cb852-33" tabindex="-1"></a>      <span class="co">// Connect to the blockchain</span></span>
<span id="cb852-34"><a href="Truffle-Web3.html#cb852-34" tabindex="-1"></a>      <span class="kw">this</span><span class="op">.</span><span class="at">web3</span> <span class="op">=</span> <span class="kw">new</span> <span class="fu">Web3</span>(<span class="bu">window</span><span class="op">.</span><span class="at">ethereum</span>)<span class="op">;</span></span>
<span id="cb852-35"><a href="Truffle-Web3.html#cb852-35" tabindex="-1"></a>      <span class="co">// Get the contract</span></span>
<span id="cb852-36"><a href="Truffle-Web3.html#cb852-36" tabindex="-1"></a>      <span class="kw">this</span><span class="op">.</span><span class="at">contract</span> <span class="op">=</span> <span class="kw">new</span> <span class="kw">this</span><span class="op">.</span><span class="at">web3</span><span class="op">.</span><span class="at">eth</span><span class="op">.</span><span class="fu">Contract</span>(</span>
<span id="cb852-37"><a href="Truffle-Web3.html#cb852-37" tabindex="-1"></a>        (<span class="cf">await</span> (<span class="cf">await</span> <span class="fu">fetch</span>(environment<span class="op">.</span><span class="at">contractUrl</span>))<span class="op">.</span><span class="fu">json</span>())<span class="op">.</span><span class="at">abi</span><span class="op">,</span></span>
<span id="cb852-38"><a href="Truffle-Web3.html#cb852-38" tabindex="-1"></a>        environment<span class="op">.</span><span class="at">contractAddress</span></span>
<span id="cb852-39"><a href="Truffle-Web3.html#cb852-39" tabindex="-1"></a>      )<span class="op">;</span></span>
<span id="cb852-40"><a href="Truffle-Web3.html#cb852-40" tabindex="-1"></a>    } <span class="cf">catch</span> (<span class="dt">error</span><span class="op">:</span> any) {</span>
<span id="cb852-41"><a href="Truffle-Web3.html#cb852-41" tabindex="-1"></a>      <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(error)<span class="op">;</span></span>
<span id="cb852-42"><a href="Truffle-Web3.html#cb852-42" tabindex="-1"></a>      message <span class="op">=</span> error<span class="op">.</span><span class="at">message</span><span class="op">;</span></span>
<span id="cb852-43"><a href="Truffle-Web3.html#cb852-43" tabindex="-1"></a>    }</span>
<span id="cb852-44"><a href="Truffle-Web3.html#cb852-44" tabindex="-1"></a>    <span class="cf">return</span> message<span class="op">;</span></span>
<span id="cb852-45"><a href="Truffle-Web3.html#cb852-45" tabindex="-1"></a>  }</span>
<span id="cb852-46"><a href="Truffle-Web3.html#cb852-46" tabindex="-1"></a>}</span></code></pre></div>
<p>Če je prišlo pri prevajanju Angular projekta do napake zaradi privzeti uvozov knjižnice Web3, potem dopolnite nastavitve prevajalnika jezika TypeScript.</p>
<p><code>angular/tsconfig.json</code></p>
<div class="sourceCode" id="cb853"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb853-1"><a href="Truffle-Web3.html#cb853-1" tabindex="-1"></a>{</span>
<span id="cb853-2"><a href="Truffle-Web3.html#cb853-2" tabindex="-1"></a>  <span class="op">...,</span></span>
<span id="cb853-3"><a href="Truffle-Web3.html#cb853-3" tabindex="-1"></a>  <span class="st">&quot;compilerOptions&quot;</span><span class="op">:</span> {</span>
<span id="cb853-4"><a href="Truffle-Web3.html#cb853-4" tabindex="-1"></a>    <span class="op">...,</span></span>
<span id="cb853-5"><a href="Truffle-Web3.html#cb853-5" tabindex="-1"></a>    <span class="st">&quot;allowSyntheticDefaultImports&quot;</span><span class="op">:</span> <span class="kw">true</span></span>
<span id="cb853-6"><a href="Truffle-Web3.html#cb853-6" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb853-7"><a href="Truffle-Web3.html#cb853-7" tabindex="-1"></a>  <span class="op">...</span></span>
<span id="cb853-8"><a href="Truffle-Web3.html#cb853-8" tabindex="-1"></a>}</span></code></pre></div>
<p>Ob zagonu komponente pokličemo metodo <code>connectToBC()</code> storitve <code>web3</code>, ki od uporabnika zahteva prijavo na zahtevano verigo blokov. V primeru napake, se uporabniku prikaže sporočilo o napaki.</p>
<p><code>angular/src/app/shared/components/vote/vote.component.ts</code></p>
<div class="sourceCode" id="cb854"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb854-1"><a href="Truffle-Web3.html#cb854-1" tabindex="-1"></a><span class="im">import</span> { Component<span class="op">,</span> OnInit } <span class="im">from</span> <span class="st">&quot;@angular/core&quot;</span><span class="op">;</span></span>
<span id="cb854-2"><a href="Truffle-Web3.html#cb854-2" tabindex="-1"></a><span class="im">import</span> { Web3Service } <span class="im">from</span> <span class="st">&quot;../../services/web3.service&quot;</span><span class="op">;</span></span>
<span id="cb854-3"><a href="Truffle-Web3.html#cb854-3" tabindex="-1"></a></span>
<span id="cb854-4"><a href="Truffle-Web3.html#cb854-4" tabindex="-1"></a>@<span class="fu">Component</span>({</span>
<span id="cb854-5"><a href="Truffle-Web3.html#cb854-5" tabindex="-1"></a>  <span class="dt">selector</span><span class="op">:</span> <span class="st">&quot;app-vote&quot;</span><span class="op">,</span></span>
<span id="cb854-6"><a href="Truffle-Web3.html#cb854-6" tabindex="-1"></a>  <span class="dt">templateUrl</span><span class="op">:</span> <span class="st">&quot;./vote.component.html&quot;</span><span class="op">,</span></span>
<span id="cb854-7"><a href="Truffle-Web3.html#cb854-7" tabindex="-1"></a>  <span class="dt">styles</span><span class="op">:</span> []<span class="op">,</span></span>
<span id="cb854-8"><a href="Truffle-Web3.html#cb854-8" tabindex="-1"></a>})</span>
<span id="cb854-9"><a href="Truffle-Web3.html#cb854-9" tabindex="-1"></a><span class="im">export</span> <span class="kw">class</span> VoteComponent <span class="kw">implements</span> OnInit {</span>
<span id="cb854-10"><a href="Truffle-Web3.html#cb854-10" tabindex="-1"></a>  <span class="kw">protected</span> <span class="dt">message</span><span class="op">:</span> string <span class="op">=</span> <span class="st">&quot;Please connect MetaMask wallet to continue!&quot;</span><span class="op">;</span></span>
<span id="cb854-11"><a href="Truffle-Web3.html#cb854-11" tabindex="-1"></a>  <span class="fu">constructor</span>(<span class="kw">public</span> <span class="dt">web3Service</span><span class="op">:</span> Web3Service) {}</span>
<span id="cb854-12"><a href="Truffle-Web3.html#cb854-12" tabindex="-1"></a>  <span class="fu">ngOnInit</span>()<span class="op">:</span> <span class="kw">void</span> {</span>
<span id="cb854-13"><a href="Truffle-Web3.html#cb854-13" tabindex="-1"></a>    <span class="kw">this</span><span class="op">.</span><span class="at">web3Service</span></span>
<span id="cb854-14"><a href="Truffle-Web3.html#cb854-14" tabindex="-1"></a>      <span class="op">.</span><span class="fu">connectToBC</span>()</span>
<span id="cb854-15"><a href="Truffle-Web3.html#cb854-15" tabindex="-1"></a>      <span class="op">.</span><span class="fu">then</span>((<span class="dt">message</span><span class="op">:</span> string) <span class="kw">=&gt;</span> (<span class="kw">this</span><span class="op">.</span><span class="at">message</span> <span class="op">=</span> message))<span class="op">;</span></span>
<span id="cb854-16"><a href="Truffle-Web3.html#cb854-16" tabindex="-1"></a>  }</span>
<span id="cb854-17"><a href="Truffle-Web3.html#cb854-17" tabindex="-1"></a>}</span></code></pre></div>
<p><code>angular/src/app/shared/components/vote/vote.component.html</code></p>
<div class="sourceCode" id="cb855"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb855-1"><a href="Truffle-Web3.html#cb855-1" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">h1</span><span class="dt">&gt;</span>Vote for the best new hidden location<span class="dt">&lt;/</span><span class="kw">h1</span><span class="dt">&gt;</span></span>
<span id="cb855-2"><a href="Truffle-Web3.html#cb855-2" tabindex="-1"></a><span class="co">&lt;!-- START: Error message --&gt;</span></span>
<span id="cb855-3"><a href="Truffle-Web3.html#cb855-3" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;row&quot;</span><span class="ot"> *ngIf</span><span class="op">=</span><span class="st">&quot;message&quot;</span><span class="dt">&gt;</span></span>
<span id="cb855-4"><a href="Truffle-Web3.html#cb855-4" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;col-12&quot;</span><span class="dt">&gt;</span></span>
<span id="cb855-5"><a href="Truffle-Web3.html#cb855-5" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;alert alert-dark mt-4 p-2&quot;</span><span class="dt">&gt;</span></span>
<span id="cb855-6"><a href="Truffle-Web3.html#cb855-6" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">i</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;fa-solid fa-triangle-exclamation pe-2&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">i</span><span class="dt">&gt;</span>{{ message }}</span>
<span id="cb855-7"><a href="Truffle-Web3.html#cb855-7" tabindex="-1"></a>    <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb855-8"><a href="Truffle-Web3.html#cb855-8" tabindex="-1"></a>  <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb855-9"><a href="Truffle-Web3.html#cb855-9" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb855-10"><a href="Truffle-Web3.html#cb855-10" tabindex="-1"></a><span class="co">&lt;!-- </span><span class="re">END</span><span class="co">: Error message --&gt;</span></span></code></pre></div>
<script>
  $(document).ready(function() {
    $("#povezava-na-verigo-blokov-preko-denarnice-metamask code.javascript:eq(0)").markRegExp(/.+?(allowedChainId|contractUrl|contractAddress).+/, options_dodaj);
    $("#povezava-na-verigo-blokov-preko-denarnice-metamask code.javascript:eq(1)").markRegExp(/import { (Web3|Contract|environment).+/, options_dodaj);
    $("#povezava-na-verigo-blokov-preko-denarnice-metamask code.javascript:eq(1)").markRegExp(/declare let window.+/, options_dodaj);
    $("#povezava-na-verigo-blokov-preko-denarnice-metamask code.javascript:eq(1)").markRegExp(/.+?(userAddress|web3|contract)\!: .+/, options_dodaj);
    $("#povezava-na-verigo-blokov-preko-denarnice-metamask code.javascript:eq(1)").markRegExp(/\s+?public async connectToBC[\s\S]+?}[\s\S]+?return[\s\S]+?}[\s\S]+?}/, options_dodaj);
    $("#povezava-na-verigo-blokov-preko-denarnice-metamask code.javascript:eq(2)").markRegExp(/,[^"]+?"allowSynthetic.+/, options_dodaj);
    $("#povezava-na-verigo-blokov-preko-denarnice-metamask code.javascript:eq(3)").markRegExp(/, OnInit/, options_dodaj);
    $("#povezava-na-verigo-blokov-preko-denarnice-metamask code.javascript:eq(3)").markRegExp(/ implements OnInit/, options_dodaj);
    $("#povezava-na-verigo-blokov-preko-denarnice-metamask code.javascript:eq(3)").markRegExp(/\s+?protected message.+/, options_dodaj);
    $("#povezava-na-verigo-blokov-preko-denarnice-metamask code.javascript:eq(3)").markRegExp(/\s+?ngOnInit\(\)[\s\S]+?}/, options_dodaj);
    $("#povezava-na-verigo-blokov-preko-denarnice-metamask code.html:eq(0)").markRegExp(/<\!--[\s\S]+?END.+?>/, options_dodaj);
  });
</script>
</div>
</div>
<div id="podpora-funkcionalnostim-neregistriranega-volivca" class="section level3 hasAnchor" number="13.2.6">
<h3><span class="header-section-number">13.2.6</span> Podpora funkcionalnostim neregistriranega volivca<a href="Truffle-Web3.html#podpora-funkcionalnostim-neregistriranega-volivca" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><i class="fa-solid fa-user"></i><strong>Neregistriran volivec</strong>, ki obišče spletno stran, ima na voljo naslednje funkcionalnosti:</p>
<ul>
<li><strong>prikaz uporabniške vloge</strong>,</li>
<li><strong>pregled statusa glasovanja</strong>,</li>
<li><strong>pregled seznama predlogov</strong> in</li>
<li><strong>pregled rezultatov glasovanja</strong>.</li>
</ul>
<p>Za <strong>prikaz uporabniške vloge</strong> dodamo opredelitev vseh uporabniških vlog s pomočjo <a href="https://www.typescriptlang.org/docs/handbook/enums.html"><i class="fa-brands fa-square-js"></i><code>enum</code></a> <code>UserType</code>. Nato ob uspešni povezavi na pametni pogodbi na verigi blokov pokličemo metodi <code>isRegisteredVoter</code> in <code>isAdministrator</code> ter tako določimo uporabniško vlogo prijavljenega uporabnika v denarnico MetaMask.</p>
<p><code>angular/src/app/shared/services/web3.service.ts</code></p>
<div class="sourceCode" id="cb856"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb856-1"><a href="Truffle-Web3.html#cb856-1" tabindex="-1"></a>declare <span class="kw">let</span> <span class="bu">window</span><span class="op">:</span> any<span class="op">;</span></span>
<span id="cb856-2"><a href="Truffle-Web3.html#cb856-2" tabindex="-1"></a><span class="kw">enum</span> UserType {</span>
<span id="cb856-3"><a href="Truffle-Web3.html#cb856-3" tabindex="-1"></a>  AnonymousUser <span class="op">=</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb856-4"><a href="Truffle-Web3.html#cb856-4" tabindex="-1"></a>  UnregisteredVoter <span class="op">=</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb856-5"><a href="Truffle-Web3.html#cb856-5" tabindex="-1"></a>  RegisteredVoter <span class="op">=</span> <span class="dv">3</span><span class="op">,</span></span>
<span id="cb856-6"><a href="Truffle-Web3.html#cb856-6" tabindex="-1"></a>  Administrator <span class="op">=</span> <span class="dv">4</span><span class="op">,</span></span>
<span id="cb856-7"><a href="Truffle-Web3.html#cb856-7" tabindex="-1"></a>}</span>
<span id="cb856-8"><a href="Truffle-Web3.html#cb856-8" tabindex="-1"></a>@<span class="fu">Injectable</span>({</span>
<span id="cb856-9"><a href="Truffle-Web3.html#cb856-9" tabindex="-1"></a>  <span class="dt">providedIn</span><span class="op">:</span> <span class="st">&quot;root&quot;</span><span class="op">,</span></span>
<span id="cb856-10"><a href="Truffle-Web3.html#cb856-10" tabindex="-1"></a>})</span>
<span id="cb856-11"><a href="Truffle-Web3.html#cb856-11" tabindex="-1"></a><span class="im">export</span> <span class="kw">class</span> Web3Service {</span>
<span id="cb856-12"><a href="Truffle-Web3.html#cb856-12" tabindex="-1"></a>  <span class="kw">public</span> userAddress<span class="op">!:</span> string<span class="op">;</span></span>
<span id="cb856-13"><a href="Truffle-Web3.html#cb856-13" tabindex="-1"></a>  <span class="kw">public</span> <span class="dt">userType</span><span class="op">:</span> UserType <span class="op">=</span> UserType<span class="op">.</span><span class="at">AnonymousUser</span><span class="op">;</span></span>
<span id="cb856-14"><a href="Truffle-Web3.html#cb856-14" tabindex="-1"></a>  <span class="kw">private</span> web3<span class="op">!:</span> any<span class="op">;</span></span>
<span id="cb856-15"><a href="Truffle-Web3.html#cb856-15" tabindex="-1"></a>  <span class="op">...</span></span>
<span id="cb856-16"><a href="Truffle-Web3.html#cb856-16" tabindex="-1"></a>  <span class="kw">public</span> <span class="kw">async</span> <span class="fu">connectToBC</span>()<span class="op">:</span> <span class="bu">Promise</span><span class="op">&lt;</span>string<span class="op">&gt;</span> {</span>
<span id="cb856-17"><a href="Truffle-Web3.html#cb856-17" tabindex="-1"></a>    <span class="op">...</span></span>
<span id="cb856-18"><a href="Truffle-Web3.html#cb856-18" tabindex="-1"></a>    <span class="cf">try</span> {</span>
<span id="cb856-19"><a href="Truffle-Web3.html#cb856-19" tabindex="-1"></a>      <span class="op">...</span></span>
<span id="cb856-20"><a href="Truffle-Web3.html#cb856-20" tabindex="-1"></a>      <span class="co">// Get the contract</span></span>
<span id="cb856-21"><a href="Truffle-Web3.html#cb856-21" tabindex="-1"></a>      <span class="kw">this</span><span class="op">.</span><span class="at">contract</span> <span class="op">=</span> <span class="kw">new</span> <span class="kw">this</span><span class="op">.</span><span class="at">web3</span><span class="op">.</span><span class="at">eth</span><span class="op">.</span><span class="fu">Contract</span>(</span>
<span id="cb856-22"><a href="Truffle-Web3.html#cb856-22" tabindex="-1"></a>        (<span class="cf">await</span> (<span class="cf">await</span> <span class="fu">fetch</span>(environment<span class="op">.</span><span class="at">contractUrl</span>))<span class="op">.</span><span class="fu">json</span>())<span class="op">.</span><span class="at">abi</span><span class="op">,</span></span>
<span id="cb856-23"><a href="Truffle-Web3.html#cb856-23" tabindex="-1"></a>        environment<span class="op">.</span><span class="at">contractAddress</span></span>
<span id="cb856-24"><a href="Truffle-Web3.html#cb856-24" tabindex="-1"></a>      )<span class="op">;</span></span>
<span id="cb856-25"><a href="Truffle-Web3.html#cb856-25" tabindex="-1"></a>      <span class="co">// Set the default user type</span></span>
<span id="cb856-26"><a href="Truffle-Web3.html#cb856-26" tabindex="-1"></a>      <span class="kw">this</span><span class="op">.</span><span class="at">userType</span> <span class="op">=</span> UserType<span class="op">.</span><span class="at">UnregisteredVoter</span><span class="op">;</span></span>
<span id="cb856-27"><a href="Truffle-Web3.html#cb856-27" tabindex="-1"></a>      <span class="co">// Get the user type</span></span>
<span id="cb856-28"><a href="Truffle-Web3.html#cb856-28" tabindex="-1"></a>      <span class="cf">if</span> (</span>
<span id="cb856-29"><a href="Truffle-Web3.html#cb856-29" tabindex="-1"></a>        <span class="cf">await</span> (<span class="kw">this</span><span class="op">.</span><span class="at">contract</span><span class="op">.</span><span class="at">methods</span>[<span class="st">&quot;isRegisteredVoter&quot;</span>] <span class="im">as</span> any)(</span>
<span id="cb856-30"><a href="Truffle-Web3.html#cb856-30" tabindex="-1"></a>          <span class="kw">this</span><span class="op">.</span><span class="at">userAddress</span></span>
<span id="cb856-31"><a href="Truffle-Web3.html#cb856-31" tabindex="-1"></a>        )<span class="op">.</span><span class="fu">call</span>()</span>
<span id="cb856-32"><a href="Truffle-Web3.html#cb856-32" tabindex="-1"></a>      )</span>
<span id="cb856-33"><a href="Truffle-Web3.html#cb856-33" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">userType</span> <span class="op">=</span> UserType<span class="op">.</span><span class="at">RegisteredVoter</span><span class="op">;</span></span>
<span id="cb856-34"><a href="Truffle-Web3.html#cb856-34" tabindex="-1"></a>      <span class="cf">if</span> (</span>
<span id="cb856-35"><a href="Truffle-Web3.html#cb856-35" tabindex="-1"></a>        <span class="cf">await</span> (<span class="kw">this</span><span class="op">.</span><span class="at">contract</span><span class="op">.</span><span class="at">methods</span>[<span class="st">&quot;isAdministrator&quot;</span>] <span class="im">as</span> any)(</span>
<span id="cb856-36"><a href="Truffle-Web3.html#cb856-36" tabindex="-1"></a>          <span class="kw">this</span><span class="op">.</span><span class="at">userAddress</span></span>
<span id="cb856-37"><a href="Truffle-Web3.html#cb856-37" tabindex="-1"></a>        )<span class="op">.</span><span class="fu">call</span>()</span>
<span id="cb856-38"><a href="Truffle-Web3.html#cb856-38" tabindex="-1"></a>      )</span>
<span id="cb856-39"><a href="Truffle-Web3.html#cb856-39" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">userType</span> <span class="op">=</span> UserType<span class="op">.</span><span class="at">Administrator</span><span class="op">;</span></span>
<span id="cb856-40"><a href="Truffle-Web3.html#cb856-40" tabindex="-1"></a>    } <span class="cf">catch</span> (<span class="dt">error</span><span class="op">:</span> any) {</span>
<span id="cb856-41"><a href="Truffle-Web3.html#cb856-41" tabindex="-1"></a>      <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(error)<span class="op">;</span></span>
<span id="cb856-42"><a href="Truffle-Web3.html#cb856-42" tabindex="-1"></a>      message <span class="op">=</span> error<span class="op">.</span><span class="at">message</span><span class="op">;</span></span>
<span id="cb856-43"><a href="Truffle-Web3.html#cb856-43" tabindex="-1"></a>    }</span>
<span id="cb856-44"><a href="Truffle-Web3.html#cb856-44" tabindex="-1"></a>    <span class="cf">return</span> message<span class="op">;</span></span>
<span id="cb856-45"><a href="Truffle-Web3.html#cb856-45" tabindex="-1"></a>  }</span>
<span id="cb856-46"><a href="Truffle-Web3.html#cb856-46" tabindex="-1"></a>}</span></code></pre></div>
<p>Uporabniško vlogo uporabnika označimo na seznamu vseh vlog in zraven dodamo še njegov podatek o računu.</p>
<p><code>angular/src/app/shared/components/vote/vote.component.html</code></p>
<div class="sourceCode" id="cb857"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb857-1"><a href="Truffle-Web3.html#cb857-1" tabindex="-1"></a><span class="co">&lt;!-- START: User&#39;s role --&gt;</span></span>
<span id="cb857-2"><a href="Truffle-Web3.html#cb857-2" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;col-3&quot;</span><span class="dt">&gt;</span></span>
<span id="cb857-3"><a href="Truffle-Web3.html#cb857-3" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card h-100&quot;</span><span class="dt">&gt;</span></span>
<span id="cb857-4"><a href="Truffle-Web3.html#cb857-4" tabindex="-1"></a>    ...</span>
<span id="cb857-5"><a href="Truffle-Web3.html#cb857-5" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card-body&quot;</span><span class="dt">&gt;</span></span>
<span id="cb857-6"><a href="Truffle-Web3.html#cb857-6" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">div</span></span>
<span id="cb857-7"><a href="Truffle-Web3.html#cb857-7" tabindex="-1"></a><span class="ot">        *ngFor</span><span class="op">=</span><span class="st">&quot;</span></span>
<span id="cb857-8"><a href="Truffle-Web3.html#cb857-8" tabindex="-1"></a><span class="st">          let userType of [</span></span>
<span id="cb857-9"><a href="Truffle-Web3.html#cb857-9" tabindex="-1"></a><span class="st">            { type: &#39;Anonymous user&#39;, icon: &#39;fa-regular fa-user&#39; },</span></span>
<span id="cb857-10"><a href="Truffle-Web3.html#cb857-10" tabindex="-1"></a><span class="st">            { type: &#39;Unregistered voter&#39;, icon: &#39;fa-solid fa-user&#39; },</span></span>
<span id="cb857-11"><a href="Truffle-Web3.html#cb857-11" tabindex="-1"></a><span class="st">            { type: &#39;Registered voter&#39;, icon: &#39;fa-solid fa-user-plus&#39; },</span></span>
<span id="cb857-12"><a href="Truffle-Web3.html#cb857-12" tabindex="-1"></a><span class="st">            { type: &#39;Administrator&#39;, icon: &#39;fa-solid fa-user-gear&#39; }</span></span>
<span id="cb857-13"><a href="Truffle-Web3.html#cb857-13" tabindex="-1"></a><span class="st">          ];</span></span>
<span id="cb857-14"><a href="Truffle-Web3.html#cb857-14" tabindex="-1"></a><span class="st">          let i = index</span></span>
<span id="cb857-15"><a href="Truffle-Web3.html#cb857-15" tabindex="-1"></a><span class="st">        &quot;</span></span>
<span id="cb857-16"><a href="Truffle-Web3.html#cb857-16" tabindex="-1"></a><span class="ot">      </span><span class="dt">&gt;</span></span>
<span id="cb857-17"><a href="Truffle-Web3.html#cb857-17" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">span</span></span>
<span id="cb857-18"><a href="Truffle-Web3.html#cb857-18" tabindex="-1"></a><span class="ot">          [ngClass]</span><span class="op">=</span><span class="st">&quot;{</span></span>
<span id="cb857-19"><a href="Truffle-Web3.html#cb857-19" tabindex="-1"></a><span class="st">            &#39;text-primary fw-bold&#39;: web3Service.userType == i + 1,</span></span>
<span id="cb857-20"><a href="Truffle-Web3.html#cb857-20" tabindex="-1"></a><span class="st">            &#39;text-muted&#39;: web3Service.userType != i + 1</span></span>
<span id="cb857-21"><a href="Truffle-Web3.html#cb857-21" tabindex="-1"></a><span class="st">          }&quot;</span></span>
<span id="cb857-22"><a href="Truffle-Web3.html#cb857-22" tabindex="-1"></a><span class="ot">          </span><span class="dt">&gt;&lt;</span><span class="kw">i</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;{{ userType.icon }} pe-2&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">i</span><span class="dt">&gt;</span>{{ userType.type }}<span class="dt">&lt;/</span><span class="kw">span</span></span>
<span id="cb857-23"><a href="Truffle-Web3.html#cb857-23" tabindex="-1"></a>        <span class="dt">&gt;</span></span>
<span id="cb857-24"><a href="Truffle-Web3.html#cb857-24" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> *ngIf</span><span class="op">=</span><span class="st">&quot;web3Service.userType == i + 1&quot;</span><span class="dt">&gt;</span></span>
<span id="cb857-25"><a href="Truffle-Web3.html#cb857-25" tabindex="-1"></a>          <span class="dt">&lt;</span><span class="kw">small</span></span>
<span id="cb857-26"><a href="Truffle-Web3.html#cb857-26" tabindex="-1"></a><span class="ot">            </span><span class="dt">&gt;&lt;</span><span class="kw">code</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;text-primary&quot;</span><span class="dt">&gt;</span>{{</span>
<span id="cb857-27"><a href="Truffle-Web3.html#cb857-27" tabindex="-1"></a>              web3Service.userAddress</span>
<span id="cb857-28"><a href="Truffle-Web3.html#cb857-28" tabindex="-1"></a>            }}<span class="dt">&lt;/</span><span class="kw">code</span><span class="dt">&gt;&lt;/</span><span class="kw">small</span></span>
<span id="cb857-29"><a href="Truffle-Web3.html#cb857-29" tabindex="-1"></a>          <span class="dt">&gt;</span></span>
<span id="cb857-30"><a href="Truffle-Web3.html#cb857-30" tabindex="-1"></a>        <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb857-31"><a href="Truffle-Web3.html#cb857-31" tabindex="-1"></a>      <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb857-32"><a href="Truffle-Web3.html#cb857-32" tabindex="-1"></a>    <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb857-33"><a href="Truffle-Web3.html#cb857-33" tabindex="-1"></a>    ...</span>
<span id="cb857-34"><a href="Truffle-Web3.html#cb857-34" tabindex="-1"></a>  <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb857-35"><a href="Truffle-Web3.html#cb857-35" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb857-36"><a href="Truffle-Web3.html#cb857-36" tabindex="-1"></a><span class="co">&lt;!-- </span><span class="re">END</span><span class="co">: User&#39;s role --&gt;</span></span></code></pre></div>
<p>Za <strong>pregled statusa glasovanja</strong> je na voljo funkcija <code>getWorkflowStatus()</code> storitve <code>web3</code>, kjer s klicem funkcije <code>getWorkflowStatus()</code> pametne pogodbe na verigi blokov zahtevamo trenutni status glasovanja.</p>
<p>V skladu z rezultatom stanja spremenljivke pametne pogodbe na verigi blokov najprej posodobimo prikazan status na spletni strani (glej razdelek <strong>Current voting status</strong> na sliki <a href="Truffle-Web3.html#fig:slika-Glasovanje-spletna-stran">13.4</a>).</p>
<p>Poleg statusov, ki smo jih opredelili že v pametni pogodbi, dodamo še status, ko status glasovanja ni na voljo, saj ne moremo dostopati do pametne pogodbe (npr. le-ta ni postavljena na verigo blokov ali smo povezani na napačno verigo blokov).</p>
<p>Poskrbimo tudi, da se omenjena funkcija pokliče ob začetnem nalaganju spletne strani.</p>
<p><code>angular/src/app/shared/services/web3.service.ts</code></p>
<div class="sourceCode" id="cb858"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb858-1"><a href="Truffle-Web3.html#cb858-1" tabindex="-1"></a><span class="kw">enum</span> UserType {</span>
<span id="cb858-2"><a href="Truffle-Web3.html#cb858-2" tabindex="-1"></a>  AnonymousUser <span class="op">=</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb858-3"><a href="Truffle-Web3.html#cb858-3" tabindex="-1"></a>  UnregisteredVoter <span class="op">=</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb858-4"><a href="Truffle-Web3.html#cb858-4" tabindex="-1"></a>  RegisteredVoter <span class="op">=</span> <span class="dv">3</span><span class="op">,</span></span>
<span id="cb858-5"><a href="Truffle-Web3.html#cb858-5" tabindex="-1"></a>  Administrator <span class="op">=</span> <span class="dv">4</span><span class="op">,</span></span>
<span id="cb858-6"><a href="Truffle-Web3.html#cb858-6" tabindex="-1"></a>}</span>
<span id="cb858-7"><a href="Truffle-Web3.html#cb858-7" tabindex="-1"></a><span class="kw">enum</span> WorkflowStatus {</span>
<span id="cb858-8"><a href="Truffle-Web3.html#cb858-8" tabindex="-1"></a>  NotAvailable <span class="op">=</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb858-9"><a href="Truffle-Web3.html#cb858-9" tabindex="-1"></a>  RegisteringVoters <span class="op">=</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb858-10"><a href="Truffle-Web3.html#cb858-10" tabindex="-1"></a>  ProposalsRegistrationStarted <span class="op">=</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb858-11"><a href="Truffle-Web3.html#cb858-11" tabindex="-1"></a>  ProposalRegistrationEnded <span class="op">=</span> <span class="dv">3</span><span class="op">,</span></span>
<span id="cb858-12"><a href="Truffle-Web3.html#cb858-12" tabindex="-1"></a>  VotingSessionStarted <span class="op">=</span> <span class="dv">4</span><span class="op">,</span></span>
<span id="cb858-13"><a href="Truffle-Web3.html#cb858-13" tabindex="-1"></a>  VotingSessionEnded <span class="op">=</span> <span class="dv">5</span><span class="op">,</span></span>
<span id="cb858-14"><a href="Truffle-Web3.html#cb858-14" tabindex="-1"></a>  VotesTallied <span class="op">=</span> <span class="dv">6</span><span class="op">,</span></span>
<span id="cb858-15"><a href="Truffle-Web3.html#cb858-15" tabindex="-1"></a>}</span>
<span id="cb858-16"><a href="Truffle-Web3.html#cb858-16" tabindex="-1"></a><span class="op">...</span></span>
<span id="cb858-17"><a href="Truffle-Web3.html#cb858-17" tabindex="-1"></a><span class="im">export</span> <span class="kw">class</span> Web3Service {</span>
<span id="cb858-18"><a href="Truffle-Web3.html#cb858-18" tabindex="-1"></a>  <span class="kw">public</span> userAddress<span class="op">!:</span> string<span class="op">;</span></span>
<span id="cb858-19"><a href="Truffle-Web3.html#cb858-19" tabindex="-1"></a>  <span class="kw">public</span> <span class="dt">userType</span><span class="op">:</span> UserType <span class="op">=</span> UserType<span class="op">.</span><span class="at">AnonymousUser</span><span class="op">;</span></span>
<span id="cb858-20"><a href="Truffle-Web3.html#cb858-20" tabindex="-1"></a>  <span class="kw">public</span> <span class="dt">workflowStatus</span><span class="op">:</span> WorkflowStatus <span class="op">=</span> WorkflowStatus<span class="op">.</span><span class="at">NotAvailable</span><span class="op">;</span></span>
<span id="cb858-21"><a href="Truffle-Web3.html#cb858-21" tabindex="-1"></a>  <span class="kw">private</span> web3<span class="op">!:</span> any<span class="op">;</span></span>
<span id="cb858-22"><a href="Truffle-Web3.html#cb858-22" tabindex="-1"></a>  <span class="op">...</span></span>
<span id="cb858-23"><a href="Truffle-Web3.html#cb858-23" tabindex="-1"></a>  <span class="kw">public</span> <span class="kw">async</span> <span class="fu">connectToBC</span>()<span class="op">:</span> <span class="bu">Promise</span><span class="op">&lt;</span>string<span class="op">&gt;</span> {</span>
<span id="cb858-24"><a href="Truffle-Web3.html#cb858-24" tabindex="-1"></a>    <span class="kw">let</span> message <span class="op">=</span> <span class="st">&quot;&quot;</span><span class="op">;</span></span>
<span id="cb858-25"><a href="Truffle-Web3.html#cb858-25" tabindex="-1"></a>    <span class="cf">try</span> {</span>
<span id="cb858-26"><a href="Truffle-Web3.html#cb858-26" tabindex="-1"></a>      <span class="op">...</span></span>
<span id="cb858-27"><a href="Truffle-Web3.html#cb858-27" tabindex="-1"></a>      <span class="co">// Get the workflow status</span></span>
<span id="cb858-28"><a href="Truffle-Web3.html#cb858-28" tabindex="-1"></a>      <span class="kw">this</span><span class="op">.</span><span class="at">workflowStatus</span> <span class="op">=</span> <span class="cf">await</span> <span class="kw">this</span><span class="op">.</span><span class="fu">getWorkflowStatus</span>()<span class="op">;</span></span>
<span id="cb858-29"><a href="Truffle-Web3.html#cb858-29" tabindex="-1"></a>    } <span class="cf">catch</span> (<span class="dt">error</span><span class="op">:</span> any) {</span>
<span id="cb858-30"><a href="Truffle-Web3.html#cb858-30" tabindex="-1"></a>      message <span class="op">=</span> error<span class="op">.</span><span class="at">message</span><span class="op">;</span></span>
<span id="cb858-31"><a href="Truffle-Web3.html#cb858-31" tabindex="-1"></a>    }</span>
<span id="cb858-32"><a href="Truffle-Web3.html#cb858-32" tabindex="-1"></a>    <span class="cf">return</span> message<span class="op">;</span></span>
<span id="cb858-33"><a href="Truffle-Web3.html#cb858-33" tabindex="-1"></a>  }</span>
<span id="cb858-34"><a href="Truffle-Web3.html#cb858-34" tabindex="-1"></a>  <span class="kw">public</span> <span class="kw">async</span> <span class="fu">getWorkflowStatus</span>()<span class="op">:</span> <span class="bu">Promise</span><span class="op">&lt;</span>WorkflowStatus<span class="op">&gt;</span> {</span>
<span id="cb858-35"><a href="Truffle-Web3.html#cb858-35" tabindex="-1"></a>    <span class="kw">let</span> workflowStatus <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb858-36"><a href="Truffle-Web3.html#cb858-36" tabindex="-1"></a>    <span class="cf">try</span> {</span>
<span id="cb858-37"><a href="Truffle-Web3.html#cb858-37" tabindex="-1"></a>      workflowStatus <span class="op">=</span></span>
<span id="cb858-38"><a href="Truffle-Web3.html#cb858-38" tabindex="-1"></a>        <span class="bu">Number</span>(</span>
<span id="cb858-39"><a href="Truffle-Web3.html#cb858-39" tabindex="-1"></a>          Web3<span class="op">.</span><span class="at">utils</span><span class="op">.</span><span class="fu">toNumber</span>(</span>
<span id="cb858-40"><a href="Truffle-Web3.html#cb858-40" tabindex="-1"></a>            <span class="cf">await</span> (<span class="kw">this</span><span class="op">.</span><span class="at">contract</span><span class="op">.</span><span class="at">methods</span>[<span class="st">&quot;getWorkflowStatus&quot;</span>] <span class="im">as</span> any)()<span class="op">.</span><span class="fu">call</span>()</span>
<span id="cb858-41"><a href="Truffle-Web3.html#cb858-41" tabindex="-1"></a>          )</span>
<span id="cb858-42"><a href="Truffle-Web3.html#cb858-42" tabindex="-1"></a>        ) <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb858-43"><a href="Truffle-Web3.html#cb858-43" tabindex="-1"></a>      <span class="kw">this</span><span class="op">.</span><span class="at">workflowStatus</span> <span class="op">=</span> workflowStatus<span class="op">;</span></span>
<span id="cb858-44"><a href="Truffle-Web3.html#cb858-44" tabindex="-1"></a>    } <span class="cf">catch</span> (error) {}</span>
<span id="cb858-45"><a href="Truffle-Web3.html#cb858-45" tabindex="-1"></a>    <span class="cf">return</span> workflowStatus<span class="op">;</span></span>
<span id="cb858-46"><a href="Truffle-Web3.html#cb858-46" tabindex="-1"></a>  }</span>
<span id="cb858-47"><a href="Truffle-Web3.html#cb858-47" tabindex="-1"></a>}</span></code></pre></div>
<p><code>angular/src/app/shared/components/vote/vote.component.html</code></p>
<div class="sourceCode" id="cb859"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb859-1"><a href="Truffle-Web3.html#cb859-1" tabindex="-1"></a><span class="co">&lt;!-- START: Current voting status --&gt;</span></span>
<span id="cb859-2"><a href="Truffle-Web3.html#cb859-2" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;col-9&quot;</span><span class="dt">&gt;</span></span>
<span id="cb859-3"><a href="Truffle-Web3.html#cb859-3" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card h-100&quot;</span><span class="dt">&gt;</span></span>
<span id="cb859-4"><a href="Truffle-Web3.html#cb859-4" tabindex="-1"></a>    ...</span>
<span id="cb859-5"><a href="Truffle-Web3.html#cb859-5" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card-body&quot;</span><span class="dt">&gt;</span></span>
<span id="cb859-6"><a href="Truffle-Web3.html#cb859-6" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;d-flex justify-content-between&quot;</span><span class="dt">&gt;</span></span>
<span id="cb859-7"><a href="Truffle-Web3.html#cb859-7" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">div</span></span>
<span id="cb859-8"><a href="Truffle-Web3.html#cb859-8" tabindex="-1"></a><span class="ot">          class</span><span class="op">=</span><span class="st">&quot;justify-content-center text-center&quot;</span></span>
<span id="cb859-9"><a href="Truffle-Web3.html#cb859-9" tabindex="-1"></a><span class="ot">          *ngFor</span><span class="op">=</span><span class="st">&quot;</span></span>
<span id="cb859-10"><a href="Truffle-Web3.html#cb859-10" tabindex="-1"></a><span class="st">            let status of [</span></span>
<span id="cb859-11"><a href="Truffle-Web3.html#cb859-11" tabindex="-1"></a><span class="st">              &#39;Not available&#39;,</span></span>
<span id="cb859-12"><a href="Truffle-Web3.html#cb859-12" tabindex="-1"></a><span class="st">              &#39;Registering voters&#39;,</span></span>
<span id="cb859-13"><a href="Truffle-Web3.html#cb859-13" tabindex="-1"></a><span class="st">              &#39;Proposal registration started&#39;,</span></span>
<span id="cb859-14"><a href="Truffle-Web3.html#cb859-14" tabindex="-1"></a><span class="st">              &#39;Proposal registration ended&#39;,</span></span>
<span id="cb859-15"><a href="Truffle-Web3.html#cb859-15" tabindex="-1"></a><span class="st">              &#39;Voting started&#39;,</span></span>
<span id="cb859-16"><a href="Truffle-Web3.html#cb859-16" tabindex="-1"></a><span class="st">              &#39;Voting ended&#39;,</span></span>
<span id="cb859-17"><a href="Truffle-Web3.html#cb859-17" tabindex="-1"></a><span class="st">              &#39;Votes tallied&#39;</span></span>
<span id="cb859-18"><a href="Truffle-Web3.html#cb859-18" tabindex="-1"></a><span class="st">            ];</span></span>
<span id="cb859-19"><a href="Truffle-Web3.html#cb859-19" tabindex="-1"></a><span class="st">            let i = index</span></span>
<span id="cb859-20"><a href="Truffle-Web3.html#cb859-20" tabindex="-1"></a><span class="st">          &quot;</span></span>
<span id="cb859-21"><a href="Truffle-Web3.html#cb859-21" tabindex="-1"></a><span class="ot">        </span><span class="dt">&gt;</span></span>
<span id="cb859-22"><a href="Truffle-Web3.html#cb859-22" tabindex="-1"></a>          <span class="dt">&lt;</span><span class="kw">div</span></span>
<span id="cb859-23"><a href="Truffle-Web3.html#cb859-23" tabindex="-1"></a><span class="ot">            class</span><span class="op">=</span><span class="st">&quot;badge rounded-circle bg-light text-muted ps-2 pe-2&quot;</span></span>
<span id="cb859-24"><a href="Truffle-Web3.html#cb859-24" tabindex="-1"></a><span class="ot">            [ngClass]</span><span class="op">=</span><span class="st">&quot;{</span></span>
<span id="cb859-25"><a href="Truffle-Web3.html#cb859-25" tabindex="-1"></a><span class="st">              &#39;bg-primary&#39;: web3Service.workflowStatus == i,</span></span>
<span id="cb859-26"><a href="Truffle-Web3.html#cb859-26" tabindex="-1"></a><span class="st">              &#39;bg-light text-muted&#39;: web3Service.workflowStatus != i</span></span>
<span id="cb859-27"><a href="Truffle-Web3.html#cb859-27" tabindex="-1"></a><span class="st">            }&quot;</span></span>
<span id="cb859-28"><a href="Truffle-Web3.html#cb859-28" tabindex="-1"></a><span class="ot">          </span><span class="dt">&gt;</span></span>
<span id="cb859-29"><a href="Truffle-Web3.html#cb859-29" tabindex="-1"></a>            {{ i }}</span>
<span id="cb859-30"><a href="Truffle-Web3.html#cb859-30" tabindex="-1"></a>          <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb859-31"><a href="Truffle-Web3.html#cb859-31" tabindex="-1"></a>          <span class="dt">&lt;</span><span class="kw">div</span></span>
<span id="cb859-32"><a href="Truffle-Web3.html#cb859-32" tabindex="-1"></a><span class="ot">            class</span><span class="op">=</span><span class="st">&quot;m-2&quot;</span></span>
<span id="cb859-33"><a href="Truffle-Web3.html#cb859-33" tabindex="-1"></a><span class="ot">            [ngClass]</span><span class="op">=</span><span class="st">&quot;{</span></span>
<span id="cb859-34"><a href="Truffle-Web3.html#cb859-34" tabindex="-1"></a><span class="st">              &#39;text-primary fw-bold&#39;: web3Service.workflowStatus == i,</span></span>
<span id="cb859-35"><a href="Truffle-Web3.html#cb859-35" tabindex="-1"></a><span class="st">              &#39;text-muted&#39;: web3Service.workflowStatus != i</span></span>
<span id="cb859-36"><a href="Truffle-Web3.html#cb859-36" tabindex="-1"></a><span class="st">            }&quot;</span></span>
<span id="cb859-37"><a href="Truffle-Web3.html#cb859-37" tabindex="-1"></a><span class="ot">          </span><span class="dt">&gt;</span></span>
<span id="cb859-38"><a href="Truffle-Web3.html#cb859-38" tabindex="-1"></a>            {{ status }}</span>
<span id="cb859-39"><a href="Truffle-Web3.html#cb859-39" tabindex="-1"></a>          <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb859-40"><a href="Truffle-Web3.html#cb859-40" tabindex="-1"></a>        <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb859-41"><a href="Truffle-Web3.html#cb859-41" tabindex="-1"></a>      <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb859-42"><a href="Truffle-Web3.html#cb859-42" tabindex="-1"></a>    <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb859-43"><a href="Truffle-Web3.html#cb859-43" tabindex="-1"></a>    ...</span>
<span id="cb859-44"><a href="Truffle-Web3.html#cb859-44" tabindex="-1"></a>  <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb859-45"><a href="Truffle-Web3.html#cb859-45" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb859-46"><a href="Truffle-Web3.html#cb859-46" tabindex="-1"></a><span class="co">&lt;!-- </span><span class="re">END</span><span class="co">: Current voting status --&gt;</span></span></code></pre></div>
<p>Naslednja funkcionalnost je <strong>pregled seznama predlogov</strong> v okviru metode <code>getListOfProposals()</code>, kjer uporabimo metodo <code>getProposalsNumber()</code> pametne pogodbe ter nato v zanki pridobimo opise predlogov (<code>getProposalDescription(...)</code>) in jih dodamo v tabelo predlogov.</p>
<p>Seznam predlogov prikažemo zgolj v fazah zbiranja predlogov in glasovanja, kjer uporabimo metodo <code>displayListOfProposals()</code>, ki jo uporabimo na ustreznih mestih v HTML predlogi.</p>
<p><code>angular/src/app/shared/services/web3.service.ts</code></p>
<div class="sourceCode" id="cb860"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb860-1"><a href="Truffle-Web3.html#cb860-1" tabindex="-1"></a><span class="im">export</span> <span class="kw">class</span> Web3Service {</span>
<span id="cb860-2"><a href="Truffle-Web3.html#cb860-2" tabindex="-1"></a>  <span class="op">...</span></span>
<span id="cb860-3"><a href="Truffle-Web3.html#cb860-3" tabindex="-1"></a>  <span class="kw">public</span> <span class="dt">workflowStatus</span><span class="op">:</span> WorkflowStatus <span class="op">=</span> WorkflowStatus<span class="op">.</span><span class="at">NotAvailable</span><span class="op">;</span></span>
<span id="cb860-4"><a href="Truffle-Web3.html#cb860-4" tabindex="-1"></a>  <span class="kw">public</span> <span class="dt">proposals</span><span class="op">:</span> string[] <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb860-5"><a href="Truffle-Web3.html#cb860-5" tabindex="-1"></a>  <span class="kw">private</span> web3<span class="op">!:</span> any<span class="op">;</span></span>
<span id="cb860-6"><a href="Truffle-Web3.html#cb860-6" tabindex="-1"></a>  <span class="op">...</span></span>
<span id="cb860-7"><a href="Truffle-Web3.html#cb860-7" tabindex="-1"></a>  <span class="kw">public</span> <span class="kw">async</span> <span class="fu">connectToBC</span>()<span class="op">:</span> <span class="bu">Promise</span><span class="op">&lt;</span>string<span class="op">&gt;</span> {</span>
<span id="cb860-8"><a href="Truffle-Web3.html#cb860-8" tabindex="-1"></a>    <span class="op">...</span></span>
<span id="cb860-9"><a href="Truffle-Web3.html#cb860-9" tabindex="-1"></a>    <span class="cf">try</span> {</span>
<span id="cb860-10"><a href="Truffle-Web3.html#cb860-10" tabindex="-1"></a>      <span class="op">...</span></span>
<span id="cb860-11"><a href="Truffle-Web3.html#cb860-11" tabindex="-1"></a>      <span class="co">// Refresh data</span></span>
<span id="cb860-12"><a href="Truffle-Web3.html#cb860-12" tabindex="-1"></a>      <span class="cf">await</span> <span class="kw">this</span><span class="op">.</span><span class="fu">getListOfProposals</span>()<span class="op">;</span></span>
<span id="cb860-13"><a href="Truffle-Web3.html#cb860-13" tabindex="-1"></a>    } <span class="cf">catch</span> (<span class="dt">error</span><span class="op">:</span> any) {</span>
<span id="cb860-14"><a href="Truffle-Web3.html#cb860-14" tabindex="-1"></a>      message <span class="op">=</span> error<span class="op">.</span><span class="at">message</span><span class="op">;</span></span>
<span id="cb860-15"><a href="Truffle-Web3.html#cb860-15" tabindex="-1"></a>    } <span class="cf">finally</span> {</span>
<span id="cb860-16"><a href="Truffle-Web3.html#cb860-16" tabindex="-1"></a>      <span class="cf">return</span> message<span class="op">;</span></span>
<span id="cb860-17"><a href="Truffle-Web3.html#cb860-17" tabindex="-1"></a>    }</span>
<span id="cb860-18"><a href="Truffle-Web3.html#cb860-18" tabindex="-1"></a>  }</span>
<span id="cb860-19"><a href="Truffle-Web3.html#cb860-19" tabindex="-1"></a>  <span class="op">...</span></span>
<span id="cb860-20"><a href="Truffle-Web3.html#cb860-20" tabindex="-1"></a>  <span class="kw">public</span> <span class="kw">async</span> <span class="fu">getListOfProposals</span>()<span class="op">:</span> <span class="bu">Promise</span><span class="op">&lt;</span>string[]<span class="op">&gt;</span> {</span>
<span id="cb860-21"><a href="Truffle-Web3.html#cb860-21" tabindex="-1"></a>    <span class="kw">let</span> <span class="dt">proposals</span><span class="op">:</span> string[] <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb860-22"><a href="Truffle-Web3.html#cb860-22" tabindex="-1"></a>    <span class="cf">try</span> {</span>
<span id="cb860-23"><a href="Truffle-Web3.html#cb860-23" tabindex="-1"></a>      <span class="kw">let</span> nProposals <span class="op">=</span> Web3<span class="op">.</span><span class="at">utils</span><span class="op">.</span><span class="fu">toNumber</span>(</span>
<span id="cb860-24"><a href="Truffle-Web3.html#cb860-24" tabindex="-1"></a>        <span class="cf">await</span> (<span class="kw">this</span><span class="op">.</span><span class="at">contract</span><span class="op">.</span><span class="at">methods</span>[<span class="st">&quot;getProposalsNumber&quot;</span>] <span class="im">as</span> any)()<span class="op">.</span><span class="fu">call</span>()</span>
<span id="cb860-25"><a href="Truffle-Web3.html#cb860-25" tabindex="-1"></a>      )<span class="op">;</span></span>
<span id="cb860-26"><a href="Truffle-Web3.html#cb860-26" tabindex="-1"></a>      <span class="cf">if</span> (nProposals <span class="op">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb860-27"><a href="Truffle-Web3.html#cb860-27" tabindex="-1"></a>        <span class="cf">for</span> (<span class="kw">let</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> nProposals<span class="op">;</span> i<span class="op">++</span>)</span>
<span id="cb860-28"><a href="Truffle-Web3.html#cb860-28" tabindex="-1"></a>          proposals<span class="op">.</span><span class="fu">push</span>(</span>
<span id="cb860-29"><a href="Truffle-Web3.html#cb860-29" tabindex="-1"></a>            <span class="cf">await</span> (<span class="kw">this</span><span class="op">.</span><span class="at">contract</span><span class="op">.</span><span class="at">methods</span>[<span class="st">&quot;getProposalDescription&quot;</span>] <span class="im">as</span> any)(</span>
<span id="cb860-30"><a href="Truffle-Web3.html#cb860-30" tabindex="-1"></a>              i</span>
<span id="cb860-31"><a href="Truffle-Web3.html#cb860-31" tabindex="-1"></a>            )<span class="op">.</span><span class="fu">call</span>()</span>
<span id="cb860-32"><a href="Truffle-Web3.html#cb860-32" tabindex="-1"></a>          )<span class="op">;</span></span>
<span id="cb860-33"><a href="Truffle-Web3.html#cb860-33" tabindex="-1"></a>      }</span>
<span id="cb860-34"><a href="Truffle-Web3.html#cb860-34" tabindex="-1"></a>    } <span class="cf">catch</span> (error) {</span>
<span id="cb860-35"><a href="Truffle-Web3.html#cb860-35" tabindex="-1"></a>      <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(error)<span class="op">;</span></span>
<span id="cb860-36"><a href="Truffle-Web3.html#cb860-36" tabindex="-1"></a>    } <span class="cf">finally</span> {</span>
<span id="cb860-37"><a href="Truffle-Web3.html#cb860-37" tabindex="-1"></a>      <span class="kw">this</span><span class="op">.</span><span class="at">proposals</span> <span class="op">=</span> proposals<span class="op">;</span></span>
<span id="cb860-38"><a href="Truffle-Web3.html#cb860-38" tabindex="-1"></a>    }</span>
<span id="cb860-39"><a href="Truffle-Web3.html#cb860-39" tabindex="-1"></a>    <span class="cf">return</span> proposals<span class="op">;</span></span>
<span id="cb860-40"><a href="Truffle-Web3.html#cb860-40" tabindex="-1"></a>  }</span>
<span id="cb860-41"><a href="Truffle-Web3.html#cb860-41" tabindex="-1"></a>}</span></code></pre></div>
<p><code>angular/src/app/shared/components/vote/vote.component.ts</code></p>
<div class="sourceCode" id="cb861"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb861-1"><a href="Truffle-Web3.html#cb861-1" tabindex="-1"></a><span class="im">export</span> <span class="kw">class</span> VoteComponent <span class="kw">implements</span> OnInit {</span>
<span id="cb861-2"><a href="Truffle-Web3.html#cb861-2" tabindex="-1"></a>  <span class="op">...</span></span>
<span id="cb861-3"><a href="Truffle-Web3.html#cb861-3" tabindex="-1"></a>  <span class="fu">displayListOfProposals</span>()<span class="op">:</span> boolean {</span>
<span id="cb861-4"><a href="Truffle-Web3.html#cb861-4" tabindex="-1"></a>    <span class="cf">return</span> (</span>
<span id="cb861-5"><a href="Truffle-Web3.html#cb861-5" tabindex="-1"></a>      <span class="kw">this</span><span class="op">.</span><span class="at">web3Service</span><span class="op">.</span><span class="at">workflowStatus</span> <span class="op">&gt;=</span> <span class="dv">2</span> <span class="op">&amp;&amp;</span></span>
<span id="cb861-6"><a href="Truffle-Web3.html#cb861-6" tabindex="-1"></a>      <span class="kw">this</span><span class="op">.</span><span class="at">web3Service</span><span class="op">.</span><span class="at">workflowStatus</span> <span class="op">&lt;=</span> <span class="dv">4</span></span>
<span id="cb861-7"><a href="Truffle-Web3.html#cb861-7" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb861-8"><a href="Truffle-Web3.html#cb861-8" tabindex="-1"></a>  }</span>
<span id="cb861-9"><a href="Truffle-Web3.html#cb861-9" tabindex="-1"></a>}</span></code></pre></div>
<p><code>angular/src/app/shared/components/vote/vote.component.html</code></p>
<div class="sourceCode" id="cb862"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb862-1"><a href="Truffle-Web3.html#cb862-1" tabindex="-1"></a><span class="co">&lt;!-- START: List of proposals --&gt;</span></span>
<span id="cb862-2"><a href="Truffle-Web3.html#cb862-2" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;col&quot;</span><span class="dt">&gt;</span></span>
<span id="cb862-3"><a href="Truffle-Web3.html#cb862-3" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card h-100&quot;</span><span class="dt">&gt;</span></span>
<span id="cb862-4"><a href="Truffle-Web3.html#cb862-4" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card-header bg-light&quot;</span><span class="dt">&gt;</span></span>
<span id="cb862-5"><a href="Truffle-Web3.html#cb862-5" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">h4</span></span>
<span id="cb862-6"><a href="Truffle-Web3.html#cb862-6" tabindex="-1"></a><span class="ot">        class</span><span class="op">=</span><span class="st">&quot;mb-0&quot;</span></span>
<span id="cb862-7"><a href="Truffle-Web3.html#cb862-7" tabindex="-1"></a><span class="ot">        [ngClass]</span><span class="op">=</span><span class="st">&quot;{ &#39;text-muted&#39;: !displayListOfProposals() }&quot;</span></span>
<span id="cb862-8"><a href="Truffle-Web3.html#cb862-8" tabindex="-1"></a><span class="ot">      </span><span class="dt">&gt;</span></span>
<span id="cb862-9"><a href="Truffle-Web3.html#cb862-9" tabindex="-1"></a>        List of proposals<span class="dt">&lt;</span><span class="kw">sup</span></span>
<span id="cb862-10"><a href="Truffle-Web3.html#cb862-10" tabindex="-1"></a><span class="ot">          </span><span class="dt">&gt;&lt;</span><span class="kw">small</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;text-muted&quot;</span></span>
<span id="cb862-11"><a href="Truffle-Web3.html#cb862-11" tabindex="-1"></a><span class="ot">            </span><span class="dt">&gt;&lt;</span><span class="kw">i</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;fa-solid fa-user ps-2 pe-1&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">i</span><span class="dt">&gt;&lt;/</span><span class="kw">small</span></span>
<span id="cb862-12"><a href="Truffle-Web3.html#cb862-12" tabindex="-1"></a>        <span class="dt">&gt;&lt;/</span><span class="kw">sup</span><span class="dt">&gt;</span></span>
<span id="cb862-13"><a href="Truffle-Web3.html#cb862-13" tabindex="-1"></a>      <span class="dt">&lt;/</span><span class="kw">h4</span><span class="dt">&gt;</span></span>
<span id="cb862-14"><a href="Truffle-Web3.html#cb862-14" tabindex="-1"></a>    <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb862-15"><a href="Truffle-Web3.html#cb862-15" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">div</span></span>
<span id="cb862-16"><a href="Truffle-Web3.html#cb862-16" tabindex="-1"></a><span class="ot">      class</span><span class="op">=</span><span class="st">&quot;card-body&quot;</span></span>
<span id="cb862-17"><a href="Truffle-Web3.html#cb862-17" tabindex="-1"></a><span class="ot">      *ngIf</span><span class="op">=</span><span class="st">&quot;web3Service.proposals.length == 0&quot;</span></span>
<span id="cb862-18"><a href="Truffle-Web3.html#cb862-18" tabindex="-1"></a><span class="ot">      [ngClass]</span><span class="op">=</span><span class="st">&quot;{ &#39;text-muted&#39;: !displayListOfProposals() }&quot;</span></span>
<span id="cb862-19"><a href="Truffle-Web3.html#cb862-19" tabindex="-1"></a><span class="ot">    </span><span class="dt">&gt;</span></span>
<span id="cb862-20"><a href="Truffle-Web3.html#cb862-20" tabindex="-1"></a>      List of proposals is empty.</span>
<span id="cb862-21"><a href="Truffle-Web3.html#cb862-21" tabindex="-1"></a>    <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb862-22"><a href="Truffle-Web3.html#cb862-22" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">div</span></span>
<span id="cb862-23"><a href="Truffle-Web3.html#cb862-23" tabindex="-1"></a><span class="ot">      class</span><span class="op">=</span><span class="st">&quot;card-body&quot;</span></span>
<span id="cb862-24"><a href="Truffle-Web3.html#cb862-24" tabindex="-1"></a><span class="ot">      *ngIf</span><span class="op">=</span><span class="st">&quot;web3Service.proposals.length &gt; 0&quot;</span></span>
<span id="cb862-25"><a href="Truffle-Web3.html#cb862-25" tabindex="-1"></a><span class="ot">      [ngClass]</span><span class="op">=</span><span class="st">&quot;{ &#39;text-muted&#39;: !displayListOfProposals() }&quot;</span></span>
<span id="cb862-26"><a href="Truffle-Web3.html#cb862-26" tabindex="-1"></a><span class="ot">    </span><span class="dt">&gt;</span></span>
<span id="cb862-27"><a href="Truffle-Web3.html#cb862-27" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">ul</span><span class="dt">&gt;</span></span>
<span id="cb862-28"><a href="Truffle-Web3.html#cb862-28" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">li</span></span>
<span id="cb862-29"><a href="Truffle-Web3.html#cb862-29" tabindex="-1"></a><span class="ot">          class</span><span class="op">=</span><span class="st">&quot;fw-bold&quot;</span></span>
<span id="cb862-30"><a href="Truffle-Web3.html#cb862-30" tabindex="-1"></a><span class="ot">          [ngClass]</span><span class="op">=</span><span class="st">&quot;{</span></span>
<span id="cb862-31"><a href="Truffle-Web3.html#cb862-31" tabindex="-1"></a><span class="st">            &#39;text-muted&#39;: !displayListOfProposals(),</span></span>
<span id="cb862-32"><a href="Truffle-Web3.html#cb862-32" tabindex="-1"></a><span class="st">            &#39;text-primary&#39;: displayListOfProposals()</span></span>
<span id="cb862-33"><a href="Truffle-Web3.html#cb862-33" tabindex="-1"></a><span class="st">          }&quot;</span></span>
<span id="cb862-34"><a href="Truffle-Web3.html#cb862-34" tabindex="-1"></a><span class="ot">          *ngFor</span><span class="op">=</span><span class="st">&quot;let proposal of web3Service.proposals&quot;</span></span>
<span id="cb862-35"><a href="Truffle-Web3.html#cb862-35" tabindex="-1"></a><span class="ot">        </span><span class="dt">&gt;</span></span>
<span id="cb862-36"><a href="Truffle-Web3.html#cb862-36" tabindex="-1"></a>          {{ proposal }}</span>
<span id="cb862-37"><a href="Truffle-Web3.html#cb862-37" tabindex="-1"></a>        <span class="dt">&lt;/</span><span class="kw">li</span><span class="dt">&gt;</span></span>
<span id="cb862-38"><a href="Truffle-Web3.html#cb862-38" tabindex="-1"></a>      <span class="dt">&lt;/</span><span class="kw">ul</span><span class="dt">&gt;</span></span>
<span id="cb862-39"><a href="Truffle-Web3.html#cb862-39" tabindex="-1"></a>    <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb862-40"><a href="Truffle-Web3.html#cb862-40" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card-footer small text-muted&quot;</span><span class="dt">&gt;</span></span>
<span id="cb862-41"><a href="Truffle-Web3.html#cb862-41" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">i</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;fa-solid fa-circle-info pe-1&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">i</span><span class="dt">&gt;</span>List of proposals for voting</span>
<span id="cb862-42"><a href="Truffle-Web3.html#cb862-42" tabindex="-1"></a>      is available to all users.</span>
<span id="cb862-43"><a href="Truffle-Web3.html#cb862-43" tabindex="-1"></a>    <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb862-44"><a href="Truffle-Web3.html#cb862-44" tabindex="-1"></a>  <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb862-45"><a href="Truffle-Web3.html#cb862-45" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb862-46"><a href="Truffle-Web3.html#cb862-46" tabindex="-1"></a><span class="co">&lt;!-- </span><span class="re">END</span><span class="co">: List of proposals --&gt;</span></span></code></pre></div>
<p>Neregistriran volivec ima na voljo tudi <strong>pregled rezultatov glasovanja</strong>, ki je na voljo zgolj v zaključni fazi (<code>displayVotingResults()</code>), zato pri funkciji <code>getVotingResults()</code> najprej preverimo, če se nahajamo v fazi preštetih glasov. Če to drži, pridobimo enolični identifikator, opis in število glasov zmagovalnega predloga ter rezultat prikažemo na spletni strani.</p>
<p>Poskrbimo tudi, da se funkcija pokliče ob začetnem nalaganju strani.</p>
<div class="sourceCode" id="cb863"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb863-1"><a href="Truffle-Web3.html#cb863-1" tabindex="-1"></a><span class="im">export</span> <span class="kw">class</span> Web3Service {</span>
<span id="cb863-2"><a href="Truffle-Web3.html#cb863-2" tabindex="-1"></a>  <span class="op">...</span></span>
<span id="cb863-3"><a href="Truffle-Web3.html#cb863-3" tabindex="-1"></a>  <span class="kw">public</span> <span class="dt">proposals</span><span class="op">:</span> string[] <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb863-4"><a href="Truffle-Web3.html#cb863-4" tabindex="-1"></a>  <span class="kw">public</span> <span class="dt">winningProposal</span><span class="op">:</span> any <span class="op">=</span> {}<span class="op">;</span></span>
<span id="cb863-5"><a href="Truffle-Web3.html#cb863-5" tabindex="-1"></a>  <span class="kw">private</span> web3<span class="op">!:</span> any<span class="op">;</span></span>
<span id="cb863-6"><a href="Truffle-Web3.html#cb863-6" tabindex="-1"></a>  <span class="op">...</span></span>
<span id="cb863-7"><a href="Truffle-Web3.html#cb863-7" tabindex="-1"></a>  <span class="kw">public</span> <span class="kw">async</span> <span class="fu">connectToBC</span>()<span class="op">:</span> <span class="bu">Promise</span><span class="op">&lt;</span>string<span class="op">&gt;</span> {</span>
<span id="cb863-8"><a href="Truffle-Web3.html#cb863-8" tabindex="-1"></a>    <span class="op">...</span></span>
<span id="cb863-9"><a href="Truffle-Web3.html#cb863-9" tabindex="-1"></a>    <span class="cf">try</span> {</span>
<span id="cb863-10"><a href="Truffle-Web3.html#cb863-10" tabindex="-1"></a>      <span class="op">...</span></span>
<span id="cb863-11"><a href="Truffle-Web3.html#cb863-11" tabindex="-1"></a>      <span class="co">// Refresh data</span></span>
<span id="cb863-12"><a href="Truffle-Web3.html#cb863-12" tabindex="-1"></a>      <span class="cf">await</span> <span class="kw">this</span><span class="op">.</span><span class="fu">getListOfProposals</span>()<span class="op">;</span></span>
<span id="cb863-13"><a href="Truffle-Web3.html#cb863-13" tabindex="-1"></a>      <span class="cf">await</span> <span class="kw">this</span><span class="op">.</span><span class="fu">getVotingResults</span>()<span class="op">;</span></span>
<span id="cb863-14"><a href="Truffle-Web3.html#cb863-14" tabindex="-1"></a>    } <span class="cf">catch</span> (<span class="dt">error</span><span class="op">:</span> any) {</span>
<span id="cb863-15"><a href="Truffle-Web3.html#cb863-15" tabindex="-1"></a>      message <span class="op">=</span> error<span class="op">.</span><span class="at">message</span><span class="op">;</span></span>
<span id="cb863-16"><a href="Truffle-Web3.html#cb863-16" tabindex="-1"></a>    } <span class="cf">finally</span> {</span>
<span id="cb863-17"><a href="Truffle-Web3.html#cb863-17" tabindex="-1"></a>      <span class="cf">return</span> message<span class="op">;</span></span>
<span id="cb863-18"><a href="Truffle-Web3.html#cb863-18" tabindex="-1"></a>    }</span>
<span id="cb863-19"><a href="Truffle-Web3.html#cb863-19" tabindex="-1"></a>  }</span>
<span id="cb863-20"><a href="Truffle-Web3.html#cb863-20" tabindex="-1"></a>  <span class="op">...</span></span>
<span id="cb863-21"><a href="Truffle-Web3.html#cb863-21" tabindex="-1"></a>  <span class="kw">public</span> <span class="kw">async</span> <span class="fu">getVotingResults</span>()<span class="op">:</span> <span class="bu">Promise</span><span class="op">&lt;</span>any<span class="op">&gt;</span> {</span>
<span id="cb863-22"><a href="Truffle-Web3.html#cb863-22" tabindex="-1"></a>    <span class="kw">let</span> <span class="dt">winningProposal</span><span class="op">:</span> any <span class="op">=</span> {}<span class="op">;</span></span>
<span id="cb863-23"><a href="Truffle-Web3.html#cb863-23" tabindex="-1"></a>    <span class="cf">try</span> {</span>
<span id="cb863-24"><a href="Truffle-Web3.html#cb863-24" tabindex="-1"></a>      <span class="cf">if</span> (<span class="kw">this</span><span class="op">.</span><span class="at">workflowStatus</span> <span class="op">==</span> WorkflowStatus<span class="op">.</span><span class="at">VotesTallied</span>) {</span>
<span id="cb863-25"><a href="Truffle-Web3.html#cb863-25" tabindex="-1"></a>        winningProposal <span class="op">=</span> {</span>
<span id="cb863-26"><a href="Truffle-Web3.html#cb863-26" tabindex="-1"></a>          <span class="dt">index</span><span class="op">:</span> Web3<span class="op">.</span><span class="at">utils</span><span class="op">.</span><span class="fu">toNumber</span>(</span>
<span id="cb863-27"><a href="Truffle-Web3.html#cb863-27" tabindex="-1"></a>            <span class="cf">await</span> (</span>
<span id="cb863-28"><a href="Truffle-Web3.html#cb863-28" tabindex="-1"></a>              <span class="kw">this</span><span class="op">.</span><span class="at">contract</span><span class="op">.</span><span class="at">methods</span>[<span class="st">&quot;getWinningProposalId&quot;</span>] <span class="im">as</span> any</span>
<span id="cb863-29"><a href="Truffle-Web3.html#cb863-29" tabindex="-1"></a>            )()<span class="op">.</span><span class="fu">call</span>()</span>
<span id="cb863-30"><a href="Truffle-Web3.html#cb863-30" tabindex="-1"></a>          )<span class="op">,</span></span>
<span id="cb863-31"><a href="Truffle-Web3.html#cb863-31" tabindex="-1"></a>          <span class="dt">description</span><span class="op">:</span> <span class="cf">await</span> (</span>
<span id="cb863-32"><a href="Truffle-Web3.html#cb863-32" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="at">contract</span><span class="op">.</span><span class="at">methods</span>[<span class="st">&quot;getWinningProposalDescription&quot;</span>] <span class="im">as</span> any</span>
<span id="cb863-33"><a href="Truffle-Web3.html#cb863-33" tabindex="-1"></a>          )()<span class="op">.</span><span class="fu">call</span>()<span class="op">,</span></span>
<span id="cb863-34"><a href="Truffle-Web3.html#cb863-34" tabindex="-1"></a>          <span class="dt">voteCount</span><span class="op">:</span> Web3<span class="op">.</span><span class="at">utils</span><span class="op">.</span><span class="fu">toNumber</span>(</span>
<span id="cb863-35"><a href="Truffle-Web3.html#cb863-35" tabindex="-1"></a>            <span class="cf">await</span> (</span>
<span id="cb863-36"><a href="Truffle-Web3.html#cb863-36" tabindex="-1"></a>              <span class="kw">this</span><span class="op">.</span><span class="at">contract</span><span class="op">.</span><span class="at">methods</span>[<span class="st">&quot;getWinningProposalVoteCounts&quot;</span>] <span class="im">as</span> any</span>
<span id="cb863-37"><a href="Truffle-Web3.html#cb863-37" tabindex="-1"></a>            )()<span class="op">.</span><span class="fu">call</span>()</span>
<span id="cb863-38"><a href="Truffle-Web3.html#cb863-38" tabindex="-1"></a>          )<span class="op">,</span></span>
<span id="cb863-39"><a href="Truffle-Web3.html#cb863-39" tabindex="-1"></a>        }<span class="op">;</span></span>
<span id="cb863-40"><a href="Truffle-Web3.html#cb863-40" tabindex="-1"></a>      }</span>
<span id="cb863-41"><a href="Truffle-Web3.html#cb863-41" tabindex="-1"></a>    } <span class="cf">catch</span> (error) {</span>
<span id="cb863-42"><a href="Truffle-Web3.html#cb863-42" tabindex="-1"></a>      <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(error)<span class="op">;</span></span>
<span id="cb863-43"><a href="Truffle-Web3.html#cb863-43" tabindex="-1"></a>    } <span class="cf">finally</span> {</span>
<span id="cb863-44"><a href="Truffle-Web3.html#cb863-44" tabindex="-1"></a>      <span class="kw">this</span><span class="op">.</span><span class="at">winningProposal</span> <span class="op">=</span> winningProposal<span class="op">;</span></span>
<span id="cb863-45"><a href="Truffle-Web3.html#cb863-45" tabindex="-1"></a>    }</span>
<span id="cb863-46"><a href="Truffle-Web3.html#cb863-46" tabindex="-1"></a>    <span class="cf">return</span> winningProposal<span class="op">;</span></span>
<span id="cb863-47"><a href="Truffle-Web3.html#cb863-47" tabindex="-1"></a>  }</span>
<span id="cb863-48"><a href="Truffle-Web3.html#cb863-48" tabindex="-1"></a>}</span></code></pre></div>
<p><code>angular/src/app/shared/components/vote/vote.component.ts</code></p>
<div class="sourceCode" id="cb864"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb864-1"><a href="Truffle-Web3.html#cb864-1" tabindex="-1"></a><span class="im">export</span> <span class="kw">class</span> VoteComponent <span class="kw">implements</span> OnInit {</span>
<span id="cb864-2"><a href="Truffle-Web3.html#cb864-2" tabindex="-1"></a>  <span class="op">...</span></span>
<span id="cb864-3"><a href="Truffle-Web3.html#cb864-3" tabindex="-1"></a>  <span class="fu">displayVotingResults</span>()<span class="op">:</span> boolean {</span>
<span id="cb864-4"><a href="Truffle-Web3.html#cb864-4" tabindex="-1"></a>    <span class="cf">return</span> <span class="kw">this</span><span class="op">.</span><span class="at">web3Service</span><span class="op">.</span><span class="at">workflowStatus</span> <span class="op">==</span> <span class="dv">6</span><span class="op">;</span></span>
<span id="cb864-5"><a href="Truffle-Web3.html#cb864-5" tabindex="-1"></a>  }</span>
<span id="cb864-6"><a href="Truffle-Web3.html#cb864-6" tabindex="-1"></a>}</span></code></pre></div>
<p><code>angular/src/app/shared/components/vote/vote.component.html</code></p>
<div class="sourceCode" id="cb865"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb865-1"><a href="Truffle-Web3.html#cb865-1" tabindex="-1"></a><span class="co">&lt;!-- START: Voting results --&gt;</span></span>
<span id="cb865-2"><a href="Truffle-Web3.html#cb865-2" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;col&quot;</span><span class="dt">&gt;</span></span>
<span id="cb865-3"><a href="Truffle-Web3.html#cb865-3" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card h-100&quot;</span><span class="dt">&gt;</span></span>
<span id="cb865-4"><a href="Truffle-Web3.html#cb865-4" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card-header bg-light&quot;</span><span class="dt">&gt;</span></span>
<span id="cb865-5"><a href="Truffle-Web3.html#cb865-5" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">h4</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;mb-0&quot;</span><span class="ot"> [ngClass]</span><span class="op">=</span><span class="st">&quot;{ &#39;text-muted&#39;: !displayVotingResults() }&quot;</span><span class="dt">&gt;</span></span>
<span id="cb865-6"><a href="Truffle-Web3.html#cb865-6" tabindex="-1"></a>        Voting results<span class="dt">&lt;</span><span class="kw">sup</span></span>
<span id="cb865-7"><a href="Truffle-Web3.html#cb865-7" tabindex="-1"></a><span class="ot">          </span><span class="dt">&gt;&lt;</span><span class="kw">small</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;text-muted&quot;</span></span>
<span id="cb865-8"><a href="Truffle-Web3.html#cb865-8" tabindex="-1"></a><span class="ot">            </span><span class="dt">&gt;&lt;</span><span class="kw">i</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;fa-solid fa-user ps-2 pe-1&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">i</span><span class="dt">&gt;&lt;/</span><span class="kw">small</span></span>
<span id="cb865-9"><a href="Truffle-Web3.html#cb865-9" tabindex="-1"></a>        <span class="dt">&gt;&lt;/</span><span class="kw">sup</span><span class="dt">&gt;</span></span>
<span id="cb865-10"><a href="Truffle-Web3.html#cb865-10" tabindex="-1"></a>      <span class="dt">&lt;/</span><span class="kw">h4</span><span class="dt">&gt;</span></span>
<span id="cb865-11"><a href="Truffle-Web3.html#cb865-11" tabindex="-1"></a>    <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb865-12"><a href="Truffle-Web3.html#cb865-12" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">div</span></span>
<span id="cb865-13"><a href="Truffle-Web3.html#cb865-13" tabindex="-1"></a><span class="ot">      class</span><span class="op">=</span><span class="st">&quot;card-body&quot;</span></span>
<span id="cb865-14"><a href="Truffle-Web3.html#cb865-14" tabindex="-1"></a><span class="ot">      *ngIf</span><span class="op">=</span><span class="st">&quot;!web3Service.winningProposal.voteCount&quot;</span></span>
<span id="cb865-15"><a href="Truffle-Web3.html#cb865-15" tabindex="-1"></a><span class="ot">      [ngClass]</span><span class="op">=</span><span class="st">&quot;{ &#39;text-muted&#39;: !displayVotingResults() }&quot;</span></span>
<span id="cb865-16"><a href="Truffle-Web3.html#cb865-16" tabindex="-1"></a><span class="ot">    </span><span class="dt">&gt;</span></span>
<span id="cb865-17"><a href="Truffle-Web3.html#cb865-17" tabindex="-1"></a>      The voting result is not yet available.</span>
<span id="cb865-18"><a href="Truffle-Web3.html#cb865-18" tabindex="-1"></a>    <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb865-19"><a href="Truffle-Web3.html#cb865-19" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card-body&quot;</span><span class="ot"> *ngIf</span><span class="op">=</span><span class="st">&quot;web3Service.winningProposal.voteCount&quot;</span><span class="dt">&gt;</span></span>
<span id="cb865-20"><a href="Truffle-Web3.html#cb865-20" tabindex="-1"></a>      The winning proposal with</span>
<span id="cb865-21"><a href="Truffle-Web3.html#cb865-21" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">span</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;text-primary fw-bold&quot;</span></span>
<span id="cb865-22"><a href="Truffle-Web3.html#cb865-22" tabindex="-1"></a><span class="ot">        </span><span class="dt">&gt;&lt;</span><span class="kw">i</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;fa-solid fa-chart-line pe-1&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">i</span></span>
<span id="cb865-23"><a href="Truffle-Web3.html#cb865-23" tabindex="-1"></a>        <span class="dt">&gt;</span>{{ web3Service.winningProposal.voteCount }} vote{{</span>
<span id="cb865-24"><a href="Truffle-Web3.html#cb865-24" tabindex="-1"></a>          web3Service.winningProposal.voteCount &gt; 1 ? &quot;s&quot; : &quot;&quot;</span>
<span id="cb865-25"><a href="Truffle-Web3.html#cb865-25" tabindex="-1"></a>        }}<span class="dt">&lt;/</span><span class="kw">span</span></span>
<span id="cb865-26"><a href="Truffle-Web3.html#cb865-26" tabindex="-1"></a>      <span class="dt">&gt;</span></span>
<span id="cb865-27"><a href="Truffle-Web3.html#cb865-27" tabindex="-1"></a>      is</span>
<span id="cb865-28"><a href="Truffle-Web3.html#cb865-28" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">span</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;text-primary fw-bold&quot;</span></span>
<span id="cb865-29"><a href="Truffle-Web3.html#cb865-29" tabindex="-1"></a><span class="ot">        </span><span class="dt">&gt;&lt;</span><span class="kw">i</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;fa-solid fa-trophy pe-1&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">i</span></span>
<span id="cb865-30"><a href="Truffle-Web3.html#cb865-30" tabindex="-1"></a>        <span class="dt">&gt;</span>{{ web3Service.winningProposal.description }}<span class="dt">&lt;/</span><span class="kw">span</span></span>
<span id="cb865-31"><a href="Truffle-Web3.html#cb865-31" tabindex="-1"></a>      <span class="dt">&gt;</span>.</span>
<span id="cb865-32"><a href="Truffle-Web3.html#cb865-32" tabindex="-1"></a>    <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb865-33"><a href="Truffle-Web3.html#cb865-33" tabindex="-1"></a>    ...</span>
<span id="cb865-34"><a href="Truffle-Web3.html#cb865-34" tabindex="-1"></a>  <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb865-35"><a href="Truffle-Web3.html#cb865-35" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb865-36"><a href="Truffle-Web3.html#cb865-36" tabindex="-1"></a><span class="co">&lt;!-- </span><span class="re">END</span><span class="co">: Voting results --&gt;</span></span></code></pre></div>
<script>
  $(document).ready(function() {
    $("#podpora-funkcionalnostim-neregistriranega-volivca code.javascript:eq(0)").markRegExp(/enum UserType[\s\S]+?}/, options_dodaj);
    $("#podpora-funkcionalnostim-neregistriranega-volivca code.javascript:eq(0)").markRegExp(/\s+?public userType.+/, options_dodaj);
    $("#podpora-funkcionalnostim-neregistriranega-volivca code.javascript:eq(0)").markRegExp(/\s+?\/\/ Set the default user type[\s\S]+?Administrator;/, options_dodaj);
    $("#podpora-funkcionalnostim-neregistriranega-volivca code.html:eq(0)").markRegExp(/\s+?\[ngClass\]="[\s\S]+?"/, options_dodaj);
    $("#podpora-funkcionalnostim-neregistriranega-volivca code.html:eq(0)").markRegExp(/\s+?<div \*ngIf[\s\S]+?<\/div>/, options_dodaj);
    $("#podpora-funkcionalnostim-neregistriranega-volivca code.javascript:eq(1)").markRegExp(/enum WorkflowStatus[\s\S]+?}/, options_dodaj);
    $("#podpora-funkcionalnostim-neregistriranega-volivca code.javascript:eq(1)").markRegExp(/\s+?\/\/ Get the workflow status[\s\S]+?;/, options_dodaj);
    $("#podpora-funkcionalnostim-neregistriranega-volivca code.javascript:eq(1)").markRegExp(/\s+?public workflowStatus:.+/, options_dodaj);
    $("#podpora-funkcionalnostim-neregistriranega-volivca code.javascript:eq(1)").markRegExp(/\s+?public async getWorkflowStatus[\s\S]+?return[\s\S]+?}[\s\S]+?}/, options_dodaj);
    $("#podpora-funkcionalnostim-neregistriranega-volivca code.html:eq(1)").markRegExp(/\s+?\[ngClass\]="[\s\S]+?"/, options_dodaj);
    $("#podpora-funkcionalnostim-neregistriranega-volivca code.html:eq(1)").markRegExp(/ bg-light text-muted/, options_izbrisi);
    $("#podpora-funkcionalnostim-neregistriranega-volivca code.javascript:eq(2)").markRegExp(/\s+?public proposals:.+/, options_dodaj);
    $("#podpora-funkcionalnostim-neregistriranega-volivca code.javascript:eq(2)").markRegExp(/\s+?\/\/ Refresh data[\s\S]+?\(\);/, options_dodaj);
    $("#podpora-funkcionalnostim-neregistriranega-volivca code.javascript:eq(2)").markRegExp(/\s+?public async getListOfProposals[\s\S]+?return[\s\S]+?}/, options_dodaj);
    $("#podpora-funkcionalnostim-neregistriranega-volivca code.javascript:eq(3)").markRegExp(/\s+?displayListOfProposals[\s\S]+?}/, options_dodaj);
    $("#podpora-funkcionalnostim-neregistriranega-volivca code.html:eq(2)").markRegExp(/\s+?\[ngClass\]="[\s\S]+?"/, options_dodaj);
    $("#podpora-funkcionalnostim-neregistriranega-volivca code.html:eq(2)").markRegExp(/\s+?\*ngIf.+/, options_dodaj);
    $("#podpora-funkcionalnostim-neregistriranega-volivca code.html:eq(2)").markRegExp(/\s+?<div[^>]+?> 0[\s\S]+?<\/ul>[\s\S]+?<\/div>/, options_dodaj);
    $("#podpora-funkcionalnostim-neregistriranega-volivca code.javascript:eq(4)").markRegExp(/\s+?public winningProposal.+/, options_dodaj);
    $("#podpora-funkcionalnostim-neregistriranega-volivca code.javascript:eq(4)").markRegExp(/\s+?await this\.getVotingResults.+/, options_dodaj);
    $("#podpora-funkcionalnostim-neregistriranega-volivca code.javascript:eq(4)").markRegExp(/\s+?public async getVotingResults[\s\S]+?return[\s\S]+?}[\s\S]+?}/, options_dodaj);
    $("#podpora-funkcionalnostim-neregistriranega-volivca code.javascript:eq(5)").markRegExp(/\s+?displayVotingResults[\s\S]+?}/, options_dodaj);
    $("#podpora-funkcionalnostim-neregistriranega-volivca code.html:eq(3)").markRegExp(/\s+?\[ngClass\]=".+?"/, options_dodaj);
    $("#podpora-funkcionalnostim-neregistriranega-volivca code.html:eq(3)").markRegExp(/\s+?\*ngIf.+/, options_dodaj);
    $("#podpora-funkcionalnostim-neregistriranega-volivca code.html:eq(3)").markRegExp(/\s+?<div[^\]]+?>[^\<]+?The[\s\S]+?<\/div>/, options_dodaj);
  });
</script>
</div>
<div id="podpora-funkcionalnostim-registriranega-volivca" class="section level3 hasAnchor" number="13.2.7">
<h3><span class="header-section-number">13.2.7</span> Podpora funkcionalnostim registriranega volivca<a href="Truffle-Web3.html#podpora-funkcionalnostim-registriranega-volivca" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><i class="fa-solid fa-user-plus"></i><strong>Registriran volivec</strong> je tisti uporabnik, za katerega velja:</p>
<ul>
<li>volivčev naslov denarnice je <strong>skrbnik</strong> glasovanja <strong>dodal med registrirane volivce</strong>,</li>
<li>volivec se s pomočjo vtičnika <a href="https://metamask.io/"><i class="fa-solid fa-wallet"></i><strong>MetaMask</strong></a>, v okviru spletnega brskalnika, <strong>poveže z decentralizirano aplikacijo glasovanja</strong>.</li>
</ul>
<p>Poleg vseh funkcionalnosti neregistriranega volivca je registriranemu volivcu na voljo še možnost:</p>
<ul>
<li><strong>oddaje predloga za glasovanje</strong> in</li>
<li><strong>oddaje glasu</strong> v okviru glasovanja.</li>
</ul>
<p>Pri funkcionalnostih registriranega volivca bodo z izvedbo povezani <strong>transakcijski stroški</strong>, zato bomo metode pametne pogodbe na verigi blokov klicali s pomočjo <strong><a href="https://bitsofco.de/calling-smart-contract-functions-using-web3-js-call-vs-send/"><i class="fa-solid fa-tag"></i><code>send()</code></a></strong>. Pri funkcionalnostih neregistriranega volivca smo <strong>do verige blokov</strong> zgolj <strong>bralno dostopali</strong> in transakcije nismo kreirali, kar smo dosegli s pomočjo <strong><a href="https://bitsofco.de/calling-smart-contract-functions-using-web3-js-call-vs-send/"><i class="fa-solid fa-tag"></i><code>call()</code></a></strong>.</p>
<p>Pri <strong>oddaji predloga za glasovanje</strong> najprej preverimo ali je uporabnik registrirani volivec in smo v ustrezni fazi sprejemanja predlogov za glasovanje.</p>
<p>Če so omenjeni pogoji izpolnjeni, izvedemo klic funkcije <code>registerProposal(...)</code> pametne pogodbe na verigi blokov, ki zahteva stroške transakcije, saj se bo predlog zapisal na verigo blokov. V primeru, da prej omenjeni pogoji niso izpolnjeni, akcije ne izvedemo in tako uporabniku prihranimo stroške neuspelih transakcij.</p>
<p>Status operacije na verigi blokov uporabniku prikažemo v obliki <strong>modalnega okna</strong>, ki ga vključimo v Web3 komponento. Prikaz posredovanja predloga za glasovanje omejimo s pomočjo metode <code>displayProposalSubmission()</code>, ki poskrbi da je funkcionalnost na voljo zgolj registriranim uporabnikom in po začetku sprejemanja predloga za glasovanje.</p>
<p><code>angular/src/app/shared/services/web3.service.ts</code></p>
<div class="sourceCode" id="cb866"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb866-1"><a href="Truffle-Web3.html#cb866-1" tabindex="-1"></a><span class="im">export</span> <span class="kw">class</span> Web3Service {</span>
<span id="cb866-2"><a href="Truffle-Web3.html#cb866-2" tabindex="-1"></a>  <span class="op">...</span></span>
<span id="cb866-3"><a href="Truffle-Web3.html#cb866-3" tabindex="-1"></a>  <span class="kw">public</span> <span class="kw">async</span> <span class="fu">submitProposal</span>(<span class="dt">description</span><span class="op">:</span> string)<span class="op">:</span> <span class="bu">Promise</span><span class="op">&lt;</span>string<span class="op">&gt;</span> {</span>
<span id="cb866-4"><a href="Truffle-Web3.html#cb866-4" tabindex="-1"></a>    <span class="kw">let</span> message <span class="op">=</span> <span class="st">&quot;&quot;</span><span class="op">;</span></span>
<span id="cb866-5"><a href="Truffle-Web3.html#cb866-5" tabindex="-1"></a>    <span class="cf">try</span> {</span>
<span id="cb866-6"><a href="Truffle-Web3.html#cb866-6" tabindex="-1"></a>      <span class="cf">if</span> (<span class="op">!</span>description <span class="op">||</span> description<span class="op">.</span><span class="fu">trim</span>() <span class="op">==</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb866-7"><a href="Truffle-Web3.html#cb866-7" tabindex="-1"></a>        <span class="cf">throw</span> <span class="kw">new</span> <span class="bu">Error</span>(<span class="st">&quot;Proposal description is required!&quot;</span>)<span class="op">;</span></span>
<span id="cb866-8"><a href="Truffle-Web3.html#cb866-8" tabindex="-1"></a>      <span class="cf">else</span> <span class="cf">if</span> (</span>
<span id="cb866-9"><a href="Truffle-Web3.html#cb866-9" tabindex="-1"></a>        <span class="op">!</span>(<span class="cf">await</span> (<span class="kw">this</span><span class="op">.</span><span class="at">contract</span><span class="op">.</span><span class="at">methods</span>[<span class="st">&quot;isRegisteredVoter&quot;</span>] <span class="im">as</span> any)(</span>
<span id="cb866-10"><a href="Truffle-Web3.html#cb866-10" tabindex="-1"></a>          <span class="kw">this</span><span class="op">.</span><span class="at">userAddress</span></span>
<span id="cb866-11"><a href="Truffle-Web3.html#cb866-11" tabindex="-1"></a>        )<span class="op">.</span><span class="fu">call</span>())</span>
<span id="cb866-12"><a href="Truffle-Web3.html#cb866-12" tabindex="-1"></a>      )</span>
<span id="cb866-13"><a href="Truffle-Web3.html#cb866-13" tabindex="-1"></a>        <span class="cf">throw</span> <span class="kw">new</span> <span class="bu">Error</span>(</span>
<span id="cb866-14"><a href="Truffle-Web3.html#cb866-14" tabindex="-1"></a>          <span class="st">&quot;User &#39;&quot;</span> <span class="op">+</span> <span class="kw">this</span><span class="op">.</span><span class="at">userAddress</span> <span class="op">+</span> <span class="st">&quot;&#39; is not a registered voter!&quot;</span></span>
<span id="cb866-15"><a href="Truffle-Web3.html#cb866-15" tabindex="-1"></a>        )<span class="op">;</span></span>
<span id="cb866-16"><a href="Truffle-Web3.html#cb866-16" tabindex="-1"></a>      <span class="cf">else</span> <span class="cf">if</span> (</span>
<span id="cb866-17"><a href="Truffle-Web3.html#cb866-17" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">workflowStatus</span> <span class="op">!=</span> WorkflowStatus<span class="op">.</span><span class="at">ProposalsRegistrationStarted</span></span>
<span id="cb866-18"><a href="Truffle-Web3.html#cb866-18" tabindex="-1"></a>      )</span>
<span id="cb866-19"><a href="Truffle-Web3.html#cb866-19" tabindex="-1"></a>        <span class="cf">throw</span> <span class="kw">new</span> <span class="bu">Error</span>(<span class="st">&quot;Proposal submission is not allowed at this time!&quot;</span>)<span class="op">;</span></span>
<span id="cb866-20"><a href="Truffle-Web3.html#cb866-20" tabindex="-1"></a>      <span class="cf">if</span> (</span>
<span id="cb866-21"><a href="Truffle-Web3.html#cb866-21" tabindex="-1"></a>        <span class="op">!</span>(</span>
<span id="cb866-22"><a href="Truffle-Web3.html#cb866-22" tabindex="-1"></a>          <span class="cf">await</span> (<span class="kw">this</span><span class="op">.</span><span class="at">contract</span><span class="op">.</span><span class="at">methods</span>[<span class="st">&quot;registerProposal&quot;</span>] <span class="im">as</span> any)(</span>
<span id="cb866-23"><a href="Truffle-Web3.html#cb866-23" tabindex="-1"></a>            description</span>
<span id="cb866-24"><a href="Truffle-Web3.html#cb866-24" tabindex="-1"></a>          )<span class="op">.</span><span class="fu">send</span>({ <span class="dt">from</span><span class="op">:</span> <span class="kw">this</span><span class="op">.</span><span class="at">userAddress</span> })</span>
<span id="cb866-25"><a href="Truffle-Web3.html#cb866-25" tabindex="-1"></a>        )<span class="op">.</span><span class="at">status</span></span>
<span id="cb866-26"><a href="Truffle-Web3.html#cb866-26" tabindex="-1"></a>      )</span>
<span id="cb866-27"><a href="Truffle-Web3.html#cb866-27" tabindex="-1"></a>        <span class="cf">throw</span> <span class="kw">new</span> <span class="bu">Error</span>(<span class="st">&quot;Error registering proposal!&quot;</span>)<span class="op">;</span></span>
<span id="cb866-28"><a href="Truffle-Web3.html#cb866-28" tabindex="-1"></a>    } <span class="cf">catch</span> (<span class="dt">error</span><span class="op">:</span> any) {</span>
<span id="cb866-29"><a href="Truffle-Web3.html#cb866-29" tabindex="-1"></a>      message <span class="op">=</span> error<span class="op">.</span><span class="at">message</span><span class="op">;</span></span>
<span id="cb866-30"><a href="Truffle-Web3.html#cb866-30" tabindex="-1"></a>    }</span>
<span id="cb866-31"><a href="Truffle-Web3.html#cb866-31" tabindex="-1"></a>    <span class="cf">return</span> message<span class="op">;</span></span>
<span id="cb866-32"><a href="Truffle-Web3.html#cb866-32" tabindex="-1"></a>  }</span>
<span id="cb866-33"><a href="Truffle-Web3.html#cb866-33" tabindex="-1"></a>}</span></code></pre></div>
<p><code>angular/src/app/shared/components/vote/vote.component.ts</code></p>
<div class="sourceCode" id="cb867"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb867-1"><a href="Truffle-Web3.html#cb867-1" tabindex="-1"></a><span class="im">import</span> { Component<span class="op">,</span> OnInit<span class="op">,</span> TemplateRef<span class="op">,</span> ViewChild } <span class="im">from</span> <span class="st">&quot;@angular/core&quot;</span><span class="op">;</span></span>
<span id="cb867-2"><a href="Truffle-Web3.html#cb867-2" tabindex="-1"></a><span class="im">import</span> { Web3Service } <span class="im">from</span> <span class="st">&quot;../../services/web3.service&quot;</span><span class="op">;</span></span>
<span id="cb867-3"><a href="Truffle-Web3.html#cb867-3" tabindex="-1"></a><span class="im">import</span> { BsModalService<span class="op">,</span> BsModalRef } <span class="im">from</span> <span class="st">&quot;ngx-bootstrap/modal&quot;</span><span class="op">;</span></span>
<span id="cb867-4"><a href="Truffle-Web3.html#cb867-4" tabindex="-1"></a><span class="op">...</span></span>
<span id="cb867-5"><a href="Truffle-Web3.html#cb867-5" tabindex="-1"></a><span class="im">export</span> <span class="kw">class</span> VoteComponent <span class="kw">implements</span> OnInit {</span>
<span id="cb867-6"><a href="Truffle-Web3.html#cb867-6" tabindex="-1"></a>  <span class="kw">protected</span> <span class="dt">message</span><span class="op">:</span> string <span class="op">=</span> <span class="st">&quot;Please connect MetaMask wallet to continue!&quot;</span><span class="op">;</span></span>
<span id="cb867-7"><a href="Truffle-Web3.html#cb867-7" tabindex="-1"></a>  <span class="kw">protected</span> <span class="dt">confirmation</span><span class="op">:</span> string <span class="op">=</span> <span class="st">&quot;&quot;</span><span class="op">;</span></span>
<span id="cb867-8"><a href="Truffle-Web3.html#cb867-8" tabindex="-1"></a>  <span class="kw">protected</span> <span class="dt">inputProposal</span><span class="op">:</span> string <span class="op">=</span> <span class="st">&quot;&quot;</span><span class="op">;</span></span>
<span id="cb867-9"><a href="Truffle-Web3.html#cb867-9" tabindex="-1"></a>  modalRef<span class="op">?:</span> BsModalRef<span class="op">;</span></span>
<span id="cb867-10"><a href="Truffle-Web3.html#cb867-10" tabindex="-1"></a>  @<span class="fu">ViewChild</span>(<span class="st">&quot;displayMessage&quot;</span>) displayMessage<span class="op">!:</span> TemplateRef<span class="op">&lt;</span>any<span class="op">&gt;;</span></span>
<span id="cb867-11"><a href="Truffle-Web3.html#cb867-11" tabindex="-1"></a>  <span class="fu">constructor</span>(</span>
<span id="cb867-12"><a href="Truffle-Web3.html#cb867-12" tabindex="-1"></a>    <span class="kw">public</span> <span class="dt">web3Service</span><span class="op">:</span> Web3Service<span class="op">,</span></span>
<span id="cb867-13"><a href="Truffle-Web3.html#cb867-13" tabindex="-1"></a>    <span class="kw">private</span> <span class="dt">modalService</span><span class="op">:</span> BsModalService</span>
<span id="cb867-14"><a href="Truffle-Web3.html#cb867-14" tabindex="-1"></a>  ) {}</span>
<span id="cb867-15"><a href="Truffle-Web3.html#cb867-15" tabindex="-1"></a>  <span class="op">...</span></span>
<span id="cb867-16"><a href="Truffle-Web3.html#cb867-16" tabindex="-1"></a>  <span class="fu">displayProposalSubmission</span>()<span class="op">:</span> boolean {</span>
<span id="cb867-17"><a href="Truffle-Web3.html#cb867-17" tabindex="-1"></a>    <span class="cf">return</span> (</span>
<span id="cb867-18"><a href="Truffle-Web3.html#cb867-18" tabindex="-1"></a>      <span class="kw">this</span><span class="op">.</span><span class="at">web3Service</span><span class="op">.</span><span class="at">userType</span> <span class="op">==</span> <span class="dv">3</span> <span class="op">&amp;&amp;</span> <span class="kw">this</span><span class="op">.</span><span class="at">web3Service</span><span class="op">.</span><span class="at">workflowStatus</span> <span class="op">==</span> <span class="dv">2</span></span>
<span id="cb867-19"><a href="Truffle-Web3.html#cb867-19" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb867-20"><a href="Truffle-Web3.html#cb867-20" tabindex="-1"></a>  }</span>
<span id="cb867-21"><a href="Truffle-Web3.html#cb867-21" tabindex="-1"></a>  <span class="fu">submitProposal</span>()<span class="op">:</span> <span class="kw">void</span> {</span>
<span id="cb867-22"><a href="Truffle-Web3.html#cb867-22" tabindex="-1"></a>    <span class="kw">this</span><span class="op">.</span><span class="at">web3Service</span></span>
<span id="cb867-23"><a href="Truffle-Web3.html#cb867-23" tabindex="-1"></a>      <span class="op">.</span><span class="fu">submitProposal</span>(<span class="kw">this</span><span class="op">.</span><span class="at">inputProposal</span>)</span>
<span id="cb867-24"><a href="Truffle-Web3.html#cb867-24" tabindex="-1"></a>      <span class="op">.</span><span class="fu">then</span>((<span class="dt">message</span><span class="op">:</span> string) <span class="kw">=&gt;</span> {</span>
<span id="cb867-25"><a href="Truffle-Web3.html#cb867-25" tabindex="-1"></a>        <span class="cf">if</span> (message<span class="op">.</span><span class="at">length</span> <span class="op">==</span> <span class="dv">0</span>) {</span>
<span id="cb867-26"><a href="Truffle-Web3.html#cb867-26" tabindex="-1"></a>          <span class="kw">this</span><span class="op">.</span><span class="fu">openModal</span>(</span>
<span id="cb867-27"><a href="Truffle-Web3.html#cb867-27" tabindex="-1"></a>            <span class="st">&quot;Proposal &#39;&quot;</span> <span class="op">+</span> <span class="kw">this</span><span class="op">.</span><span class="at">inputProposal</span> <span class="op">+</span> <span class="st">&quot;&#39; submitted successfully!&quot;</span></span>
<span id="cb867-28"><a href="Truffle-Web3.html#cb867-28" tabindex="-1"></a>          )<span class="op">;</span></span>
<span id="cb867-29"><a href="Truffle-Web3.html#cb867-29" tabindex="-1"></a>          <span class="kw">this</span><span class="op">.</span><span class="at">inputProposal</span> <span class="op">=</span> <span class="st">&quot;&quot;</span><span class="op">;</span></span>
<span id="cb867-30"><a href="Truffle-Web3.html#cb867-30" tabindex="-1"></a>          <span class="kw">this</span><span class="op">.</span><span class="at">web3Service</span><span class="op">.</span><span class="fu">getListOfProposals</span>()<span class="op">;</span></span>
<span id="cb867-31"><a href="Truffle-Web3.html#cb867-31" tabindex="-1"></a>        }</span>
<span id="cb867-32"><a href="Truffle-Web3.html#cb867-32" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">message</span> <span class="op">=</span> message<span class="op">;</span></span>
<span id="cb867-33"><a href="Truffle-Web3.html#cb867-33" tabindex="-1"></a>      })<span class="op">;</span></span>
<span id="cb867-34"><a href="Truffle-Web3.html#cb867-34" tabindex="-1"></a>  }</span>
<span id="cb867-35"><a href="Truffle-Web3.html#cb867-35" tabindex="-1"></a>  <span class="kw">protected</span> <span class="fu">openModal</span>(<span class="dt">message</span><span class="op">:</span> string) {</span>
<span id="cb867-36"><a href="Truffle-Web3.html#cb867-36" tabindex="-1"></a>    <span class="kw">this</span><span class="op">.</span><span class="at">confirmation</span> <span class="op">=</span> message<span class="op">;</span></span>
<span id="cb867-37"><a href="Truffle-Web3.html#cb867-37" tabindex="-1"></a>    <span class="kw">this</span><span class="op">.</span><span class="at">modalRef</span> <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">modalService</span><span class="op">.</span><span class="fu">show</span>(<span class="kw">this</span><span class="op">.</span><span class="at">displayMessage</span><span class="op">,</span> {</span>
<span id="cb867-38"><a href="Truffle-Web3.html#cb867-38" tabindex="-1"></a>      <span class="dt">class</span><span class="op">:</span> <span class="st">&quot;modal-dialog-centered&quot;</span><span class="op">,</span></span>
<span id="cb867-39"><a href="Truffle-Web3.html#cb867-39" tabindex="-1"></a>      <span class="dt">keyboard</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb867-40"><a href="Truffle-Web3.html#cb867-40" tabindex="-1"></a>      <span class="dt">ignoreBackdropClick</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb867-41"><a href="Truffle-Web3.html#cb867-41" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb867-42"><a href="Truffle-Web3.html#cb867-42" tabindex="-1"></a>  }</span>
<span id="cb867-43"><a href="Truffle-Web3.html#cb867-43" tabindex="-1"></a>  <span class="kw">protected</span> <span class="fu">closeModal</span>() {</span>
<span id="cb867-44"><a href="Truffle-Web3.html#cb867-44" tabindex="-1"></a>    <span class="kw">this</span><span class="op">.</span><span class="at">confirmation</span> <span class="op">=</span> <span class="st">&quot;&quot;</span><span class="op">;</span></span>
<span id="cb867-45"><a href="Truffle-Web3.html#cb867-45" tabindex="-1"></a>    <span class="kw">this</span><span class="op">.</span><span class="at">modalRef</span><span class="op">?.</span><span class="fu">hide</span>()<span class="op">;</span></span>
<span id="cb867-46"><a href="Truffle-Web3.html#cb867-46" tabindex="-1"></a>  }</span>
<span id="cb867-47"><a href="Truffle-Web3.html#cb867-47" tabindex="-1"></a>}</span></code></pre></div>
<p><code>angular/src/app/shared/components/vote/vote.component.html</code></p>
<div class="sourceCode" id="cb868"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb868-1"><a href="Truffle-Web3.html#cb868-1" tabindex="-1"></a><span class="co">&lt;!-- START: Submit proposal --&gt;</span></span>
<span id="cb868-2"><a href="Truffle-Web3.html#cb868-2" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;col&quot;</span><span class="dt">&gt;</span></span>
<span id="cb868-3"><a href="Truffle-Web3.html#cb868-3" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card h-100&quot;</span><span class="dt">&gt;</span></span>
<span id="cb868-4"><a href="Truffle-Web3.html#cb868-4" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card-header bg-light&quot;</span><span class="dt">&gt;</span></span>
<span id="cb868-5"><a href="Truffle-Web3.html#cb868-5" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">h4</span></span>
<span id="cb868-6"><a href="Truffle-Web3.html#cb868-6" tabindex="-1"></a><span class="ot">        class</span><span class="op">=</span><span class="st">&quot;mb-0&quot;</span></span>
<span id="cb868-7"><a href="Truffle-Web3.html#cb868-7" tabindex="-1"></a><span class="ot">        [ngClass]</span><span class="op">=</span><span class="st">&quot;{ &#39;text-muted&#39;: !displayProposalSubmission() }&quot;</span></span>
<span id="cb868-8"><a href="Truffle-Web3.html#cb868-8" tabindex="-1"></a><span class="ot">      </span><span class="dt">&gt;</span></span>
<span id="cb868-9"><a href="Truffle-Web3.html#cb868-9" tabindex="-1"></a>        Submit proposal<span class="dt">&lt;</span><span class="kw">sup</span></span>
<span id="cb868-10"><a href="Truffle-Web3.html#cb868-10" tabindex="-1"></a><span class="ot">          </span><span class="dt">&gt;&lt;</span><span class="kw">small</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;text-muted&quot;</span></span>
<span id="cb868-11"><a href="Truffle-Web3.html#cb868-11" tabindex="-1"></a><span class="ot">            </span><span class="dt">&gt;&lt;</span><span class="kw">i</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;fa-solid fa-user-plus ps-2 pe-1&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">i</span><span class="dt">&gt;&lt;/</span><span class="kw">small</span></span>
<span id="cb868-12"><a href="Truffle-Web3.html#cb868-12" tabindex="-1"></a>        <span class="dt">&gt;&lt;/</span><span class="kw">sup</span><span class="dt">&gt;</span></span>
<span id="cb868-13"><a href="Truffle-Web3.html#cb868-13" tabindex="-1"></a>      <span class="dt">&lt;/</span><span class="kw">h4</span><span class="dt">&gt;</span></span>
<span id="cb868-14"><a href="Truffle-Web3.html#cb868-14" tabindex="-1"></a>    <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb868-15"><a href="Truffle-Web3.html#cb868-15" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card-body&quot;</span><span class="dt">&gt;</span></span>
<span id="cb868-16"><a href="Truffle-Web3.html#cb868-16" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;mb-3&quot;</span><span class="dt">&gt;</span></span>
<span id="cb868-17"><a href="Truffle-Web3.html#cb868-17" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">label</span></span>
<span id="cb868-18"><a href="Truffle-Web3.html#cb868-18" tabindex="-1"></a><span class="ot">          class</span><span class="op">=</span><span class="st">&quot;form-label&quot;</span></span>
<span id="cb868-19"><a href="Truffle-Web3.html#cb868-19" tabindex="-1"></a><span class="ot">          [ngClass]</span><span class="op">=</span><span class="st">&quot;{ &#39;text-muted&#39;: !displayProposalSubmission() }&quot;</span></span>
<span id="cb868-20"><a href="Truffle-Web3.html#cb868-20" tabindex="-1"></a><span class="ot">          </span><span class="dt">&gt;</span>Proposal description<span class="dt">&lt;/</span><span class="kw">label</span></span>
<span id="cb868-21"><a href="Truffle-Web3.html#cb868-21" tabindex="-1"></a>        <span class="dt">&gt;</span></span>
<span id="cb868-22"><a href="Truffle-Web3.html#cb868-22" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">input</span></span>
<span id="cb868-23"><a href="Truffle-Web3.html#cb868-23" tabindex="-1"></a><span class="ot">          type</span><span class="op">=</span><span class="st">&quot;text&quot;</span></span>
<span id="cb868-24"><a href="Truffle-Web3.html#cb868-24" tabindex="-1"></a><span class="ot">          class</span><span class="op">=</span><span class="st">&quot;form-control form-control-sm&quot;</span></span>
<span id="cb868-25"><a href="Truffle-Web3.html#cb868-25" tabindex="-1"></a><span class="ot">          [(ngModel)]</span><span class="op">=</span><span class="st">&quot;inputProposal&quot;</span></span>
<span id="cb868-26"><a href="Truffle-Web3.html#cb868-26" tabindex="-1"></a><span class="ot">          [disabled]</span><span class="op">=</span><span class="st">&quot;!displayProposalSubmission()&quot;</span></span>
<span id="cb868-27"><a href="Truffle-Web3.html#cb868-27" tabindex="-1"></a><span class="ot">        </span><span class="dt">/&gt;</span></span>
<span id="cb868-28"><a href="Truffle-Web3.html#cb868-28" tabindex="-1"></a>      <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb868-29"><a href="Truffle-Web3.html#cb868-29" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">button</span></span>
<span id="cb868-30"><a href="Truffle-Web3.html#cb868-30" tabindex="-1"></a><span class="ot">        class</span><span class="op">=</span><span class="st">&quot;btn btn-sm btn-primary&quot;</span></span>
<span id="cb868-31"><a href="Truffle-Web3.html#cb868-31" tabindex="-1"></a><span class="ot">        (click)</span><span class="op">=</span><span class="st">&quot;submitProposal()&quot;</span></span>
<span id="cb868-32"><a href="Truffle-Web3.html#cb868-32" tabindex="-1"></a><span class="ot">        [disabled]</span><span class="op">=</span><span class="st">&quot;!displayProposalSubmission()&quot;</span></span>
<span id="cb868-33"><a href="Truffle-Web3.html#cb868-33" tabindex="-1"></a><span class="ot">      </span><span class="dt">&gt;</span></span>
<span id="cb868-34"><a href="Truffle-Web3.html#cb868-34" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">i</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;fa-solid fa-plus me-2&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">i</span><span class="dt">&gt;</span>Submit</span>
<span id="cb868-35"><a href="Truffle-Web3.html#cb868-35" tabindex="-1"></a>      <span class="dt">&lt;/</span><span class="kw">button</span><span class="dt">&gt;</span></span>
<span id="cb868-36"><a href="Truffle-Web3.html#cb868-36" tabindex="-1"></a>    <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb868-37"><a href="Truffle-Web3.html#cb868-37" tabindex="-1"></a>    ...</span>
<span id="cb868-38"><a href="Truffle-Web3.html#cb868-38" tabindex="-1"></a>  <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb868-39"><a href="Truffle-Web3.html#cb868-39" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb868-40"><a href="Truffle-Web3.html#cb868-40" tabindex="-1"></a><span class="co">&lt;!-- </span><span class="re">END</span><span class="co">: Submit proposal --&gt;</span></span>
<span id="cb868-41"><a href="Truffle-Web3.html#cb868-41" tabindex="-1"></a>...</span>
<span id="cb868-42"><a href="Truffle-Web3.html#cb868-42" tabindex="-1"></a><span class="co">&lt;!-- START: Modal --&gt;</span></span>
<span id="cb868-43"><a href="Truffle-Web3.html#cb868-43" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">ng-template</span><span class="ot"> #displayMessage</span><span class="dt">&gt;</span></span>
<span id="cb868-44"><a href="Truffle-Web3.html#cb868-44" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;modal-header&quot;</span><span class="dt">&gt;</span></span>
<span id="cb868-45"><a href="Truffle-Web3.html#cb868-45" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;text-primary&quot;</span><span class="dt">&gt;</span></span>
<span id="cb868-46"><a href="Truffle-Web3.html#cb868-46" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">i</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;fa-regular fa-circle-check pe-2&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">i</span><span class="dt">&gt;</span>{{ confirmation }}</span>
<span id="cb868-47"><a href="Truffle-Web3.html#cb868-47" tabindex="-1"></a>    <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb868-48"><a href="Truffle-Web3.html#cb868-48" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">button</span></span>
<span id="cb868-49"><a href="Truffle-Web3.html#cb868-49" tabindex="-1"></a><span class="ot">      type</span><span class="op">=</span><span class="st">&quot;button&quot;</span></span>
<span id="cb868-50"><a href="Truffle-Web3.html#cb868-50" tabindex="-1"></a><span class="ot">      class</span><span class="op">=</span><span class="st">&quot;btn-close close pull-right&quot;</span></span>
<span id="cb868-51"><a href="Truffle-Web3.html#cb868-51" tabindex="-1"></a><span class="ot">      aria-label</span><span class="op">=</span><span class="st">&quot;Close&quot;</span></span>
<span id="cb868-52"><a href="Truffle-Web3.html#cb868-52" tabindex="-1"></a><span class="ot">      (click)</span><span class="op">=</span><span class="st">&quot;closeModal()&quot;</span></span>
<span id="cb868-53"><a href="Truffle-Web3.html#cb868-53" tabindex="-1"></a><span class="ot">    </span><span class="dt">&gt;</span></span>
<span id="cb868-54"><a href="Truffle-Web3.html#cb868-54" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">span</span><span class="ot"> aria-hidden</span><span class="op">=</span><span class="st">&quot;true&quot;</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;visually-hidden&quot;</span><span class="dt">&gt;</span><span class="dv">&amp;times;</span><span class="dt">&lt;/</span><span class="kw">span</span><span class="dt">&gt;</span></span>
<span id="cb868-55"><a href="Truffle-Web3.html#cb868-55" tabindex="-1"></a>    <span class="dt">&lt;/</span><span class="kw">button</span><span class="dt">&gt;</span></span>
<span id="cb868-56"><a href="Truffle-Web3.html#cb868-56" tabindex="-1"></a>  <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb868-57"><a href="Truffle-Web3.html#cb868-57" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">ng-template</span><span class="dt">&gt;</span></span>
<span id="cb868-58"><a href="Truffle-Web3.html#cb868-58" tabindex="-1"></a><span class="co">&lt;!-- </span><span class="re">END</span><span class="co">: Modal --&gt;</span></span></code></pre></div>
<p>Podobno poteka tudi <strong>glasovanje</strong>, kjer iz spletne strani pridobimo izbran predlog ter preverimo ali je uporabnik registriran volivec in smo v fazi glasovanja. V tem primeru uporabniku dovolimo glasovanje, v nasprotnem primeru mu klica funkcije pametne pogodbe ne dovolimo.</p>
<p>V primeru glasovanja pa je treba izpostaviti izjemo, kjer <strong>uporabniku</strong> na spletni strani <strong>ne onemogočimo večkratnega glasovanja</strong>, kljub temu, da vemo, da bo takšna transakcija na verigi blokov neuspešna. Uporabniku večkratno glasovanje dovolimo, sporočilo se posreduje na verigo blokov, vendar je transakcija zavrnjena, volivec pa kljub temu plača stroške transakcije (recimo temu kazen za nedovoljen poskus vplivanja na rezultat volitev).</p>
<p><code>angular/src/app/shared/services/web3.service.ts</code></p>
<div class="sourceCode" id="cb869"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb869-1"><a href="Truffle-Web3.html#cb869-1" tabindex="-1"></a><span class="im">export</span> <span class="kw">class</span> Web3Service {</span>
<span id="cb869-2"><a href="Truffle-Web3.html#cb869-2" tabindex="-1"></a>  <span class="op">...</span></span>
<span id="cb869-3"><a href="Truffle-Web3.html#cb869-3" tabindex="-1"></a>  <span class="kw">public</span> <span class="kw">async</span> <span class="fu">castVote</span>(<span class="dt">proposalIndex</span><span class="op">:</span> number)<span class="op">:</span> <span class="bu">Promise</span><span class="op">&lt;</span>string<span class="op">&gt;</span> {</span>
<span id="cb869-4"><a href="Truffle-Web3.html#cb869-4" tabindex="-1"></a>    <span class="kw">let</span> message <span class="op">=</span> <span class="st">&quot;&quot;</span><span class="op">;</span></span>
<span id="cb869-5"><a href="Truffle-Web3.html#cb869-5" tabindex="-1"></a>    <span class="cf">try</span> {</span>
<span id="cb869-6"><a href="Truffle-Web3.html#cb869-6" tabindex="-1"></a>      <span class="cf">if</span> (</span>
<span id="cb869-7"><a href="Truffle-Web3.html#cb869-7" tabindex="-1"></a>        <span class="op">!</span>(<span class="cf">await</span> (<span class="kw">this</span><span class="op">.</span><span class="at">contract</span><span class="op">.</span><span class="at">methods</span>[<span class="st">&quot;isRegisteredVoter&quot;</span>] <span class="im">as</span> any)(</span>
<span id="cb869-8"><a href="Truffle-Web3.html#cb869-8" tabindex="-1"></a>          <span class="kw">this</span><span class="op">.</span><span class="at">userAddress</span></span>
<span id="cb869-9"><a href="Truffle-Web3.html#cb869-9" tabindex="-1"></a>        )<span class="op">.</span><span class="fu">call</span>())</span>
<span id="cb869-10"><a href="Truffle-Web3.html#cb869-10" tabindex="-1"></a>      )</span>
<span id="cb869-11"><a href="Truffle-Web3.html#cb869-11" tabindex="-1"></a>        <span class="cf">throw</span> <span class="kw">new</span> <span class="bu">Error</span>(</span>
<span id="cb869-12"><a href="Truffle-Web3.html#cb869-12" tabindex="-1"></a>          <span class="st">&quot;User &#39;&quot;</span> <span class="op">+</span> <span class="kw">this</span><span class="op">.</span><span class="at">userAddress</span> <span class="op">+</span> <span class="st">&quot;&#39; is not a registered voter!&quot;</span></span>
<span id="cb869-13"><a href="Truffle-Web3.html#cb869-13" tabindex="-1"></a>        )<span class="op">;</span></span>
<span id="cb869-14"><a href="Truffle-Web3.html#cb869-14" tabindex="-1"></a>      <span class="cf">else</span> <span class="cf">if</span> (<span class="kw">this</span><span class="op">.</span><span class="at">workflowStatus</span> <span class="op">!=</span> WorkflowStatus<span class="op">.</span><span class="at">VotingSessionStarted</span>)</span>
<span id="cb869-15"><a href="Truffle-Web3.html#cb869-15" tabindex="-1"></a>        <span class="cf">throw</span> <span class="kw">new</span> <span class="bu">Error</span>(<span class="st">&quot;Casting vote is not allowed at this time!&quot;</span>)<span class="op">;</span></span>
<span id="cb869-16"><a href="Truffle-Web3.html#cb869-16" tabindex="-1"></a>      <span class="cf">if</span> (</span>
<span id="cb869-17"><a href="Truffle-Web3.html#cb869-17" tabindex="-1"></a>        <span class="op">!</span>(</span>
<span id="cb869-18"><a href="Truffle-Web3.html#cb869-18" tabindex="-1"></a>          <span class="cf">await</span> (<span class="kw">this</span><span class="op">.</span><span class="at">contract</span><span class="op">.</span><span class="at">methods</span>[<span class="st">&quot;vote&quot;</span>] <span class="im">as</span> any)(proposalIndex)<span class="op">.</span><span class="fu">send</span>({</span>
<span id="cb869-19"><a href="Truffle-Web3.html#cb869-19" tabindex="-1"></a>            <span class="dt">from</span><span class="op">:</span> <span class="kw">this</span><span class="op">.</span><span class="at">userAddress</span><span class="op">,</span></span>
<span id="cb869-20"><a href="Truffle-Web3.html#cb869-20" tabindex="-1"></a>          })</span>
<span id="cb869-21"><a href="Truffle-Web3.html#cb869-21" tabindex="-1"></a>        )<span class="op">.</span><span class="at">status</span></span>
<span id="cb869-22"><a href="Truffle-Web3.html#cb869-22" tabindex="-1"></a>      )</span>
<span id="cb869-23"><a href="Truffle-Web3.html#cb869-23" tabindex="-1"></a>        <span class="cf">throw</span> <span class="kw">new</span> <span class="bu">Error</span>(<span class="st">&quot;Error casting vote!&quot;</span>)<span class="op">;</span></span>
<span id="cb869-24"><a href="Truffle-Web3.html#cb869-24" tabindex="-1"></a>    } <span class="cf">catch</span> (<span class="dt">error</span><span class="op">:</span> any) {</span>
<span id="cb869-25"><a href="Truffle-Web3.html#cb869-25" tabindex="-1"></a>      message <span class="op">=</span> error<span class="op">.</span><span class="at">message</span><span class="op">;</span></span>
<span id="cb869-26"><a href="Truffle-Web3.html#cb869-26" tabindex="-1"></a>    }</span>
<span id="cb869-27"><a href="Truffle-Web3.html#cb869-27" tabindex="-1"></a>    <span class="cf">return</span> message<span class="op">;</span></span>
<span id="cb869-28"><a href="Truffle-Web3.html#cb869-28" tabindex="-1"></a>  }</span>
<span id="cb869-29"><a href="Truffle-Web3.html#cb869-29" tabindex="-1"></a>}</span></code></pre></div>
<p><code>angular/src/app/shared/components/vote/vote.component.ts</code></p>
<div class="sourceCode" id="cb870"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb870-1"><a href="Truffle-Web3.html#cb870-1" tabindex="-1"></a><span class="im">export</span> <span class="kw">class</span> VoteComponent <span class="kw">implements</span> OnInit {</span>
<span id="cb870-2"><a href="Truffle-Web3.html#cb870-2" tabindex="-1"></a>  <span class="op">...</span></span>
<span id="cb870-3"><a href="Truffle-Web3.html#cb870-3" tabindex="-1"></a>  <span class="kw">protected</span> <span class="dt">inputProposal</span><span class="op">:</span> string <span class="op">=</span> <span class="st">&quot;&quot;</span><span class="op">;</span></span>
<span id="cb870-4"><a href="Truffle-Web3.html#cb870-4" tabindex="-1"></a>  <span class="kw">protected</span> <span class="dt">inputVoteProposalId</span><span class="op">:</span> number <span class="op">=</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb870-5"><a href="Truffle-Web3.html#cb870-5" tabindex="-1"></a>  modalRef<span class="op">?:</span> BsModalRef<span class="op">;</span></span>
<span id="cb870-6"><a href="Truffle-Web3.html#cb870-6" tabindex="-1"></a>  <span class="op">...</span></span>
<span id="cb870-7"><a href="Truffle-Web3.html#cb870-7" tabindex="-1"></a>  <span class="fu">displayCastingVote</span>()<span class="op">:</span> boolean {</span>
<span id="cb870-8"><a href="Truffle-Web3.html#cb870-8" tabindex="-1"></a>    <span class="cf">return</span> (</span>
<span id="cb870-9"><a href="Truffle-Web3.html#cb870-9" tabindex="-1"></a>      <span class="kw">this</span><span class="op">.</span><span class="at">web3Service</span><span class="op">.</span><span class="at">userType</span> <span class="op">==</span> <span class="dv">3</span> <span class="op">&amp;&amp;</span> <span class="kw">this</span><span class="op">.</span><span class="at">web3Service</span><span class="op">.</span><span class="at">workflowStatus</span> <span class="op">==</span> <span class="dv">4</span></span>
<span id="cb870-10"><a href="Truffle-Web3.html#cb870-10" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb870-11"><a href="Truffle-Web3.html#cb870-11" tabindex="-1"></a>  }</span>
<span id="cb870-12"><a href="Truffle-Web3.html#cb870-12" tabindex="-1"></a>  <span class="fu">castVote</span>()<span class="op">:</span> <span class="kw">void</span> {</span>
<span id="cb870-13"><a href="Truffle-Web3.html#cb870-13" tabindex="-1"></a>    <span class="kw">this</span><span class="op">.</span><span class="at">web3Service</span></span>
<span id="cb870-14"><a href="Truffle-Web3.html#cb870-14" tabindex="-1"></a>      <span class="op">.</span><span class="fu">castVote</span>(<span class="kw">this</span><span class="op">.</span><span class="at">inputVoteProposalId</span>)</span>
<span id="cb870-15"><a href="Truffle-Web3.html#cb870-15" tabindex="-1"></a>      <span class="op">.</span><span class="fu">then</span>((<span class="dt">message</span><span class="op">:</span> string) <span class="kw">=&gt;</span> {</span>
<span id="cb870-16"><a href="Truffle-Web3.html#cb870-16" tabindex="-1"></a>        <span class="cf">if</span> (message<span class="op">.</span><span class="at">length</span> <span class="op">==</span> <span class="dv">0</span>) <span class="kw">this</span><span class="op">.</span><span class="fu">openModal</span>(<span class="st">&quot;Cast vote successfully!&quot;</span>)<span class="op">;</span></span>
<span id="cb870-17"><a href="Truffle-Web3.html#cb870-17" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">inputVoteProposalId</span> <span class="op">=</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb870-18"><a href="Truffle-Web3.html#cb870-18" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">message</span> <span class="op">=</span> message<span class="op">;</span></span>
<span id="cb870-19"><a href="Truffle-Web3.html#cb870-19" tabindex="-1"></a>      })<span class="op">;</span></span>
<span id="cb870-20"><a href="Truffle-Web3.html#cb870-20" tabindex="-1"></a>  }</span>
<span id="cb870-21"><a href="Truffle-Web3.html#cb870-21" tabindex="-1"></a>  <span class="kw">protected</span> <span class="fu">openModal</span>(<span class="dt">message</span><span class="op">:</span> string) {</span>
<span id="cb870-22"><a href="Truffle-Web3.html#cb870-22" tabindex="-1"></a>    <span class="op">...</span></span>
<span id="cb870-23"><a href="Truffle-Web3.html#cb870-23" tabindex="-1"></a>  }</span>
<span id="cb870-24"><a href="Truffle-Web3.html#cb870-24" tabindex="-1"></a>  <span class="op">...</span></span>
<span id="cb870-25"><a href="Truffle-Web3.html#cb870-25" tabindex="-1"></a>}</span></code></pre></div>
<p><code>angular/src/app/shared/components/vote/vote.component.html</code></p>
<div class="sourceCode" id="cb871"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb871-1"><a href="Truffle-Web3.html#cb871-1" tabindex="-1"></a><span class="co">&lt;!-- START: Cast vote --&gt;</span></span>
<span id="cb871-2"><a href="Truffle-Web3.html#cb871-2" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;col&quot;</span><span class="dt">&gt;</span></span>
<span id="cb871-3"><a href="Truffle-Web3.html#cb871-3" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card h-100&quot;</span><span class="dt">&gt;</span></span>
<span id="cb871-4"><a href="Truffle-Web3.html#cb871-4" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card-header bg-light&quot;</span><span class="dt">&gt;</span></span>
<span id="cb871-5"><a href="Truffle-Web3.html#cb871-5" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">h4</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;mb-0&quot;</span><span class="ot"> [ngClass]</span><span class="op">=</span><span class="st">&quot;{ &#39;text-muted&#39;: !displayCastingVote() }&quot;</span><span class="dt">&gt;</span></span>
<span id="cb871-6"><a href="Truffle-Web3.html#cb871-6" tabindex="-1"></a>        Cast vote<span class="dt">&lt;</span><span class="kw">sup</span></span>
<span id="cb871-7"><a href="Truffle-Web3.html#cb871-7" tabindex="-1"></a><span class="ot">          </span><span class="dt">&gt;&lt;</span><span class="kw">small</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;text-muted&quot;</span></span>
<span id="cb871-8"><a href="Truffle-Web3.html#cb871-8" tabindex="-1"></a><span class="ot">            </span><span class="dt">&gt;&lt;</span><span class="kw">i</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;fa-solid fa-user-plus ps-2 pe-1&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">i</span><span class="dt">&gt;&lt;/</span><span class="kw">small</span></span>
<span id="cb871-9"><a href="Truffle-Web3.html#cb871-9" tabindex="-1"></a>        <span class="dt">&gt;&lt;/</span><span class="kw">sup</span><span class="dt">&gt;</span></span>
<span id="cb871-10"><a href="Truffle-Web3.html#cb871-10" tabindex="-1"></a>      <span class="dt">&lt;/</span><span class="kw">h4</span><span class="dt">&gt;</span></span>
<span id="cb871-11"><a href="Truffle-Web3.html#cb871-11" tabindex="-1"></a>    <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb871-12"><a href="Truffle-Web3.html#cb871-12" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card-body&quot;</span><span class="dt">&gt;</span></span>
<span id="cb871-13"><a href="Truffle-Web3.html#cb871-13" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;mb-3&quot;</span><span class="dt">&gt;</span></span>
<span id="cb871-14"><a href="Truffle-Web3.html#cb871-14" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">select</span></span>
<span id="cb871-15"><a href="Truffle-Web3.html#cb871-15" tabindex="-1"></a><span class="ot">          class</span><span class="op">=</span><span class="st">&quot;form-select form-select-sm&quot;</span></span>
<span id="cb871-16"><a href="Truffle-Web3.html#cb871-16" tabindex="-1"></a><span class="ot">          [disabled]</span><span class="op">=</span><span class="st">&quot;!displayCastingVote()&quot;</span></span>
<span id="cb871-17"><a href="Truffle-Web3.html#cb871-17" tabindex="-1"></a><span class="ot">          [(ngModel)]</span><span class="op">=</span><span class="st">&quot;inputVoteProposalId&quot;</span></span>
<span id="cb871-18"><a href="Truffle-Web3.html#cb871-18" tabindex="-1"></a><span class="ot">        </span><span class="dt">&gt;</span></span>
<span id="cb871-19"><a href="Truffle-Web3.html#cb871-19" tabindex="-1"></a>          <span class="dt">&lt;</span><span class="kw">option</span><span class="ot"> [ngValue]</span><span class="op">=</span><span class="st">&quot;-1&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">option</span><span class="dt">&gt;</span></span>
<span id="cb871-20"><a href="Truffle-Web3.html#cb871-20" tabindex="-1"></a>          <span class="dt">&lt;</span><span class="kw">option</span></span>
<span id="cb871-21"><a href="Truffle-Web3.html#cb871-21" tabindex="-1"></a><span class="ot">            *ngFor</span><span class="op">=</span><span class="st">&quot;let proposal of web3Service.proposals; let i = index&quot;</span></span>
<span id="cb871-22"><a href="Truffle-Web3.html#cb871-22" tabindex="-1"></a><span class="ot">            [ngValue]</span><span class="op">=</span><span class="st">&quot;i&quot;</span></span>
<span id="cb871-23"><a href="Truffle-Web3.html#cb871-23" tabindex="-1"></a><span class="ot">          </span><span class="dt">&gt;</span></span>
<span id="cb871-24"><a href="Truffle-Web3.html#cb871-24" tabindex="-1"></a>            {{ proposal }}</span>
<span id="cb871-25"><a href="Truffle-Web3.html#cb871-25" tabindex="-1"></a>          <span class="dt">&lt;/</span><span class="kw">option</span><span class="dt">&gt;</span></span>
<span id="cb871-26"><a href="Truffle-Web3.html#cb871-26" tabindex="-1"></a>        <span class="dt">&lt;/</span><span class="kw">select</span><span class="dt">&gt;</span></span>
<span id="cb871-27"><a href="Truffle-Web3.html#cb871-27" tabindex="-1"></a>      <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb871-28"><a href="Truffle-Web3.html#cb871-28" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">button</span></span>
<span id="cb871-29"><a href="Truffle-Web3.html#cb871-29" tabindex="-1"></a><span class="ot">        class</span><span class="op">=</span><span class="st">&quot;btn btn-sm btn-primary&quot;</span></span>
<span id="cb871-30"><a href="Truffle-Web3.html#cb871-30" tabindex="-1"></a><span class="ot">        (click)</span><span class="op">=</span><span class="st">&quot;castVote()&quot;</span></span>
<span id="cb871-31"><a href="Truffle-Web3.html#cb871-31" tabindex="-1"></a><span class="ot">        [disabled]</span><span class="op">=</span><span class="st">&quot;!displayCastingVote()&quot;</span></span>
<span id="cb871-32"><a href="Truffle-Web3.html#cb871-32" tabindex="-1"></a><span class="ot">      </span><span class="dt">&gt;</span></span>
<span id="cb871-33"><a href="Truffle-Web3.html#cb871-33" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">i</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;fa-solid fa-plus me-2&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">i</span><span class="dt">&gt;</span>Vote</span>
<span id="cb871-34"><a href="Truffle-Web3.html#cb871-34" tabindex="-1"></a>      <span class="dt">&lt;/</span><span class="kw">button</span><span class="dt">&gt;</span></span>
<span id="cb871-35"><a href="Truffle-Web3.html#cb871-35" tabindex="-1"></a>    <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb871-36"><a href="Truffle-Web3.html#cb871-36" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card-footer small text-muted&quot;</span><span class="dt">&gt;</span></span>
<span id="cb871-37"><a href="Truffle-Web3.html#cb871-37" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">i</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;fa-solid fa-circle-info pe-1&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">i</span><span class="dt">&gt;</span>A registered voter casts</span>
<span id="cb871-38"><a href="Truffle-Web3.html#cb871-38" tabindex="-1"></a>      vote.</span>
<span id="cb871-39"><a href="Truffle-Web3.html#cb871-39" tabindex="-1"></a>    <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb871-40"><a href="Truffle-Web3.html#cb871-40" tabindex="-1"></a>  <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb871-41"><a href="Truffle-Web3.html#cb871-41" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb871-42"><a href="Truffle-Web3.html#cb871-42" tabindex="-1"></a><span class="co">&lt;!-- </span><span class="re">END</span><span class="co">: Cast vote --&gt;</span></span></code></pre></div>
<script>
  $(document).ready(function() {
    $("#podpora-funkcionalnostim-registriranega-volivca code.javascript:eq(0)").markRegExp(/\s+?public async submitProposal[\s\S]+?return[\s\S]+?}[\s\S]+?}/, options_dodaj);
    $("#podpora-funkcionalnostim-registriranega-volivca code.javascript:eq(1)").markRegExp(/, TemplateRef, ViewChild/, options_dodaj);
    $("#podpora-funkcionalnostim-registriranega-volivca code.javascript:eq(1)").markRegExp(/import { BsModalService.+/, options_dodaj);
    $("#podpora-funkcionalnostim-registriranega-volivca code.javascript:eq(1)").markRegExp(/\s+?protected (confirmation|inputProposal):.+/, options_dodaj);
    $("#podpora-funkcionalnostim-registriranega-volivca code.javascript:eq(1)").markRegExp(/\s+?modalRef\?:.+/, options_dodaj);
    $("#podpora-funkcionalnostim-registriranega-volivca code.javascript:eq(1)").markRegExp(/\s+?\@ViewChild.+/, options_dodaj);
    $("#podpora-funkcionalnostim-registriranega-volivca code.javascript:eq(1)").markRegExp(/,[^\p]+?private modalService.+/, options_dodaj);
    $("#podpora-funkcionalnostim-registriranega-volivca code.javascript:eq(1)").markRegExp(/\s+?displayProposalSubmission[\s\S]+?hide[\s\S]+?}/, options_dodaj);
    $("#podpora-funkcionalnostim-registriranega-volivca code.html:eq(0)").markRegExp(/\s+?(\[ngClass\]|\[disabled\]|\[\(ngModel\)\]|\(click\))=".+?"/, options_dodaj);
    $("#podpora-funkcionalnostim-registriranega-volivca code.html:eq(0)").markRegExp(/\s+?<\!-- START: Modal[\s\S]+?END: Modal -->/, options_dodaj);
    $("#podpora-funkcionalnostim-registriranega-volivca code.javascript:eq(2)").markRegExp(/\s+?public async castVote[\s\S]+?return[\s\S]+?}[\s\S]+?}/, options_dodaj);
    $("#podpora-funkcionalnostim-registriranega-volivca code.javascript:eq(3)").markRegExp(/\s+?protected inputVoteProposalId.+/, options_dodaj);
    $("#podpora-funkcionalnostim-registriranega-volivca code.javascript:eq(3)").markRegExp(/\s+?displayCastingVote[\s\S]+?}\);[\s\S]+?}/, options_dodaj);
    $("#podpora-funkcionalnostim-registriranega-volivca code.html:eq(1)").markRegExp(/\s+?(\[ngClass\]|\[disabled\]|\[\(ngModel\)\]|\(click\))=".+?"/, options_dodaj);
    $("#podpora-funkcionalnostim-registriranega-volivca code.html:eq(1)").markRegExp(/\s+?<option[^\]]+?\*ngFor[\s\S]+?<\/option>/, options_dodaj);
  });
</script>
</div>
<div id="podpora-funkcionalnostim-skrbnika" class="section level3 hasAnchor" number="13.2.8">
<h3><span class="header-section-number">13.2.8</span> Podpora funkcionalnostim skrbnika<a href="Truffle-Web3.html#podpora-funkcionalnostim-skrbnika" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><i class="fa-solid fa-user-gear"></i><strong>Skrbnik volitev</strong> je uporabnik, ki je poskrbel za postavitev pametne pogodbe na verigo blokov. Na voljo so mu vse funkcionalnosti neregistriranega volivca in še naslednje funkcionalnosti (glej sliko <a href="Truffle-Web3.html#fig:slika-Glasovanje-spletna-stran">13.4</a>):</p>
<ul>
<li><strong>registracija volivca</strong>,</li>
<li><strong>sprememba statusa sprejemanja predlogov</strong>,</li>
<li><strong>sprememba statusa glasovanja</strong> in</li>
<li><strong>štetje glasov</strong>.</li>
</ul>
<p>Pri <strong>registraciji volivca</strong> skrbnik vnese njegov naslov računa, ki se, preko klica funkcije <code>registerVoter(...)</code> na pametni pogodbi, trajno shrani na verigo blokov.</p>
<p>Pred klicem metode preverimo ali je prijavljeni uporabnik skrbnik, ali je naslov vnesenega računa ustrezen in mogoče že registriran ter ali smo v fazi registracije. Če pogoji niso izpolnjeni, uporabniku ne dovolimo klica funkcije pametne pogodbe.</p>
<p>S pomočjo metode <code>displayRegisteringVoters()</code> poskrbimo za prikaz funkcionalnosti zgolj za skrbnike in v fazi registracije volivcev.</p>
<p><code>angular/src/app/shared/services/web3.service.ts</code></p>
<div class="sourceCode" id="cb872"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb872-1"><a href="Truffle-Web3.html#cb872-1" tabindex="-1"></a><span class="im">import</span> { Injectable } <span class="im">from</span> <span class="st">&quot;@angular/core&quot;</span><span class="op">;</span></span>
<span id="cb872-2"><a href="Truffle-Web3.html#cb872-2" tabindex="-1"></a><span class="im">import</span> { Web3 } <span class="im">from</span> <span class="st">&quot;web3&quot;</span><span class="op">;</span></span>
<span id="cb872-3"><a href="Truffle-Web3.html#cb872-3" tabindex="-1"></a><span class="im">import</span> { Contract } <span class="im">from</span> <span class="st">&quot;web3-eth-contract&quot;</span><span class="op">;</span></span>
<span id="cb872-4"><a href="Truffle-Web3.html#cb872-4" tabindex="-1"></a><span class="im">import</span> { isAddress } <span class="im">from</span> <span class="st">&quot;web3-validator&quot;</span><span class="op">;</span></span>
<span id="cb872-5"><a href="Truffle-Web3.html#cb872-5" tabindex="-1"></a><span class="im">import</span> { environment } <span class="im">from</span> <span class="st">&quot;../../../environments/environment&quot;</span><span class="op">;</span></span>
<span id="cb872-6"><a href="Truffle-Web3.html#cb872-6" tabindex="-1"></a><span class="op">...</span></span>
<span id="cb872-7"><a href="Truffle-Web3.html#cb872-7" tabindex="-1"></a><span class="im">export</span> <span class="kw">class</span> Web3Service {</span>
<span id="cb872-8"><a href="Truffle-Web3.html#cb872-8" tabindex="-1"></a>  <span class="op">...</span></span>
<span id="cb872-9"><a href="Truffle-Web3.html#cb872-9" tabindex="-1"></a>  <span class="kw">public</span> <span class="kw">async</span> <span class="fu">registerVoter</span>(<span class="dt">voterAddress</span><span class="op">:</span> string)<span class="op">:</span> <span class="bu">Promise</span><span class="op">&lt;</span>string<span class="op">&gt;</span> {</span>
<span id="cb872-10"><a href="Truffle-Web3.html#cb872-10" tabindex="-1"></a>    <span class="kw">let</span> message <span class="op">=</span> <span class="st">&quot;&quot;</span><span class="op">;</span></span>
<span id="cb872-11"><a href="Truffle-Web3.html#cb872-11" tabindex="-1"></a>    <span class="cf">try</span> {</span>
<span id="cb872-12"><a href="Truffle-Web3.html#cb872-12" tabindex="-1"></a>      <span class="cf">if</span> (<span class="op">!</span><span class="fu">isAddress</span>(voterAddress))</span>
<span id="cb872-13"><a href="Truffle-Web3.html#cb872-13" tabindex="-1"></a>        <span class="cf">throw</span> <span class="kw">new</span> <span class="bu">Error</span>(</span>
<span id="cb872-14"><a href="Truffle-Web3.html#cb872-14" tabindex="-1"></a>          <span class="st">&quot;&#39;&quot;</span> <span class="op">+</span> voterAddress <span class="op">+</span> <span class="st">&quot;&#39; is an invalid Ethereum address!&quot;</span></span>
<span id="cb872-15"><a href="Truffle-Web3.html#cb872-15" tabindex="-1"></a>        )<span class="op">;</span></span>
<span id="cb872-16"><a href="Truffle-Web3.html#cb872-16" tabindex="-1"></a>      <span class="cf">else</span> <span class="cf">if</span> (</span>
<span id="cb872-17"><a href="Truffle-Web3.html#cb872-17" tabindex="-1"></a>        <span class="op">!</span>(<span class="cf">await</span> (<span class="kw">this</span><span class="op">.</span><span class="at">contract</span><span class="op">.</span><span class="at">methods</span>[<span class="st">&quot;isAdministrator&quot;</span>] <span class="im">as</span> any)(</span>
<span id="cb872-18"><a href="Truffle-Web3.html#cb872-18" tabindex="-1"></a>          <span class="kw">this</span><span class="op">.</span><span class="at">userAddress</span></span>
<span id="cb872-19"><a href="Truffle-Web3.html#cb872-19" tabindex="-1"></a>        )<span class="op">.</span><span class="fu">call</span>())</span>
<span id="cb872-20"><a href="Truffle-Web3.html#cb872-20" tabindex="-1"></a>      )</span>
<span id="cb872-21"><a href="Truffle-Web3.html#cb872-21" tabindex="-1"></a>        <span class="cf">throw</span> <span class="kw">new</span> <span class="bu">Error</span>(<span class="st">&quot;You are not an administrator!&quot;</span>)<span class="op">;</span></span>
<span id="cb872-22"><a href="Truffle-Web3.html#cb872-22" tabindex="-1"></a>      <span class="cf">else</span> <span class="cf">if</span> (</span>
<span id="cb872-23"><a href="Truffle-Web3.html#cb872-23" tabindex="-1"></a>        <span class="cf">await</span> (<span class="kw">this</span><span class="op">.</span><span class="at">contract</span><span class="op">.</span><span class="at">methods</span>[<span class="st">&quot;isRegisteredVoter&quot;</span>] <span class="im">as</span> any)(</span>
<span id="cb872-24"><a href="Truffle-Web3.html#cb872-24" tabindex="-1"></a>          voterAddress</span>
<span id="cb872-25"><a href="Truffle-Web3.html#cb872-25" tabindex="-1"></a>        )<span class="op">.</span><span class="fu">call</span>()</span>
<span id="cb872-26"><a href="Truffle-Web3.html#cb872-26" tabindex="-1"></a>      )</span>
<span id="cb872-27"><a href="Truffle-Web3.html#cb872-27" tabindex="-1"></a>        <span class="cf">throw</span> <span class="kw">new</span> <span class="bu">Error</span>(<span class="st">&quot;Voter &#39;&quot;</span> <span class="op">+</span> voterAddress <span class="op">+</span> <span class="st">&quot;&#39; already registered!&quot;</span>)<span class="op">;</span></span>
<span id="cb872-28"><a href="Truffle-Web3.html#cb872-28" tabindex="-1"></a>      <span class="cf">else</span> <span class="cf">if</span> (<span class="kw">this</span><span class="op">.</span><span class="at">workflowStatus</span> <span class="op">!=</span> WorkflowStatus<span class="op">.</span><span class="at">RegisteringVoters</span>)</span>
<span id="cb872-29"><a href="Truffle-Web3.html#cb872-29" tabindex="-1"></a>        <span class="cf">throw</span> <span class="kw">new</span> <span class="bu">Error</span>(<span class="st">&quot;Voter registration is not allowed at this time!&quot;</span>)<span class="op">;</span></span>
<span id="cb872-30"><a href="Truffle-Web3.html#cb872-30" tabindex="-1"></a>      <span class="cf">if</span> (</span>
<span id="cb872-31"><a href="Truffle-Web3.html#cb872-31" tabindex="-1"></a>        <span class="op">!</span>(</span>
<span id="cb872-32"><a href="Truffle-Web3.html#cb872-32" tabindex="-1"></a>          <span class="cf">await</span> (<span class="kw">this</span><span class="op">.</span><span class="at">contract</span><span class="op">.</span><span class="at">methods</span>[<span class="st">&quot;registerVoter&quot;</span>] <span class="im">as</span> any)(</span>
<span id="cb872-33"><a href="Truffle-Web3.html#cb872-33" tabindex="-1"></a>            voterAddress</span>
<span id="cb872-34"><a href="Truffle-Web3.html#cb872-34" tabindex="-1"></a>          )<span class="op">.</span><span class="fu">send</span>({</span>
<span id="cb872-35"><a href="Truffle-Web3.html#cb872-35" tabindex="-1"></a>            <span class="dt">from</span><span class="op">:</span> <span class="kw">this</span><span class="op">.</span><span class="at">userAddress</span><span class="op">,</span></span>
<span id="cb872-36"><a href="Truffle-Web3.html#cb872-36" tabindex="-1"></a>          })</span>
<span id="cb872-37"><a href="Truffle-Web3.html#cb872-37" tabindex="-1"></a>        )<span class="op">.</span><span class="at">status</span></span>
<span id="cb872-38"><a href="Truffle-Web3.html#cb872-38" tabindex="-1"></a>      )</span>
<span id="cb872-39"><a href="Truffle-Web3.html#cb872-39" tabindex="-1"></a>        <span class="cf">throw</span> <span class="kw">new</span> <span class="bu">Error</span>(<span class="st">&quot;Error registering voter &#39;&quot;</span> <span class="op">+</span> voterAddress <span class="op">+</span> <span class="st">&quot;&#39;!&quot;</span>)<span class="op">;</span></span>
<span id="cb872-40"><a href="Truffle-Web3.html#cb872-40" tabindex="-1"></a>    } <span class="cf">catch</span> (<span class="dt">error</span><span class="op">:</span> any) {</span>
<span id="cb872-41"><a href="Truffle-Web3.html#cb872-41" tabindex="-1"></a>      message <span class="op">=</span> error<span class="op">.</span><span class="at">message</span><span class="op">;</span></span>
<span id="cb872-42"><a href="Truffle-Web3.html#cb872-42" tabindex="-1"></a>    }</span>
<span id="cb872-43"><a href="Truffle-Web3.html#cb872-43" tabindex="-1"></a>    <span class="cf">return</span> message<span class="op">;</span></span>
<span id="cb872-44"><a href="Truffle-Web3.html#cb872-44" tabindex="-1"></a>  }</span>
<span id="cb872-45"><a href="Truffle-Web3.html#cb872-45" tabindex="-1"></a>}</span></code></pre></div>
<p><code>angular/src/app/shared/components/vote/vote.component.ts</code></p>
<div class="sourceCode" id="cb873"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb873-1"><a href="Truffle-Web3.html#cb873-1" tabindex="-1"></a><span class="im">export</span> <span class="kw">class</span> VoteComponent <span class="kw">implements</span> OnInit {</span>
<span id="cb873-2"><a href="Truffle-Web3.html#cb873-2" tabindex="-1"></a>  <span class="op">...</span></span>
<span id="cb873-3"><a href="Truffle-Web3.html#cb873-3" tabindex="-1"></a>  <span class="kw">protected</span> <span class="dt">inputVoteProposalId</span><span class="op">:</span> number <span class="op">=</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb873-4"><a href="Truffle-Web3.html#cb873-4" tabindex="-1"></a>  <span class="kw">protected</span> <span class="dt">inputVoterAddress</span><span class="op">:</span> string <span class="op">=</span> <span class="st">&quot;&quot;</span><span class="op">;</span></span>
<span id="cb873-5"><a href="Truffle-Web3.html#cb873-5" tabindex="-1"></a>  modalRef<span class="op">?:</span> BsModalRef<span class="op">;</span></span>
<span id="cb873-6"><a href="Truffle-Web3.html#cb873-6" tabindex="-1"></a>  <span class="op">...</span></span>
<span id="cb873-7"><a href="Truffle-Web3.html#cb873-7" tabindex="-1"></a>  <span class="fu">displayRegisteringVoters</span>()<span class="op">:</span> boolean {</span>
<span id="cb873-8"><a href="Truffle-Web3.html#cb873-8" tabindex="-1"></a>    <span class="cf">return</span> (</span>
<span id="cb873-9"><a href="Truffle-Web3.html#cb873-9" tabindex="-1"></a>      <span class="kw">this</span><span class="op">.</span><span class="at">web3Service</span><span class="op">.</span><span class="at">userType</span> <span class="op">==</span> <span class="dv">4</span> <span class="op">&amp;&amp;</span> <span class="kw">this</span><span class="op">.</span><span class="at">web3Service</span><span class="op">.</span><span class="at">workflowStatus</span> <span class="op">==</span> <span class="dv">1</span></span>
<span id="cb873-10"><a href="Truffle-Web3.html#cb873-10" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb873-11"><a href="Truffle-Web3.html#cb873-11" tabindex="-1"></a>  }</span>
<span id="cb873-12"><a href="Truffle-Web3.html#cb873-12" tabindex="-1"></a>  <span class="fu">registerVoter</span>()<span class="op">:</span> <span class="kw">void</span> {</span>
<span id="cb873-13"><a href="Truffle-Web3.html#cb873-13" tabindex="-1"></a>    <span class="kw">this</span><span class="op">.</span><span class="at">web3Service</span></span>
<span id="cb873-14"><a href="Truffle-Web3.html#cb873-14" tabindex="-1"></a>      <span class="op">.</span><span class="fu">registerVoter</span>(<span class="kw">this</span><span class="op">.</span><span class="at">inputVoterAddress</span>)</span>
<span id="cb873-15"><a href="Truffle-Web3.html#cb873-15" tabindex="-1"></a>      <span class="op">.</span><span class="fu">then</span>((<span class="dt">message</span><span class="op">:</span> string) <span class="kw">=&gt;</span> {</span>
<span id="cb873-16"><a href="Truffle-Web3.html#cb873-16" tabindex="-1"></a>        <span class="cf">if</span> (message<span class="op">.</span><span class="at">length</span> <span class="op">==</span> <span class="dv">0</span>) {</span>
<span id="cb873-17"><a href="Truffle-Web3.html#cb873-17" tabindex="-1"></a>          <span class="kw">this</span><span class="op">.</span><span class="fu">openModal</span>(</span>
<span id="cb873-18"><a href="Truffle-Web3.html#cb873-18" tabindex="-1"></a>            <span class="st">&quot;Voter with address &quot;</span> <span class="op">+</span></span>
<span id="cb873-19"><a href="Truffle-Web3.html#cb873-19" tabindex="-1"></a>              <span class="kw">this</span><span class="op">.</span><span class="at">inputVoterAddress</span> <span class="op">+</span></span>
<span id="cb873-20"><a href="Truffle-Web3.html#cb873-20" tabindex="-1"></a>              <span class="st">&quot; registered successfully!&quot;</span></span>
<span id="cb873-21"><a href="Truffle-Web3.html#cb873-21" tabindex="-1"></a>          )<span class="op">;</span></span>
<span id="cb873-22"><a href="Truffle-Web3.html#cb873-22" tabindex="-1"></a>          <span class="kw">this</span><span class="op">.</span><span class="at">inputVoterAddress</span> <span class="op">=</span> <span class="st">&quot;&quot;</span><span class="op">;</span></span>
<span id="cb873-23"><a href="Truffle-Web3.html#cb873-23" tabindex="-1"></a>        }</span>
<span id="cb873-24"><a href="Truffle-Web3.html#cb873-24" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">message</span> <span class="op">=</span> message<span class="op">;</span></span>
<span id="cb873-25"><a href="Truffle-Web3.html#cb873-25" tabindex="-1"></a>      })<span class="op">;</span></span>
<span id="cb873-26"><a href="Truffle-Web3.html#cb873-26" tabindex="-1"></a>  }</span>
<span id="cb873-27"><a href="Truffle-Web3.html#cb873-27" tabindex="-1"></a>  <span class="kw">protected</span> <span class="fu">openModal</span>(<span class="dt">message</span><span class="op">:</span> string) {</span>
<span id="cb873-28"><a href="Truffle-Web3.html#cb873-28" tabindex="-1"></a>    <span class="op">...</span></span>
<span id="cb873-29"><a href="Truffle-Web3.html#cb873-29" tabindex="-1"></a>  }</span>
<span id="cb873-30"><a href="Truffle-Web3.html#cb873-30" tabindex="-1"></a>  <span class="op">...</span></span>
<span id="cb873-31"><a href="Truffle-Web3.html#cb873-31" tabindex="-1"></a>}</span></code></pre></div>
<p><code>angular/src/app/shared/components/vote/vote.component.html</code></p>
<div class="sourceCode" id="cb874"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb874-1"><a href="Truffle-Web3.html#cb874-1" tabindex="-1"></a><span class="co">&lt;!-- START: Registering voters --&gt;</span></span>
<span id="cb874-2"><a href="Truffle-Web3.html#cb874-2" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;col&quot;</span><span class="dt">&gt;</span></span>
<span id="cb874-3"><a href="Truffle-Web3.html#cb874-3" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card&quot;</span><span class="dt">&gt;</span></span>
<span id="cb874-4"><a href="Truffle-Web3.html#cb874-4" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card-header bg-light&quot;</span><span class="dt">&gt;</span></span>
<span id="cb874-5"><a href="Truffle-Web3.html#cb874-5" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">h4</span></span>
<span id="cb874-6"><a href="Truffle-Web3.html#cb874-6" tabindex="-1"></a><span class="ot">        class</span><span class="op">=</span><span class="st">&quot;mb-0&quot;</span></span>
<span id="cb874-7"><a href="Truffle-Web3.html#cb874-7" tabindex="-1"></a><span class="ot">        [ngClass]</span><span class="op">=</span><span class="st">&quot;{ &#39;text-muted&#39;: !displayRegisteringVoters() }&quot;</span></span>
<span id="cb874-8"><a href="Truffle-Web3.html#cb874-8" tabindex="-1"></a><span class="ot">      </span><span class="dt">&gt;</span></span>
<span id="cb874-9"><a href="Truffle-Web3.html#cb874-9" tabindex="-1"></a>        Registering voters<span class="dt">&lt;</span><span class="kw">sup</span></span>
<span id="cb874-10"><a href="Truffle-Web3.html#cb874-10" tabindex="-1"></a><span class="ot">          </span><span class="dt">&gt;&lt;</span><span class="kw">small</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;text-muted&quot;</span><span class="dt">&gt;</span></span>
<span id="cb874-11"><a href="Truffle-Web3.html#cb874-11" tabindex="-1"></a>            <span class="dt">&lt;</span><span class="kw">i</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;fa-solid fa-user-gear ps-2 pe-1&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">i</span><span class="dt">&gt;&lt;/</span><span class="kw">small</span></span>
<span id="cb874-12"><a href="Truffle-Web3.html#cb874-12" tabindex="-1"></a>        <span class="dt">&gt;&lt;/</span><span class="kw">sup</span><span class="dt">&gt;</span></span>
<span id="cb874-13"><a href="Truffle-Web3.html#cb874-13" tabindex="-1"></a>      <span class="dt">&lt;/</span><span class="kw">h4</span><span class="dt">&gt;</span></span>
<span id="cb874-14"><a href="Truffle-Web3.html#cb874-14" tabindex="-1"></a>    <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb874-15"><a href="Truffle-Web3.html#cb874-15" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card-body&quot;</span><span class="dt">&gt;</span></span>
<span id="cb874-16"><a href="Truffle-Web3.html#cb874-16" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;mb-3&quot;</span><span class="dt">&gt;</span></span>
<span id="cb874-17"><a href="Truffle-Web3.html#cb874-17" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">label</span></span>
<span id="cb874-18"><a href="Truffle-Web3.html#cb874-18" tabindex="-1"></a><span class="ot">          class</span><span class="op">=</span><span class="st">&quot;form-label&quot;</span></span>
<span id="cb874-19"><a href="Truffle-Web3.html#cb874-19" tabindex="-1"></a><span class="ot">          [ngClass]</span><span class="op">=</span><span class="st">&quot;{ &#39;text-muted&#39;: !displayRegisteringVoters() }&quot;</span></span>
<span id="cb874-20"><a href="Truffle-Web3.html#cb874-20" tabindex="-1"></a><span class="ot">          </span><span class="dt">&gt;</span>Address of the voter&#39;s account<span class="dt">&lt;/</span><span class="kw">label</span></span>
<span id="cb874-21"><a href="Truffle-Web3.html#cb874-21" tabindex="-1"></a>        <span class="dt">&gt;</span></span>
<span id="cb874-22"><a href="Truffle-Web3.html#cb874-22" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">input</span></span>
<span id="cb874-23"><a href="Truffle-Web3.html#cb874-23" tabindex="-1"></a><span class="ot">          type</span><span class="op">=</span><span class="st">&quot;text&quot;</span></span>
<span id="cb874-24"><a href="Truffle-Web3.html#cb874-24" tabindex="-1"></a><span class="ot">          class</span><span class="op">=</span><span class="st">&quot;form-control form-control-sm&quot;</span></span>
<span id="cb874-25"><a href="Truffle-Web3.html#cb874-25" tabindex="-1"></a><span class="ot">          [disabled]</span><span class="op">=</span><span class="st">&quot;!displayRegisteringVoters()&quot;</span></span>
<span id="cb874-26"><a href="Truffle-Web3.html#cb874-26" tabindex="-1"></a><span class="ot">          [(ngModel)]</span><span class="op">=</span><span class="st">&quot;inputVoterAddress&quot;</span></span>
<span id="cb874-27"><a href="Truffle-Web3.html#cb874-27" tabindex="-1"></a><span class="ot">        </span><span class="dt">/&gt;</span></span>
<span id="cb874-28"><a href="Truffle-Web3.html#cb874-28" tabindex="-1"></a>      <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb874-29"><a href="Truffle-Web3.html#cb874-29" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">button</span></span>
<span id="cb874-30"><a href="Truffle-Web3.html#cb874-30" tabindex="-1"></a><span class="ot">        class</span><span class="op">=</span><span class="st">&quot;btn btn-sm btn-primary&quot;</span></span>
<span id="cb874-31"><a href="Truffle-Web3.html#cb874-31" tabindex="-1"></a><span class="ot">        (click)</span><span class="op">=</span><span class="st">&quot;registerVoter()&quot;</span></span>
<span id="cb874-32"><a href="Truffle-Web3.html#cb874-32" tabindex="-1"></a><span class="ot">        [disabled]</span><span class="op">=</span><span class="st">&quot;!displayRegisteringVoters()&quot;</span></span>
<span id="cb874-33"><a href="Truffle-Web3.html#cb874-33" tabindex="-1"></a><span class="ot">      </span><span class="dt">&gt;</span></span>
<span id="cb874-34"><a href="Truffle-Web3.html#cb874-34" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">i</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;fa-solid fa-plus me-2&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">i</span><span class="dt">&gt;</span>Register</span>
<span id="cb874-35"><a href="Truffle-Web3.html#cb874-35" tabindex="-1"></a>      <span class="dt">&lt;/</span><span class="kw">button</span><span class="dt">&gt;</span></span>
<span id="cb874-36"><a href="Truffle-Web3.html#cb874-36" tabindex="-1"></a>    <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb874-37"><a href="Truffle-Web3.html#cb874-37" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card-footer small text-muted&quot;</span><span class="dt">&gt;</span></span>
<span id="cb874-38"><a href="Truffle-Web3.html#cb874-38" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">i</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;fa-solid fa-circle-info pe-1&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">i</span><span class="dt">&gt;</span>The administrator registers</span>
<span id="cb874-39"><a href="Truffle-Web3.html#cb874-39" tabindex="-1"></a>      a new voter.</span>
<span id="cb874-40"><a href="Truffle-Web3.html#cb874-40" tabindex="-1"></a>    <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb874-41"><a href="Truffle-Web3.html#cb874-41" tabindex="-1"></a>  <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb874-42"><a href="Truffle-Web3.html#cb874-42" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb874-43"><a href="Truffle-Web3.html#cb874-43" tabindex="-1"></a><span class="co">&lt;!-- </span><span class="re">END</span><span class="co">: Registering voters --&gt;</span></span></code></pre></div>
<p>Pri <strong>spremembi statusa sprejemanja predlogov</strong> podpremo dve akciji, in sicer začetek (<code>start</code>) ter konec (<code>end</code>) procesa sprejemanja predlogov, kar določa parameter <code>action</code> funkcije <code>proposalRegistrationProcess(...)</code>.</p>
<p>V obeh primerih preverimo ali je prijavljen uporabnik skrbnik in smo v ustrezni fazi (registracije oz. posredovanja predlogov za glasovanje). Če pogoji niso izpolnjeni, klica funkcije na pametni pogodbi ne dovolimo.</p>
<p>Prav tako poskrbimo za prikaz omenjene funkcionalnosti zgolj ob prej omenjenih izpolnjenih pogojih.</p>
<p><code>angular/src/app/shared/services/web3.service.ts</code></p>
<div class="sourceCode" id="cb875"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb875-1"><a href="Truffle-Web3.html#cb875-1" tabindex="-1"></a><span class="im">export</span> <span class="kw">class</span> Web3Service {</span>
<span id="cb875-2"><a href="Truffle-Web3.html#cb875-2" tabindex="-1"></a>  <span class="op">...</span></span>
<span id="cb875-3"><a href="Truffle-Web3.html#cb875-3" tabindex="-1"></a>  <span class="kw">public</span> <span class="kw">async</span> <span class="fu">proposalRegistrationProcess</span>(<span class="dt">action</span><span class="op">:</span> string)<span class="op">:</span> <span class="bu">Promise</span><span class="op">&lt;</span>string<span class="op">&gt;</span> {</span>
<span id="cb875-4"><a href="Truffle-Web3.html#cb875-4" tabindex="-1"></a>    <span class="kw">let</span> message <span class="op">=</span> <span class="st">&quot;&quot;</span><span class="op">;</span></span>
<span id="cb875-5"><a href="Truffle-Web3.html#cb875-5" tabindex="-1"></a>    <span class="cf">try</span> {</span>
<span id="cb875-6"><a href="Truffle-Web3.html#cb875-6" tabindex="-1"></a>      <span class="cf">if</span> (</span>
<span id="cb875-7"><a href="Truffle-Web3.html#cb875-7" tabindex="-1"></a>        <span class="op">!</span>(<span class="cf">await</span> (<span class="kw">this</span><span class="op">.</span><span class="at">contract</span><span class="op">.</span><span class="at">methods</span>[<span class="st">&quot;isAdministrator&quot;</span>] <span class="im">as</span> any)(</span>
<span id="cb875-8"><a href="Truffle-Web3.html#cb875-8" tabindex="-1"></a>          <span class="kw">this</span><span class="op">.</span><span class="at">userAddress</span></span>
<span id="cb875-9"><a href="Truffle-Web3.html#cb875-9" tabindex="-1"></a>        )<span class="op">.</span><span class="fu">call</span>())</span>
<span id="cb875-10"><a href="Truffle-Web3.html#cb875-10" tabindex="-1"></a>      )</span>
<span id="cb875-11"><a href="Truffle-Web3.html#cb875-11" tabindex="-1"></a>        <span class="cf">throw</span> <span class="kw">new</span> <span class="bu">Error</span>(<span class="st">&quot;You are not an administrator!&quot;</span>)<span class="op">;</span></span>
<span id="cb875-12"><a href="Truffle-Web3.html#cb875-12" tabindex="-1"></a>      <span class="cf">else</span> <span class="cf">if</span> (</span>
<span id="cb875-13"><a href="Truffle-Web3.html#cb875-13" tabindex="-1"></a>        action <span class="op">==</span> <span class="st">&quot;start&quot;</span> <span class="op">&amp;&amp;</span></span>
<span id="cb875-14"><a href="Truffle-Web3.html#cb875-14" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">workflowStatus</span> <span class="op">!=</span> WorkflowStatus<span class="op">.</span><span class="at">RegisteringVoters</span></span>
<span id="cb875-15"><a href="Truffle-Web3.html#cb875-15" tabindex="-1"></a>      )</span>
<span id="cb875-16"><a href="Truffle-Web3.html#cb875-16" tabindex="-1"></a>        <span class="cf">throw</span> <span class="kw">new</span> <span class="bu">Error</span>(</span>
<span id="cb875-17"><a href="Truffle-Web3.html#cb875-17" tabindex="-1"></a>          <span class="st">&quot;Start of proposal registration is not allowed at this time!&quot;</span></span>
<span id="cb875-18"><a href="Truffle-Web3.html#cb875-18" tabindex="-1"></a>        )<span class="op">;</span></span>
<span id="cb875-19"><a href="Truffle-Web3.html#cb875-19" tabindex="-1"></a>      <span class="cf">else</span> <span class="cf">if</span> (</span>
<span id="cb875-20"><a href="Truffle-Web3.html#cb875-20" tabindex="-1"></a>        action <span class="op">==</span> <span class="st">&quot;end&quot;</span> <span class="op">&amp;&amp;</span></span>
<span id="cb875-21"><a href="Truffle-Web3.html#cb875-21" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">workflowStatus</span> <span class="op">!=</span> WorkflowStatus<span class="op">.</span><span class="at">ProposalsRegistrationStarted</span></span>
<span id="cb875-22"><a href="Truffle-Web3.html#cb875-22" tabindex="-1"></a>      )</span>
<span id="cb875-23"><a href="Truffle-Web3.html#cb875-23" tabindex="-1"></a>        <span class="cf">throw</span> <span class="kw">new</span> <span class="bu">Error</span>(</span>
<span id="cb875-24"><a href="Truffle-Web3.html#cb875-24" tabindex="-1"></a>          <span class="st">&quot;End of proposal registration is not allowed at this time!&quot;</span></span>
<span id="cb875-25"><a href="Truffle-Web3.html#cb875-25" tabindex="-1"></a>        )<span class="op">;</span></span>
<span id="cb875-26"><a href="Truffle-Web3.html#cb875-26" tabindex="-1"></a>      <span class="cf">if</span> (action <span class="op">==</span> <span class="st">&quot;start&quot;</span>) {</span>
<span id="cb875-27"><a href="Truffle-Web3.html#cb875-27" tabindex="-1"></a>        <span class="cf">if</span> (</span>
<span id="cb875-28"><a href="Truffle-Web3.html#cb875-28" tabindex="-1"></a>          <span class="op">!</span>(</span>
<span id="cb875-29"><a href="Truffle-Web3.html#cb875-29" tabindex="-1"></a>            <span class="cf">await</span> (</span>
<span id="cb875-30"><a href="Truffle-Web3.html#cb875-30" tabindex="-1"></a>              <span class="kw">this</span><span class="op">.</span><span class="at">contract</span><span class="op">.</span><span class="at">methods</span>[<span class="st">&quot;startProposalsRegistration&quot;</span>] <span class="im">as</span> any</span>
<span id="cb875-31"><a href="Truffle-Web3.html#cb875-31" tabindex="-1"></a>            )()<span class="op">.</span><span class="fu">send</span>({ <span class="dt">from</span><span class="op">:</span> <span class="kw">this</span><span class="op">.</span><span class="at">userAddress</span> })</span>
<span id="cb875-32"><a href="Truffle-Web3.html#cb875-32" tabindex="-1"></a>          )<span class="op">.</span><span class="at">status</span></span>
<span id="cb875-33"><a href="Truffle-Web3.html#cb875-33" tabindex="-1"></a>        )</span>
<span id="cb875-34"><a href="Truffle-Web3.html#cb875-34" tabindex="-1"></a>          <span class="cf">throw</span> <span class="kw">new</span> <span class="bu">Error</span>(<span class="st">&quot;Error starting proposal registration!&quot;</span>)<span class="op">;</span></span>
<span id="cb875-35"><a href="Truffle-Web3.html#cb875-35" tabindex="-1"></a>      } <span class="cf">else</span> <span class="cf">if</span> (action <span class="op">==</span> <span class="st">&quot;end&quot;</span>) {</span>
<span id="cb875-36"><a href="Truffle-Web3.html#cb875-36" tabindex="-1"></a>        <span class="cf">if</span> (</span>
<span id="cb875-37"><a href="Truffle-Web3.html#cb875-37" tabindex="-1"></a>          <span class="op">!</span>(</span>
<span id="cb875-38"><a href="Truffle-Web3.html#cb875-38" tabindex="-1"></a>            <span class="cf">await</span> (</span>
<span id="cb875-39"><a href="Truffle-Web3.html#cb875-39" tabindex="-1"></a>              <span class="kw">this</span><span class="op">.</span><span class="at">contract</span><span class="op">.</span><span class="at">methods</span>[<span class="st">&quot;endProposalsRegistration&quot;</span>] <span class="im">as</span> any</span>
<span id="cb875-40"><a href="Truffle-Web3.html#cb875-40" tabindex="-1"></a>            )()<span class="op">.</span><span class="fu">send</span>({ <span class="dt">from</span><span class="op">:</span> <span class="kw">this</span><span class="op">.</span><span class="at">userAddress</span> })</span>
<span id="cb875-41"><a href="Truffle-Web3.html#cb875-41" tabindex="-1"></a>          )<span class="op">.</span><span class="at">status</span></span>
<span id="cb875-42"><a href="Truffle-Web3.html#cb875-42" tabindex="-1"></a>        )</span>
<span id="cb875-43"><a href="Truffle-Web3.html#cb875-43" tabindex="-1"></a>          <span class="cf">throw</span> <span class="kw">new</span> <span class="bu">Error</span>(<span class="st">&quot;Error ending proposal registration!&quot;</span>)<span class="op">;</span></span>
<span id="cb875-44"><a href="Truffle-Web3.html#cb875-44" tabindex="-1"></a>      }</span>
<span id="cb875-45"><a href="Truffle-Web3.html#cb875-45" tabindex="-1"></a>    } <span class="cf">catch</span> (<span class="dt">error</span><span class="op">:</span> any) {</span>
<span id="cb875-46"><a href="Truffle-Web3.html#cb875-46" tabindex="-1"></a>      message <span class="op">=</span> error<span class="op">.</span><span class="at">message</span><span class="op">;</span></span>
<span id="cb875-47"><a href="Truffle-Web3.html#cb875-47" tabindex="-1"></a>    }</span>
<span id="cb875-48"><a href="Truffle-Web3.html#cb875-48" tabindex="-1"></a>    <span class="cf">return</span> message<span class="op">;</span></span>
<span id="cb875-49"><a href="Truffle-Web3.html#cb875-49" tabindex="-1"></a>  }</span>
<span id="cb875-50"><a href="Truffle-Web3.html#cb875-50" tabindex="-1"></a>}</span></code></pre></div>
<p><code>angular/src/app/shared/components/vote/vote.component.ts</code></p>
<div class="sourceCode" id="cb876"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb876-1"><a href="Truffle-Web3.html#cb876-1" tabindex="-1"></a><span class="im">export</span> <span class="kw">class</span> VoteComponent <span class="kw">implements</span> OnInit {</span>
<span id="cb876-2"><a href="Truffle-Web3.html#cb876-2" tabindex="-1"></a>  <span class="op">...</span></span>
<span id="cb876-3"><a href="Truffle-Web3.html#cb876-3" tabindex="-1"></a>  <span class="fu">displayProposalsRegistration</span>(action<span class="op">?:</span> string)<span class="op">:</span> boolean {</span>
<span id="cb876-4"><a href="Truffle-Web3.html#cb876-4" tabindex="-1"></a>    <span class="kw">let</span> display <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">web3Service</span><span class="op">.</span><span class="at">userType</span> <span class="op">==</span> <span class="dv">4</span><span class="op">;</span></span>
<span id="cb876-5"><a href="Truffle-Web3.html#cb876-5" tabindex="-1"></a>    <span class="cf">if</span> (<span class="op">!</span>action)</span>
<span id="cb876-6"><a href="Truffle-Web3.html#cb876-6" tabindex="-1"></a>      display <span class="op">=</span></span>
<span id="cb876-7"><a href="Truffle-Web3.html#cb876-7" tabindex="-1"></a>        display <span class="op">&amp;&amp;</span></span>
<span id="cb876-8"><a href="Truffle-Web3.html#cb876-8" tabindex="-1"></a>        (<span class="kw">this</span><span class="op">.</span><span class="at">web3Service</span><span class="op">.</span><span class="at">workflowStatus</span> <span class="op">==</span> <span class="dv">1</span> <span class="op">||</span></span>
<span id="cb876-9"><a href="Truffle-Web3.html#cb876-9" tabindex="-1"></a>          <span class="kw">this</span><span class="op">.</span><span class="at">web3Service</span><span class="op">.</span><span class="at">workflowStatus</span> <span class="op">==</span> <span class="dv">2</span>)<span class="op">;</span></span>
<span id="cb876-10"><a href="Truffle-Web3.html#cb876-10" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> (action <span class="op">==</span> <span class="st">&quot;start&quot;</span>)</span>
<span id="cb876-11"><a href="Truffle-Web3.html#cb876-11" tabindex="-1"></a>      display <span class="op">=</span> display <span class="op">&amp;&amp;</span> <span class="kw">this</span><span class="op">.</span><span class="at">web3Service</span><span class="op">.</span><span class="at">workflowStatus</span> <span class="op">==</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb876-12"><a href="Truffle-Web3.html#cb876-12" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> (action <span class="op">==</span> <span class="st">&quot;end&quot;</span>)</span>
<span id="cb876-13"><a href="Truffle-Web3.html#cb876-13" tabindex="-1"></a>      display <span class="op">=</span> display <span class="op">&amp;&amp;</span> <span class="kw">this</span><span class="op">.</span><span class="at">web3Service</span><span class="op">.</span><span class="at">workflowStatus</span> <span class="op">==</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb876-14"><a href="Truffle-Web3.html#cb876-14" tabindex="-1"></a>    <span class="cf">return</span> display<span class="op">;</span></span>
<span id="cb876-15"><a href="Truffle-Web3.html#cb876-15" tabindex="-1"></a>  }</span>
<span id="cb876-16"><a href="Truffle-Web3.html#cb876-16" tabindex="-1"></a>  <span class="fu">proposalRegistrationProcess</span>(<span class="dt">action</span><span class="op">:</span> string)<span class="op">:</span> <span class="kw">void</span> {</span>
<span id="cb876-17"><a href="Truffle-Web3.html#cb876-17" tabindex="-1"></a>    <span class="kw">this</span><span class="op">.</span><span class="at">web3Service</span></span>
<span id="cb876-18"><a href="Truffle-Web3.html#cb876-18" tabindex="-1"></a>      <span class="op">.</span><span class="fu">proposalRegistrationProcess</span>(action)</span>
<span id="cb876-19"><a href="Truffle-Web3.html#cb876-19" tabindex="-1"></a>      <span class="op">.</span><span class="fu">then</span>((<span class="dt">message</span><span class="op">:</span> string) <span class="kw">=&gt;</span> {</span>
<span id="cb876-20"><a href="Truffle-Web3.html#cb876-20" tabindex="-1"></a>        <span class="cf">if</span> (message<span class="op">.</span><span class="at">length</span> <span class="op">==</span> <span class="dv">0</span>) {</span>
<span id="cb876-21"><a href="Truffle-Web3.html#cb876-21" tabindex="-1"></a>          <span class="kw">this</span><span class="op">.</span><span class="at">web3Service</span><span class="op">.</span><span class="fu">getWorkflowStatus</span>()<span class="op">;</span></span>
<span id="cb876-22"><a href="Truffle-Web3.html#cb876-22" tabindex="-1"></a>          <span class="kw">this</span><span class="op">.</span><span class="fu">openModal</span>(</span>
<span id="cb876-23"><a href="Truffle-Web3.html#cb876-23" tabindex="-1"></a>            <span class="st">&quot;Proposal registration &quot;</span> <span class="op">+</span> action <span class="op">+</span> <span class="st">&quot;ed successfully!&quot;</span></span>
<span id="cb876-24"><a href="Truffle-Web3.html#cb876-24" tabindex="-1"></a>          )<span class="op">;</span></span>
<span id="cb876-25"><a href="Truffle-Web3.html#cb876-25" tabindex="-1"></a>        }</span>
<span id="cb876-26"><a href="Truffle-Web3.html#cb876-26" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">message</span> <span class="op">=</span> message<span class="op">;</span></span>
<span id="cb876-27"><a href="Truffle-Web3.html#cb876-27" tabindex="-1"></a>      })<span class="op">;</span></span>
<span id="cb876-28"><a href="Truffle-Web3.html#cb876-28" tabindex="-1"></a>  }</span>
<span id="cb876-29"><a href="Truffle-Web3.html#cb876-29" tabindex="-1"></a>  <span class="kw">protected</span> <span class="fu">openModal</span>(<span class="dt">message</span><span class="op">:</span> string) {</span>
<span id="cb876-30"><a href="Truffle-Web3.html#cb876-30" tabindex="-1"></a>    <span class="op">...</span></span>
<span id="cb876-31"><a href="Truffle-Web3.html#cb876-31" tabindex="-1"></a>  }</span>
<span id="cb876-32"><a href="Truffle-Web3.html#cb876-32" tabindex="-1"></a>  <span class="op">...</span></span>
<span id="cb876-33"><a href="Truffle-Web3.html#cb876-33" tabindex="-1"></a>}</span></code></pre></div>
<p><code>angular/src/app/shared/components/vote/vote.component.html</code></p>
<div class="sourceCode" id="cb877"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb877-1"><a href="Truffle-Web3.html#cb877-1" tabindex="-1"></a><span class="co">&lt;!-- START: Proposal registration --&gt;</span></span>
<span id="cb877-2"><a href="Truffle-Web3.html#cb877-2" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;col&quot;</span><span class="dt">&gt;</span></span>
<span id="cb877-3"><a href="Truffle-Web3.html#cb877-3" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card h-100&quot;</span><span class="dt">&gt;</span></span>
<span id="cb877-4"><a href="Truffle-Web3.html#cb877-4" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card-header bg-light&quot;</span><span class="dt">&gt;</span></span>
<span id="cb877-5"><a href="Truffle-Web3.html#cb877-5" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">h4</span></span>
<span id="cb877-6"><a href="Truffle-Web3.html#cb877-6" tabindex="-1"></a><span class="ot">        class</span><span class="op">=</span><span class="st">&quot;mb-0&quot;</span></span>
<span id="cb877-7"><a href="Truffle-Web3.html#cb877-7" tabindex="-1"></a><span class="ot">        [ngClass]</span><span class="op">=</span><span class="st">&quot;{ &#39;text-muted&#39;: !displayProposalsRegistration() }&quot;</span></span>
<span id="cb877-8"><a href="Truffle-Web3.html#cb877-8" tabindex="-1"></a><span class="ot">      </span><span class="dt">&gt;</span></span>
<span id="cb877-9"><a href="Truffle-Web3.html#cb877-9" tabindex="-1"></a>        Proposal registration<span class="dt">&lt;</span><span class="kw">sup</span></span>
<span id="cb877-10"><a href="Truffle-Web3.html#cb877-10" tabindex="-1"></a><span class="ot">          </span><span class="dt">&gt;&lt;</span><span class="kw">small</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;text-muted&quot;</span></span>
<span id="cb877-11"><a href="Truffle-Web3.html#cb877-11" tabindex="-1"></a><span class="ot">            </span><span class="dt">&gt;&lt;</span><span class="kw">i</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;fa-solid fa-user-gear ps-2 pe-1&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">i</span><span class="dt">&gt;&lt;/</span><span class="kw">small</span></span>
<span id="cb877-12"><a href="Truffle-Web3.html#cb877-12" tabindex="-1"></a>        <span class="dt">&gt;&lt;/</span><span class="kw">sup</span><span class="dt">&gt;</span></span>
<span id="cb877-13"><a href="Truffle-Web3.html#cb877-13" tabindex="-1"></a>      <span class="dt">&lt;/</span><span class="kw">h4</span><span class="dt">&gt;</span></span>
<span id="cb877-14"><a href="Truffle-Web3.html#cb877-14" tabindex="-1"></a>    <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb877-15"><a href="Truffle-Web3.html#cb877-15" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card-body&quot;</span><span class="dt">&gt;</span></span>
<span id="cb877-16"><a href="Truffle-Web3.html#cb877-16" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">button</span></span>
<span id="cb877-17"><a href="Truffle-Web3.html#cb877-17" tabindex="-1"></a><span class="ot">        class</span><span class="op">=</span><span class="st">&quot;btn btn-sm btn-primary me-2&quot;</span></span>
<span id="cb877-18"><a href="Truffle-Web3.html#cb877-18" tabindex="-1"></a><span class="ot">        (click)</span><span class="op">=</span><span class="st">&quot;proposalRegistrationProcess(&#39;start&#39;)&quot;</span></span>
<span id="cb877-19"><a href="Truffle-Web3.html#cb877-19" tabindex="-1"></a><span class="ot">        [disabled]</span><span class="op">=</span><span class="st">&quot;!displayProposalsRegistration(&#39;start&#39;)&quot;</span></span>
<span id="cb877-20"><a href="Truffle-Web3.html#cb877-20" tabindex="-1"></a><span class="ot">      </span><span class="dt">&gt;</span></span>
<span id="cb877-21"><a href="Truffle-Web3.html#cb877-21" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">i</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;fas fa-play me-2&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">i</span><span class="dt">&gt;</span>Start<span class="dt">&lt;/</span><span class="kw">button</span></span>
<span id="cb877-22"><a href="Truffle-Web3.html#cb877-22" tabindex="-1"></a>      <span class="dt">&gt;&lt;</span><span class="kw">button</span></span>
<span id="cb877-23"><a href="Truffle-Web3.html#cb877-23" tabindex="-1"></a><span class="ot">        class</span><span class="op">=</span><span class="st">&quot;btn btn-sm btn-primary&quot;</span></span>
<span id="cb877-24"><a href="Truffle-Web3.html#cb877-24" tabindex="-1"></a><span class="ot">        (click)</span><span class="op">=</span><span class="st">&quot;proposalRegistrationProcess(&#39;end&#39;)&quot;</span></span>
<span id="cb877-25"><a href="Truffle-Web3.html#cb877-25" tabindex="-1"></a><span class="ot">        [disabled]</span><span class="op">=</span><span class="st">&quot;!displayProposalsRegistration(&#39;end&#39;)&quot;</span></span>
<span id="cb877-26"><a href="Truffle-Web3.html#cb877-26" tabindex="-1"></a><span class="ot">      </span><span class="dt">&gt;</span></span>
<span id="cb877-27"><a href="Truffle-Web3.html#cb877-27" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">i</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;fas fa-stop me-2&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">i</span><span class="dt">&gt;</span>End</span>
<span id="cb877-28"><a href="Truffle-Web3.html#cb877-28" tabindex="-1"></a>      <span class="dt">&lt;/</span><span class="kw">button</span><span class="dt">&gt;</span></span>
<span id="cb877-29"><a href="Truffle-Web3.html#cb877-29" tabindex="-1"></a>    <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb877-30"><a href="Truffle-Web3.html#cb877-30" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card-footer small text-muted&quot;</span><span class="dt">&gt;</span></span>
<span id="cb877-31"><a href="Truffle-Web3.html#cb877-31" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">i</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;fa-solid fa-circle-info pe-1&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">i</span><span class="dt">&gt;</span>The administrator starts and</span>
<span id="cb877-32"><a href="Truffle-Web3.html#cb877-32" tabindex="-1"></a>      ends the proposal registration.</span>
<span id="cb877-33"><a href="Truffle-Web3.html#cb877-33" tabindex="-1"></a>    <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb877-34"><a href="Truffle-Web3.html#cb877-34" tabindex="-1"></a>  <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb877-35"><a href="Truffle-Web3.html#cb877-35" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb877-36"><a href="Truffle-Web3.html#cb877-36" tabindex="-1"></a><span class="co">&lt;!-- </span><span class="re">END</span><span class="co">: Proposal registration --&gt;</span></span></code></pre></div>
<p>Podobno pri <strong>spremembi statusa glasovanja</strong> tudi podpremo dve akciji, in sicer začetek (<code>start</code>) ter konec (<code>end</code>) procesa glasovanja, kar prav tako določa parameter <code>action</code> funkcije <code>votingProcess(...)</code>.</p>
<p>V obeh primerih preverimo ali je prijavljen uporabnik skrbnik in smo v ustrezni fazi (konec sprejemanja predlogov oz. glasovanje). Če pogoji niso izpolnjeni, klica funkcije na pametni pogodbi ne dovolimo.</p>
<p>Prav tako s funkcijo <code>displayProposalsRegistration()</code> poksrbimo za prikaz omenjene funkcionalnosti zgolj ob prej omenjenih izpolnjenih pogojih.</p>
<p><code>angular/src/app/shared/services/web3.service.ts</code></p>
<div class="sourceCode" id="cb878"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb878-1"><a href="Truffle-Web3.html#cb878-1" tabindex="-1"></a><span class="im">export</span> <span class="kw">class</span> Web3Service {</span>
<span id="cb878-2"><a href="Truffle-Web3.html#cb878-2" tabindex="-1"></a>  <span class="op">...</span></span>
<span id="cb878-3"><a href="Truffle-Web3.html#cb878-3" tabindex="-1"></a>  <span class="kw">public</span> <span class="kw">async</span> <span class="fu">votingProcess</span>(<span class="dt">action</span><span class="op">:</span> string)<span class="op">:</span> <span class="bu">Promise</span><span class="op">&lt;</span>string<span class="op">&gt;</span> {</span>
<span id="cb878-4"><a href="Truffle-Web3.html#cb878-4" tabindex="-1"></a>    <span class="kw">let</span> message <span class="op">=</span> <span class="st">&quot;&quot;</span><span class="op">;</span></span>
<span id="cb878-5"><a href="Truffle-Web3.html#cb878-5" tabindex="-1"></a>    <span class="cf">try</span> {</span>
<span id="cb878-6"><a href="Truffle-Web3.html#cb878-6" tabindex="-1"></a>      <span class="cf">if</span> (</span>
<span id="cb878-7"><a href="Truffle-Web3.html#cb878-7" tabindex="-1"></a>        <span class="op">!</span>(<span class="cf">await</span> (<span class="kw">this</span><span class="op">.</span><span class="at">contract</span><span class="op">.</span><span class="at">methods</span>[<span class="st">&quot;isAdministrator&quot;</span>] <span class="im">as</span> any)(</span>
<span id="cb878-8"><a href="Truffle-Web3.html#cb878-8" tabindex="-1"></a>          <span class="kw">this</span><span class="op">.</span><span class="at">userAddress</span></span>
<span id="cb878-9"><a href="Truffle-Web3.html#cb878-9" tabindex="-1"></a>        )<span class="op">.</span><span class="fu">call</span>())</span>
<span id="cb878-10"><a href="Truffle-Web3.html#cb878-10" tabindex="-1"></a>      )</span>
<span id="cb878-11"><a href="Truffle-Web3.html#cb878-11" tabindex="-1"></a>        <span class="cf">throw</span> <span class="kw">new</span> <span class="bu">Error</span>(<span class="st">&quot;You are not an administrator!&quot;</span>)<span class="op">;</span></span>
<span id="cb878-12"><a href="Truffle-Web3.html#cb878-12" tabindex="-1"></a>      <span class="cf">else</span> <span class="cf">if</span> (</span>
<span id="cb878-13"><a href="Truffle-Web3.html#cb878-13" tabindex="-1"></a>        action <span class="op">==</span> <span class="st">&quot;start&quot;</span> <span class="op">&amp;&amp;</span></span>
<span id="cb878-14"><a href="Truffle-Web3.html#cb878-14" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">workflowStatus</span> <span class="op">!=</span> WorkflowStatus<span class="op">.</span><span class="at">ProposalRegistrationEnded</span></span>
<span id="cb878-15"><a href="Truffle-Web3.html#cb878-15" tabindex="-1"></a>      )</span>
<span id="cb878-16"><a href="Truffle-Web3.html#cb878-16" tabindex="-1"></a>        <span class="cf">throw</span> <span class="kw">new</span> <span class="bu">Error</span>(<span class="st">&quot;Start of voting is not allowed at this time!&quot;</span>)<span class="op">;</span></span>
<span id="cb878-17"><a href="Truffle-Web3.html#cb878-17" tabindex="-1"></a>      <span class="cf">else</span> <span class="cf">if</span> (</span>
<span id="cb878-18"><a href="Truffle-Web3.html#cb878-18" tabindex="-1"></a>        action <span class="op">==</span> <span class="st">&quot;end&quot;</span> <span class="op">&amp;&amp;</span></span>
<span id="cb878-19"><a href="Truffle-Web3.html#cb878-19" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">workflowStatus</span> <span class="op">!=</span> WorkflowStatus<span class="op">.</span><span class="at">VotingSessionStarted</span></span>
<span id="cb878-20"><a href="Truffle-Web3.html#cb878-20" tabindex="-1"></a>      )</span>
<span id="cb878-21"><a href="Truffle-Web3.html#cb878-21" tabindex="-1"></a>        <span class="cf">throw</span> <span class="kw">new</span> <span class="bu">Error</span>(<span class="st">&quot;End of voting is not allowed at this time!&quot;</span>)<span class="op">;</span></span>
<span id="cb878-22"><a href="Truffle-Web3.html#cb878-22" tabindex="-1"></a>      <span class="cf">if</span> (action <span class="op">==</span> <span class="st">&quot;start&quot;</span>) {</span>
<span id="cb878-23"><a href="Truffle-Web3.html#cb878-23" tabindex="-1"></a>        <span class="cf">if</span> (</span>
<span id="cb878-24"><a href="Truffle-Web3.html#cb878-24" tabindex="-1"></a>          <span class="op">!</span>(</span>
<span id="cb878-25"><a href="Truffle-Web3.html#cb878-25" tabindex="-1"></a>            <span class="cf">await</span> (<span class="kw">this</span><span class="op">.</span><span class="at">contract</span><span class="op">.</span><span class="at">methods</span>[<span class="st">&quot;startVoteSession&quot;</span>] <span class="im">as</span> any)()<span class="op">.</span><span class="fu">send</span>({</span>
<span id="cb878-26"><a href="Truffle-Web3.html#cb878-26" tabindex="-1"></a>              <span class="dt">from</span><span class="op">:</span> <span class="kw">this</span><span class="op">.</span><span class="at">userAddress</span><span class="op">,</span></span>
<span id="cb878-27"><a href="Truffle-Web3.html#cb878-27" tabindex="-1"></a>            })</span>
<span id="cb878-28"><a href="Truffle-Web3.html#cb878-28" tabindex="-1"></a>          )<span class="op">.</span><span class="at">status</span></span>
<span id="cb878-29"><a href="Truffle-Web3.html#cb878-29" tabindex="-1"></a>        )</span>
<span id="cb878-30"><a href="Truffle-Web3.html#cb878-30" tabindex="-1"></a>          <span class="cf">throw</span> <span class="kw">new</span> <span class="bu">Error</span>(<span class="st">&quot;Error starting proposal registration!&quot;</span>)<span class="op">;</span></span>
<span id="cb878-31"><a href="Truffle-Web3.html#cb878-31" tabindex="-1"></a>      } <span class="cf">else</span> <span class="cf">if</span> (action <span class="op">==</span> <span class="st">&quot;end&quot;</span>) {</span>
<span id="cb878-32"><a href="Truffle-Web3.html#cb878-32" tabindex="-1"></a>        <span class="cf">if</span> (</span>
<span id="cb878-33"><a href="Truffle-Web3.html#cb878-33" tabindex="-1"></a>          <span class="op">!</span>(</span>
<span id="cb878-34"><a href="Truffle-Web3.html#cb878-34" tabindex="-1"></a>            <span class="cf">await</span> (<span class="kw">this</span><span class="op">.</span><span class="at">contract</span><span class="op">.</span><span class="at">methods</span>[<span class="st">&quot;endVoteSession&quot;</span>] <span class="im">as</span> any)()<span class="op">.</span><span class="fu">send</span>({</span>
<span id="cb878-35"><a href="Truffle-Web3.html#cb878-35" tabindex="-1"></a>              <span class="dt">from</span><span class="op">:</span> <span class="kw">this</span><span class="op">.</span><span class="at">userAddress</span><span class="op">,</span></span>
<span id="cb878-36"><a href="Truffle-Web3.html#cb878-36" tabindex="-1"></a>            })</span>
<span id="cb878-37"><a href="Truffle-Web3.html#cb878-37" tabindex="-1"></a>          )<span class="op">.</span><span class="at">status</span></span>
<span id="cb878-38"><a href="Truffle-Web3.html#cb878-38" tabindex="-1"></a>        )</span>
<span id="cb878-39"><a href="Truffle-Web3.html#cb878-39" tabindex="-1"></a>          <span class="cf">throw</span> <span class="kw">new</span> <span class="bu">Error</span>(<span class="st">&quot;Error ending proposal registration!&quot;</span>)<span class="op">;</span></span>
<span id="cb878-40"><a href="Truffle-Web3.html#cb878-40" tabindex="-1"></a>      }</span>
<span id="cb878-41"><a href="Truffle-Web3.html#cb878-41" tabindex="-1"></a>    } <span class="cf">catch</span> (<span class="dt">error</span><span class="op">:</span> any) {</span>
<span id="cb878-42"><a href="Truffle-Web3.html#cb878-42" tabindex="-1"></a>      message <span class="op">=</span> error<span class="op">.</span><span class="at">message</span><span class="op">;</span></span>
<span id="cb878-43"><a href="Truffle-Web3.html#cb878-43" tabindex="-1"></a>    }</span>
<span id="cb878-44"><a href="Truffle-Web3.html#cb878-44" tabindex="-1"></a>    <span class="cf">return</span> message<span class="op">;</span></span>
<span id="cb878-45"><a href="Truffle-Web3.html#cb878-45" tabindex="-1"></a>  }</span>
<span id="cb878-46"><a href="Truffle-Web3.html#cb878-46" tabindex="-1"></a>}</span></code></pre></div>
<p><code>angular/src/app/shared/components/vote/vote.component.ts</code></p>
<div class="sourceCode" id="cb879"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb879-1"><a href="Truffle-Web3.html#cb879-1" tabindex="-1"></a><span class="im">export</span> <span class="kw">class</span> Vote1Component <span class="kw">implements</span> OnInit {</span>
<span id="cb879-2"><a href="Truffle-Web3.html#cb879-2" tabindex="-1"></a>  <span class="op">...</span></span>
<span id="cb879-3"><a href="Truffle-Web3.html#cb879-3" tabindex="-1"></a>  <span class="fu">displayVoting</span>(action<span class="op">?:</span> string)<span class="op">:</span> boolean {</span>
<span id="cb879-4"><a href="Truffle-Web3.html#cb879-4" tabindex="-1"></a>    <span class="kw">let</span> display <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">web3Service</span><span class="op">.</span><span class="at">userType</span> <span class="op">==</span> <span class="dv">4</span><span class="op">;</span></span>
<span id="cb879-5"><a href="Truffle-Web3.html#cb879-5" tabindex="-1"></a>    <span class="cf">if</span> (<span class="op">!</span>action)</span>
<span id="cb879-6"><a href="Truffle-Web3.html#cb879-6" tabindex="-1"></a>      display <span class="op">=</span></span>
<span id="cb879-7"><a href="Truffle-Web3.html#cb879-7" tabindex="-1"></a>        display <span class="op">&amp;&amp;</span></span>
<span id="cb879-8"><a href="Truffle-Web3.html#cb879-8" tabindex="-1"></a>        (<span class="kw">this</span><span class="op">.</span><span class="at">web3Service</span><span class="op">.</span><span class="at">workflowStatus</span> <span class="op">==</span> <span class="dv">3</span> <span class="op">||</span></span>
<span id="cb879-9"><a href="Truffle-Web3.html#cb879-9" tabindex="-1"></a>          <span class="kw">this</span><span class="op">.</span><span class="at">web3Service</span><span class="op">.</span><span class="at">workflowStatus</span> <span class="op">==</span> <span class="dv">4</span>)<span class="op">;</span></span>
<span id="cb879-10"><a href="Truffle-Web3.html#cb879-10" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> (action <span class="op">==</span> <span class="st">&quot;start&quot;</span>)</span>
<span id="cb879-11"><a href="Truffle-Web3.html#cb879-11" tabindex="-1"></a>      display <span class="op">=</span> display <span class="op">&amp;&amp;</span> <span class="kw">this</span><span class="op">.</span><span class="at">web3Service</span><span class="op">.</span><span class="at">workflowStatus</span> <span class="op">==</span> <span class="dv">3</span><span class="op">;</span></span>
<span id="cb879-12"><a href="Truffle-Web3.html#cb879-12" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> (action <span class="op">==</span> <span class="st">&quot;end&quot;</span>)</span>
<span id="cb879-13"><a href="Truffle-Web3.html#cb879-13" tabindex="-1"></a>      display <span class="op">=</span> display <span class="op">&amp;&amp;</span> <span class="kw">this</span><span class="op">.</span><span class="at">web3Service</span><span class="op">.</span><span class="at">workflowStatus</span> <span class="op">==</span> <span class="dv">4</span><span class="op">;</span></span>
<span id="cb879-14"><a href="Truffle-Web3.html#cb879-14" tabindex="-1"></a>    <span class="cf">return</span> display<span class="op">;</span></span>
<span id="cb879-15"><a href="Truffle-Web3.html#cb879-15" tabindex="-1"></a>  }</span>
<span id="cb879-16"><a href="Truffle-Web3.html#cb879-16" tabindex="-1"></a>  <span class="fu">votingProcess</span>(<span class="dt">action</span><span class="op">:</span> string)<span class="op">:</span> <span class="kw">void</span> {</span>
<span id="cb879-17"><a href="Truffle-Web3.html#cb879-17" tabindex="-1"></a>    <span class="kw">this</span><span class="op">.</span><span class="at">web3Service</span><span class="op">.</span><span class="fu">votingProcess</span>(action)<span class="op">.</span><span class="fu">then</span>((<span class="dt">message</span><span class="op">:</span> string) <span class="kw">=&gt;</span> {</span>
<span id="cb879-18"><a href="Truffle-Web3.html#cb879-18" tabindex="-1"></a>      <span class="cf">if</span> (message<span class="op">.</span><span class="at">length</span> <span class="op">==</span> <span class="dv">0</span>) {</span>
<span id="cb879-19"><a href="Truffle-Web3.html#cb879-19" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">web3Service</span><span class="op">.</span><span class="fu">getWorkflowStatus</span>()<span class="op">;</span></span>
<span id="cb879-20"><a href="Truffle-Web3.html#cb879-20" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="fu">openModal</span>(<span class="st">&quot;Voting &quot;</span> <span class="op">+</span> action <span class="op">+</span> <span class="st">&quot;ed successfully!&quot;</span>)<span class="op">;</span></span>
<span id="cb879-21"><a href="Truffle-Web3.html#cb879-21" tabindex="-1"></a>      }</span>
<span id="cb879-22"><a href="Truffle-Web3.html#cb879-22" tabindex="-1"></a>      <span class="kw">this</span><span class="op">.</span><span class="at">message</span> <span class="op">=</span> message<span class="op">;</span></span>
<span id="cb879-23"><a href="Truffle-Web3.html#cb879-23" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb879-24"><a href="Truffle-Web3.html#cb879-24" tabindex="-1"></a>  }</span>
<span id="cb879-25"><a href="Truffle-Web3.html#cb879-25" tabindex="-1"></a>  <span class="kw">protected</span> <span class="fu">openModal</span>(<span class="dt">message</span><span class="op">:</span> string) {</span>
<span id="cb879-26"><a href="Truffle-Web3.html#cb879-26" tabindex="-1"></a>    <span class="op">...</span></span>
<span id="cb879-27"><a href="Truffle-Web3.html#cb879-27" tabindex="-1"></a>  }</span>
<span id="cb879-28"><a href="Truffle-Web3.html#cb879-28" tabindex="-1"></a>  <span class="op">...</span></span>
<span id="cb879-29"><a href="Truffle-Web3.html#cb879-29" tabindex="-1"></a>}</span></code></pre></div>
<p><code>angular/src/app/shared/components/vote/vote.component.html</code></p>
<div class="sourceCode" id="cb880"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb880-1"><a href="Truffle-Web3.html#cb880-1" tabindex="-1"></a><span class="co">&lt;!-- START: Voting --&gt;</span></span>
<span id="cb880-2"><a href="Truffle-Web3.html#cb880-2" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;col&quot;</span><span class="dt">&gt;</span></span>
<span id="cb880-3"><a href="Truffle-Web3.html#cb880-3" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card h-100&quot;</span><span class="dt">&gt;</span></span>
<span id="cb880-4"><a href="Truffle-Web3.html#cb880-4" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card-header bg-light&quot;</span><span class="dt">&gt;</span></span>
<span id="cb880-5"><a href="Truffle-Web3.html#cb880-5" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">h4</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;mb-0&quot;</span><span class="ot"> [ngClass]</span><span class="op">=</span><span class="st">&quot;{ &#39;text-muted&#39;: !displayVoting() }&quot;</span><span class="dt">&gt;</span></span>
<span id="cb880-6"><a href="Truffle-Web3.html#cb880-6" tabindex="-1"></a>        Voting<span class="dt">&lt;</span><span class="kw">sup</span></span>
<span id="cb880-7"><a href="Truffle-Web3.html#cb880-7" tabindex="-1"></a><span class="ot">          </span><span class="dt">&gt;&lt;</span><span class="kw">small</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;text-muted&quot;</span></span>
<span id="cb880-8"><a href="Truffle-Web3.html#cb880-8" tabindex="-1"></a><span class="ot">            </span><span class="dt">&gt;&lt;</span><span class="kw">i</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;fa-solid fa-user-gear ps-2 pe-1&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">i</span><span class="dt">&gt;&lt;/</span><span class="kw">small</span></span>
<span id="cb880-9"><a href="Truffle-Web3.html#cb880-9" tabindex="-1"></a>        <span class="dt">&gt;&lt;/</span><span class="kw">sup</span><span class="dt">&gt;</span></span>
<span id="cb880-10"><a href="Truffle-Web3.html#cb880-10" tabindex="-1"></a>      <span class="dt">&lt;/</span><span class="kw">h4</span><span class="dt">&gt;</span></span>
<span id="cb880-11"><a href="Truffle-Web3.html#cb880-11" tabindex="-1"></a>    <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb880-12"><a href="Truffle-Web3.html#cb880-12" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card-body&quot;</span><span class="dt">&gt;</span></span>
<span id="cb880-13"><a href="Truffle-Web3.html#cb880-13" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">button</span></span>
<span id="cb880-14"><a href="Truffle-Web3.html#cb880-14" tabindex="-1"></a><span class="ot">        class</span><span class="op">=</span><span class="st">&quot;btn btn-sm btn-primary me-2&quot;</span></span>
<span id="cb880-15"><a href="Truffle-Web3.html#cb880-15" tabindex="-1"></a><span class="ot">        (click)</span><span class="op">=</span><span class="st">&quot;votingProcess(&#39;start&#39;)&quot;</span></span>
<span id="cb880-16"><a href="Truffle-Web3.html#cb880-16" tabindex="-1"></a><span class="ot">        [disabled]</span><span class="op">=</span><span class="st">&quot;!displayVoting(&#39;start&#39;)&quot;</span></span>
<span id="cb880-17"><a href="Truffle-Web3.html#cb880-17" tabindex="-1"></a><span class="ot">      </span><span class="dt">&gt;</span></span>
<span id="cb880-18"><a href="Truffle-Web3.html#cb880-18" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">i</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;fas fa-play me-2&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">i</span><span class="dt">&gt;</span>Start<span class="dt">&lt;/</span><span class="kw">button</span></span>
<span id="cb880-19"><a href="Truffle-Web3.html#cb880-19" tabindex="-1"></a>      <span class="dt">&gt;&lt;</span><span class="kw">button</span></span>
<span id="cb880-20"><a href="Truffle-Web3.html#cb880-20" tabindex="-1"></a><span class="ot">        class</span><span class="op">=</span><span class="st">&quot;btn btn-sm btn-primary&quot;</span></span>
<span id="cb880-21"><a href="Truffle-Web3.html#cb880-21" tabindex="-1"></a><span class="ot">        (click)</span><span class="op">=</span><span class="st">&quot;votingProcess(&#39;end&#39;)&quot;</span></span>
<span id="cb880-22"><a href="Truffle-Web3.html#cb880-22" tabindex="-1"></a><span class="ot">        [disabled]</span><span class="op">=</span><span class="st">&quot;!displayVoting(&#39;end&#39;)&quot;</span></span>
<span id="cb880-23"><a href="Truffle-Web3.html#cb880-23" tabindex="-1"></a><span class="ot">      </span><span class="dt">&gt;</span></span>
<span id="cb880-24"><a href="Truffle-Web3.html#cb880-24" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">i</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;fas fa-stop me-2&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">i</span><span class="dt">&gt;</span>End</span>
<span id="cb880-25"><a href="Truffle-Web3.html#cb880-25" tabindex="-1"></a>      <span class="dt">&lt;/</span><span class="kw">button</span><span class="dt">&gt;</span></span>
<span id="cb880-26"><a href="Truffle-Web3.html#cb880-26" tabindex="-1"></a>    <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb880-27"><a href="Truffle-Web3.html#cb880-27" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card-footer small text-muted&quot;</span><span class="dt">&gt;</span></span>
<span id="cb880-28"><a href="Truffle-Web3.html#cb880-28" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">i</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;fa-solid fa-circle-info pe-1&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">i</span><span class="dt">&gt;</span>The administrator starts and</span>
<span id="cb880-29"><a href="Truffle-Web3.html#cb880-29" tabindex="-1"></a>      ends the voting.</span>
<span id="cb880-30"><a href="Truffle-Web3.html#cb880-30" tabindex="-1"></a>    <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb880-31"><a href="Truffle-Web3.html#cb880-31" tabindex="-1"></a>  <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb880-32"><a href="Truffle-Web3.html#cb880-32" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb880-33"><a href="Truffle-Web3.html#cb880-33" tabindex="-1"></a><span class="co">&lt;!-- </span><span class="re">END</span><span class="co">: Voting --&gt;</span></span></code></pre></div>
<p>Zadnja funkcionalnost, ki je še na voljo skrbniku glasovanja, je <strong>štetje glasov</strong>. Gre za funkcijo pametne pogodbe, ki zaključi življenjski cikel pametne pogodbe in poskrbi za objavo rezultatov glasovanja.</p>
<p>Podobno kot pri ostalih funkcijah, tudi tukaj preverimo ali je uporabnik skrbnik in smo v ustrezni fazi konca glasovanja. Če pogojem ni zadoščeno, klica funkcije pametne pogodbe ne dovolimo ter tud funkcionalnost skrijemo.</p>
<p><code>angular/src/app/shared/services/web3.service.ts</code></p>
<div class="sourceCode" id="cb881"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb881-1"><a href="Truffle-Web3.html#cb881-1" tabindex="-1"></a><span class="im">export</span> <span class="kw">class</span> Web3Service {</span>
<span id="cb881-2"><a href="Truffle-Web3.html#cb881-2" tabindex="-1"></a>  <span class="op">...</span></span>
<span id="cb881-3"><a href="Truffle-Web3.html#cb881-3" tabindex="-1"></a>  <span class="kw">public</span> <span class="kw">async</span> <span class="fu">tallyVotes</span>()<span class="op">:</span> <span class="bu">Promise</span><span class="op">&lt;</span>string<span class="op">&gt;</span> {</span>
<span id="cb881-4"><a href="Truffle-Web3.html#cb881-4" tabindex="-1"></a>    <span class="kw">let</span> message <span class="op">=</span> <span class="st">&quot;&quot;</span><span class="op">;</span></span>
<span id="cb881-5"><a href="Truffle-Web3.html#cb881-5" tabindex="-1"></a>    <span class="cf">try</span> {</span>
<span id="cb881-6"><a href="Truffle-Web3.html#cb881-6" tabindex="-1"></a>      <span class="cf">if</span> (</span>
<span id="cb881-7"><a href="Truffle-Web3.html#cb881-7" tabindex="-1"></a>        <span class="op">!</span>(<span class="cf">await</span> (<span class="kw">this</span><span class="op">.</span><span class="at">contract</span><span class="op">.</span><span class="at">methods</span>[<span class="st">&quot;isAdministrator&quot;</span>] <span class="im">as</span> any)(</span>
<span id="cb881-8"><a href="Truffle-Web3.html#cb881-8" tabindex="-1"></a>          <span class="kw">this</span><span class="op">.</span><span class="at">userAddress</span></span>
<span id="cb881-9"><a href="Truffle-Web3.html#cb881-9" tabindex="-1"></a>        )<span class="op">.</span><span class="fu">call</span>())</span>
<span id="cb881-10"><a href="Truffle-Web3.html#cb881-10" tabindex="-1"></a>      )</span>
<span id="cb881-11"><a href="Truffle-Web3.html#cb881-11" tabindex="-1"></a>        <span class="cf">throw</span> <span class="kw">new</span> <span class="bu">Error</span>(<span class="st">&quot;You are not an administrator!&quot;</span>)<span class="op">;</span></span>
<span id="cb881-12"><a href="Truffle-Web3.html#cb881-12" tabindex="-1"></a>      <span class="cf">else</span> <span class="cf">if</span> (<span class="kw">this</span><span class="op">.</span><span class="at">workflowStatus</span> <span class="op">!=</span> WorkflowStatus<span class="op">.</span><span class="at">VotingSessionEnded</span>)</span>
<span id="cb881-13"><a href="Truffle-Web3.html#cb881-13" tabindex="-1"></a>        <span class="cf">throw</span> <span class="kw">new</span> <span class="bu">Error</span>(<span class="st">&quot;Tallying votes is not allowed at this time!&quot;</span>)<span class="op">;</span></span>
<span id="cb881-14"><a href="Truffle-Web3.html#cb881-14" tabindex="-1"></a>      <span class="cf">if</span> (</span>
<span id="cb881-15"><a href="Truffle-Web3.html#cb881-15" tabindex="-1"></a>        <span class="op">!</span>(</span>
<span id="cb881-16"><a href="Truffle-Web3.html#cb881-16" tabindex="-1"></a>          <span class="cf">await</span> (<span class="kw">this</span><span class="op">.</span><span class="at">contract</span><span class="op">.</span><span class="at">methods</span>[<span class="st">&quot;tallyVotes&quot;</span>] <span class="im">as</span> any)()<span class="op">.</span><span class="fu">send</span>({</span>
<span id="cb881-17"><a href="Truffle-Web3.html#cb881-17" tabindex="-1"></a>            <span class="dt">from</span><span class="op">:</span> <span class="kw">this</span><span class="op">.</span><span class="at">userAddress</span><span class="op">,</span></span>
<span id="cb881-18"><a href="Truffle-Web3.html#cb881-18" tabindex="-1"></a>          })</span>
<span id="cb881-19"><a href="Truffle-Web3.html#cb881-19" tabindex="-1"></a>        )<span class="op">.</span><span class="at">status</span></span>
<span id="cb881-20"><a href="Truffle-Web3.html#cb881-20" tabindex="-1"></a>      )</span>
<span id="cb881-21"><a href="Truffle-Web3.html#cb881-21" tabindex="-1"></a>        <span class="cf">throw</span> <span class="kw">new</span> <span class="bu">Error</span>(<span class="st">&quot;Error tallying votes!&quot;</span>)<span class="op">;</span></span>
<span id="cb881-22"><a href="Truffle-Web3.html#cb881-22" tabindex="-1"></a>    } <span class="cf">catch</span> (<span class="dt">error</span><span class="op">:</span> any) {</span>
<span id="cb881-23"><a href="Truffle-Web3.html#cb881-23" tabindex="-1"></a>      message <span class="op">=</span> error<span class="op">.</span><span class="at">message</span><span class="op">;</span></span>
<span id="cb881-24"><a href="Truffle-Web3.html#cb881-24" tabindex="-1"></a>    }</span>
<span id="cb881-25"><a href="Truffle-Web3.html#cb881-25" tabindex="-1"></a>    <span class="cf">return</span> message<span class="op">;</span></span>
<span id="cb881-26"><a href="Truffle-Web3.html#cb881-26" tabindex="-1"></a>  }</span>
<span id="cb881-27"><a href="Truffle-Web3.html#cb881-27" tabindex="-1"></a>}</span></code></pre></div>
<p><code>angular/src/app/shared/components/vote/vote.component.ts</code></p>
<div class="sourceCode" id="cb882"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb882-1"><a href="Truffle-Web3.html#cb882-1" tabindex="-1"></a><span class="im">export</span> <span class="kw">class</span> VoteComponent <span class="kw">implements</span> OnInit {</span>
<span id="cb882-2"><a href="Truffle-Web3.html#cb882-2" tabindex="-1"></a>  <span class="op">...</span></span>
<span id="cb882-3"><a href="Truffle-Web3.html#cb882-3" tabindex="-1"></a>  <span class="fu">displayTallyingVotes</span>()<span class="op">:</span> boolean {</span>
<span id="cb882-4"><a href="Truffle-Web3.html#cb882-4" tabindex="-1"></a>    <span class="cf">return</span> (</span>
<span id="cb882-5"><a href="Truffle-Web3.html#cb882-5" tabindex="-1"></a>      <span class="kw">this</span><span class="op">.</span><span class="at">web3Service</span><span class="op">.</span><span class="at">userType</span> <span class="op">==</span> <span class="dv">4</span> <span class="op">&amp;&amp;</span> <span class="kw">this</span><span class="op">.</span><span class="at">web3Service</span><span class="op">.</span><span class="at">workflowStatus</span> <span class="op">==</span> <span class="dv">5</span></span>
<span id="cb882-6"><a href="Truffle-Web3.html#cb882-6" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb882-7"><a href="Truffle-Web3.html#cb882-7" tabindex="-1"></a>  }</span>
<span id="cb882-8"><a href="Truffle-Web3.html#cb882-8" tabindex="-1"></a>  <span class="fu">tallyVotes</span>()<span class="op">:</span> <span class="kw">void</span> {</span>
<span id="cb882-9"><a href="Truffle-Web3.html#cb882-9" tabindex="-1"></a>    <span class="kw">this</span><span class="op">.</span><span class="at">web3Service</span><span class="op">.</span><span class="fu">tallyVotes</span>()<span class="op">.</span><span class="fu">then</span>((<span class="dt">message</span><span class="op">:</span> string) <span class="kw">=&gt;</span> {</span>
<span id="cb882-10"><a href="Truffle-Web3.html#cb882-10" tabindex="-1"></a>      <span class="cf">if</span> (message<span class="op">.</span><span class="at">length</span> <span class="op">==</span> <span class="dv">0</span>) {</span>
<span id="cb882-11"><a href="Truffle-Web3.html#cb882-11" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">web3Service</span><span class="op">.</span><span class="fu">getWorkflowStatus</span>()<span class="op">;</span></span>
<span id="cb882-12"><a href="Truffle-Web3.html#cb882-12" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">web3Service</span><span class="op">.</span><span class="fu">getVotingResults</span>()<span class="op">;</span></span>
<span id="cb882-13"><a href="Truffle-Web3.html#cb882-13" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="fu">openModal</span>(</span>
<span id="cb882-14"><a href="Truffle-Web3.html#cb882-14" tabindex="-1"></a>          <span class="st">&quot;Votes tallied successfully and voting results are available!&quot;</span></span>
<span id="cb882-15"><a href="Truffle-Web3.html#cb882-15" tabindex="-1"></a>        )<span class="op">;</span></span>
<span id="cb882-16"><a href="Truffle-Web3.html#cb882-16" tabindex="-1"></a>      }</span>
<span id="cb882-17"><a href="Truffle-Web3.html#cb882-17" tabindex="-1"></a>      <span class="kw">this</span><span class="op">.</span><span class="at">message</span> <span class="op">=</span> message<span class="op">;</span></span>
<span id="cb882-18"><a href="Truffle-Web3.html#cb882-18" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb882-19"><a href="Truffle-Web3.html#cb882-19" tabindex="-1"></a>  }</span>
<span id="cb882-20"><a href="Truffle-Web3.html#cb882-20" tabindex="-1"></a>  <span class="kw">protected</span> <span class="fu">openModal</span>(<span class="dt">message</span><span class="op">:</span> string) {</span>
<span id="cb882-21"><a href="Truffle-Web3.html#cb882-21" tabindex="-1"></a>    <span class="op">...</span></span>
<span id="cb882-22"><a href="Truffle-Web3.html#cb882-22" tabindex="-1"></a>  }</span>
<span id="cb882-23"><a href="Truffle-Web3.html#cb882-23" tabindex="-1"></a>  <span class="op">...</span></span>
<span id="cb882-24"><a href="Truffle-Web3.html#cb882-24" tabindex="-1"></a>}</span></code></pre></div>
<p><code>angular/src/app/shared/components/vote/vote.component.html</code></p>
<div class="sourceCode" id="cb883"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb883-1"><a href="Truffle-Web3.html#cb883-1" tabindex="-1"></a><span class="co">&lt;!-- START: Tally votes --&gt;</span></span>
<span id="cb883-2"><a href="Truffle-Web3.html#cb883-2" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;col&quot;</span><span class="dt">&gt;</span></span>
<span id="cb883-3"><a href="Truffle-Web3.html#cb883-3" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card h-100&quot;</span><span class="dt">&gt;</span></span>
<span id="cb883-4"><a href="Truffle-Web3.html#cb883-4" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card-header bg-light&quot;</span><span class="dt">&gt;</span></span>
<span id="cb883-5"><a href="Truffle-Web3.html#cb883-5" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">h4</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;mb-0&quot;</span><span class="ot"> [ngClass]</span><span class="op">=</span><span class="st">&quot;{ &#39;text-muted&#39;: !displayTallyingVotes() }&quot;</span><span class="dt">&gt;</span></span>
<span id="cb883-6"><a href="Truffle-Web3.html#cb883-6" tabindex="-1"></a>        Tally votes<span class="dt">&lt;</span><span class="kw">sup</span></span>
<span id="cb883-7"><a href="Truffle-Web3.html#cb883-7" tabindex="-1"></a><span class="ot">          </span><span class="dt">&gt;&lt;</span><span class="kw">small</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;text-muted&quot;</span></span>
<span id="cb883-8"><a href="Truffle-Web3.html#cb883-8" tabindex="-1"></a><span class="ot">            </span><span class="dt">&gt;&lt;</span><span class="kw">i</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;fa-solid fa-user-gear ps-2 pe-1&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">i</span><span class="dt">&gt;&lt;/</span><span class="kw">small</span></span>
<span id="cb883-9"><a href="Truffle-Web3.html#cb883-9" tabindex="-1"></a>        <span class="dt">&gt;&lt;/</span><span class="kw">sup</span><span class="dt">&gt;</span></span>
<span id="cb883-10"><a href="Truffle-Web3.html#cb883-10" tabindex="-1"></a>      <span class="dt">&lt;/</span><span class="kw">h4</span><span class="dt">&gt;</span></span>
<span id="cb883-11"><a href="Truffle-Web3.html#cb883-11" tabindex="-1"></a>    <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb883-12"><a href="Truffle-Web3.html#cb883-12" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card-body&quot;</span><span class="dt">&gt;</span></span>
<span id="cb883-13"><a href="Truffle-Web3.html#cb883-13" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">button</span></span>
<span id="cb883-14"><a href="Truffle-Web3.html#cb883-14" tabindex="-1"></a><span class="ot">        class</span><span class="op">=</span><span class="st">&quot;btn btn-sm btn-primary me-2&quot;</span></span>
<span id="cb883-15"><a href="Truffle-Web3.html#cb883-15" tabindex="-1"></a><span class="ot">        (click)</span><span class="op">=</span><span class="st">&quot;tallyVotes()&quot;</span></span>
<span id="cb883-16"><a href="Truffle-Web3.html#cb883-16" tabindex="-1"></a><span class="ot">        [disabled]</span><span class="op">=</span><span class="st">&quot;!displayTallyingVotes()&quot;</span></span>
<span id="cb883-17"><a href="Truffle-Web3.html#cb883-17" tabindex="-1"></a><span class="ot">      </span><span class="dt">&gt;</span></span>
<span id="cb883-18"><a href="Truffle-Web3.html#cb883-18" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">i</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;fas fa-play me-2&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">i</span><span class="dt">&gt;</span>Tally votes</span>
<span id="cb883-19"><a href="Truffle-Web3.html#cb883-19" tabindex="-1"></a>      <span class="dt">&lt;/</span><span class="kw">button</span><span class="dt">&gt;</span></span>
<span id="cb883-20"><a href="Truffle-Web3.html#cb883-20" tabindex="-1"></a>    <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb883-21"><a href="Truffle-Web3.html#cb883-21" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;card-footer small text-muted&quot;</span><span class="dt">&gt;</span></span>
<span id="cb883-22"><a href="Truffle-Web3.html#cb883-22" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">i</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;fa-solid fa-circle-info pe-1&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">i</span><span class="dt">&gt;</span>After the voting is</span>
<span id="cb883-23"><a href="Truffle-Web3.html#cb883-23" tabindex="-1"></a>      completed, the administrator counts the votes.</span>
<span id="cb883-24"><a href="Truffle-Web3.html#cb883-24" tabindex="-1"></a>    <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb883-25"><a href="Truffle-Web3.html#cb883-25" tabindex="-1"></a>  <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb883-26"><a href="Truffle-Web3.html#cb883-26" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb883-27"><a href="Truffle-Web3.html#cb883-27" tabindex="-1"></a><span class="co">&lt;!-- </span><span class="re">END</span><span class="co">: Tally votes --&gt;</span></span></code></pre></div>
<script>
  $(document).ready(function() {
    $("#podpora-funkcionalnostim-skrbnika code.javascript:eq(0)").markRegExp(/.+?web3-validator.+/, options_dodaj);
    $("#podpora-funkcionalnostim-skrbnika code.javascript:eq(0)").markRegExp(/\s+?public async registerVoter[\s\S]+?return[\s\S]+?}[\s\S]+?}/, options_dodaj);
    $("#podpora-funkcionalnostim-skrbnika code.javascript:eq(1)").markRegExp(/\s+?protected inputVoterAddress.+/, options_dodaj);
    $("#podpora-funkcionalnostim-skrbnika code.javascript:eq(1)").markRegExp(/\s+?displayRegisteringVoters[\s\S]+?}\);[\s\S]+?}/, options_dodaj);
    $("#podpora-funkcionalnostim-skrbnika code.html:eq(0)").markRegExp(/\s+?(\[ngClass\]|\[disabled\]|\[\(ngModel\)\]|\(click\))=".+?"/, options_dodaj);
    $("#podpora-funkcionalnostim-skrbnika code.javascript:eq(2)").markRegExp(/\s+?public async proposalRegistrationProcess[\s\S]+?return[\s\S]+?}[\s\S]+?}/, options_dodaj);
    $("#podpora-funkcionalnostim-skrbnika code.javascript:eq(3)").markRegExp(/\s+?displayProposalsRegistration[\s\S]+?}\);[\s\S]+?}/, options_dodaj);
    $("#podpora-funkcionalnostim-skrbnika code.html:eq(1)").markRegExp(/\s+?(\[ngClass\]|\[disabled\]|\(click\))=".+?"/, options_dodaj);
    $("#podpora-funkcionalnostim-skrbnika code.javascript:eq(4)").markRegExp(/\s+?public async votingProcess[\s\S]+?return[\s\S]+?}[\s\S]+?}/, options_dodaj);
    $("#podpora-funkcionalnostim-skrbnika code.javascript:eq(5)").markRegExp(/\s+?displayVoting[\s\S]+?}\);[\s\S]+?}/, options_dodaj);
    $("#podpora-funkcionalnostim-skrbnika code.html:eq(2)").markRegExp(/\s+?(\[ngClass\]|\[disabled\]|\(click\))=".+?"/, options_dodaj);
    $("#podpora-funkcionalnostim-skrbnika code.javascript:eq(6)").markRegExp(/\s+?public async tallyVotes[\s\S]+?return[\s\S]+?}[\s\S]+?}/, options_dodaj);
    $("#podpora-funkcionalnostim-skrbnika code.javascript:eq(7)").markRegExp(/\s+?displayTallyingVotes[\s\S]+?}\);[\s\S]+?}/, options_dodaj);
    $("#podpora-funkcionalnostim-skrbnika code.html:eq(3)").markRegExp(/\s+?(\[ngClass\]|\[disabled\]|\(click\))=".+?"/, options_dodaj);
  });
</script>
</div>
<div id="obvladovanje-dogodkov-v-okviru-dapp" class="section level3 hasAnchor" number="13.2.9">
<h3><span class="header-section-number">13.2.9</span> Obvladovanje dogodkov v okviru DApp<a href="Truffle-Web3.html#obvladovanje-dogodkov-v-okviru-dapp" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Zaradi vzdrževanja enostavni naše decentralizirane aplikacije pri razvoju nismo vključili obvladovanje dogodkov, ampak smo vse rezultate asinhronih operacij neposredno obravnavali v povratnih klicih. Za izboljšanje interaktivnosti delovanja DApps se pogosto uporablja obvladovanje dogodkov, kar nam neposredno omogoča tudi knjižnica <a href="https://docs.web3js.org/guides/events_subscriptions/"><i class="fa-solid fa-earth-europe"></i><strong>Web3.js</strong></a>.</p>
<p>Glede na to, da smo pri zasnovi pametne pogodbe že implementirali številne dogodke, se lahko sedaj v okviru Web3 aplikacije na njih preprosto naročimo, kot prikazuje naslednji enostavni primer. Zaključek glasovanja v našem scenariju predstavlja dogodek <code>VotesTalliedEvent</code>, ki se samodejno sproži ob zadnji akciji skrbnika z zahtevo po štetju glasov. Na dogodek se prijavimo že pri prijavi na verigo blokov v okviru funkcije <code>connectToBC()</code>.</p>
<p><code>angular/src/app/shared/services/web3.services.ts</code></p>
<div class="sourceCode" id="cb884"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb884-1"><a href="Truffle-Web3.html#cb884-1" tabindex="-1"></a><span class="im">export</span> <span class="kw">class</span> Web3Service {</span>
<span id="cb884-2"><a href="Truffle-Web3.html#cb884-2" tabindex="-1"></a>  <span class="op">...</span></span>
<span id="cb884-3"><a href="Truffle-Web3.html#cb884-3" tabindex="-1"></a>  <span class="kw">public</span> <span class="kw">async</span> <span class="fu">connectToBC</span>()<span class="op">:</span> <span class="bu">Promise</span><span class="op">&lt;</span>string<span class="op">&gt;</span> {</span>
<span id="cb884-4"><a href="Truffle-Web3.html#cb884-4" tabindex="-1"></a>    <span class="kw">let</span> message <span class="op">=</span> <span class="st">&quot;&quot;</span><span class="op">;</span></span>
<span id="cb884-5"><a href="Truffle-Web3.html#cb884-5" tabindex="-1"></a>    <span class="cf">try</span> {</span>
<span id="cb884-6"><a href="Truffle-Web3.html#cb884-6" tabindex="-1"></a>      <span class="op">...</span></span>
<span id="cb884-7"><a href="Truffle-Web3.html#cb884-7" tabindex="-1"></a>      <span class="co">// Subscribe to events</span></span>
<span id="cb884-8"><a href="Truffle-Web3.html#cb884-8" tabindex="-1"></a>      (<span class="kw">this</span><span class="op">.</span><span class="at">contract</span><span class="op">.</span><span class="at">events</span>[<span class="st">&quot;VotesTalliedEvent&quot;</span>] <span class="im">as</span> any)({ <span class="dt">fromBlock</span><span class="op">:</span> <span class="dv">0</span> })<span class="op">.</span><span class="fu">on</span>(</span>
<span id="cb884-9"><a href="Truffle-Web3.html#cb884-9" tabindex="-1"></a>        <span class="st">&quot;data&quot;</span><span class="op">,</span></span>
<span id="cb884-10"><a href="Truffle-Web3.html#cb884-10" tabindex="-1"></a>        () <span class="kw">=&gt;</span> <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="st">&quot;Voting completed!&quot;</span>)</span>
<span id="cb884-11"><a href="Truffle-Web3.html#cb884-11" tabindex="-1"></a>      )<span class="op">;</span></span>
<span id="cb884-12"><a href="Truffle-Web3.html#cb884-12" tabindex="-1"></a>    } <span class="cf">catch</span> (<span class="dt">error</span><span class="op">:</span> any) {</span>
<span id="cb884-13"><a href="Truffle-Web3.html#cb884-13" tabindex="-1"></a>      message <span class="op">=</span> error<span class="op">.</span><span class="at">message</span><span class="op">;</span></span>
<span id="cb884-14"><a href="Truffle-Web3.html#cb884-14" tabindex="-1"></a>    } <span class="cf">finally</span> {</span>
<span id="cb884-15"><a href="Truffle-Web3.html#cb884-15" tabindex="-1"></a>      <span class="cf">return</span> message<span class="op">;</span></span>
<span id="cb884-16"><a href="Truffle-Web3.html#cb884-16" tabindex="-1"></a>    }</span>
<span id="cb884-17"><a href="Truffle-Web3.html#cb884-17" tabindex="-1"></a>  }</span>
<span id="cb884-18"><a href="Truffle-Web3.html#cb884-18" tabindex="-1"></a>  <span class="op">...</span></span>
<span id="cb884-19"><a href="Truffle-Web3.html#cb884-19" tabindex="-1"></a>}</span></code></pre></div>
<script>
  $(document).ready(function() {
    $("#obvladovanje-dogodkov-v-okviru-dapp code.javascript:eq(0)").markRegExp(/\s+?\/\/ Subscribe to events[\s\S]+?\);/, options_dodaj);
  });
</script>
</div>
</div>
<div id="testiranje-decentralizirane-aplikacije-za-glasovanje" class="section level2 hasAnchor" number="13.3">
<h2><span class="header-section-number">13.3</span> Testiranje decentralizirane aplikacije za glasovanje<a href="Truffle-Web3.html#testiranje-decentralizirane-aplikacije-za-glasovanje" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="zagon-osebne-verige-blokov-ganache" class="section level3 hasAnchor" number="13.3.1">
<h3><span class="header-section-number">13.3.1</span> Zagon osebne verige blokov Ganache<a href="Truffle-Web3.html#zagon-osebne-verige-blokov-ganache" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Če imamo verigo blokov pognano, jo bomo ustavili ter jo preko prej pripravljene skripte <code>ganache</code> ponovno pognali.</p>
<div class="sourceCode" id="cb885"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb885-1"><a href="Truffle-Web3.html#cb885-1" tabindex="-1"></a><span class="ex">$</span> npm run ganache</span>
<span id="cb885-2"><a href="Truffle-Web3.html#cb885-2" tabindex="-1"></a></span>
<span id="cb885-3"><a href="Truffle-Web3.html#cb885-3" tabindex="-1"></a><span class="op">&gt;</span> demo@0.1.0 <span class="ex">ganache</span></span>
<span id="cb885-4"><a href="Truffle-Web3.html#cb885-4" tabindex="-1"></a><span class="op">&gt;</span> ganache <span class="ex">--wallet.totalAccounts</span> 5 <span class="at">--wallet.defaultBalance</span> 100 <span class="at">--wallet.mnemonic</span> <span class="st">&quot;nuclear seat much sketch element fame hard hedgehog local expect speed cinnamon&quot;</span> <span class="at">--wallet.passphrase</span> <span class="st">&quot;my little secret&quot;</span></span>
<span id="cb885-5"><a href="Truffle-Web3.html#cb885-5" tabindex="-1"></a></span>
<span id="cb885-6"><a href="Truffle-Web3.html#cb885-6" tabindex="-1"></a><span class="ex">ganache</span> v7.9.1 <span class="er">(</span><span class="ex">@ganache/cli:</span> 0.10.1, @ganache/core: 0.10.1<span class="kw">)</span></span>
<span id="cb885-7"><a href="Truffle-Web3.html#cb885-7" tabindex="-1"></a><span class="ex">Starting</span> RPC server</span>
<span id="cb885-8"><a href="Truffle-Web3.html#cb885-8" tabindex="-1"></a></span>
<span id="cb885-9"><a href="Truffle-Web3.html#cb885-9" tabindex="-1"></a><span class="ex">Available</span> Accounts</span>
<span id="cb885-10"><a href="Truffle-Web3.html#cb885-10" tabindex="-1"></a><span class="ex">==================</span></span>
<span id="cb885-11"><a href="Truffle-Web3.html#cb885-11" tabindex="-1"></a><span class="kw">(</span><span class="ex">0</span><span class="kw">)</span> <span class="ex">0x818476CEc6a8D017DB14AB0A25EBE4eBdB518eD8</span> <span class="er">(</span><span class="ex">100</span> ETH<span class="kw">)</span></span>
<span id="cb885-12"><a href="Truffle-Web3.html#cb885-12" tabindex="-1"></a><span class="kw">(</span><span class="ex">1</span><span class="kw">)</span> <span class="ex">0xf57FE3f91F261803a24e7092d2806f308DfE1cCe</span> <span class="er">(</span><span class="ex">100</span> ETH<span class="kw">)</span></span>
<span id="cb885-13"><a href="Truffle-Web3.html#cb885-13" tabindex="-1"></a><span class="kw">(</span><span class="ex">2</span><span class="kw">)</span> <span class="ex">0xa61B49C72D7775a6dbe20C3Cc4EE2c211d98D97D</span> <span class="er">(</span><span class="ex">100</span> ETH<span class="kw">)</span></span>
<span id="cb885-14"><a href="Truffle-Web3.html#cb885-14" tabindex="-1"></a><span class="kw">(</span><span class="ex">3</span><span class="kw">)</span> <span class="ex">0xcD1c3Ae672ed5F24f316967057062A957F64b25d</span> <span class="er">(</span><span class="ex">100</span> ETH<span class="kw">)</span></span>
<span id="cb885-15"><a href="Truffle-Web3.html#cb885-15" tabindex="-1"></a><span class="kw">(</span><span class="ex">4</span><span class="kw">)</span> <span class="ex">0x60626BAcF68e0c1Cc5fC09bEA63196D4C5B374e8</span> <span class="er">(</span><span class="ex">100</span> ETH<span class="kw">)</span></span>
<span id="cb885-16"><a href="Truffle-Web3.html#cb885-16" tabindex="-1"></a></span>
<span id="cb885-17"><a href="Truffle-Web3.html#cb885-17" tabindex="-1"></a><span class="ex">Private</span> Keys</span>
<span id="cb885-18"><a href="Truffle-Web3.html#cb885-18" tabindex="-1"></a><span class="ex">==================</span></span>
<span id="cb885-19"><a href="Truffle-Web3.html#cb885-19" tabindex="-1"></a><span class="kw">(</span><span class="ex">0</span><span class="kw">)</span> <span class="ex">0x9474979ddf5fad50ae845de9fffd43baff65aa67c4701d9245fc24f097eea42e</span></span>
<span id="cb885-20"><a href="Truffle-Web3.html#cb885-20" tabindex="-1"></a><span class="kw">(</span><span class="ex">1</span><span class="kw">)</span> <span class="ex">0x867d08d868d5d0e44564ff7bd1a5c4814f160261e3fd1aa5ca38b2e802ad2c33</span></span>
<span id="cb885-21"><a href="Truffle-Web3.html#cb885-21" tabindex="-1"></a><span class="kw">(</span><span class="ex">2</span><span class="kw">)</span> <span class="ex">0xa628cb6805ed47b701a5085cc0ebe59181ff1eda8bb740658b78cb18d2b3a578</span></span>
<span id="cb885-22"><a href="Truffle-Web3.html#cb885-22" tabindex="-1"></a><span class="kw">(</span><span class="ex">3</span><span class="kw">)</span> <span class="ex">0x50abf45326e49d2a0af6e64fc4b4b8f4ee458ff8cf29bef9d70e2d13c53a0beb</span></span>
<span id="cb885-23"><a href="Truffle-Web3.html#cb885-23" tabindex="-1"></a><span class="kw">(</span><span class="ex">4</span><span class="kw">)</span> <span class="ex">0x265d0f7bbe1974d506c0dac9e231d4fe77d8e9fa6298b5bf3baf67fd00a80e64</span></span>
<span id="cb885-24"><a href="Truffle-Web3.html#cb885-24" tabindex="-1"></a></span>
<span id="cb885-25"><a href="Truffle-Web3.html#cb885-25" tabindex="-1"></a><span class="ex">HD</span> Wallet</span>
<span id="cb885-26"><a href="Truffle-Web3.html#cb885-26" tabindex="-1"></a><span class="ex">==================</span></span>
<span id="cb885-27"><a href="Truffle-Web3.html#cb885-27" tabindex="-1"></a><span class="ex">Mnemonic:</span>      nuclear seat much sketch element fame hard hedgehog local expect speed cinnamon</span>
<span id="cb885-28"><a href="Truffle-Web3.html#cb885-28" tabindex="-1"></a><span class="ex">Base</span> HD Path:  m/44<span class="st">&#39;/60&#39;</span>/0<span class="st">&#39;/0/{account_index}</span></span>
<span id="cb885-29"><a href="Truffle-Web3.html#cb885-29" tabindex="-1"></a></span>
<span id="cb885-30"><a href="Truffle-Web3.html#cb885-30" tabindex="-1"></a><span class="st">Default Gas Price</span></span>
<span id="cb885-31"><a href="Truffle-Web3.html#cb885-31" tabindex="-1"></a><span class="st">==================</span></span>
<span id="cb885-32"><a href="Truffle-Web3.html#cb885-32" tabindex="-1"></a><span class="st">2000000000</span></span>
<span id="cb885-33"><a href="Truffle-Web3.html#cb885-33" tabindex="-1"></a></span>
<span id="cb885-34"><a href="Truffle-Web3.html#cb885-34" tabindex="-1"></a><span class="st">BlockGas Limit</span></span>
<span id="cb885-35"><a href="Truffle-Web3.html#cb885-35" tabindex="-1"></a><span class="st">==================</span></span>
<span id="cb885-36"><a href="Truffle-Web3.html#cb885-36" tabindex="-1"></a><span class="st">30000000</span></span>
<span id="cb885-37"><a href="Truffle-Web3.html#cb885-37" tabindex="-1"></a></span>
<span id="cb885-38"><a href="Truffle-Web3.html#cb885-38" tabindex="-1"></a><span class="st">Call Gas Limit</span></span>
<span id="cb885-39"><a href="Truffle-Web3.html#cb885-39" tabindex="-1"></a><span class="st">==================</span></span>
<span id="cb885-40"><a href="Truffle-Web3.html#cb885-40" tabindex="-1"></a><span class="st">50000000</span></span>
<span id="cb885-41"><a href="Truffle-Web3.html#cb885-41" tabindex="-1"></a></span>
<span id="cb885-42"><a href="Truffle-Web3.html#cb885-42" tabindex="-1"></a><span class="st">Chain</span></span>
<span id="cb885-43"><a href="Truffle-Web3.html#cb885-43" tabindex="-1"></a><span class="st">==================</span></span>
<span id="cb885-44"><a href="Truffle-Web3.html#cb885-44" tabindex="-1"></a><span class="st">Hardfork: shanghai</span></span>
<span id="cb885-45"><a href="Truffle-Web3.html#cb885-45" tabindex="-1"></a><span class="st">Id:       1337</span></span>
<span id="cb885-46"><a href="Truffle-Web3.html#cb885-46" tabindex="-1"></a></span>
<span id="cb885-47"><a href="Truffle-Web3.html#cb885-47" tabindex="-1"></a><span class="st">RPC Listening on 127.0.0.1:8545</span></span></code></pre></div>
<p>Opazimo lahko, da je bilo generiranih 5 računov, kot smo nastavili pri vzpostavitvi verige blokov, kjer ima vsak izmed računov začetno stanje v višini <span class="math inline">\(100\)</span> ETH.</p>
<script>
  $(document).ready(function() {
    $("#zagon-osebne-verige-blokov-ganache code.bash:eq(0)").markRegExp(/npm run ganache/, options_dodaj);
  });
</script>
</div>
<div id="dostop-do-racunov-metamask" class="section level3 hasAnchor" number="13.3.2">
<h3><span class="header-section-number">13.3.2</span> Dostop do računov preko MetaMask<a href="Truffle-Web3.html#dostop-do-racunov-metamask" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Ko se prijavimo v denarnico MetaMask, ki je na voljo v obliki vtičnika brskalnika, je na voljo zgolj privzeti račun ter dostop do glavnega in testnega omrežja.</p>
<p>Najprej bomo dodali naše testno omrežje Ganache tako, da v MetaMask kliknemo na naziv omrežja (trenutno je izbrano <strong>Glavno omrežje</strong>) in potrdimo akcijo s klikom na gumb <strong>Dodaj omrežje</strong>.</p>
<blockquote>
<p><strong>Opomba</strong>: Če v seznamu nimate prikazanih testnih omrežij, lahko to omogočite v nastavitvah (<code>Advanced</code> → <code>Show test networks</code>). Prav tako v primeru, ko imate na seznamu testnih omrežij že vključeno omrežje na naslovu <code>http://localhost:8545</code>, le-tega najprej izbrišite, predenj nadaljujete z dodajanjem novega v nadaljevanju (lahko pa ga seveda obdržite z imenom <code>Localhost</code>).</p>
</blockquote>
<p>V pogovornem oknu dodamo potrebne podatke za povezovanje na osebno verigo blokov Ganache, in sicer predvsem <strong>RPC naslov</strong> <code>http://localhost:8545</code> ter <strong>ID verige</strong> <code>1337</code>.</p>
<p>V nadaljevanju bomo <strong>vse račune</strong>, ki so na voljo v naši osebni <strong>verigi blokov Ganache</strong>, <strong>povezali z denarnico MetaMask</strong>. Najlažje to dosežemo z vnosom privatnega ključa posameznega računa pri uvozu računa v MetaMask. Seznam privatnih ključev imamo na voljo v konzoli, kjer smo pognali verigo blokov.</p>
<p>V vtičniku MetaMask kliknemo na ikono računa ter izberemo možnost <strong>Uvoz računa</strong>.</p>
<p>Račun je uspešno dodan in na voljo je stanje <span class="math inline">\(100\)</span> ETH, kar je skladno s privatno verigo blokov Ganache, na katero se povezujemo. Zaradi preglednosti bomo spremenili oznako računov, kot prikazuje tabela <a href="Truffle-Web3.html#tab:tabela-MetaMask-racuni">13.2</a>, kar lahko dosežemo z izbiro dodatnih možnosti (klik na ikono treh pik desno od računa).</p>
<p>Sedaj uvozimo še preostale 4 račune osebne verige blokov Ganache v denarnico MetaMask in jih ustrezno poimenujmo, kot je predvideno v tabeli <a href="Truffle-Web3.html#tab:tabela-MetaMask-racuni">13.2</a>.</p>
<table class="tabela-manjsa table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:tabela-MetaMask-racuni">Tabela 13.2: </span>Dostop do računov v Ganache iz denarnice MetaMask
</caption>
<thead>
<tr>
<th style="text-align:left;">
Javni naslov računa
</th>
<th style="text-align:left;">
 Naziv računa
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<code>0x818476CEc6a8D017DB14AB0A25EBE4eBdB518eD8</code>
</td>
<td style="text-align:left;">
 1. račun (skrbnik)
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>0xf57FE3f91F261803a24e7092d2806f308DfE1cCe</code>
</td>
<td style="text-align:left;">
 2. račun
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>0xa61B49C72D7775a6dbe20C3Cc4EE2c211d98D97D</code>
</td>
<td style="text-align:left;">
 3. račun
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>0xcD1c3Ae672ed5F24f316967057062A957F64b25d</code>
</td>
<td style="text-align:left;">
 4. račun
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>0x60626BAcF68e0c1Cc5fC09bEA63196D4C5B374e8</code>
</td>
<td style="text-align:left;">
 5. račun
</td>
</tr>
</tbody>
</table>
<p>Ko v MetaMask denarnico uspešno dodamo vseh <span class="math inline">\(5\)</span> računov, imamo v denarnici na voljo dostop, kjer lahko opazimo, da ima vsak začetno stanje <span class="math inline">\(100\)</span> ETH.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:slika-MetaMask-uvozeni-racuni"></span>
<img src="assets/img/MetaMask_uvozeni_racuni.png" alt="Vseh 5 uvoženih računov v MetaMask iz Ganache." width="250" />
<p class="caption">
Slika 13.5: Vseh 5 uvoženih računov v MetaMask iz Ganache.
</p>
</div>
<blockquote>
<p><strong>Opomba</strong>: Če smo že pred temu uporabljali račune na testnem omrežju Ganache, lahko zaradi boljšega delovanja izbrišemo celotno zgodovino za izbran račun na trenutnem omrežju, in sicer izberemo <i class="fa-solid fa-ellipsis-vertical" style="padding-left:5px"></i> → <code>Nastavitve</code> → <code>Napredno</code> → <code>Clear activity tab data</code> → <code>Clear</code>.</p>
</blockquote>
</div>
<div id="postavitev-pametne-pogodbe-na-verigo-blokov" class="section level3 hasAnchor" number="13.3.3">
<h3><span class="header-section-number">13.3.3</span> Postavitev pametne pogodbe na verigo blokov<a href="Truffle-Web3.html#postavitev-pametne-pogodbe-na-verigo-blokov" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>S pomočjo ogrodja Truffle bomo poskrbeli za ponovno postavitev pogodbe na privatno verigo Ganache, podobno kot smo to izvedli že v poglavju <a href="Truffle-Web3.html#prevajanje-in-postavitev-pametne-pogodbe">13.1.6</a>.</p>
<div class="sourceCode" id="cb886"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb886-1"><a href="Truffle-Web3.html#cb886-1" tabindex="-1"></a><span class="ex">$</span> cd dapp</span>
<span id="cb886-2"><a href="Truffle-Web3.html#cb886-2" tabindex="-1"></a><span class="ex">$</span> truffle migrate</span>
<span id="cb886-3"><a href="Truffle-Web3.html#cb886-3" tabindex="-1"></a></span>
<span id="cb886-4"><a href="Truffle-Web3.html#cb886-4" tabindex="-1"></a><span class="ex">Compiling</span> your contracts...</span>
<span id="cb886-5"><a href="Truffle-Web3.html#cb886-5" tabindex="-1"></a><span class="ex">===========================</span></span>
<span id="cb886-6"><a href="Truffle-Web3.html#cb886-6" tabindex="-1"></a><span class="op">&gt;</span> Everything <span class="ex">is</span> up to date, there is nothing to compile.</span>
<span id="cb886-7"><a href="Truffle-Web3.html#cb886-7" tabindex="-1"></a></span>
<span id="cb886-8"><a href="Truffle-Web3.html#cb886-8" tabindex="-1"></a><span class="ex">Starting</span> migrations...</span>
<span id="cb886-9"><a href="Truffle-Web3.html#cb886-9" tabindex="-1"></a><span class="ex">======================</span></span>
<span id="cb886-10"><a href="Truffle-Web3.html#cb886-10" tabindex="-1"></a><span class="op">&gt;</span> Network <span class="ex">name:</span>    <span class="st">&#39;development&#39;</span></span>
<span id="cb886-11"><a href="Truffle-Web3.html#cb886-11" tabindex="-1"></a><span class="op">&gt;</span> Network <span class="ex">id:</span>      1701875719249</span>
<span id="cb886-12"><a href="Truffle-Web3.html#cb886-12" tabindex="-1"></a><span class="op">&gt;</span> Block <span class="ex">gas</span> limit: 30000000 <span class="er">(</span><span class="ex">0x1c9c380</span><span class="kw">)</span></span>
<span id="cb886-13"><a href="Truffle-Web3.html#cb886-13" tabindex="-1"></a></span>
<span id="cb886-14"><a href="Truffle-Web3.html#cb886-14" tabindex="-1"></a><span class="ex">1_deploy_contracts.js</span></span>
<span id="cb886-15"><a href="Truffle-Web3.html#cb886-15" tabindex="-1"></a><span class="ex">=====================</span></span>
<span id="cb886-16"><a href="Truffle-Web3.html#cb886-16" tabindex="-1"></a>   <span class="ex">Deploying</span> <span class="st">&#39;SimpleVoting&#39;</span></span>
<span id="cb886-17"><a href="Truffle-Web3.html#cb886-17" tabindex="-1"></a>   <span class="ex">------------------------</span></span>
<span id="cb886-18"><a href="Truffle-Web3.html#cb886-18" tabindex="-1"></a>   <span class="op">&gt;</span> transaction <span class="ex">hash:</span>    0x4d62d3d0ec9b099a9f5947daaa24f67e60ba41fd02ec517e4b932a652b780128</span>
<span id="cb886-19"><a href="Truffle-Web3.html#cb886-19" tabindex="-1"></a>   <span class="op">&gt;</span> Blocks: <span class="ex">0</span>            Seconds: 0</span>
<span id="cb886-20"><a href="Truffle-Web3.html#cb886-20" tabindex="-1"></a>   <span class="op">&gt;</span> contract <span class="ex">address:</span>    0xD76d2DF6994C2e515F8e2279CBd4309C144EC395</span>
<span id="cb886-21"><a href="Truffle-Web3.html#cb886-21" tabindex="-1"></a>   <span class="op">&gt;</span> block <span class="ex">number:</span>        1</span>
<span id="cb886-22"><a href="Truffle-Web3.html#cb886-22" tabindex="-1"></a>   <span class="op">&gt;</span> block <span class="ex">timestamp:</span>     1701876366</span>
<span id="cb886-23"><a href="Truffle-Web3.html#cb886-23" tabindex="-1"></a>   <span class="op">&gt;</span> account:             <span class="ex">0x818476CEc6a8D017DB14AB0A25EBE4eBdB518eD8</span></span>
<span id="cb886-24"><a href="Truffle-Web3.html#cb886-24" tabindex="-1"></a>   <span class="op">&gt;</span> balance:             <span class="ex">99.99262097425</span></span>
<span id="cb886-25"><a href="Truffle-Web3.html#cb886-25" tabindex="-1"></a>   <span class="op">&gt;</span> gas <span class="ex">used:</span>            2186378 <span class="er">(</span><span class="ex">0x215c8a</span><span class="kw">)</span></span>
<span id="cb886-26"><a href="Truffle-Web3.html#cb886-26" tabindex="-1"></a>   <span class="op">&gt;</span> gas <span class="ex">price:</span>           3.375 gwei</span>
<span id="cb886-27"><a href="Truffle-Web3.html#cb886-27" tabindex="-1"></a>   <span class="op">&gt;</span> value <span class="ex">sent:</span>          0 ETH</span>
<span id="cb886-28"><a href="Truffle-Web3.html#cb886-28" tabindex="-1"></a>   <span class="op">&gt;</span> total <span class="ex">cost:</span>          0.00737902575 ETH</span>
<span id="cb886-29"><a href="Truffle-Web3.html#cb886-29" tabindex="-1"></a>   <span class="op">&gt;</span> Saving <span class="ex">artifacts</span></span>
<span id="cb886-30"><a href="Truffle-Web3.html#cb886-30" tabindex="-1"></a>   <span class="ex">-------------------------------------</span></span>
<span id="cb886-31"><a href="Truffle-Web3.html#cb886-31" tabindex="-1"></a>   <span class="op">&gt;</span> Total <span class="ex">cost:</span>       0.00737902575 ETH</span>
<span id="cb886-32"><a href="Truffle-Web3.html#cb886-32" tabindex="-1"></a></span>
<span id="cb886-33"><a href="Truffle-Web3.html#cb886-33" tabindex="-1"></a><span class="ex">Summary</span></span>
<span id="cb886-34"><a href="Truffle-Web3.html#cb886-34" tabindex="-1"></a><span class="ex">=======</span></span>
<span id="cb886-35"><a href="Truffle-Web3.html#cb886-35" tabindex="-1"></a><span class="op">&gt;</span> Total <span class="ex">deployments:</span>   1</span>
<span id="cb886-36"><a href="Truffle-Web3.html#cb886-36" tabindex="-1"></a><span class="op">&gt;</span> Final <span class="ex">cost:</span>          0.00737902575 ETH</span></code></pre></div>
<p>V Angular aplikaciji aplikaciji moramo tudi posodobiti okoljsko spremenljivko <code>contractAddress</code>, ki jo posodobimo na trenutni naslov postavljene pogodbe na verigi blokov.</p>
<p><code>angular/src/environments/environment.ts</code></p>
<div class="sourceCode" id="cb887"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb887-1"><a href="Truffle-Web3.html#cb887-1" tabindex="-1"></a><span class="im">export</span> <span class="kw">const</span> environment <span class="op">=</span> {</span>
<span id="cb887-2"><a href="Truffle-Web3.html#cb887-2" tabindex="-1"></a>  <span class="dt">apiUrl</span><span class="op">:</span> <span class="st">&quot;http://localhost:3000/api&quot;</span><span class="op">,</span></span>
<span id="cb887-3"><a href="Truffle-Web3.html#cb887-3" tabindex="-1"></a>  <span class="dt">production</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb887-4"><a href="Truffle-Web3.html#cb887-4" tabindex="-1"></a>  <span class="dt">allowedChainId</span><span class="op">:</span> <span class="dv">1337</span><span class="op">,</span></span>
<span id="cb887-5"><a href="Truffle-Web3.html#cb887-5" tabindex="-1"></a>  <span class="dt">contractUrl</span><span class="op">:</span> <span class="st">&quot;http://localhost:3000/ABI/SimpleVoting.json&quot;</span><span class="op">,</span></span>
<span id="cb887-6"><a href="Truffle-Web3.html#cb887-6" tabindex="-1"></a>  <span class="dt">contractAddress</span><span class="op">:</span> <span class="st">&quot;0xD76d2DF6994C2e515F8e2279CBd4309C144EC3950xc5BAF6E151433B6027C0D3a8d684b495E748503B&quot;</span><span class="op">,</span></span>
<span id="cb887-7"><a href="Truffle-Web3.html#cb887-7" tabindex="-1"></a>}<span class="op">;</span></span></code></pre></div>
<p>V okviru ogrodja Truffle se privzeto za postavitev pametne pogodbe na verigo blokov uporabi 1. račun, ki ga imamo v našem primeru v MetaMask prijavljenega kot <strong>1. račun (skrbnik)</strong>.</p>
<p>Pri postavitvi pogodbe je prišlo do stroškov, kar je razvidno tudi v MetaMask denarnici računa Skrbnik, kot prikazuje slika <a href="Truffle-Web3.html#fig:slika-MetaMask-Skrbnik-po-postavitvi-pogodbe">13.6</a>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:slika-MetaMask-Skrbnik-po-postavitvi-pogodbe"></span>
<img src="assets/img/MetaMask_Skrbnik_po_postavitvi_pogodbe.png" alt="Stanje na računu Skrbnik po postavitvi pogodbe." width="250" />
<p class="caption">
Slika 13.6: Stanje na računu Skrbnik po postavitvi pogodbe.
</p>
</div>
<script>
  $(document).ready(function() {
    $("#postavitev-pametne-pogodbe-na-verigo-blokov code.bash:eq(0)").markRegExp(/(cd |truffle).+/, options_dodaj);
    $("#postavitev-pametne-pogodbe-na-verigo-blokov code.bash:eq(0)").markRegExp(/0x\w+?395/, options_dodaj);
    $("#postavitev-pametne-pogodbe-na-verigo-blokov code.javascript:eq(0)").markRegExp(/0xD76d2DF6994C2e515F8e2279CBd4309C144EC395/, options_dodaj);
    $("#postavitev-pametne-pogodbe-na-verigo-blokov code.javascript:eq(0)").markRegExp(/0xc5BAF6E151433B6027C0D3a8d684b495E748503B/, options_izbrisi);
  });
</script>
</div>
<div id="povezovanje-metamask-z-dapp" class="section level3 hasAnchor" number="13.3.4">
<h3><span class="header-section-number">13.3.4</span> Povezovanje MetaMask z DApp<a href="Truffle-Web3.html#povezovanje-metamask-z-dapp" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>V denarnici MetaMask imamo na voljo vseh 5 računov, ki so na voljo v privatni verigi blokov Ganache (glej poglavje <a href="Truffle-Web3.html#dostop-do-racunov-metamask">13.3.2</a>), prav tako je pametna pogodba za podporo glasovanju postavljena na verigo blokov (glej poglavje <a href="Truffle-Web3.html#postavitev-pametne-pogodbe-na-verigo-blokov">13.3.3</a>).</p>
<p>Sedaj se želimo z izbranimi računi denarnice MetaMask povezati na našo decentralizirano aplikacijo.</p>
<p>Najprej v brskalniku obiščemo spletno stran aplikacije na naslovu <a href="http://localhost:4200/vote/"><i class="fa-solid fa-earth-europe"></i>http://localhost:4200/<strong>vote</strong></a>. Nato v denarnici MetaMask kliknemo na ikono s tremi pikami, desno od izbranega uporabnika, ter izberemo prikaz povezanih spletnih strani oz. <strong>Connected sites</strong>, kot prikazuje slika <a href="Truffle-Web3.html#fig:slika-MetaMask-connected-sites">13.7</a>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:slika-MetaMask-connected-sites"></span>
<img src="assets/img/MetaMask_connected_sites.png" alt="Prikaz računov, ki dostopajo do trenutne decentralizirane aplikacije." width="250" />
<p class="caption">
Slika 13.7: Prikaz računov, ki dostopajo do trenutne decentralizirane aplikacije.
</p>
</div>
<p>V naslednjem koraku izberemo ročno povezovanje na trenutno stran <strong>Manually connect to current site</strong>. Nato na seznamu izberemo vseh 5 računov (<strong>1. račun (skrbnik)</strong>, <strong>2. račun</strong>, <strong>3. račun</strong>, <strong>4. račun</strong> in <strong>5. račun</strong>) ter s klikom na <strong>Naprej</strong> nadaljujemo (glej sliko <a href="Truffle-Web3.html#fig:slika-MetaMask-connect-1">13.8</a>). V naslednjem koraku potrdimo povezovanje vseh 5 računov na aplikacijo in potrdimo s klikom na <strong>Poveži</strong> (glej sliko <a href="Truffle-Web3.html#fig:slika-MetaMask-connect-2">13.9</a>).</p>
<div style="display: flex; width:100%">
<div style="width:50%">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:slika-MetaMask-connect-1"></span>
<img src="assets/img/MetaMask_connect_1.png" alt="Izbira računov za povezovanje z DApp." width="250" />
<p class="caption">
Slika 13.8: Izbira računov za povezovanje z DApp.
</p>
</div>
</div>
<div style="width:50%">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:slika-MetaMask-connect-2"></span>
<img src="assets/img/MetaMask_connect_2.png" alt="Potrditev računov za povezovanje z DApp." width="250" />
<p class="caption">
Slika 13.9: Potrditev računov za povezovanje z DApp.
</p>
</div>
</div>
</div>
<p>Ko se denarnica MetaMask uspešno poveže z decentralizirano aplikacijo za glasovanje, se prikaže zelen indikator in opis <strong>Connected</strong>, kot to prikazuje slika <a href="Truffle-Web3.html#fig:slika-MetaMask-connected">13.10</a>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:slika-MetaMask-connected"></span>
<img src="assets/img/MetaMask_connected.png" alt="MetaMask denarnica je uspešno povezana z DApp." width="250" />
<p class="caption">
Slika 13.10: MetaMask denarnica je uspešno povezana z DApp.
</p>
</div>
</div>
<div id="faza-registracije-volivcev" class="section level3 hasAnchor" number="13.3.5">
<h3><span class="header-section-number">13.3.5</span> Faza registracije volivcev<a href="Truffle-Web3.html#faza-registracije-volivcev" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Ob zagonu aplikacije je začetni status faza registracije volivcev, kot prikazuje desna stran slike <a href="Truffle-Web3.html#fig:slika-Dapp-status-Registracija-volivcev">13.11</a>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:slika-Dapp-status-Registracija-volivcev"></span>
<img src="assets/img/DApp_status_Registracija_volivcev.png" alt="Začetna faza registracije volivcev." width="800" />
<p class="caption">
Slika 13.11: Začetna faza registracije volivcev.
</p>
</div>
<p>V začetni fazi registracije volivcev v denarnici MetaMask preverimo, da je trenutno aktiven uporabnik <strong>1. račun (skrbnik)</strong>, ki je uspešno povezan na DApp, kot to prikazuje slika <a href="Truffle-Web3.html#fig:slika-MetaMask-connected-Skrbnik">13.12</a>, prav tako pa DApps prikaže vlogo trenutno prijavljenega uporabnika, kot to prikazuje levi del slike <a href="Truffle-Web3.html#fig:slika-Dapp-status-Registracija-volivcev">13.11</a></p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:slika-MetaMask-connected-Skrbnik"></span>
<img src="assets/img/MetaMask_connected_Skrbnik.png" alt="Račun skrbnika v MetaMask je uspešno povezan na DApp." width="250" />
<p class="caption">
Slika 13.12: Račun skrbnika v MetaMask je uspešno povezan na DApp.
</p>
</div>
<p>Skrbnik volitev mora v tej začetni fazi dodati 3 volivce, in sicer račune uporabnikov <strong>2. račun</strong> (<code>0xf57FE3f91F261803a24e7092d2806f308DfE1cCe</code>), <strong>3. račun</strong> (<code>0xa61B49C72D7775a6dbe20C3Cc4EE2c211d98D97D</code>) in <strong>4. račun</strong> (<code>0xcD1c3Ae672ed5F24f316967057062A957F64b25d</code>). V okviru razdelka <strong>Registering voters</strong> zaporedoma vnesemo naslove omenjenih volivcev, kot so prikazani v tabeli <a href="Truffle-Web3.html#tab:tabela-MetaMask-racuni">13.2</a>.</p>
<p>V verigi blokov se ob prej omenjenih akcijah <strong>ustvarijo 3 transakcije</strong>, kjer je bilo pri potrjevanju vsake transakcije potrebno <span class="math inline">\(50.854\)</span> enot gas kot strošek transakcije, ki je bil zaračunan pošiljatelju sporočila, tj. skrbniku.</p>
<div class="sourceCode" id="cb888"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb888-1"><a href="Truffle-Web3.html#cb888-1" tabindex="-1"></a><span class="ex">eth_sendRawTransaction</span></span>
<span id="cb888-2"><a href="Truffle-Web3.html#cb888-2" tabindex="-1"></a>  <span class="ex">Transaction:</span> 0xf98f4e3779dcebf8d4c5970426016024e5ec3355f7e5502e5e17a8bbcd5e0818</span>
<span id="cb888-3"><a href="Truffle-Web3.html#cb888-3" tabindex="-1"></a>  <span class="ex">Gas</span> usage: 50854</span>
<span id="cb888-4"><a href="Truffle-Web3.html#cb888-4" tabindex="-1"></a>  <span class="ex">Block</span> number: 2</span>
<span id="cb888-5"><a href="Truffle-Web3.html#cb888-5" tabindex="-1"></a>  <span class="ex">Block</span> time: Wed Dec 06 2023 16:51:54 GMT+0100 <span class="er">(</span><span class="ex">GMT+01:00</span><span class="kw">)</span></span>
<span id="cb888-6"><a href="Truffle-Web3.html#cb888-6" tabindex="-1"></a><span class="ex">...</span></span>
<span id="cb888-7"><a href="Truffle-Web3.html#cb888-7" tabindex="-1"></a><span class="ex">eth_sendRawTransaction</span></span>
<span id="cb888-8"><a href="Truffle-Web3.html#cb888-8" tabindex="-1"></a>  <span class="ex">Transaction:</span> 0x1c33cf5e3b7618a9347cd8bb0f3b9595d96455ab5c80936ad04b5c6f2c3fe6eb</span>
<span id="cb888-9"><a href="Truffle-Web3.html#cb888-9" tabindex="-1"></a>  <span class="ex">Gas</span> usage: 50854</span>
<span id="cb888-10"><a href="Truffle-Web3.html#cb888-10" tabindex="-1"></a>  <span class="ex">Block</span> number: 3</span>
<span id="cb888-11"><a href="Truffle-Web3.html#cb888-11" tabindex="-1"></a>  <span class="ex">Block</span> time: Wed Dec 06 2023 16:52:13 GMT+0100 <span class="er">(</span><span class="ex">GMT+01:00</span><span class="kw">)</span></span>
<span id="cb888-12"><a href="Truffle-Web3.html#cb888-12" tabindex="-1"></a><span class="ex">...</span></span>
<span id="cb888-13"><a href="Truffle-Web3.html#cb888-13" tabindex="-1"></a><span class="ex">eth_sendRawTransaction</span></span>
<span id="cb888-14"><a href="Truffle-Web3.html#cb888-14" tabindex="-1"></a>  <span class="ex">Transaction:</span> 0x3e5a162c133da1a5eb57ddb1266f0d4ac3cf9f3eec75287fcf5f0d40e10ba31c</span>
<span id="cb888-15"><a href="Truffle-Web3.html#cb888-15" tabindex="-1"></a>  <span class="ex">Gas</span> usage: 50854</span>
<span id="cb888-16"><a href="Truffle-Web3.html#cb888-16" tabindex="-1"></a>  <span class="ex">Block</span> number: 4</span>
<span id="cb888-17"><a href="Truffle-Web3.html#cb888-17" tabindex="-1"></a>  <span class="ex">Block</span> time: Wed Dec 06 2023 16:52:26 GMT+0100 <span class="er">(</span><span class="ex">GMT+01:00</span><span class="kw">)</span></span></code></pre></div>
<p>V skladu z <a href="https://eips.ethereum.org/EIPS/eip-1559"><i class="fa-brands fa-ethereum"></i>EIP-1559</a> se pri izračunu stroškov transakcije upošteva več elementov, in sicer:</p>
<ul>
<li><strong><code>Base fee</code></strong> je pristojbina, ki jo določi omrežje, glede na zasedenost predhodnega bloka, in ta pristojbina se nato uniči (angl. burn),
<ul>
<li>zadnji blok <span class="math inline">\(= 50\ \%\)</span> zaseden → nepsremenjena pristojbina,</li>
<li>zadnji blok <span class="math inline">\(= 100\ \%\)</span> zaseden → povečanje pristojbine za <span class="math inline">\(12,5\ \%\)</span>,</li>
<li>zadnji blok <span class="math inline">\(\in (50\ \%, 100\ \%)\)</span> zaseden → povečanje pristojbine za največ <span class="math inline">\(12,5\ \%\)</span>,</li>
<li>zadnji blok <span class="math inline">\(= 0\ \%\)</span> zaseden → zmanjšanje pristojbine za <span class="math inline">\(12,5\ \%\)</span>,</li>
<li>zadnji blok <span class="math inline">\(\in (0\ \%, 50\ \%)\)</span> zaseden → zmanjšanje pristojbine za največ <span class="math inline">\(12,5\ \%\)</span>.</li>
</ul></li>
<li><strong><code>Priority fee</code></strong> je neobvezna pristojbina, ki jo določi uporabnik in se plača neposredno rudarju, tj. predlagatelju bloka.</li>
<li><strong><code>Max fee per gas</code></strong> je absolutno najvišji znesek, ki ga je uporabnik pripravljen plačati na enoto gas.</li>
</ul>
<p>Podrobnosti stroška transakcije si lahko ogledamo v vtičniku MetaMask, kar prikazuje slika <a href="Truffle-Web3.html#fig:slika-MetaMask-stroski-transakcije">13.13</a>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:slika-MetaMask-stroski-transakcije"></span>
<img src="assets/img/MetaMask_stroski_transakcije.png" alt="Podrobnosti stroška transkacije v MetaMask-u." width="250" />
<p class="caption">
Slika 13.13: Podrobnosti stroška transkacije v MetaMask-u.
</p>
</div>
<p>Podatke stroškov vseh treh transakcij, s katerimi je skrbnik dodal volivce, lahko združeno prikažemo v tabeli <a href="Truffle-Web3.html#tab:tabela-transakcije">13.3</a>.</p>
<table class="tabela-manjsa table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:tabela-transakcije">Tabela 13.3: </span>Stroški transakcij
</caption>
<thead>
<tr>
<th style="text-align:right;">
Zap. št.
</th>
<th style="text-align:left;">
Transakcija
</th>
<th style="text-align:right;">
Porabljen gas (enote)
</th>
<th style="text-align:right;">
Base fee (Gwei)
</th>
<th style="text-align:right;">
Priority fee (Gwei)
</th>
<th style="text-align:right;">
Total fee (ETH)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
<code>0xf9...818</code>
</td>
<td style="text-align:right;">
<span class="math inline">\(50.854\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0,781567340\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(2,5\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0,00016688\)</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
<code>0x1c...6eb</code>
</td>
<td style="text-align:right;">
<span class="math inline">\(50.854\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0,684202638\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(2,5\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0,00016193\)</span>
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
<code>0x3e...31c</code>
</td>
<td style="text-align:right;">
<span class="math inline">\(50.854\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0,598967262\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(2,5\)</span>
</td>
<td style="text-align:right;">
<span class="math inline">\(0,00015759\)</span>
</td>
</tr>
</tbody>
</table>
<p>Pri izračuni skupnega stroška transakcije lahko uporabimo naslednjo enačbo:</p>
<p><span class="math display">\[\begin{equation}
\begin{aligned}
\textbf{strošek 1. transakcije} &amp;\ = \text{porabljen gas} \times ( \text{base fee} + \text{priority fee} ) = \\
&amp;\ = 50.854 \times (0,781567340 + 2,5) = \\
&amp;\ = 166.881\ \text{Gwei} = 166.881 \times 10^{9}\ \text{Wei} = \boldsymbol{0,00016688}\ \textbf{ETH}
\end{aligned}
\end{equation}\]</span></p>
<p>V okviru naše privatne testne verige lahko opazimo, da je strošek vsake nadaljnje transakcije nižji, saj je v vsakem bloku zgolj ena transakcija. Posledično se zato pristojbina za vsak naslednji blok zniža za nekoliko manj kot <span class="math inline">\(12,5\ \%\)</span>.</p>
<script>
  $(document).ready(function() {
    $("#faza-registracije-volivcev code.bash:eq(0)").markRegExp(/0x.+/, options_dodaj);
    $("#faza-registracije-volivcev code.bash:eq(0)").markRegExp(/50854/, options_dodaj);
  });
</script>
</div>
<div id="faza-začetka-sprejemanja-predlogov" class="section level3 hasAnchor" number="13.3.6">
<h3><span class="header-section-number">13.3.6</span> Faza začetka sprejemanja predlogov<a href="Truffle-Web3.html#faza-začetka-sprejemanja-predlogov" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Skrbnik nato poskrbi za <strong>prehod v fazo sprejemanja predlogov</strong>, kar se odraža v statusu prikazanem na spletni strani (glej sliko <a href="Truffle-Web3.html#fig:slika-Dapp-status-Zacetek-postopka-sprejemanja-predlogov">13.14</a>).</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:slika-Dapp-status-Zacetek-postopka-sprejemanja-predlogov"></span>
<img src="assets/img/DApp_status_Zacetek_sprejemanja_predlogov.png" alt="Faza začetka sprejemanja predlogov." width="800" />
<p class="caption">
Slika 13.14: Faza začetka sprejemanja predlogov.
</p>
</div>
<p>Nato izmed vseh računov denarnice MetaMask, ki so prijavljeni v decentralizirano aplikacijo, <strong>izberemo 2. račun</strong>, ki bo privzeti račun in uporabljen pri interakciji z DApp (glej slike <a href="Truffle-Web3.html#fig:slika-MetaMask-switch-users-1">13.15</a>, <a href="Truffle-Web3.html#fig:slika-MetaMask-switch-users-2">13.16</a>, <a href="Truffle-Web3.html#fig:slika-MetaMask-switch-users-3">13.17</a>, <a href="Truffle-Web3.html#fig:slika-MetaMask-switch-users-4">13.18</a> in <a href="Truffle-Web3.html#fig:slika-Dapp-status-Zacetek-postopka-sprejemanja-predlogov-volivec">13.19</a>).</p>
<div style="display: flex; width:100%">
<div style="width:50%">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:slika-MetaMask-switch-users-1"></span>
<img src="assets/img/MetaMask_switch_users_1.png" alt="Skrbnik je privzeti račun MetaMask denarnice." width="250" />
<p class="caption">
Slika 13.15: Skrbnik je privzeti račun MetaMask denarnice.
</p>
</div>
</div>
<div style="width:50%">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:slika-MetaMask-switch-users-2"></span>
<img src="assets/img/MetaMask_switch_users_2.png" alt="Izbira 2. računa kot privzetega." width="250" />
<p class="caption">
Slika 13.16: Izbira 2. računa kot privzetega.
</p>
</div>
</div>
</div>
<div style="display: flex; width:100%">
<div style="width:50%">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:slika-MetaMask-switch-users-3"></span>
<img src="assets/img/MetaMask_switch_users_3.png" alt="2. račun je potrjen kot privzeti račun." width="250" />
<p class="caption">
Slika 13.17: 2. račun je potrjen kot privzeti račun.
</p>
</div>
</div>
<div style="width:50%">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:slika-MetaMask-switch-users-4"></span>
<img src="assets/img/MetaMask_switch_users_4.png" alt="2. račun je prikazan kot privzeti račun." width="250" />
<p class="caption">
Slika 13.18: 2. račun je prikazan kot privzeti račun.
</p>
</div>
</div>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:slika-Dapp-status-Zacetek-postopka-sprejemanja-predlogov-volivec"></span>
<img src="assets/img/DApp_status_Zacetek_sprejemanja_predlogov_volivec.png" alt="2. račun v vlogi registriranega volivca DApps v fazi začetka sprejemanja predlogov." width="800" />
<p class="caption">
Slika 13.19: 2. račun v vlogi registriranega volivca DApps v fazi začetka sprejemanja predlogov.
</p>
</div>
<p>Nato volivci oddajo predloge za glasovanje, kot to prikazuje tabela <a href="Truffle-Web3.html#tab:tabela-Oddaja-predlogov">13.4</a>. Vsak volivec odda 1 predlog, medtem ko 2. volivec odda 2.</p>
<table class="tabela-manjsa table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:tabela-Oddaja-predlogov">Tabela 13.4: </span>Oddaja predlogov za glasovanje
</caption>
<thead>
<tr>
<th style="text-align:left;">
 Uporabnik
</th>
<th style="text-align:left;">
Vloga
</th>
<th style="text-align:left;">
Predlog
</th>
<th style="text-align:center;">
Rezultat transakcije
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
 2. račun
</td>
<td style="text-align:left;">
 registriran volivec
</td>
<td style="text-align:left;">
Bohinjsko jezero
</td>
<td style="text-align:center;">
<i class="fas fa-check"></i>
</td>
</tr>
<tr>
<td style="text-align:left;">
 3. račun
</td>
<td style="text-align:left;">
 registriran volivec
</td>
<td style="text-align:left;">
Kočevski rog
</td>
<td style="text-align:center;">
<i class="fas fa-check"></i>
</td>
</tr>
<tr>
<td style="text-align:left;">
 3. račun
</td>
<td style="text-align:left;">
 registriran volivec
</td>
<td style="text-align:left;">
Triglav
</td>
<td style="text-align:center;">
<i class="fas fa-check"></i>
</td>
</tr>
<tr>
<td style="text-align:left;">
 4. račun
</td>
<td style="text-align:left;">
 registriran volivec
</td>
<td style="text-align:left;">
Rogla
</td>
<td style="text-align:center;">
<i class="fas fa-check"></i>
</td>
</tr>
<tr>
<td style="text-align:left;">
 5. račun
</td>
<td style="text-align:left;">
 neregistriran volivec
</td>
<td style="text-align:left;">
Blejski vintgar
</td>
<td style="text-align:center;">
<i class="fas fa-times"></i>
</td>
</tr>
</tbody>
</table>
<p>Med uporabniki, ki ravno tako poskušajo oddati predlog za glasovanje, je tudi <strong>neregistriran volivec</strong>, ki je edini izmed uporabnikov v tabeli <a href="Truffle-Web3.html#tab:tabela-Oddaja-predlogov">13.4</a>, ki mu operacija v aplikaciji ni dovoljena.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:slika-DApp-2-oddaja-predloga-seznam-predlogov"></span>
<img src="assets/img/DApp_2_Oddaja_predloga_Seznam_predlogov.png" alt="Po oddaji predloga, se le-ta prikaže na seznamu." width="800" />
<p class="caption">
Slika 13.20: Po oddaji predloga, se le-ta prikaže na seznamu.
</p>
</div>
<p>Kot prikazuje slika <a href="Truffle-Web3.html#fig:slika-DApp-2-oddaja-predloga-seznam-predlogov">13.20</a>, se ob uspešni transakciji na verigi blokov, predlogi prikažejo na seznamu predlogov.</p>
<blockquote>
<p><strong>Opomba</strong>: Če pride pri izvajanju transakcij do napake, je pogost razlog v medpomnjenju podatkov v denarnici MetaMask, medtem ko na privatno verigo Ganache večkrat naložimo novo pametno pogodbo, ki jo potem testiramo v DApp. Rešitev problema je ponavadi v resetiranju računa v denarnici MetaMask, tako da izberemo račun in nato <code>Nastavitve</code> <em>(angl. <code>Settings</code>)</em> → <code>Napredno</code> <em>(angl. <code>Advanced</code>)</em> → <em><code>Clear activity tab data</code></em>.</p>
</blockquote>
</div>
<div id="faza-konca-sprejemanja-predlogov" class="section level3 hasAnchor" number="13.3.7">
<h3><span class="header-section-number">13.3.7</span> Faza konca sprejemanja predlogov<a href="Truffle-Web3.html#faza-konca-sprejemanja-predlogov" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Ob zaključku procesa sprejemanja predlogov skrbnik poskrbi za <strong>prehod v konec faze sprejemanja predlogov</strong>, kar se odraža v statusu prikazanem na spletni strani (glej sliko <a href="Truffle-Web3.html#fig:slika-Dapp-status-Konec-postopka-sprejemanja-predlogov">13.21</a>).</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:slika-Dapp-status-Konec-postopka-sprejemanja-predlogov"></span>
<img src="assets/img/DApp_status_Konec_sprejemanja_predlogov.png" alt="Faza konca sprejemanja predlogov." width="800" />
<p class="caption">
Slika 13.21: Faza konca sprejemanja predlogov.
</p>
</div>
<blockquote>
<p><strong>Opomba</strong>: Pri zahtevanju zaključka faze sprejemanja predlogov moramo biti prijavljeni s skrbniškim računom, saj nam v nasprotnem primeru operacija ne bo dovoljena. V prejšnjem koraku smo namreč bili prijavljeni z neregistriranim volivcem.</p>
</blockquote>
</div>
<div id="faza-začetka-glasovanja" class="section level3 hasAnchor" number="13.3.8">
<h3><span class="header-section-number">13.3.8</span> Faza začetka glasovanja<a href="Truffle-Web3.html#faza-začetka-glasovanja" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Takoj po zaključenem procesu sprejemanja predlogov lahko skrbnik aktivira <strong>začetek faze glasovanja</strong>, kar prikazuje posodobljen status na sliki <a href="Truffle-Web3.html#fig:slika-Dapp-status-Zacetek-glasovanja">13.22</a>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:slika-Dapp-status-Zacetek-glasovanja"></span>
<img src="assets/img/DApp_status_Zacetek_glasovanja.png" alt="Faza začetka glasovanja" width="800" />
<p class="caption">
Slika 13.22: Faza začetka glasovanja
</p>
</div>
<p>Nato volivci glasujejo (glej sliko <a href="Truffle-Web3.html#fig:slika-DApp-3-oddaja-glasu">13.23</a>) tako, da iz seznama predlogov izberejo tistega, za katerega glasujejo.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:slika-DApp-3-oddaja-glasu"></span>
<img src="assets/img/DApp_3_Oddaja_glasu.png" alt="Pri glasovanju volivec izbere predlog iz seznama." width="800" />
<p class="caption">
Slika 13.23: Pri glasovanju volivec izbere predlog iz seznama.
</p>
</div>
<p>Vsak volivec odda 1 glas, medtem ko 3. volivec poskuša oddati 2, prav tako z glasovanjem poskusi neregistriran volivec, kot to prikazuje tabela <a href="Truffle-Web3.html#tab:tabela-Oddaja-glasov">13.5</a>.</p>
<table class="tabela-manjsa table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:tabela-Oddaja-glasov">Tabela 13.5: </span>Oddaja glasu
</caption>
<thead>
<tr>
<th style="text-align:left;">
 Uporabnik
</th>
<th style="text-align:left;">
Vloga
</th>
<th style="text-align:left;">
Glas
</th>
<th style="text-align:center;">
Rezultat transakcije
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
 2. račun
</td>
<td style="text-align:left;">
 registriran volivec
</td>
<td style="text-align:left;">
Kočevski rog
</td>
<td style="text-align:center;">
<i class="fas fa-check"></i>
</td>
</tr>
<tr>
<td style="text-align:left;">
 3. račun
</td>
<td style="text-align:left;">
 registriran volivec
</td>
<td style="text-align:left;">
Rogla
</td>
<td style="text-align:center;">
<i class="fas fa-check"></i>
</td>
</tr>
<tr>
<td style="text-align:left;">
 4. račun
</td>
<td style="text-align:left;">
 registriran volivec
</td>
<td style="text-align:left;">
Kočevski rog
</td>
<td style="text-align:center;">
<i class="fas fa-check"></i>
</td>
</tr>
<tr>
<td style="text-align:left;">
 4. račun
</td>
<td style="text-align:left;">
 registriran volivec
</td>
<td style="text-align:left;">
Rogla
</td>
<td style="text-align:center;">
<i class="fas fa-times"></i>
</td>
</tr>
<tr>
<td style="text-align:left;">
 5. račun
</td>
<td style="text-align:left;">
 neregistriran volivec
</td>
<td style="text-align:left;">
Rogla
</td>
<td style="text-align:center;">
<i class="fas fa-times"></i>
</td>
</tr>
</tbody>
</table>
<p>S podrobno analizo transakcij v privatni verigi blokov Ganache opazimo, da so v verigi blokov zavedene <span class="math inline">\(4\)</span> transakcije, medtem ko je bilo poskusov glasovanja <span class="math inline">\(5\)</span>.</p>
<div class="sourceCode" id="cb889"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb889-1"><a href="Truffle-Web3.html#cb889-1" tabindex="-1"></a><span class="ex">eth_sendRawTransaction</span></span>
<span id="cb889-2"><a href="Truffle-Web3.html#cb889-2" tabindex="-1"></a>  <span class="ex">Transaction:</span> 0xd592df3bb4850256116a0faf8d1abc0a71b9c295f15e94d2d705b6cc14f58624</span>
<span id="cb889-3"><a href="Truffle-Web3.html#cb889-3" tabindex="-1"></a>  <span class="ex">Gas</span> usage: 78020</span>
<span id="cb889-4"><a href="Truffle-Web3.html#cb889-4" tabindex="-1"></a>  <span class="ex">Block</span> number: 12</span>
<span id="cb889-5"><a href="Truffle-Web3.html#cb889-5" tabindex="-1"></a>  <span class="ex">Block</span> time: Wed Dec 06 2023 18:44:53 GMT+0100 <span class="er">(</span><span class="ex">GMT+01:00</span><span class="kw">)</span></span>
<span id="cb889-6"><a href="Truffle-Web3.html#cb889-6" tabindex="-1"></a><span class="ex">...</span></span>
<span id="cb889-7"><a href="Truffle-Web3.html#cb889-7" tabindex="-1"></a><span class="ex">eth_sendRawTransaction</span></span>
<span id="cb889-8"><a href="Truffle-Web3.html#cb889-8" tabindex="-1"></a>  <span class="ex">Transaction:</span> 0xaf6ca2b83b27034c0c3e822170efe5570dcfa25f137dd7571d96810111d132b9</span>
<span id="cb889-9"><a href="Truffle-Web3.html#cb889-9" tabindex="-1"></a>  <span class="ex">Gas</span> usage: 78020</span>
<span id="cb889-10"><a href="Truffle-Web3.html#cb889-10" tabindex="-1"></a>  <span class="ex">Block</span> number: 13</span>
<span id="cb889-11"><a href="Truffle-Web3.html#cb889-11" tabindex="-1"></a>  <span class="ex">Block</span> time: Wed Dec 06 2023 18:45:25 GMT+0100 <span class="er">(</span><span class="ex">GMT+01:00</span><span class="kw">)</span></span>
<span id="cb889-12"><a href="Truffle-Web3.html#cb889-12" tabindex="-1"></a><span class="ex">...</span></span>
<span id="cb889-13"><a href="Truffle-Web3.html#cb889-13" tabindex="-1"></a><span class="ex">eth_sendRawTransaction</span></span>
<span id="cb889-14"><a href="Truffle-Web3.html#cb889-14" tabindex="-1"></a>  <span class="ex">Transaction:</span> 0x97464d93c93b66d80d4bd49e53ac2355031ea0cfd46edc212415c9600cf381b6</span>
<span id="cb889-15"><a href="Truffle-Web3.html#cb889-15" tabindex="-1"></a>  <span class="ex">Gas</span> usage: 60920</span>
<span id="cb889-16"><a href="Truffle-Web3.html#cb889-16" tabindex="-1"></a>  <span class="ex">Block</span> number: 14</span>
<span id="cb889-17"><a href="Truffle-Web3.html#cb889-17" tabindex="-1"></a>  <span class="ex">Block</span> time: Wed Dec 06 2023 18:45:45 GMT+0100 <span class="er">(</span><span class="ex">GMT+01:00</span><span class="kw">)</span></span>
<span id="cb889-18"><a href="Truffle-Web3.html#cb889-18" tabindex="-1"></a><span class="ex">...</span></span>
<span id="cb889-19"><a href="Truffle-Web3.html#cb889-19" tabindex="-1"></a><span class="ex">eth_sendRawTransaction</span></span>
<span id="cb889-20"><a href="Truffle-Web3.html#cb889-20" tabindex="-1"></a>  <span class="ex">Transaction:</span> 0x9e7adcf4cead6dbbbf6b4f32eeecdffefe8730e0d31bf851f67256d3542cc19d</span>
<span id="cb889-21"><a href="Truffle-Web3.html#cb889-21" tabindex="-1"></a>  <span class="ex">Gas</span> usage: 26713</span>
<span id="cb889-22"><a href="Truffle-Web3.html#cb889-22" tabindex="-1"></a>  <span class="ex">Block</span> number: 15</span>
<span id="cb889-23"><a href="Truffle-Web3.html#cb889-23" tabindex="-1"></a>  <span class="ex">Block</span> time: Wed Dec 06 2023 18:46:07 GMT+0100 <span class="er">(</span><span class="ex">GMT+01:00</span><span class="kw">)</span></span>
<span id="cb889-24"><a href="Truffle-Web3.html#cb889-24" tabindex="-1"></a>  <span class="ex">Runtime</span> error: revert</span>
<span id="cb889-25"><a href="Truffle-Web3.html#cb889-25" tabindex="-1"></a>  <span class="ex">Revert</span> reason: the caller has already voted</span></code></pre></div>
<p>Kot je razvidno iz tabele <a href="Truffle-Web3.html#tab:tabela-Oddaja-glasov">13.5</a>, so bili prvi trije glasovi uspešno oddani. 2. glas 4. računa je bil tudi oddan, vendar ni bil upoštevan, saj preverjanje pogojev znotraj pametne pogodbe ni bilo uspešno (tj. težava večkratnega glasovanja). 5. glas neregistriranega volivca pa sploh ni bil posredovan na verigo blokov, saj smo to preprečili že v okviru aplikacije. Podobno bi sicer lahko naredili tudi pri večkratnem glasovanju, vendar smo želeli vpeljati “kazen” v obliki plačila stroškov neuspele transakcije pri tistih uporabnikih, ki bi želeli glasovati večkrat.</p>
<script>
  $(document).ready(function() {
    $("#faza-začetka-glasovanja code.bash:eq(0)").markRegExp(/0x.+/, options_dodaj);
    $("#faza-začetka-glasovanja code.bash:eq(0)").markRegExp(/revert/, options_dodaj);
    $("#faza-začetka-glasovanja code.bash:eq(0)").markRegExp(/the caller.+/, options_dodaj);
  });
</script>
</div>
<div id="faza-konca-glasovanja" class="section level3 hasAnchor" number="13.3.9">
<h3><span class="header-section-number">13.3.9</span> Faza konca glasovanja<a href="Truffle-Web3.html#faza-konca-glasovanja" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Skrbnik po poteku vnaprej dogovorjenega časa za glasovanja aktivira <strong>konec faze glasovanja</strong>, kar prikazuje posodobljen status na sliki <a href="Truffle-Web3.html#fig:slika-Dapp-status-Konec-glasovanja">13.24</a>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:slika-Dapp-status-Konec-glasovanja"></span>
<img src="assets/img/DApp_status_Konec_glasovanja.png" alt="Faza konca glasovanja" width="800" />
<p class="caption">
Slika 13.24: Faza konca glasovanja
</p>
</div>
<blockquote>
<p><strong>Opomba</strong>: Pri zahtevanju zaključka faze glasovanja moramo biti prijavljeni s skrbniškim računom, saj nam v nasprotnem primeru operacija ne bo dovoljena. V prejšnjem koraku smo namreč bili prijavljeni z neregistriranim volivcem.</p>
</blockquote>
</div>
<div id="zaključna-faza-preštetih-glasov" class="section level3 hasAnchor" number="13.3.10">
<h3><span class="header-section-number">13.3.10</span> Zaključna faza preštetih glasov<a href="Truffle-Web3.html#zaključna-faza-preštetih-glasov" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Skrbnik na koncu poskrbi še zgolj za sklepno dejanje <strong>štetja glasov</strong>, kar prikazuje posodobljen status na sliki <a href="Truffle-Web3.html#fig:slika-Dapp-status-Glasovi-presteti">13.25</a>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:slika-Dapp-status-Glasovi-presteti"></span>
<img src="assets/img/DApp_status_Glasovi_presteti.png" alt="Zaključna faza preštetih glasov" width="800" />
<p class="caption">
Slika 13.25: Zaključna faza preštetih glasov
</p>
</div>
<p>Rezultat glasovanja je na voljo vsem uporabnikov, kot prikazuje slika <a href="Truffle-Web3.html#fig:slika-DApp-6-rezultat-glasovanja">13.26</a>. V našem primeru je zmagal <strong>Kočevski rog</strong>, in sicer z <span class="math inline">\(2\)</span> prejetima glasovoma (od <span class="math inline">\(3\)</span> glasov).</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:slika-DApp-6-rezultat-glasovanja"></span>
<img src="assets/img/DApp_6_Rezultat_glasovanja.png" alt="Rezultat glasovanja je na voljo vsem uporabnikom." width="800" />
<p class="caption">
Slika 13.26: Rezultat glasovanja je na voljo vsem uporabnikom.
</p>
</div>
</div>
</div>
<div id="varna-postavitev" class="section level2 hasAnchor" number="13.4">
<h2><span class="header-section-number">13.4</span> Postavitev pametne pogodbe na zaščiteno verigo blokov<a href="Truffle-Web3.html#varna-postavitev" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Do tega trenutka smo testirali na privatnem omrežju, ki ni bilo zaščiteno. To nam je zelo poenostavilo razvoj in testiranje pametnih pogodb, saj računi na verigi blokov niso bili zaklenjeni in niso zahtevali gesla oz. privatnega ključa. Zato bomo sedaj postavili novo privatno verigo blokov, ki bo imela nespremenjene parametre kot sedaj, zgolj zaklenili bomo račun (<code>--wallet.lock</code>), kar posledično od uporabnikov zahteva obvezno avtentikacijo.</p>
<p>Najprej pripravimo novo skripto za zagon zaščitene privatne verige blokov.</p>
<p><code>package.json</code></p>
<div class="sourceCode" id="cb890"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb890-1"><a href="Truffle-Web3.html#cb890-1" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb890-2"><a href="Truffle-Web3.html#cb890-2" tabindex="-1"></a>  <span class="er">...</span></span>
<span id="cb890-3"><a href="Truffle-Web3.html#cb890-3" tabindex="-1"></a>    <span class="dt">&quot;ganache&quot;</span><span class="fu">:</span> <span class="st">&quot;ganache --wallet.totalAccounts 5 --wallet.defaultBalance 100 --wallet.mnemonic </span><span class="ch">\&quot;</span><span class="st">nuclear seat much sketch element fame hard hedgehog local expect speed cinnamon</span><span class="ch">\&quot;</span><span class="st"> --wallet.passphrase </span><span class="ch">\&quot;</span><span class="st">my little secret</span><span class="ch">\&quot;</span><span class="st">&quot;</span><span class="fu">,</span></span>
<span id="cb890-4"><a href="Truffle-Web3.html#cb890-4" tabindex="-1"></a>    <span class="dt">&quot;ganache-secure&quot;</span><span class="fu">:</span> <span class="st">&quot;ganache --wallet.totalAccounts 5 --wallet.defaultBalance 100 --wallet.mnemonic </span><span class="ch">\&quot;</span><span class="st">nuclear seat much sketch element fame hard hedgehog local expect speed cinnamon</span><span class="ch">\&quot;</span><span class="st"> --wallet.passphrase </span><span class="ch">\&quot;</span><span class="st">my little secret</span><span class="ch">\&quot;</span><span class="st"> --wallet.lock true&quot;</span></span>
<span id="cb890-5"><a href="Truffle-Web3.html#cb890-5" tabindex="-1"></a>  <span class="fu">}</span><span class="er">,</span></span>
<span id="cb890-6"><a href="Truffle-Web3.html#cb890-6" tabindex="-1"></a>  <span class="er">...</span></span>
<span id="cb890-7"><a href="Truffle-Web3.html#cb890-7" tabindex="-1"></a><span class="er">}</span></span></code></pre></div>
<p>Če verigo blokov poženemo, opazimo poleg računov ikono zaklenjene ključavnice <i class="fa-solid fa-lock"></i>, kar je indikator, da so <strong>računi zaklenjeni</strong>.</p>
<div class="sourceCode" id="cb891"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb891-1"><a href="Truffle-Web3.html#cb891-1" tabindex="-1"></a><span class="ex">$</span> npm run ganache-secure</span>
<span id="cb891-2"><a href="Truffle-Web3.html#cb891-2" tabindex="-1"></a></span>
<span id="cb891-3"><a href="Truffle-Web3.html#cb891-3" tabindex="-1"></a><span class="op">&gt;</span> demo@0.1.0 <span class="ex">ganache-secure</span></span>
<span id="cb891-4"><a href="Truffle-Web3.html#cb891-4" tabindex="-1"></a><span class="op">&gt;</span> ganache <span class="ex">--wallet.totalAccounts</span> 5 <span class="at">--wallet.defaultBalance</span> 100 <span class="at">--wallet.mnemonic</span> <span class="st">&quot;nuclear seat much sketch element fame hard hedgehog local expect speed cinnamon&quot;</span> <span class="at">--wallet.passphrase</span> <span class="st">&quot;my little secret&quot;</span> <span class="at">--wallet.lock</span> true</span>
<span id="cb891-5"><a href="Truffle-Web3.html#cb891-5" tabindex="-1"></a></span>
<span id="cb891-6"><a href="Truffle-Web3.html#cb891-6" tabindex="-1"></a><span class="ex">ganache</span> v7.9.1 <span class="er">(</span><span class="ex">@ganache/cli:</span> 0.10.1, @ganache/core: 0.10.1<span class="kw">)</span></span>
<span id="cb891-7"><a href="Truffle-Web3.html#cb891-7" tabindex="-1"></a><span class="ex">Starting</span> RPC server</span>
<span id="cb891-8"><a href="Truffle-Web3.html#cb891-8" tabindex="-1"></a><span class="ex">eth_blockNumber</span></span>
<span id="cb891-9"><a href="Truffle-Web3.html#cb891-9" tabindex="-1"></a></span>
<span id="cb891-10"><a href="Truffle-Web3.html#cb891-10" tabindex="-1"></a><span class="ex">Available</span> Accounts</span>
<span id="cb891-11"><a href="Truffle-Web3.html#cb891-11" tabindex="-1"></a><span class="ex">==================</span></span>
<span id="cb891-12"><a href="Truffle-Web3.html#cb891-12" tabindex="-1"></a><span class="kw">(</span><span class="ex">0</span><span class="kw">)</span> <span class="ex">0x818476CEc6a8D017DB14AB0A25EBE4eBdB518eD8</span> <span class="er">(</span><span class="ex">100</span> ETH<span class="kw">)</span> <span class="ex">🔒</span></span>
<span id="cb891-13"><a href="Truffle-Web3.html#cb891-13" tabindex="-1"></a><span class="kw">(</span><span class="ex">1</span><span class="kw">)</span> <span class="ex">0xf57FE3f91F261803a24e7092d2806f308DfE1cCe</span> <span class="er">(</span><span class="ex">100</span> ETH<span class="kw">)</span> <span class="ex">🔒</span></span>
<span id="cb891-14"><a href="Truffle-Web3.html#cb891-14" tabindex="-1"></a><span class="kw">(</span><span class="ex">2</span><span class="kw">)</span> <span class="ex">0xa61B49C72D7775a6dbe20C3Cc4EE2c211d98D97D</span> <span class="er">(</span><span class="ex">100</span> ETH<span class="kw">)</span> <span class="ex">🔒</span></span>
<span id="cb891-15"><a href="Truffle-Web3.html#cb891-15" tabindex="-1"></a><span class="kw">(</span><span class="ex">3</span><span class="kw">)</span> <span class="ex">0xcD1c3Ae672ed5F24f316967057062A957F64b25d</span> <span class="er">(</span><span class="ex">100</span> ETH<span class="kw">)</span> <span class="ex">🔒</span></span>
<span id="cb891-16"><a href="Truffle-Web3.html#cb891-16" tabindex="-1"></a><span class="kw">(</span><span class="ex">4</span><span class="kw">)</span> <span class="ex">0x60626BAcF68e0c1Cc5fC09bEA63196D4C5B374e8</span> <span class="er">(</span><span class="ex">100</span> ETH<span class="kw">)</span> <span class="ex">🔒</span></span>
<span id="cb891-17"><a href="Truffle-Web3.html#cb891-17" tabindex="-1"></a></span>
<span id="cb891-18"><a href="Truffle-Web3.html#cb891-18" tabindex="-1"></a><span class="ex">Private</span> Keys</span>
<span id="cb891-19"><a href="Truffle-Web3.html#cb891-19" tabindex="-1"></a><span class="ex">==================</span></span>
<span id="cb891-20"><a href="Truffle-Web3.html#cb891-20" tabindex="-1"></a><span class="kw">(</span><span class="ex">0</span><span class="kw">)</span> <span class="ex">0x9474979ddf5fad50ae845de9fffd43baff65aa67c4701d9245fc24f097eea42e</span></span>
<span id="cb891-21"><a href="Truffle-Web3.html#cb891-21" tabindex="-1"></a><span class="kw">(</span><span class="ex">1</span><span class="kw">)</span> <span class="ex">0x867d08d868d5d0e44564ff7bd1a5c4814f160261e3fd1aa5ca38b2e802ad2c33</span></span>
<span id="cb891-22"><a href="Truffle-Web3.html#cb891-22" tabindex="-1"></a><span class="kw">(</span><span class="ex">2</span><span class="kw">)</span> <span class="ex">0xa628cb6805ed47b701a5085cc0ebe59181ff1eda8bb740658b78cb18d2b3a578</span></span>
<span id="cb891-23"><a href="Truffle-Web3.html#cb891-23" tabindex="-1"></a><span class="kw">(</span><span class="ex">3</span><span class="kw">)</span> <span class="ex">0x50abf45326e49d2a0af6e64fc4b4b8f4ee458ff8cf29bef9d70e2d13c53a0beb</span></span>
<span id="cb891-24"><a href="Truffle-Web3.html#cb891-24" tabindex="-1"></a><span class="kw">(</span><span class="ex">4</span><span class="kw">)</span> <span class="ex">0x265d0f7bbe1974d506c0dac9e231d4fe77d8e9fa6298b5bf3baf67fd00a80e64</span></span>
<span id="cb891-25"><a href="Truffle-Web3.html#cb891-25" tabindex="-1"></a></span>
<span id="cb891-26"><a href="Truffle-Web3.html#cb891-26" tabindex="-1"></a><span class="ex">HD</span> Wallet</span>
<span id="cb891-27"><a href="Truffle-Web3.html#cb891-27" tabindex="-1"></a><span class="ex">==================</span></span>
<span id="cb891-28"><a href="Truffle-Web3.html#cb891-28" tabindex="-1"></a><span class="ex">Mnemonic:</span>      nuclear seat much sketch element fame hard hedgehog local expect speed cinnamon</span>
<span id="cb891-29"><a href="Truffle-Web3.html#cb891-29" tabindex="-1"></a><span class="ex">Base</span> HD Path:  m/44<span class="st">&#39;/60&#39;</span>/0<span class="st">&#39;/0/{account_index}</span></span>
<span id="cb891-30"><a href="Truffle-Web3.html#cb891-30" tabindex="-1"></a></span>
<span id="cb891-31"><a href="Truffle-Web3.html#cb891-31" tabindex="-1"></a><span class="st">Default Gas Price</span></span>
<span id="cb891-32"><a href="Truffle-Web3.html#cb891-32" tabindex="-1"></a><span class="st">==================</span></span>
<span id="cb891-33"><a href="Truffle-Web3.html#cb891-33" tabindex="-1"></a><span class="st">2000000000</span></span>
<span id="cb891-34"><a href="Truffle-Web3.html#cb891-34" tabindex="-1"></a></span>
<span id="cb891-35"><a href="Truffle-Web3.html#cb891-35" tabindex="-1"></a><span class="st">BlockGas Limit</span></span>
<span id="cb891-36"><a href="Truffle-Web3.html#cb891-36" tabindex="-1"></a><span class="st">==================</span></span>
<span id="cb891-37"><a href="Truffle-Web3.html#cb891-37" tabindex="-1"></a><span class="st">30000000</span></span>
<span id="cb891-38"><a href="Truffle-Web3.html#cb891-38" tabindex="-1"></a></span>
<span id="cb891-39"><a href="Truffle-Web3.html#cb891-39" tabindex="-1"></a><span class="st">Call Gas Limit</span></span>
<span id="cb891-40"><a href="Truffle-Web3.html#cb891-40" tabindex="-1"></a><span class="st">==================</span></span>
<span id="cb891-41"><a href="Truffle-Web3.html#cb891-41" tabindex="-1"></a><span class="st">50000000</span></span>
<span id="cb891-42"><a href="Truffle-Web3.html#cb891-42" tabindex="-1"></a></span>
<span id="cb891-43"><a href="Truffle-Web3.html#cb891-43" tabindex="-1"></a><span class="st">Chain</span></span>
<span id="cb891-44"><a href="Truffle-Web3.html#cb891-44" tabindex="-1"></a><span class="st">==================</span></span>
<span id="cb891-45"><a href="Truffle-Web3.html#cb891-45" tabindex="-1"></a><span class="st">Hardfork: shanghai</span></span>
<span id="cb891-46"><a href="Truffle-Web3.html#cb891-46" tabindex="-1"></a><span class="st">Id:       1337</span></span>
<span id="cb891-47"><a href="Truffle-Web3.html#cb891-47" tabindex="-1"></a></span>
<span id="cb891-48"><a href="Truffle-Web3.html#cb891-48" tabindex="-1"></a><span class="st">RPC Listening on 127.0.0.1:8545</span></span></code></pre></div>
<p>Ko poskušamo pametno pogodbo postaviti na verigo blokov, nam sistem, kot pričakovano, vrne <strong>napako</strong>, saj je <strong>potrebna avtentikacija uporabnika</strong>.</p>
<div class="sourceCode" id="cb892"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb892-1"><a href="Truffle-Web3.html#cb892-1" tabindex="-1"></a><span class="ex">$</span> cd dapp</span>
<span id="cb892-2"><a href="Truffle-Web3.html#cb892-2" tabindex="-1"></a><span class="ex">$</span> truffle migrate</span>
<span id="cb892-3"><a href="Truffle-Web3.html#cb892-3" tabindex="-1"></a></span>
<span id="cb892-4"><a href="Truffle-Web3.html#cb892-4" tabindex="-1"></a><span class="ex">Compiling</span> your contracts...</span>
<span id="cb892-5"><a href="Truffle-Web3.html#cb892-5" tabindex="-1"></a><span class="ex">===========================</span></span>
<span id="cb892-6"><a href="Truffle-Web3.html#cb892-6" tabindex="-1"></a><span class="op">&gt;</span> Everything <span class="ex">is</span> up to date, there is nothing to compile.</span>
<span id="cb892-7"><a href="Truffle-Web3.html#cb892-7" tabindex="-1"></a></span>
<span id="cb892-8"><a href="Truffle-Web3.html#cb892-8" tabindex="-1"></a><span class="ex">Starting</span> migrations...</span>
<span id="cb892-9"><a href="Truffle-Web3.html#cb892-9" tabindex="-1"></a><span class="ex">======================</span></span>
<span id="cb892-10"><a href="Truffle-Web3.html#cb892-10" tabindex="-1"></a><span class="op">&gt;</span> Network <span class="ex">name:</span>    <span class="st">&#39;development&#39;</span></span>
<span id="cb892-11"><a href="Truffle-Web3.html#cb892-11" tabindex="-1"></a><span class="op">&gt;</span> Network <span class="ex">id:</span>      1701885519282</span>
<span id="cb892-12"><a href="Truffle-Web3.html#cb892-12" tabindex="-1"></a><span class="op">&gt;</span> Block <span class="ex">gas</span> limit: 30000000 <span class="er">(</span><span class="ex">0x1c9c380</span><span class="kw">)</span></span>
<span id="cb892-13"><a href="Truffle-Web3.html#cb892-13" tabindex="-1"></a></span>
<span id="cb892-14"><a href="Truffle-Web3.html#cb892-14" tabindex="-1"></a><span class="ex">1_deploy_contracts.js</span></span>
<span id="cb892-15"><a href="Truffle-Web3.html#cb892-15" tabindex="-1"></a><span class="ex">=====================</span></span>
<span id="cb892-16"><a href="Truffle-Web3.html#cb892-16" tabindex="-1"></a>   <span class="ex">Deploying</span> <span class="st">&#39;SimpleVoting&#39;</span></span>
<span id="cb892-17"><a href="Truffle-Web3.html#cb892-17" tabindex="-1"></a>   <span class="ex">------------------------</span></span>
<span id="cb892-18"><a href="Truffle-Web3.html#cb892-18" tabindex="-1"></a> <span class="ex">***</span> Deployment Failed <span class="pp">***</span></span>
<span id="cb892-19"><a href="Truffle-Web3.html#cb892-19" tabindex="-1"></a> </span>
<span id="cb892-20"><a href="Truffle-Web3.html#cb892-20" tabindex="-1"></a><span class="st">&quot;SimpleVoting&quot;</span> <span class="at">--</span> authentication needed: passphrase or unlock.</span>
<span id="cb892-21"><a href="Truffle-Web3.html#cb892-21" tabindex="-1"></a></span>
<span id="cb892-22"><a href="Truffle-Web3.html#cb892-22" tabindex="-1"></a><span class="ex">Exiting:</span> Review successful transactions manually by checking the transaction hashes above on Etherscan.</span>
<span id="cb892-23"><a href="Truffle-Web3.html#cb892-23" tabindex="-1"></a></span>
<span id="cb892-24"><a href="Truffle-Web3.html#cb892-24" tabindex="-1"></a><span class="ex">Error:</span>  <span class="pp">***</span> Deployment Failed <span class="pp">***</span></span>
<span id="cb892-25"><a href="Truffle-Web3.html#cb892-25" tabindex="-1"></a></span>
<span id="cb892-26"><a href="Truffle-Web3.html#cb892-26" tabindex="-1"></a><span class="st">&quot;SimpleVoting&quot;</span> <span class="at">--</span> authentication needed: passphrase or unlock.</span>
<span id="cb892-27"><a href="Truffle-Web3.html#cb892-27" tabindex="-1"></a>    <span class="ex">at</span> /.nvm/versions/node/v18.17.1/lib/node_modules/truffle/build/webpack:/packages/deployer/src/deployment.js:330:1</span>
<span id="cb892-28"><a href="Truffle-Web3.html#cb892-28" tabindex="-1"></a>    <span class="ex">at</span> processTicksAndRejections <span class="er">(</span><span class="ex">node:internal/process/task_queues:95:5</span><span class="kw">)</span></span>
<span id="cb892-29"><a href="Truffle-Web3.html#cb892-29" tabindex="-1"></a><span class="ex">Truffle</span> v5.11.5 <span class="er">(</span><span class="ex">core:</span> 5.11.5<span class="kw">)</span></span>
<span id="cb892-30"><a href="Truffle-Web3.html#cb892-30" tabindex="-1"></a><span class="ex">Node</span> v18.17.1</span></code></pre></div>
<p>Najprej bomo potrebovali knjižnico <a href="https://www.npmjs.com/package/@truffle/hdwallet-provider"><i class="fa-brands fa-square-js"></i><code>@truffle/hdwallet-provider</code></a>, ki nam omogoča postavitev pametne pogodbe na privatno verigo z uporabo ogrodja Truffle.</p>
<div class="sourceCode" id="cb893"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb893-1"><a href="Truffle-Web3.html#cb893-1" tabindex="-1"></a><span class="ex">$</span> npm install @truffle/hdwallet-provider</span></code></pre></div>
<p>Konfiguracijo postavitve pametne pogodbe na zaščiteno privatno verigo bomo dopolnili v datoteki <code>truffe-config.js</code>, kamor dodamo novo omrežje <code>private</code>.</p>
<p>Privatni ključ uporabnika, ki postavlja pogodbo na verigo blokov, bomo shranili v okoljsko spremenljivko <code>MNEMONIC</code> in jo dodali v datoteko <code>.env</code>.</p>
<p><code>.env</code></p>
<div class="sourceCode" id="cb894"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb894-1"><a href="Truffle-Web3.html#cb894-1" tabindex="-1"></a><span class="co"># Blockchain</span></span>
<span id="cb894-2"><a href="Truffle-Web3.html#cb894-2" tabindex="-1"></a><span class="va">MNEMONIC</span><span class="op">=</span>0x9474979ddf5fad50ae845de9fffd43baff65aa67c4701d9245fc24f097eea42e</span></code></pre></div>
<p><code>dapp/truffle-config.js</code></p>
<div class="sourceCode" id="cb895"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb895-1"><a href="Truffle-Web3.html#cb895-1" tabindex="-1"></a><span class="co">// require(&quot;dotenv&quot;).config({ path: &quot;../.env&quot; });</span></span>
<span id="cb895-2"><a href="Truffle-Web3.html#cb895-2" tabindex="-1"></a><span class="co">// const { MNEMONIC, PROJECT_ID } = process.env;</span></span>
<span id="cb895-3"><a href="Truffle-Web3.html#cb895-3" tabindex="-1"></a><span class="co">// const HDWalletProvider = require(&quot;@truffle/hdwallet-provider&quot;);</span></span>
<span id="cb895-4"><a href="Truffle-Web3.html#cb895-4" tabindex="-1"></a>module<span class="op">.</span><span class="at">exports</span> <span class="op">=</span> {</span>
<span id="cb895-5"><a href="Truffle-Web3.html#cb895-5" tabindex="-1"></a>  <span class="op">...</span></span>
<span id="cb895-6"><a href="Truffle-Web3.html#cb895-6" tabindex="-1"></a>  <span class="dt">networks</span><span class="op">:</span> {</span>
<span id="cb895-7"><a href="Truffle-Web3.html#cb895-7" tabindex="-1"></a>    <span class="op">...</span></span>
<span id="cb895-8"><a href="Truffle-Web3.html#cb895-8" tabindex="-1"></a>    <span class="dt">development</span><span class="op">:</span> {</span>
<span id="cb895-9"><a href="Truffle-Web3.html#cb895-9" tabindex="-1"></a>      <span class="dt">host</span><span class="op">:</span> <span class="st">&quot;127.0.0.1&quot;</span></span>
<span id="cb895-10"><a href="Truffle-Web3.html#cb895-10" tabindex="-1"></a>      <span class="dt">port</span><span class="op">:</span> <span class="dv">8545</span><span class="op">,</span></span>
<span id="cb895-11"><a href="Truffle-Web3.html#cb895-11" tabindex="-1"></a>      <span class="dt">network_id</span><span class="op">:</span> <span class="st">&quot;*&quot;</span><span class="op">,</span></span>
<span id="cb895-12"><a href="Truffle-Web3.html#cb895-12" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb895-13"><a href="Truffle-Web3.html#cb895-13" tabindex="-1"></a>    <span class="dt">private</span><span class="op">:</span> {</span>
<span id="cb895-14"><a href="Truffle-Web3.html#cb895-14" tabindex="-1"></a>      <span class="dt">provider</span><span class="op">:</span> () <span class="kw">=&gt;</span> <span class="kw">new</span> <span class="fu">HDWalletProvider</span>([MNEMONIC]<span class="op">,</span> <span class="vs">`http://127.0.0.1:8545`</span>)<span class="op">,</span></span>
<span id="cb895-15"><a href="Truffle-Web3.html#cb895-15" tabindex="-1"></a>      <span class="dt">network_id</span><span class="op">:</span> <span class="st">&quot;*&quot;</span><span class="op">,</span></span>
<span id="cb895-16"><a href="Truffle-Web3.html#cb895-16" tabindex="-1"></a>      <span class="dt">from</span><span class="op">:</span> <span class="st">&quot;0x818476CEc6a8D017DB14AB0A25EBE4eBdB518eD8&quot;</span><span class="op">,</span></span>
<span id="cb895-17"><a href="Truffle-Web3.html#cb895-17" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb895-18"><a href="Truffle-Web3.html#cb895-18" tabindex="-1"></a>    <span class="op">...</span></span>
<span id="cb895-19"><a href="Truffle-Web3.html#cb895-19" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb895-20"><a href="Truffle-Web3.html#cb895-20" tabindex="-1"></a>  <span class="op">...</span></span>
<span id="cb895-21"><a href="Truffle-Web3.html#cb895-21" tabindex="-1"></a>}<span class="op">;</span></span></code></pre></div>
<p>Zdaj lahko zahtevamo postavitev pametne pogodbe na omrežje <code>private</code>.</p>
<div class="sourceCode" id="cb896"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb896-1"><a href="Truffle-Web3.html#cb896-1" tabindex="-1"></a><span class="ex">$</span> truffle migrate <span class="at">--network</span> private</span>
<span id="cb896-2"><a href="Truffle-Web3.html#cb896-2" tabindex="-1"></a></span>
<span id="cb896-3"><a href="Truffle-Web3.html#cb896-3" tabindex="-1"></a><span class="ex">Compiling</span> your contracts...</span>
<span id="cb896-4"><a href="Truffle-Web3.html#cb896-4" tabindex="-1"></a><span class="ex">===========================</span></span>
<span id="cb896-5"><a href="Truffle-Web3.html#cb896-5" tabindex="-1"></a><span class="op">&gt;</span> Everything <span class="ex">is</span> up to date, there is nothing to compile.</span>
<span id="cb896-6"><a href="Truffle-Web3.html#cb896-6" tabindex="-1"></a></span>
<span id="cb896-7"><a href="Truffle-Web3.html#cb896-7" tabindex="-1"></a><span class="ex">Starting</span> migrations...</span>
<span id="cb896-8"><a href="Truffle-Web3.html#cb896-8" tabindex="-1"></a><span class="ex">======================</span></span>
<span id="cb896-9"><a href="Truffle-Web3.html#cb896-9" tabindex="-1"></a><span class="op">&gt;</span> Network <span class="ex">name:</span>    <span class="st">&#39;private&#39;</span></span>
<span id="cb896-10"><a href="Truffle-Web3.html#cb896-10" tabindex="-1"></a><span class="op">&gt;</span> Network <span class="ex">id:</span>      1701885519282</span>
<span id="cb896-11"><a href="Truffle-Web3.html#cb896-11" tabindex="-1"></a><span class="op">&gt;</span> Block <span class="ex">gas</span> limit: 30000000 <span class="er">(</span><span class="ex">0x1c9c380</span><span class="kw">)</span></span>
<span id="cb896-12"><a href="Truffle-Web3.html#cb896-12" tabindex="-1"></a></span>
<span id="cb896-13"><a href="Truffle-Web3.html#cb896-13" tabindex="-1"></a><span class="ex">1_deploy_contracts.js</span></span>
<span id="cb896-14"><a href="Truffle-Web3.html#cb896-14" tabindex="-1"></a><span class="ex">=====================</span></span>
<span id="cb896-15"><a href="Truffle-Web3.html#cb896-15" tabindex="-1"></a>   <span class="ex">Deploying</span> <span class="st">&#39;SimpleVoting&#39;</span></span>
<span id="cb896-16"><a href="Truffle-Web3.html#cb896-16" tabindex="-1"></a>   <span class="ex">------------------------</span></span>
<span id="cb896-17"><a href="Truffle-Web3.html#cb896-17" tabindex="-1"></a>   <span class="op">&gt;</span> transaction <span class="ex">hash:</span>    0x4d62d3d0ec9b099a9f5947daaa24f67e60ba41fd02ec517e4b932a652b780128</span>
<span id="cb896-18"><a href="Truffle-Web3.html#cb896-18" tabindex="-1"></a>   <span class="op">&gt;</span> Blocks: <span class="ex">0</span>            Seconds: 0</span>
<span id="cb896-19"><a href="Truffle-Web3.html#cb896-19" tabindex="-1"></a>   <span class="op">&gt;</span> contract <span class="ex">address:</span>    0xD76d2DF6994C2e515F8e2279CBd4309C144EC395</span>
<span id="cb896-20"><a href="Truffle-Web3.html#cb896-20" tabindex="-1"></a>   <span class="op">&gt;</span> block <span class="ex">number:</span>        1</span>
<span id="cb896-21"><a href="Truffle-Web3.html#cb896-21" tabindex="-1"></a>   <span class="op">&gt;</span> block <span class="ex">timestamp:</span>     1701886034</span>
<span id="cb896-22"><a href="Truffle-Web3.html#cb896-22" tabindex="-1"></a>   <span class="op">&gt;</span> account:             <span class="ex">0x818476CEc6a8D017DB14AB0A25EBE4eBdB518eD8</span></span>
<span id="cb896-23"><a href="Truffle-Web3.html#cb896-23" tabindex="-1"></a>   <span class="op">&gt;</span> balance:             <span class="ex">99.99262097425</span></span>
<span id="cb896-24"><a href="Truffle-Web3.html#cb896-24" tabindex="-1"></a>   <span class="op">&gt;</span> gas <span class="ex">used:</span>            2186378 <span class="er">(</span><span class="ex">0x215c8a</span><span class="kw">)</span></span>
<span id="cb896-25"><a href="Truffle-Web3.html#cb896-25" tabindex="-1"></a>   <span class="op">&gt;</span> gas <span class="ex">price:</span>           3.375 gwei</span>
<span id="cb896-26"><a href="Truffle-Web3.html#cb896-26" tabindex="-1"></a>   <span class="op">&gt;</span> value <span class="ex">sent:</span>          0 ETH</span>
<span id="cb896-27"><a href="Truffle-Web3.html#cb896-27" tabindex="-1"></a>   <span class="op">&gt;</span> total <span class="ex">cost:</span>          0.00737902575 ETH</span>
<span id="cb896-28"><a href="Truffle-Web3.html#cb896-28" tabindex="-1"></a>   <span class="op">&gt;</span> Saving <span class="ex">artifacts</span></span>
<span id="cb896-29"><a href="Truffle-Web3.html#cb896-29" tabindex="-1"></a>   <span class="ex">-------------------------------------</span></span>
<span id="cb896-30"><a href="Truffle-Web3.html#cb896-30" tabindex="-1"></a>   <span class="op">&gt;</span> Total <span class="ex">cost:</span>       0.00737902575 ETH</span>
<span id="cb896-31"><a href="Truffle-Web3.html#cb896-31" tabindex="-1"></a></span>
<span id="cb896-32"><a href="Truffle-Web3.html#cb896-32" tabindex="-1"></a><span class="ex">Summary</span></span>
<span id="cb896-33"><a href="Truffle-Web3.html#cb896-33" tabindex="-1"></a><span class="ex">=======</span></span>
<span id="cb896-34"><a href="Truffle-Web3.html#cb896-34" tabindex="-1"></a><span class="op">&gt;</span> Total <span class="ex">deployments:</span>   1</span>
<span id="cb896-35"><a href="Truffle-Web3.html#cb896-35" tabindex="-1"></a><span class="op">&gt;</span> Final <span class="ex">cost:</span>          0.00737902575 ETH</span></code></pre></div>
<p>Pogodba je po uspešni postavitvi na voljo na privatni verigi, na katero lahko povežemo našo decentralizirano aplikacijo.</p>
<script>
  $(document).ready(function() {
    $("#varna-postavitev code.json:eq(0)").markRegExp(/,[^"]+?"ganache-secure".+/, options_dodaj);
    $("#varna-postavitev code.bash:eq(0)").markRegExp(/npm run ganache-secure/, options_dodaj);
    $("#varna-postavitev code.bash:eq(1)").markRegExp(/(cd dapp|truffle migrate)/, options_dodaj);
    $("#varna-postavitev code.bash:eq(2)").markRegExp(/npm.+/, options_dodaj);
    $("#varna-postavitev code.bash:eq(3)").markRegExp(/.+/, options_dodaj);
    $("#varna-postavitev code.javascript:eq(0)").markRegExp(/(\/\/ |, PROJECT_ID)/, options_izbrisi);
    $("#varna-postavitev code.javascript:eq(0)").markRegExp(/\s+?private:[\s\S]+?},/, options_dodaj);
    $("#varna-postavitev code.javascript:eq(0)").markRegExp(/{ path: .+? }/, options_dodaj);
    $("#varna-postavitev code.bash:eq(4)").markRegExp(/truffle migrate.+/, options_dodaj);
  });
</script>
</div>
<div id="postavitev-pametne-pogodbe-s-pomočjo-metamask" class="section level2 hasAnchor" number="13.5">
<h2><span class="header-section-number">13.5</span> Postavitev pametne pogodbe s pomočjo MetaMask<a href="Truffle-Web3.html#postavitev-pametne-pogodbe-s-pomočjo-metamask" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Za hiter razvoj pametne pogodbe lahko uporabimo spletno razvojno okolje <a href="https://remix.ethereum.org/"><i class="fa-solid fa-earth-europe"></i><strong>Remix</strong></a>, kjer jo lahko prevedemo in nato v povezavi z <a href="https://metamask.io/"><i class="fa-solid fa-earth-europe"></i><strong>MetaMask</strong></a> tudi postavimo na poljubno omrežje (npr. javno glavno omrežje, testna omrežja ali zasebno omrežje Ganache). MetaMask nam omogoča komunikacijo z omrežjem, brez da bi morali namestiti in vzdrževati programsko opremo Ethereum.</p>
<blockquote>
<p><strong>Opomba</strong>: Za postavitev pogodbe na javnem omrežju boste potrebovali <i class="fa-brands fa-ethereum"></i><strong>ETH</strong>, medtem ko lahko na testnih omrežjih pridobite manjše brezplačne količine za testiranje. Kot smo videli že prej, si lahko v lastnem osebnem omrežju Ganache nastavimo poljubno stanje na računih, ki jih uporabljamo za testiranje.</p>
</blockquote>
<p>V nadaljevanju bomo demonstrirali postavitev <strong>pametne pogodbe <code>SimpleCoin</code></strong>, ki smo jo razvili v okviru <a href="DApps-pametne-pogodbe.html#razvoj-enostavne-pogodbe">11.4.2</a>, v osebnem omrežju Ganache.</p>
<p>V okolju Remix najprej odpremo izvorno kodo pametne pogodbe <code>SimpleCoin</code> in jo prevedemo. V denarnici MetaMask izberemo skrbnika in ga povežemo z okoljem Remix.</p>
<p>Nato v zavihku <strong>Deploy &amp; run transaction</strong> med okolji izberemo <strong>Injected Provider - MetaMask</strong>, kot je prikazano na sliki <a href="Truffle-Web3.html#fig:slika-Remix-deploy-injected-Web3">13.27</a>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:slika-Remix-deploy-injected-Web3"></span>
<img src="assets/img/Remix_Deploy_Injected_Web3.png" alt="Postavitev pametne pogodbe preko MetaMask" width="200" />
<p class="caption">
Slika 13.27: Postavitev pametne pogodbe preko MetaMask
</p>
</div>
<p>Iz seznama izberemo pametno pogodbo <code>SimpleCoin</code> ter parameter začetnega stanja nastavimo na <span class="math inline">\(200\)</span> (glej sliko <a href="Truffle-Web3.html#fig:slika-Remix-deploy-injected-Web3">13.27</a>). Ko akcijo potrdimo s klikom na gumb <strong>Deploy</strong>, smo preusmerjeni v vmesnik denarnice MetaMask (glej sliko <a href="Truffle-Web3.html#fig:slika-MetaMask-Ganache-deploy">13.28</a>). Na tem mestu je prikazan povzetek stroškov postavitve pametne pogodbe na omrežje.</p>
<div style="display: flex; width:100%">
<div style="width:50%">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:slika-MetaMask-Ganache-deploy"></span>
<img src="assets/img/MetaMask_Ganache_deploy.png" alt="Potrditev postavitve pametne pogodbe in povzetek stroškov transakcije" width="250" />
<p class="caption">
Slika 13.28: Potrditev postavitve pametne pogodbe in povzetek stroškov transakcije
</p>
</div>
</div>
<div style="width:50%">
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:slika-MetaMask-Ganache-deploy-potrdilo"></span>
<img src="assets/img/MetaMask_Ganache_deploy_potrdilo.png" alt="Potrditev kreiranja pogodbe je prikazana med aktivnosti denarnice" width="250" />
<p class="caption">
Slika 13.29: Potrditev kreiranja pogodbe je prikazana med aktivnosti denarnice
</p>
</div>
</div>
</div>
<p>Ko dobimo potrditev o kreiranju pogodbe, je le-to tudi prikazano med aktivnostmi denarnice, kar prikazuje slika <a href="Truffle-Web3.html#fig:slika-MetaMask-Ganache-deploy-potrdilo">13.29</a>.</p>
<p>Potrditev lahko poiščemo tudi v dnevniških zapisih privatne verige Ganache, kjer zadnja transakcija prikazuje postavitveno transakcijo pogodbe, posredovane preko denarnice MetaMask.</p>
<div class="sourceCode" id="cb897"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb897-1"><a href="Truffle-Web3.html#cb897-1" tabindex="-1"></a><span class="ex">eth_sendRawTransaction</span></span>
<span id="cb897-2"><a href="Truffle-Web3.html#cb897-2" tabindex="-1"></a>  <span class="ex">Transaction:</span> 0xc4104a17bcb1c0d02564feebd6e62cee9ab7934df84c64176e64bf63f7abe472</span>
<span id="cb897-3"><a href="Truffle-Web3.html#cb897-3" tabindex="-1"></a>  <span class="ex">Contract</span> created: 0xe67ade09f98141cddefac37dec0c78976fb28ca6</span>
<span id="cb897-4"><a href="Truffle-Web3.html#cb897-4" tabindex="-1"></a>  <span class="ex">Gas</span> usage: 873782</span>
<span id="cb897-5"><a href="Truffle-Web3.html#cb897-5" tabindex="-1"></a>  <span class="ex">Block</span> number: 2</span>
<span id="cb897-6"><a href="Truffle-Web3.html#cb897-6" tabindex="-1"></a>  <span class="ex">Block</span> time: Wed Dec 06 2023 19:14:54 GMT+0100 <span class="er">(</span><span class="ex">GMT+01:00</span><span class="kw">)</span></span></code></pre></div>
<h3>
Dodatno gradivo
</h3>
<table class="dodatnoGradivo">
<tr>
<td>
<p><img src="assets/img/Infante_2019.jpg" width="200" style="display: block; margin: auto;" /></p>
</td>
<td>
<ul>
<li><strong>Building Ethereum Dapps: Decentralized applications on the Ethereum blockchain</strong>, 1<sup>st</sup> edition <span class="citation">(<a href="literatura.html#ref-infante2019">Infante 2019</a>)</span>
<ul>
<li><strong>Part 2</strong>
<ul>
<li><strong>Chapter 8</strong>: Managing smart contracts with Web3.js</li>
</ul></li>
<li><strong>Part 3</strong>
<ul>
<li><strong>Chapter 10</strong>: Unit testing contracts with Mocha</li>
<li><strong>Chapter 11</strong>: Improving the development cycle with Truffle</li>
<li><strong>Chapter 12</strong>: Putting it all together: Building a complete voting Dapp</li>
</ul></li>
</ul></li>
</ul>
</td>
</tr>
</table>

</div>
</div>



<script type="text/javascript">
  $(document).ready(function() {
    
    $("a").click(function(e) {
      if (
        $(this).has(".fa-solid").length == 1 || 
        $(this).has(".fa-brands").length == 1 || 
        $(this).has(".fa-regular").length == 1 || 
        $(this).has("img.git").length == 1
      ) {
        e.preventDefault();
        window.open($(this).attr("href"), '_blank');
      }
    });
  });
</script>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Q6109Y2092"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-Q6109Y2092');
</script>
<h3><i class="fas fa-globe-europe" style="padding-right:5px"></i>Choose your language</h3>

<p>Students whose mother tongue is not Slovene can choose to <a onclick="loadGoogleTranslate()" class="google-translate-povezava"><i class="fas fa-sync-alt" style="padding-right:3px"></i>translate the contents of the script</a> into the selected language.</p>

<div id="google_translate_element"></div>

<script type="text/javascript">
  function googleTranslateElementInit() {
    new google.translate.TranslateElement({
      pageLanguage: 'sl', 
      includedLanguages: 'en,mk', 
      layout: google.translate.TranslateElement.InlineLayout.SIMPLE, 
      multilanguagePage: true
    }, 'google_translate_element');
  }
  
  function loadGoogleTranslate() {
    if ($("script[src='//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit']").length == 0) {
      var googleTranslateScript = document.createElement('script');
      googleTranslateScript.type = 'text/javascript';
      googleTranslateScript.async = true;
      googleTranslateScript.src = '//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0] ).appendChild(googleTranslateScript);    
    }
  }
  
  $(document).ready(function() {
    // Če gre za administrativno stran, potem skrij obrazec za komentarje
    $("h1:contains('Administracija'),h1:contains('Komentarji'),h1:contains('Analiza začetnega vprašalnika'),h1:contains('Lastni projekt'),h1:contains('pisni izpit'),h1:contains('Pisni izpiti')").filter(function() {
      $("h3:contains('Choose your language')").next().hide();
      $("h3:contains('Choose your language')").hide();
    });
  });
</script>
            </section>

          </div>
        </div>
      </div>
<a href="LP2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="Varnost-testiranje-PWA.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="assets/lib/gitbook-2.6.7/js/app.min.js"></script>
<script src="assets/lib/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="assets/lib/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="assets/lib/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="assets/lib/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="assets/lib/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="assets/lib/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="assets/lib/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": {}
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 1
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
